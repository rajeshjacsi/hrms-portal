(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const p of e.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function r(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(n){if(n.ep)return;n.ep=!0;const e=r(n);fetch(n.href,e)}})();var qR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kA(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function _A(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var t=i.default;if(typeof t=="function"){var r=function a(){var n=!1;try{n=this instanceof a}catch{}return n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(i).forEach(function(a){var n=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return i[a]}})}),r}var e5={exports:{}},ym={};var wx;function IA(){if(wx)return ym;wx=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,n,e){var p=null;if(e!==void 0&&(p=""+e),n.key!==void 0&&(p=""+n.key),"key"in n){e={};for(var m in n)m!=="key"&&(e[m]=n[m])}else e=n;return n=e.ref,{$$typeof:i,type:a,key:p,ref:n!==void 0?n:null,props:e}}return ym.Fragment=t,ym.jsx=r,ym.jsxs=r,ym}var Sx;function DA(){return Sx||(Sx=1,e5.exports=IA()),e5.exports}var h=DA(),t5={exports:{}},Fn={};var Ax;function FA(){if(Ax)return Fn;Ax=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),e=Symbol.for("react.consumer"),p=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),R=Symbol.iterator;function k(X){return X===null||typeof X!="object"?null:(X=R&&X[R]||X["@@iterator"],typeof X=="function"?X:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,q={};function U(X,H,ae){this.props=X,this.context=H,this.refs=q,this.updater=ae||M}U.prototype.isReactComponent={},U.prototype.setState=function(X,H){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,H,"setState")},U.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function te(){}te.prototype=U.prototype;function W(X,H,ae){this.props=X,this.context=H,this.refs=q,this.updater=ae||M}var re=W.prototype=new te;re.constructor=W,V(re,U.prototype),re.isPureReactComponent=!0;var xe=Array.isArray;function ve(){}var De={H:null,A:null,T:null,S:null},ke=Object.prototype.hasOwnProperty;function de(X,H,ae){var Z=ae.ref;return{$$typeof:i,type:X,key:H,ref:Z!==void 0?Z:null,props:ae}}function Oe(X,H){return de(X.type,H,X.props)}function z(X){return typeof X=="object"&&X!==null&&X.$$typeof===i}function K(X){var H={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(ae){return H[ae]})}var Ae=/\/+/g;function Ce(X,H){return typeof X=="object"&&X!==null&&X.key!=null?K(""+X.key):H.toString(36)}function Be(X){switch(X.status){case"fulfilled":return X.value;case"rejected":throw X.reason;default:switch(typeof X.status=="string"?X.then(ve,ve):(X.status="pending",X.then(function(H){X.status==="pending"&&(X.status="fulfilled",X.value=H)},function(H){X.status==="pending"&&(X.status="rejected",X.reason=H)})),X.status){case"fulfilled":return X.value;case"rejected":throw X.reason}}throw X}function Ee(X,H,ae,Z,se){var ye=typeof X;(ye==="undefined"||ye==="boolean")&&(X=null);var ce=!1;if(X===null)ce=!0;else switch(ye){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(X.$$typeof){case i:case t:ce=!0;break;case A:return ce=X._init,Ee(ce(X._payload),H,ae,Z,se)}}if(ce)return se=se(X),ce=Z===""?"."+Ce(X,0):Z,xe(se)?(ae="",ce!=null&&(ae=ce.replace(Ae,"$&/")+"/"),Ee(se,H,ae,"",function(Ve){return Ve})):se!=null&&(z(se)&&(se=Oe(se,ae+(se.key==null||X&&X.key===se.key?"":(""+se.key).replace(Ae,"$&/")+"/")+ce)),H.push(se)),1;ce=0;var ze=Z===""?".":Z+":";if(xe(X))for(var pe=0;pe<X.length;pe++)Z=X[pe],ye=ze+Ce(Z,pe),ce+=Ee(Z,H,ae,ye,se);else if(pe=k(X),typeof pe=="function")for(X=pe.call(X),pe=0;!(Z=X.next()).done;)Z=Z.value,ye=ze+Ce(Z,pe++),ce+=Ee(Z,H,ae,ye,se);else if(ye==="object"){if(typeof X.then=="function")return Ee(Be(X),H,ae,Z,se);throw H=String(X),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return ce}function Pe(X,H,ae){if(X==null)return X;var Z=[],se=0;return Ee(X,Z,"","",function(ye){return H.call(ae,ye,se++)}),Z}function Ue(X){if(X._status===-1){var H=X._result;H=H(),H.then(function(ae){(X._status===0||X._status===-1)&&(X._status=1,X._result=ae)},function(ae){(X._status===0||X._status===-1)&&(X._status=2,X._result=ae)}),X._status===-1&&(X._status=0,X._result=H)}if(X._status===1)return X._result.default;throw X._result}var _e=typeof reportError=="function"?reportError:function(X){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof X=="object"&&X!==null&&typeof X.message=="string"?String(X.message):String(X),error:X});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",X);return}console.error(X)},Le={map:Pe,forEach:function(X,H,ae){Pe(X,function(){H.apply(this,arguments)},ae)},count:function(X){var H=0;return Pe(X,function(){H++}),H},toArray:function(X){return Pe(X,function(H){return H})||[]},only:function(X){if(!z(X))throw Error("React.Children.only expected to receive a single React element child.");return X}};return Fn.Activity=I,Fn.Children=Le,Fn.Component=U,Fn.Fragment=r,Fn.Profiler=n,Fn.PureComponent=W,Fn.StrictMode=a,Fn.Suspense=y,Fn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=De,Fn.__COMPILER_RUNTIME={__proto__:null,c:function(X){return De.H.useMemoCache(X)}},Fn.cache=function(X){return function(){return X.apply(null,arguments)}},Fn.cacheSignal=function(){return null},Fn.cloneElement=function(X,H,ae){if(X==null)throw Error("The argument must be a React element, but you passed "+X+".");var Z=V({},X.props),se=X.key;if(H!=null)for(ye in H.key!==void 0&&(se=""+H.key),H)!ke.call(H,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&H.ref===void 0||(Z[ye]=H[ye]);var ye=arguments.length-2;if(ye===1)Z.children=ae;else if(1<ye){for(var ce=Array(ye),ze=0;ze<ye;ze++)ce[ze]=arguments[ze+2];Z.children=ce}return de(X.type,se,Z)},Fn.createContext=function(X){return X={$$typeof:p,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null},X.Provider=X,X.Consumer={$$typeof:e,_context:X},X},Fn.createElement=function(X,H,ae){var Z,se={},ye=null;if(H!=null)for(Z in H.key!==void 0&&(ye=""+H.key),H)ke.call(H,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(se[Z]=H[Z]);var ce=arguments.length-2;if(ce===1)se.children=ae;else if(1<ce){for(var ze=Array(ce),pe=0;pe<ce;pe++)ze[pe]=arguments[pe+2];se.children=ze}if(X&&X.defaultProps)for(Z in ce=X.defaultProps,ce)se[Z]===void 0&&(se[Z]=ce[Z]);return de(X,ye,se)},Fn.createRef=function(){return{current:null}},Fn.forwardRef=function(X){return{$$typeof:m,render:X}},Fn.isValidElement=z,Fn.lazy=function(X){return{$$typeof:A,_payload:{_status:-1,_result:X},_init:Ue}},Fn.memo=function(X,H){return{$$typeof:w,type:X,compare:H===void 0?null:H}},Fn.startTransition=function(X){var H=De.T,ae={};De.T=ae;try{var Z=X(),se=De.S;se!==null&&se(ae,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(ve,_e)}catch(ye){_e(ye)}finally{H!==null&&ae.types!==null&&(H.types=ae.types),De.T=H}},Fn.unstable_useCacheRefresh=function(){return De.H.useCacheRefresh()},Fn.use=function(X){return De.H.use(X)},Fn.useActionState=function(X,H,ae){return De.H.useActionState(X,H,ae)},Fn.useCallback=function(X,H){return De.H.useCallback(X,H)},Fn.useContext=function(X){return De.H.useContext(X)},Fn.useDebugValue=function(){},Fn.useDeferredValue=function(X,H){return De.H.useDeferredValue(X,H)},Fn.useEffect=function(X,H){return De.H.useEffect(X,H)},Fn.useEffectEvent=function(X){return De.H.useEffectEvent(X)},Fn.useId=function(){return De.H.useId()},Fn.useImperativeHandle=function(X,H,ae){return De.H.useImperativeHandle(X,H,ae)},Fn.useInsertionEffect=function(X,H){return De.H.useInsertionEffect(X,H)},Fn.useLayoutEffect=function(X,H){return De.H.useLayoutEffect(X,H)},Fn.useMemo=function(X,H){return De.H.useMemo(X,H)},Fn.useOptimistic=function(X,H){return De.H.useOptimistic(X,H)},Fn.useReducer=function(X,H,ae){return De.H.useReducer(X,H,ae)},Fn.useRef=function(X){return De.H.useRef(X)},Fn.useState=function(X){return De.H.useState(X)},Fn.useSyncExternalStore=function(X,H,ae){return De.H.useSyncExternalStore(X,H,ae)},Fn.useTransition=function(){return De.H.useTransition()},Fn.version="19.2.3",Fn}var Cx;function Uv(){return Cx||(Cx=1,t5.exports=FA()),t5.exports}var le=Uv();const vo=kA(le);var r5={exports:{}},vm={},n5={exports:{}},a5={};var Nx;function RA(){return Nx||(Nx=1,(function(i){function t(Ee,Pe){var Ue=Ee.length;Ee.push(Pe);e:for(;0<Ue;){var _e=Ue-1>>>1,Le=Ee[_e];if(0<n(Le,Pe))Ee[_e]=Pe,Ee[Ue]=Le,Ue=_e;else break e}}function r(Ee){return Ee.length===0?null:Ee[0]}function a(Ee){if(Ee.length===0)return null;var Pe=Ee[0],Ue=Ee.pop();if(Ue!==Pe){Ee[0]=Ue;e:for(var _e=0,Le=Ee.length,X=Le>>>1;_e<X;){var H=2*(_e+1)-1,ae=Ee[H],Z=H+1,se=Ee[Z];if(0>n(ae,Ue))Z<Le&&0>n(se,ae)?(Ee[_e]=se,Ee[Z]=Ue,_e=Z):(Ee[_e]=ae,Ee[H]=Ue,_e=H);else if(Z<Le&&0>n(se,Ue))Ee[_e]=se,Ee[Z]=Ue,_e=Z;else break e}}return Pe}function n(Ee,Pe){var Ue=Ee.sortIndex-Pe.sortIndex;return Ue!==0?Ue:Ee.id-Pe.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var e=performance;i.unstable_now=function(){return e.now()}}else{var p=Date,m=p.now();i.unstable_now=function(){return p.now()-m}}var y=[],w=[],A=1,I=null,R=3,k=!1,M=!1,V=!1,q=!1,U=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;function re(Ee){for(var Pe=r(w);Pe!==null;){if(Pe.callback===null)a(w);else if(Pe.startTime<=Ee)a(w),Pe.sortIndex=Pe.expirationTime,t(y,Pe);else break;Pe=r(w)}}function xe(Ee){if(V=!1,re(Ee),!M)if(r(y)!==null)M=!0,ve||(ve=!0,K());else{var Pe=r(w);Pe!==null&&Be(xe,Pe.startTime-Ee)}}var ve=!1,De=-1,ke=5,de=-1;function Oe(){return q?!0:!(i.unstable_now()-de<ke)}function z(){if(q=!1,ve){var Ee=i.unstable_now();de=Ee;var Pe=!0;try{e:{M=!1,V&&(V=!1,te(De),De=-1),k=!0;var Ue=R;try{t:{for(re(Ee),I=r(y);I!==null&&!(I.expirationTime>Ee&&Oe());){var _e=I.callback;if(typeof _e=="function"){I.callback=null,R=I.priorityLevel;var Le=_e(I.expirationTime<=Ee);if(Ee=i.unstable_now(),typeof Le=="function"){I.callback=Le,re(Ee),Pe=!0;break t}I===r(y)&&a(y),re(Ee)}else a(y);I=r(y)}if(I!==null)Pe=!0;else{var X=r(w);X!==null&&Be(xe,X.startTime-Ee),Pe=!1}}break e}finally{I=null,R=Ue,k=!1}Pe=void 0}}finally{Pe?K():ve=!1}}}var K;if(typeof W=="function")K=function(){W(z)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,Ce=Ae.port2;Ae.port1.onmessage=z,K=function(){Ce.postMessage(null)}}else K=function(){U(z,0)};function Be(Ee,Pe){De=U(function(){Ee(i.unstable_now())},Pe)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Ee){Ee.callback=null},i.unstable_forceFrameRate=function(Ee){0>Ee||125<Ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ke=0<Ee?Math.floor(1e3/Ee):5},i.unstable_getCurrentPriorityLevel=function(){return R},i.unstable_next=function(Ee){switch(R){case 1:case 2:case 3:var Pe=3;break;default:Pe=R}var Ue=R;R=Pe;try{return Ee()}finally{R=Ue}},i.unstable_requestPaint=function(){q=!0},i.unstable_runWithPriority=function(Ee,Pe){switch(Ee){case 1:case 2:case 3:case 4:case 5:break;default:Ee=3}var Ue=R;R=Ee;try{return Pe()}finally{R=Ue}},i.unstable_scheduleCallback=function(Ee,Pe,Ue){var _e=i.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?_e+Ue:_e):Ue=_e,Ee){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=Ue+Le,Ee={id:A++,callback:Pe,priorityLevel:Ee,startTime:Ue,expirationTime:Le,sortIndex:-1},Ue>_e?(Ee.sortIndex=Ue,t(w,Ee),r(y)===null&&Ee===r(w)&&(V?(te(De),De=-1):V=!0,Be(xe,Ue-_e))):(Ee.sortIndex=Le,t(y,Ee),M||k||(M=!0,ve||(ve=!0,K()))),Ee},i.unstable_shouldYield=Oe,i.unstable_wrapCallback=function(Ee){var Pe=R;return function(){var Ue=R;R=Pe;try{return Ee.apply(this,arguments)}finally{R=Ue}}}})(a5)),a5}var Tx;function jA(){return Tx||(Tx=1,n5.exports=RA()),n5.exports}var s5={exports:{}},sl={};var Ex;function OA(){if(Ex)return sl;Ex=1;var i=Uv();function t(y){var w="https://react.dev/errors/"+y;if(1<arguments.length){w+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)w+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+y+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function e(y,w,A){var I=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:I==null?null:""+I,children:y,containerInfo:w,implementation:A}}var p=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(y,w){if(y==="font")return"";if(typeof w=="string")return w==="use-credentials"?w:""}return sl.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,sl.createPortal=function(y,w){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w||w.nodeType!==1&&w.nodeType!==9&&w.nodeType!==11)throw Error(t(299));return e(y,w,null,A)},sl.flushSync=function(y){var w=p.T,A=a.p;try{if(p.T=null,a.p=2,y)return y()}finally{p.T=w,a.p=A,a.d.f()}},sl.preconnect=function(y,w){typeof y=="string"&&(w?(w=w.crossOrigin,w=typeof w=="string"?w==="use-credentials"?w:"":void 0):w=null,a.d.C(y,w))},sl.prefetchDNS=function(y){typeof y=="string"&&a.d.D(y)},sl.preinit=function(y,w){if(typeof y=="string"&&w&&typeof w.as=="string"){var A=w.as,I=m(A,w.crossOrigin),R=typeof w.integrity=="string"?w.integrity:void 0,k=typeof w.fetchPriority=="string"?w.fetchPriority:void 0;A==="style"?a.d.S(y,typeof w.precedence=="string"?w.precedence:void 0,{crossOrigin:I,integrity:R,fetchPriority:k}):A==="script"&&a.d.X(y,{crossOrigin:I,integrity:R,fetchPriority:k,nonce:typeof w.nonce=="string"?w.nonce:void 0})}},sl.preinitModule=function(y,w){if(typeof y=="string")if(typeof w=="object"&&w!==null){if(w.as==null||w.as==="script"){var A=m(w.as,w.crossOrigin);a.d.M(y,{crossOrigin:A,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0})}}else w==null&&a.d.M(y)},sl.preload=function(y,w){if(typeof y=="string"&&typeof w=="object"&&w!==null&&typeof w.as=="string"){var A=w.as,I=m(A,w.crossOrigin);a.d.L(y,A,{crossOrigin:I,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0,type:typeof w.type=="string"?w.type:void 0,fetchPriority:typeof w.fetchPriority=="string"?w.fetchPriority:void 0,referrerPolicy:typeof w.referrerPolicy=="string"?w.referrerPolicy:void 0,imageSrcSet:typeof w.imageSrcSet=="string"?w.imageSrcSet:void 0,imageSizes:typeof w.imageSizes=="string"?w.imageSizes:void 0,media:typeof w.media=="string"?w.media:void 0})}},sl.preloadModule=function(y,w){if(typeof y=="string")if(w){var A=m(w.as,w.crossOrigin);a.d.m(y,{as:typeof w.as=="string"&&w.as!=="script"?w.as:void 0,crossOrigin:A,integrity:typeof w.integrity=="string"?w.integrity:void 0})}else a.d.m(y)},sl.requestFormReset=function(y){a.d.r(y)},sl.unstable_batchedUpdates=function(y,w){return y(w)},sl.useFormState=function(y,w,A){return p.H.useFormState(y,w,A)},sl.useFormStatus=function(){return p.H.useHostTransitionStatus()},sl.version="19.2.3",sl}var kx;function LA(){if(kx)return s5.exports;kx=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),s5.exports=OA(),s5.exports}var _x;function PA(){if(_x)return vm;_x=1;var i=jA(),t=Uv(),r=LA();function a(o){var l="https://react.dev/errors/"+o;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function e(o){var l=o,f=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(f=l.return),o=l.return;while(o)}return l.tag===3?f:null}function p(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function m(o){if(o.tag===31){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function y(o){if(e(o)!==o)throw Error(a(188))}function w(o){var l=o.alternate;if(!l){if(l=e(o),l===null)throw Error(a(188));return l!==o?null:o}for(var f=o,v=l;;){var E=f.return;if(E===null)break;var D=E.alternate;if(D===null){if(v=E.return,v!==null){f=v;continue}break}if(E.child===D.child){for(D=E.child;D;){if(D===f)return y(E),o;if(D===v)return y(E),l;D=D.sibling}throw Error(a(188))}if(f.return!==v.return)f=E,v=D;else{for(var Q=!1,me=E.child;me;){if(me===f){Q=!0,f=E,v=D;break}if(me===v){Q=!0,v=E,f=D;break}me=me.sibling}if(!Q){for(me=D.child;me;){if(me===f){Q=!0,f=D,v=E;break}if(me===v){Q=!0,v=D,f=E;break}me=me.sibling}if(!Q)throw Error(a(189))}}if(f.alternate!==v)throw Error(a(190))}if(f.tag!==3)throw Error(a(188));return f.stateNode.current===f?o:l}function A(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o;for(o=o.child;o!==null;){if(l=A(o),l!==null)return l;o=o.sibling}return null}var I=Object.assign,R=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),te=Symbol.for("react.consumer"),W=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),De=Symbol.for("react.memo"),ke=Symbol.for("react.lazy"),de=Symbol.for("react.activity"),Oe=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function K(o){return o===null||typeof o!="object"?null:(o=z&&o[z]||o["@@iterator"],typeof o=="function"?o:null)}var Ae=Symbol.for("react.client.reference");function Ce(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===Ae?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case V:return"Fragment";case U:return"Profiler";case q:return"StrictMode";case xe:return"Suspense";case ve:return"SuspenseList";case de:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case M:return"Portal";case W:return o.displayName||"Context";case te:return(o._context.displayName||"Context")+".Consumer";case re:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case De:return l=o.displayName||null,l!==null?l:Ce(o.type)||"Memo";case ke:l=o._payload,o=o._init;try{return Ce(o(l))}catch{}}return null}var Be=Array.isArray,Ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ue={pending:!1,data:null,method:null,action:null},_e=[],Le=-1;function X(o){return{current:o}}function H(o){0>Le||(o.current=_e[Le],_e[Le]=null,Le--)}function ae(o,l){Le++,_e[Le]=o.current,o.current=l}var Z=X(null),se=X(null),ye=X(null),ce=X(null);function ze(o,l){switch(ae(ye,l),ae(se,o),ae(Z,null),l.nodeType){case 9:case 11:o=(o=l.documentElement)&&(o=o.namespaceURI)?dm(o):0;break;default:if(o=l.tagName,l=l.namespaceURI)l=dm(l),o=jc(l,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}H(Z),ae(Z,o)}function pe(){H(Z),H(se),H(ye)}function Ve(o){o.memoizedState!==null&&ae(ce,o);var l=Z.current,f=jc(l,o.type);l!==f&&(ae(se,o),ae(Z,f))}function yt(o){se.current===o&&(H(Z),H(se)),ce.current===o&&(H(ce),dr._currentValue=Ue)}var vt,bt;function Ft(o){if(vt===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);vt=l&&l[1]||"",bt=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+vt+o+bt}var Te=!1;function Ht(o,l){if(!o||Te)return"";Te=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(l){var Tt=function(){throw Error()};if(Object.defineProperty(Tt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Tt,[])}catch(mt){var ut=mt}Reflect.construct(o,[],Tt)}else{try{Tt.call()}catch(mt){ut=mt}o.call(Tt.prototype)}}else{try{throw Error()}catch(mt){ut=mt}(Tt=o())&&typeof Tt.catch=="function"&&Tt.catch(function(){})}}catch(mt){if(mt&&ut&&typeof mt.stack=="string")return[mt.stack,ut.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=v.DetermineComponentFrameRoot(),Q=D[0],me=D[1];if(Q&&me){var Me=Q.split(`
`),at=me.split(`
`);for(E=v=0;v<Me.length&&!Me[v].includes("DetermineComponentFrameRoot");)v++;for(;E<at.length&&!at[E].includes("DetermineComponentFrameRoot");)E++;if(v===Me.length||E===at.length)for(v=Me.length-1,E=at.length-1;1<=v&&0<=E&&Me[v]!==at[E];)E--;for(;1<=v&&0<=E;v--,E--)if(Me[v]!==at[E]){if(v!==1||E!==1)do if(v--,E--,0>E||Me[v]!==at[E]){var St=`
`+Me[v].replace(" at new "," at ");return o.displayName&&St.includes("<anonymous>")&&(St=St.replace("<anonymous>",o.displayName)),St}while(1<=v&&0<=E);break}}}finally{Te=!1,Error.prepareStackTrace=f}return(f=o?o.displayName||o.name:"")?Ft(f):""}function Or(o,l){switch(o.tag){case 26:case 27:case 5:return Ft(o.type);case 16:return Ft("Lazy");case 13:return o.child!==l&&l!==null?Ft("Suspense Fallback"):Ft("Suspense");case 19:return Ft("SuspenseList");case 0:case 15:return Ht(o.type,!1);case 11:return Ht(o.type.render,!1);case 1:return Ht(o.type,!0);case 31:return Ft("Activity");default:return""}}function Vr(o){try{var l="",f=null;do l+=Or(o,f),f=o,o=o.return;while(o);return l}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}var Mt=Object.prototype.hasOwnProperty,zr=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Rt=i.unstable_shouldYield,Ct=i.unstable_requestPaint,er=i.unstable_now,nr=i.unstable_getCurrentPriorityLevel,ur=i.unstable_ImmediatePriority,Sr=i.unstable_UserBlockingPriority,kr=i.unstable_NormalPriority,ar=i.unstable_LowPriority,_r=i.unstable_IdlePriority,Ar=i.log,ra=i.unstable_setDisableYieldValue,Nn=null,Qr=null;function xr(o){if(typeof Ar=="function"&&ra(o),Qr&&typeof Qr.setStrictMode=="function")try{Qr.setStrictMode(Nn,o)}catch{}}var an=Math.clz32?Math.clz32:on,Lr=Math.log,Jn=Math.LN2;function on(o){return o>>>=0,o===0?32:31-(Lr(o)/Jn|0)|0}var gn=256,xa=262144,fn=4194304;function Wr(o){var l=o&42;if(l!==0)return l;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Jt(o,l,f){var v=o.pendingLanes;if(v===0)return 0;var E=0,D=o.suspendedLanes,Q=o.pingedLanes;o=o.warmLanes;var me=v&134217727;return me!==0?(v=me&~D,v!==0?E=Wr(v):(Q&=me,Q!==0?E=Wr(Q):f||(f=me&~o,f!==0&&(E=Wr(f))))):(me=v&~D,me!==0?E=Wr(me):Q!==0?E=Wr(Q):f||(f=v&~o,f!==0&&(E=Wr(f)))),E===0?0:l!==0&&l!==E&&(l&D)===0&&(D=E&-E,f=l&-l,D>=f||D===32&&(f&4194048)!==0)?l:E}function bo(o,l){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&l)===0}function Vs(o,l){switch(o){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fa(){var o=fn;return fn<<=1,(fn&62914560)===0&&(fn=4194304),o}function xo(o){for(var l=[],f=0;31>f;f++)l.push(o);return l}function Yr(o,l){o.pendingLanes|=l,l!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function qo(o,l,f,v,E,D){var Q=o.pendingLanes;o.pendingLanes=f,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=f,o.entangledLanes&=f,o.errorRecoveryDisabledLanes&=f,o.shellSuspendCounter=0;var me=o.entanglements,Me=o.expirationTimes,at=o.hiddenUpdates;for(f=Q&~f;0<f;){var St=31-an(f),Tt=1<<St;me[St]=0,Me[St]=-1;var ut=at[St];if(ut!==null)for(at[St]=null,St=0;St<ut.length;St++){var mt=ut[St];mt!==null&&(mt.lane&=-536870913)}f&=~Tt}v!==0&&wo(o,v,0),D!==0&&E===0&&o.tag!==0&&(o.suspendedLanes|=D&~(Q&~l))}function wo(o,l,f){o.pendingLanes|=l,o.suspendedLanes&=~l;var v=31-an(l);o.entangledLanes|=l,o.entanglements[v]=o.entanglements[v]|1073741824|f&261930}function pa(o,l){var f=o.entangledLanes|=l;for(o=o.entanglements;f;){var v=31-an(f),E=1<<v;E&l|o[v]&l&&(o[v]|=l),f&=~E}}function Ri(o,l){var f=l&-l;return f=(f&42)!==0?1:as(f),(f&(o.suspendedLanes|l))!==0?0:f}function as(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Ps(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Ms(){var o=Pe.p;return o!==0?o:(o=window.event,o===void 0?32:He(o.type))}function pl(o,l){var f=Pe.p;try{return Pe.p=o,l()}finally{Pe.p=f}}var ji=Math.random().toString(36).slice(2),Fa="__reactFiber$"+ji,vn="__reactProps$"+ji,Cs="__reactContainer$"+ji,jn="__reactEvents$"+ji,na="__reactListeners$"+ji,bi="__reactHandles$"+ji,ml="__reactResources$"+ji,Oi="__reactMarker$"+ji;function uc(o){delete o[Fa],delete o[vn],delete o[jn],delete o[na],delete o[bi]}function gl(o){var l=o[Fa];if(l)return l;for(var f=o.parentNode;f;){if(l=f[Cs]||f[Fa]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(o=Kg(o);o!==null;){if(f=o[Fa])return f;o=Kg(o)}return l}o=f,f=o.parentNode}return null}function Go(o){if(o=o[Fa]||o[Cs]){var l=o.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return o}return null}function $c(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o.stateNode;throw Error(a(33))}function Us(o){var l=o[ml];return l||(l=o[ml]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function ys(o){o[Oi]=!0}var ss=new Set,Ya={};function Vo(o,l){mn(o,l),mn(o+"Capture",l)}function mn(o,l){for(Ya[o]=l,o=0;o<l.length;o++)ss.add(l[o])}var fu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),eh={},hc={};function is(o){return Mt.call(hc,o)?!0:Mt.call(eh,o)?!1:fu.test(o)?hc[o]=!0:(eh[o]=!0,!1)}function So(o,l,f){if(is(l))if(f===null)o.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":o.removeAttribute(l);return;case"boolean":var v=l.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){o.removeAttribute(l);return}}o.setAttribute(l,""+f)}}function os(o,l,f){if(f===null)o.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(l);return}o.setAttribute(l,""+f)}}function yl(o,l,f,v){if(v===null)o.removeAttribute(f);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(f);return}o.setAttributeNS(l,f,""+v)}}function ma(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function ln(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Zs(o,l,f){var v=Object.getOwnPropertyDescriptor(o.constructor.prototype,l);if(!o.hasOwnProperty(l)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var E=v.get,D=v.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return E.call(this)},set:function(Q){f=""+Q,D.call(this,Q)}}),Object.defineProperty(o,l,{enumerable:v.enumerable}),{getValue:function(){return f},setValue:function(Q){f=""+Q},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function dc(o){if(!o._valueTracker){var l=ln(o)?"checked":"value";o._valueTracker=Zs(o,l,""+o[l])}}function th(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var f=l.getValue(),v="";return o&&(v=ln(o)?o.checked?"true":"false":o.value),o=v,o!==f?(l.setValue(o),!0):!1}function Li(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Bs=/[\n"\\]/g;function cn(o){return o.replace(Bs,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function qc(o,l,f,v,E,D,Q,me){o.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?o.type=Q:o.removeAttribute("type"),l!=null?Q==="number"?(l===0&&o.value===""||o.value!=l)&&(o.value=""+ma(l)):o.value!==""+ma(l)&&(o.value=""+ma(l)):Q!=="submit"&&Q!=="reset"||o.removeAttribute("value"),l!=null?aa(o,Q,ma(l)):f!=null?aa(o,Q,ma(f)):v!=null&&o.removeAttribute("value"),E==null&&D!=null&&(o.defaultChecked=!!D),E!=null&&(o.checked=E&&typeof E!="function"&&typeof E!="symbol"),me!=null&&typeof me!="function"&&typeof me!="symbol"&&typeof me!="boolean"?o.name=""+ma(me):o.removeAttribute("name")}function Td(o,l,f,v,E,D,Q,me){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(o.type=D),l!=null||f!=null){if(!(D!=="submit"&&D!=="reset"||l!=null)){dc(o);return}f=f!=null?""+ma(f):"",l=l!=null?""+ma(l):f,me||l===o.value||(o.value=l),o.defaultValue=l}v=v??E,v=typeof v!="function"&&typeof v!="symbol"&&!!v,o.checked=me?o.checked:!!v,o.defaultChecked=!!v,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(o.name=Q),dc(o)}function aa(o,l,f){l==="number"&&Li(o.ownerDocument)===o||o.defaultValue===""+f||(o.defaultValue=""+f)}function Pi(o,l,f,v){if(o=o.options,l){l={};for(var E=0;E<f.length;E++)l["$"+f[E]]=!0;for(f=0;f<o.length;f++)E=l.hasOwnProperty("$"+o[f].value),o[f].selected!==E&&(o[f].selected=E),E&&v&&(o[f].defaultSelected=!0)}else{for(f=""+ma(f),l=null,E=0;E<o.length;E++){if(o[E].value===f){o[E].selected=!0,v&&(o[E].defaultSelected=!0);return}l!==null||o[E].disabled||(l=o[E])}l!==null&&(l.selected=!0)}}function rh(o,l,f){if(l!=null&&(l=""+ma(l),l!==o.value&&(o.value=l),f==null)){o.defaultValue!==l&&(o.defaultValue=l);return}o.defaultValue=f!=null?""+ma(f):""}function pu(o,l,f,v){if(l==null){if(v!=null){if(f!=null)throw Error(a(92));if(Be(v)){if(1<v.length)throw Error(a(93));v=v[0]}f=v}f==null&&(f=""),l=f}f=ma(l),o.defaultValue=f,v=o.textContent,v===f&&v!==""&&v!==null&&(o.value=v),dc(o)}function Wo(o,l){if(l){var f=o.firstChild;if(f&&f===o.lastChild&&f.nodeType===3){f.nodeValue=l;return}}o.textContent=l}var Gc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ed(o,l,f){var v=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?v?o.setProperty(l,""):l==="float"?o.cssFloat="":o[l]="":v?o.setProperty(l,f):typeof f!="number"||f===0||Gc.has(l)?l==="float"?o.cssFloat=f:o[l]=(""+f).trim():o[l]=f+"px"}function Ea(o,l,f){if(l!=null&&typeof l!="object")throw Error(a(62));if(o=o.style,f!=null){for(var v in f)!f.hasOwnProperty(v)||l!=null&&l.hasOwnProperty(v)||(v.indexOf("--")===0?o.setProperty(v,""):v==="float"?o.cssFloat="":o[v]="");for(var E in l)v=l[E],l.hasOwnProperty(E)&&f[E]!==v&&Ed(o,E,v)}else for(var D in l)l.hasOwnProperty(D)&&Ed(o,D,l[D])}function mu(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Mi(o){return Lh.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function ao(){}var Ko=null;function Xn(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var xi=null,tn=null;function Ph(o){var l=Go(o);if(l&&(o=l.stateNode)){var f=o[vn]||null;e:switch(o=l.stateNode,l.type){case"input":if(qc(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=o;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+cn(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var v=f[l];if(v!==o&&v.form===o.form){var E=v[vn]||null;if(!E)throw Error(a(90));qc(v,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(l=0;l<f.length;l++)v=f[l],v.form===o.form&&th(v)}break e;case"textarea":rh(o,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&Pi(o,!!f.multiple,l,!1)}}}var Mh=!1;function kd(o,l,f){if(Mh)return o(l,f);Mh=!0;try{var v=o(l);return v}finally{if(Mh=!1,(xi!==null||tn!==null)&&(h1(),xi&&(l=xi,o=tn,tn=xi=null,Ph(l),o)))for(l=0;l<o.length;l++)Ph(o[l])}}function Ao(o,l){var f=o.stateNode;if(f===null)return null;var v=f[vn]||null;if(v===null)return null;f=v[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(f&&typeof f!="function")throw Error(a(231,l,typeof f));return f}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ah=!1;if(ii)try{var vs={};Object.defineProperty(vs,"passive",{get:function(){ah=!0}}),window.addEventListener("test",vs,vs),window.removeEventListener("test",vs,vs)}catch{ah=!1}var wi=null,Xt=null,Yo=null;function sh(){if(Yo)return Yo;var o,l=Xt,f=l.length,v,E="value"in wi?wi.value:wi.textContent,D=E.length;for(o=0;o<f&&l[o]===E[o];o++);var Q=f-o;for(v=1;v<=Q&&l[f-v]===E[D-v];v++);return Yo=E.slice(o,1<v?1-v:void 0)}function Ui(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function ls(){return!0}function Jo(){return!1}function wa(o){function l(f,v,E,D,Q){this._reactName=f,this._targetInst=E,this.type=v,this.nativeEvent=D,this.target=Q,this.currentTarget=null;for(var me in o)o.hasOwnProperty(me)&&(f=o[me],this[me]=f?f(D):D[me]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?ls:Jo,this.isPropagationStopped=Jo,this}return I(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ls)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ls)},persist:function(){},isPersistent:ls}),l}var vl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Co=wa(vl),Fl=I({},vl,{view:0,detail:0}),gu=wa(Fl),Vc,Rl,jl,Wc=I({},Fl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yn,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==jl&&(jl&&o.type==="mousemove"?(Vc=o.screenX-jl.screenX,Rl=o.screenY-jl.screenY):Rl=Vc=0,jl=o),Vc)},movementY:function(o){return"movementY"in o?o.movementY:Rl}}),ih=wa(Wc),Ol=I({},Wc,{dataTransfer:0}),Ll=wa(Ol),yu=I({},Fl,{relatedTarget:0}),Pl=wa(yu),fc=I({},vl,{animationName:0,elapsedTime:0,pseudoElement:0}),j=wa(fc),ie=I({},vl,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),je=wa(ie),Ge=I({},vl,{data:0}),tt=wa(Ge),Et={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ut={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cr(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=wr[o])?!!l[o]:!1}function yn(){return Cr}var $r=I({},Fl,{key:function(o){if(o.key){var l=Et[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=Ui(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Ut[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yn,charCode:function(o){return o.type==="keypress"?Ui(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Ui(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),On=wa($r),bs=I({},Wc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ja=wa(bs),Ba=I({},Fl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yn}),ei=wa(Ba),Ws=I({},vl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Si=wa(Ws),Ml=I({},Wc,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Ra=wa(Ml),cs=I({},vl,{newState:0,oldState:0}),xt=wa(cs),so=[9,13,27,32],xs=ii&&"CompositionEvent"in window,jt=null;ii&&"documentMode"in document&&(jt=document.documentMode);var bl=ii&&"TextEvent"in window&&!jt,Ul=ii&&(!xs||jt&&8<jt&&11>=jt),Ns=" ",Bl=!1;function Hl(o,l){switch(o){case"keyup":return so.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ja(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Qo=!1;function Ln(o,l){switch(o){case"compositionend":return ja(l);case"keypress":return l.which!==32?null:(Bl=!0,Ns);case"textInput":return o=l.data,o===Ns&&Bl?null:o;default:return null}}function ga(o,l){if(Qo)return o==="compositionend"||!xs&&Hl(o,l)?(o=sh(),Yo=Xt=wi=null,Qo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ul&&l.locale!=="ko"?null:l.data;default:return null}}var sn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ti(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!sn[o.type]:l==="textarea"}function rn(o,l,f,v){xi?tn?tn.push(v):tn=[v]:xi=v,l=h0(l,"onChange"),0<l.length&&(f=new Co("onChange","change",null,f,v),o.push({event:f,listeners:l}))}var wn=null,pc=null;function io(o){qg(o,0)}function oi(o){var l=$c(o);if(th(l))return o}function mc(o,l){if(o==="change")return l}var ri=!1;if(ii){var Qa;if(ii){var Xa="oninput"in document;if(!Xa){var Oa=document.createElement("div");Oa.setAttribute("oninput","return;"),Xa=typeof Oa.oninput=="function"}Qa=Xa}else Qa=!1;ri=Qa&&(!document.documentMode||9<document.documentMode)}function xl(){wn&&(wn.detachEvent("onpropertychange",oh),pc=wn=null)}function oh(o){if(o.propertyName==="value"&&oi(pc)){var l=[];rn(l,pc,o,Xn(o)),kd(io,l)}}function lh(o,l,f){o==="focusin"?(xl(),wn=l,pc=f,wn.attachEvent("onpropertychange",oh)):o==="focusout"&&xl()}function ca(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return oi(pc)}function zl(o,l){if(o==="click")return oi(l)}function Bi(o,l){if(o==="input"||o==="change")return oi(l)}function Hi(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var Ai=typeof Object.is=="function"?Object.is:Hi;function $l(o,l){if(Ai(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var f=Object.keys(o),v=Object.keys(l);if(f.length!==v.length)return!1;for(v=0;v<f.length;v++){var E=f[v];if(!Mt.call(l,E)||!Ai(o[E],l[E]))return!1}return!0}function Kc(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function gc(o,l){var f=Kc(o);o=0;for(var v;f;){if(f.nodeType===3){if(v=o+f.textContent.length,o<=l&&v>=l)return{node:f,offset:l-o};o=v}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Kc(f)}}function yc(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?yc(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function wl(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var l=Li(o.document);l instanceof o.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)o=l.contentWindow;else break;l=Li(o.document)}return l}function Xo(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}var vc=ii&&"documentMode"in document&&11>=document.documentMode,oo=null,ql=null,Ts=null,Ci=!1;function Sn(o,l,f){var v=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Ci||oo==null||oo!==Li(v)||(v=oo,"selectionStart"in v&&Xo(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Ts&&$l(Ts,v)||(Ts=v,v=h0(ql,"onSelect"),0<v.length&&(l=new Co("onSelect","select",null,l,f),o.push({event:l,listeners:v}),l.target=oo)))}function Un(o,l){var f={};return f[o.toLowerCase()]=l.toLowerCase(),f["Webkit"+o]="webkit"+l,f["Moz"+o]="moz"+l,f}var Ca={animationend:Un("Animation","AnimationEnd"),animationiteration:Un("Animation","AnimationIteration"),animationstart:Un("Animation","AnimationStart"),transitionrun:Un("Transition","TransitionRun"),transitionstart:Un("Transition","TransitionStart"),transitioncancel:Un("Transition","TransitionCancel"),transitionend:Un("Transition","TransitionEnd")},Es={},Zo={};ii&&(Zo=document.createElement("div").style,"AnimationEvent"in window||(delete Ca.animationend.animation,delete Ca.animationiteration.animation,delete Ca.animationstart.animation),"TransitionEvent"in window||delete Ca.transitionend.transition);function us(o){if(Es[o])return Es[o];if(!Ca[o])return o;var l=Ca[o],f;for(f in l)if(l.hasOwnProperty(f)&&f in Zo)return Es[o]=l[f];return o}var Yc=us("animationend"),ch=us("animationiteration"),If=us("animationstart"),_d=us("transitionrun"),Id=us("transitionstart"),Df=us("transitioncancel"),Ff=us("transitionend"),vu=new Map,Zi="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zi.push("scrollEnd");function No(o,l){vu.set(o,l),Vo(l,[o])}var bu=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},zi=[],bc=0,Uh=0;function Cn(){for(var o=bc,l=Uh=bc=0;l<o;){var f=zi[l];zi[l++]=null;var v=zi[l];zi[l++]=null;var E=zi[l];zi[l++]=null;var D=zi[l];if(zi[l++]=null,v!==null&&E!==null){var Q=v.pending;Q===null?E.next=E:(E.next=Q.next,Q.next=E),v.pending=E}D!==0&&sa(f,E,D)}}function xc(o,l,f,v){zi[bc++]=o,zi[bc++]=l,zi[bc++]=f,zi[bc++]=v,Uh|=v,o.lanes|=v,o=o.alternate,o!==null&&(o.lanes|=v)}function Jc(o,l,f,v){return xc(o,l,f,v),$i(o)}function lo(o,l){return xc(o,null,null,l),$i(o)}function sa(o,l,f){o.lanes|=f;var v=o.alternate;v!==null&&(v.lanes|=f);for(var E=!1,D=o.return;D!==null;)D.childLanes|=f,v=D.alternate,v!==null&&(v.childLanes|=f),D.tag===22&&(o=D.stateNode,o===null||o._visibility&1||(E=!0)),o=D,D=D.return;return o.tag===3?(D=o.stateNode,E&&l!==null&&(E=31-an(f),o=D.hiddenUpdates,v=o[E],v===null?o[E]=[l]:v.push(l),l.lane=f|536870912),D):null}function $i(o){if(50<n0)throw n0=0,a0=null,Error(a(185));for(var l=o.return;l!==null;)o=l,l=o.return;return o.tag===3?o.stateNode:null}var li={};function Bh(o,l,f,v){this.tag=o,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function La(o,l,f,v){return new Bh(o,l,f,v)}function Dd(o){return o=o.prototype,!(!o||!o.isReactComponent)}function To(o,l){var f=o.alternate;return f===null?(f=La(o.tag,l,o.key,o.mode),f.elementType=o.elementType,f.type=o.type,f.stateNode=o.stateNode,f.alternate=o,o.alternate=f):(f.pendingProps=l,f.type=o.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=o.flags&65011712,f.childLanes=o.childLanes,f.lanes=o.lanes,f.child=o.child,f.memoizedProps=o.memoizedProps,f.memoizedState=o.memoizedState,f.updateQueue=o.updateQueue,l=o.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=o.sibling,f.index=o.index,f.ref=o.ref,f.refCleanup=o.refCleanup,f}function xu(o,l){o.flags&=65011714;var f=o.alternate;return f===null?(o.childLanes=0,o.lanes=l,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=f.childLanes,o.lanes=f.lanes,o.child=f.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=f.memoizedProps,o.memoizedState=f.memoizedState,o.updateQueue=f.updateQueue,o.type=f.type,l=f.dependencies,o.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),o}function wu(o,l,f,v,E,D){var Q=0;if(v=o,typeof o=="function")Dd(o)&&(Q=1);else if(typeof o=="string")Q=lr(o,f,Z.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case de:return o=La(31,f,l,E),o.elementType=de,o.lanes=D,o;case V:return co(f.children,E,D,l);case q:Q=8,E|=24;break;case U:return o=La(12,f,l,E|2),o.elementType=U,o.lanes=D,o;case xe:return o=La(13,f,l,E),o.elementType=xe,o.lanes=D,o;case ve:return o=La(19,f,l,E),o.elementType=ve,o.lanes=D,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case W:Q=10;break e;case te:Q=9;break e;case re:Q=11;break e;case De:Q=14;break e;case ke:Q=16,v=null;break e}Q=29,f=Error(a(130,o===null?"null":typeof o,"")),v=null}return l=La(Q,f,l,E),l.elementType=o,l.type=v,l.lanes=D,l}function co(o,l,f,v){return o=La(7,o,v,l),o.lanes=f,o}function uh(o,l,f){return o=La(6,o,null,l),o.lanes=f,o}function Hh(o){var l=La(18,null,null,0);return l.stateNode=o,l}function Su(o,l,f){return l=La(4,o.children!==null?o.children:[],o.key,l),l.lanes=f,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}var Fd=new WeakMap;function Eo(o,l){if(typeof o=="object"&&o!==null){var f=Fd.get(o);return f!==void 0?f:(l={value:o,source:l,stack:Vr(l)},Fd.set(o,l),l)}return{value:o,source:l,stack:Vr(l)}}var Au=[],wc=0,hh=null,dh=0,ko=[],_o=0,Sc=null,el=1,Io="";function uo(o,l){Au[wc++]=dh,Au[wc++]=hh,hh=o,dh=l}function zh(o,l,f){ko[_o++]=el,ko[_o++]=Io,ko[_o++]=Sc,Sc=o;var v=el;o=Io;var E=32-an(v)-1;v&=~(1<<E),f+=1;var D=32-an(l)+E;if(30<D){var Q=E-E%5;D=(v&(1<<Q)-1).toString(32),v>>=Q,E-=Q,el=1<<32-an(l)+E|f<<E|v,Io=D+o}else el=1<<D|f<<E|v,Io=o}function Rd(o){o.return!==null&&(uo(o,1),zh(o,1,0))}function $h(o){for(;o===hh;)hh=Au[--wc],Au[wc]=null,dh=Au[--wc],Au[wc]=null;for(;o===Sc;)Sc=ko[--_o],ko[_o]=null,Io=ko[--_o],ko[_o]=null,el=ko[--_o],ko[_o]=null}function Rf(o,l){ko[_o++]=el,ko[_o++]=Io,ko[_o++]=Sc,el=l.id,Io=l.overflow,Sc=o}var ci=null,Ha=null,Gn=!1,ks=null,_n=!1,Za=Error(a(519));function Pa(o){var l=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Vl(Eo(l,o)),Za}function ho(o){var l=o.stateNode,f=o.type,v=o.memoizedProps;switch(l[Fa]=o,l[vn]=v,f){case"dialog":hn("cancel",l),hn("close",l);break;case"iframe":case"object":case"embed":hn("load",l);break;case"video":case"audio":for(f=0;f<ld.length;f++)hn(ld[f],l);break;case"source":hn("error",l);break;case"img":case"image":case"link":hn("error",l),hn("load",l);break;case"details":hn("toggle",l);break;case"input":hn("invalid",l),Td(l,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0);break;case"select":hn("invalid",l);break;case"textarea":hn("invalid",l),pu(l,v.value,v.defaultValue,v.children)}f=v.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||v.suppressHydrationWarning===!0||om(l.textContent,f)?(v.popover!=null&&(hn("beforetoggle",l),hn("toggle",l)),v.onScroll!=null&&hn("scroll",l),v.onScrollEnd!=null&&hn("scrollend",l),v.onClick!=null&&(l.onclick=ao),l=!0):l=!1,l||Pa(o,!0)}function Gl(o){for(ci=o.return;ci;)switch(ci.tag){case 5:case 31:case 13:_n=!1;return;case 27:case 3:_n=!0;return;default:ci=ci.return}}function ui(o){if(o!==ci)return!1;if(!Gn)return Gl(o),Gn=!0,!1;var l=o.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=o.type,f=!(f!=="form"&&f!=="button")||of(o.type,o.memoizedProps)),f=!f),f&&Ha&&Pa(o),Gl(o),l===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(a(317));Ha=ta(o)}else if(l===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(a(317));Ha=ta(o)}else l===27?(l=Ha,Uu(o.type)?(o=Ch,Ch=null,Ha=o):Ha=l):Ha=ci?kl(o.stateNode.nextSibling):null;return!0}function Sl(){Ha=ci=null,Gn=!1}function Ac(){var o=ks;return o!==null&&(nl===null?nl=o:nl.push.apply(nl,o),ks=null),o}function Vl(o){ks===null?ks=[o]:ks.push(o)}var Wl=X(null),Cc=null,Kl=null;function Al(o,l,f){ae(Wl,l._currentValue),l._currentValue=f}function Do(o){o._currentValue=Wl.current,H(Wl)}function Cu(o,l,f){for(;o!==null;){var v=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,v!==null&&(v.childLanes|=l)):v!==null&&(v.childLanes&l)!==l&&(v.childLanes|=l),o===f)break;o=o.return}}function Qc(o,l,f,v){var E=o.child;for(E!==null&&(E.return=o);E!==null;){var D=E.dependencies;if(D!==null){var Q=E.child;D=D.firstContext;e:for(;D!==null;){var me=D;D=E;for(var Me=0;Me<l.length;Me++)if(me.context===l[Me]){D.lanes|=f,me=D.alternate,me!==null&&(me.lanes|=f),Cu(D.return,f,o),v||(Q=null);break e}D=me.next}}else if(E.tag===18){if(Q=E.return,Q===null)throw Error(a(341));Q.lanes|=f,D=Q.alternate,D!==null&&(D.lanes|=f),Cu(Q,f,o),Q=null}else Q=E.child;if(Q!==null)Q.return=E;else for(Q=E;Q!==null;){if(Q===o){Q=null;break}if(E=Q.sibling,E!==null){E.return=Q.return,Q=E;break}Q=Q.return}E=Q}}function Ni(o,l,f,v){o=null;for(var E=l,D=!1;E!==null;){if(!D){if((E.flags&524288)!==0)D=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var Q=E.alternate;if(Q===null)throw Error(a(387));if(Q=Q.memoizedProps,Q!==null){var me=E.type;Ai(E.pendingProps.value,Q.value)||(o!==null?o.push(me):o=[me])}}else if(E===ce.current){if(Q=E.alternate,Q===null)throw Error(a(387));Q.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(o!==null?o.push(dr):o=[dr])}E=E.return}o!==null&&Qc(l,o,f,v),l.flags|=262144}function Yl(o){for(o=o.firstContext;o!==null;){if(!Ai(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Nc(o){Cc=o,Kl=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Ks(o){return jf(Cc,o)}function qh(o,l){return Cc===null&&Nc(o),jf(o,l)}function jf(o,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},Kl===null){if(o===null)throw Error(a(308));Kl=l,o.dependencies={lanes:0,firstContext:l},o.flags|=524288}else Kl=Kl.next=l;return f}var bp=typeof AbortController<"u"?AbortController:function(){var o=[],l=this.signal={aborted:!1,addEventListener:function(f,v){o.push(v)}};this.abort=function(){l.aborted=!0,o.forEach(function(f){return f()})}},U0=i.unstable_scheduleCallback,qi=i.unstable_NormalPriority,Hs={$$typeof:W,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tc(){return{controller:new bp,data:new Map,refCount:0}}function Nu(o){o.refCount--,o.refCount===0&&U0(qi,function(){o.controller.abort()})}var Gh=null,Vh=0,C=0,_=null;function P(o,l){if(Gh===null){var f=Gh=[];Vh=0,C=Wn(),_={status:"pending",value:void 0,then:function(v){f.push(v)}}}return Vh++,l.then(Y,Y),l}function Y(){if(--Vh===0&&Gh!==null){_!==null&&(_.status="fulfilled");var o=Gh;Gh=null,C=0,_=null;for(var l=0;l<o.length;l++)(0,o[l])()}}function oe(o,l){var f=[],v={status:"pending",value:null,reason:null,then:function(E){f.push(E)}};return o.then(function(){v.status="fulfilled",v.value=l;for(var E=0;E<f.length;E++)(0,f[E])(l)},function(E){for(v.status="rejected",v.reason=E,E=0;E<f.length;E++)(0,f[E])(void 0)}),v}var fe=Ee.S;Ee.S=function(o,l){Eg=er(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&P(o,l),fe!==null&&fe(o,l)};var ge=X(null);function Se(){var o=ge.current;return o!==null?o:ts.pooledCache}function Ne(o,l){l===null?ae(ge,ge.current):ae(ge,l.pool)}function Re(){var o=Se();return o===null?null:{parent:Hs._currentValue,pool:o}}var Ke=Error(a(460)),ot=Error(a(474)),Fe=Error(a(542)),Ze={then:function(){}};function nt(o){return o=o.status,o==="fulfilled"||o==="rejected"}function At(o,l,f){switch(f=o[f],f===void 0?o.push(l):f!==l&&(l.then(ao,ao),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,$t(o),o;default:if(typeof l.status=="string")l.then(ao,ao);else{if(o=ts,o!==null&&100<o.shellSuspendCounter)throw Error(a(482));o=l,o.status="pending",o.then(function(v){if(l.status==="pending"){var E=l;E.status="fulfilled",E.value=v}},function(v){if(l.status==="pending"){var E=l;E.status="rejected",E.reason=v}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,$t(o),o}throw wt=l,Ke}}function st(o){try{var l=o._init;return l(o._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(wt=f,Ke):f}}var wt=null;function kt(){if(wt===null)throw Error(a(459));var o=wt;return wt=null,o}function $t(o){if(o===Ke||o===Fe)throw Error(a(483))}var Lt=null,Ir=0;function yr(o){var l=Ir;return Ir+=1,Lt===null&&(Lt=[]),At(Lt,o,l)}function An(o,l){l=l.props.ref,o.ref=l!==void 0?l:null}function Er(o,l){throw l.$$typeof===R?Error(a(525)):(o=Object.prototype.toString.call(l),Error(a(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o)))}function Pn(o){function l(rt,Je){if(o){var ht=rt.deletions;ht===null?(rt.deletions=[Je],rt.flags|=16):ht.push(Je)}}function f(rt,Je){if(!o)return null;for(;Je!==null;)l(rt,Je),Je=Je.sibling;return null}function v(rt){for(var Je=new Map;rt!==null;)rt.key!==null?Je.set(rt.key,rt):Je.set(rt.index,rt),rt=rt.sibling;return Je}function E(rt,Je){return rt=To(rt,Je),rt.index=0,rt.sibling=null,rt}function D(rt,Je,ht){return rt.index=ht,o?(ht=rt.alternate,ht!==null?(ht=ht.index,ht<Je?(rt.flags|=67108866,Je):ht):(rt.flags|=67108866,Je)):(rt.flags|=1048576,Je)}function Q(rt){return o&&rt.alternate===null&&(rt.flags|=67108866),rt}function me(rt,Je,ht,Ot){return Je===null||Je.tag!==6?(Je=uh(ht,rt.mode,Ot),Je.return=rt,Je):(Je=E(Je,ht),Je.return=rt,Je)}function Me(rt,Je,ht,Ot){var dn=ht.type;return dn===V?St(rt,Je,ht.props.children,Ot,ht.key):Je!==null&&(Je.elementType===dn||typeof dn=="object"&&dn!==null&&dn.$$typeof===ke&&st(dn)===Je.type)?(Je=E(Je,ht.props),An(Je,ht),Je.return=rt,Je):(Je=wu(ht.type,ht.key,ht.props,null,rt.mode,Ot),An(Je,ht),Je.return=rt,Je)}function at(rt,Je,ht,Ot){return Je===null||Je.tag!==4||Je.stateNode.containerInfo!==ht.containerInfo||Je.stateNode.implementation!==ht.implementation?(Je=Su(ht,rt.mode,Ot),Je.return=rt,Je):(Je=E(Je,ht.children||[]),Je.return=rt,Je)}function St(rt,Je,ht,Ot,dn){return Je===null||Je.tag!==7?(Je=co(ht,rt.mode,Ot,dn),Je.return=rt,Je):(Je=E(Je,ht),Je.return=rt,Je)}function Tt(rt,Je,ht){if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return Je=uh(""+Je,rt.mode,ht),Je.return=rt,Je;if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case k:return ht=wu(Je.type,Je.key,Je.props,null,rt.mode,ht),An(ht,Je),ht.return=rt,ht;case M:return Je=Su(Je,rt.mode,ht),Je.return=rt,Je;case ke:return Je=st(Je),Tt(rt,Je,ht)}if(Be(Je)||K(Je))return Je=co(Je,rt.mode,ht,null),Je.return=rt,Je;if(typeof Je.then=="function")return Tt(rt,yr(Je),ht);if(Je.$$typeof===W)return Tt(rt,qh(rt,Je),ht);Er(rt,Je)}return null}function ut(rt,Je,ht,Ot){var dn=Je!==null?Je.key:null;if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return dn!==null?null:me(rt,Je,""+ht,Ot);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case k:return ht.key===dn?Me(rt,Je,ht,Ot):null;case M:return ht.key===dn?at(rt,Je,ht,Ot):null;case ke:return ht=st(ht),ut(rt,Je,ht,Ot)}if(Be(ht)||K(ht))return dn!==null?null:St(rt,Je,ht,Ot,null);if(typeof ht.then=="function")return ut(rt,Je,yr(ht),Ot);if(ht.$$typeof===W)return ut(rt,Je,qh(rt,ht),Ot);Er(rt,ht)}return null}function mt(rt,Je,ht,Ot,dn){if(typeof Ot=="string"&&Ot!==""||typeof Ot=="number"||typeof Ot=="bigint")return rt=rt.get(ht)||null,me(Je,rt,""+Ot,dn);if(typeof Ot=="object"&&Ot!==null){switch(Ot.$$typeof){case k:return rt=rt.get(Ot.key===null?ht:Ot.key)||null,Me(Je,rt,Ot,dn);case M:return rt=rt.get(Ot.key===null?ht:Ot.key)||null,at(Je,rt,Ot,dn);case ke:return Ot=st(Ot),mt(rt,Je,ht,Ot,dn)}if(Be(Ot)||K(Ot))return rt=rt.get(ht)||null,St(Je,rt,Ot,dn,null);if(typeof Ot.then=="function")return mt(rt,Je,ht,yr(Ot),dn);if(Ot.$$typeof===W)return mt(rt,Je,ht,qh(Je,Ot),dn);Er(Je,Ot)}return null}function Fr(rt,Je,ht,Ot){for(var dn=null,_a=null,Jr=Je,qn=Je=0,da=null;Jr!==null&&qn<ht.length;qn++){Jr.index>qn?(da=Jr,Jr=null):da=Jr.sibling;var Ia=ut(rt,Jr,ht[qn],Ot);if(Ia===null){Jr===null&&(Jr=da);break}o&&Jr&&Ia.alternate===null&&l(rt,Jr),Je=D(Ia,Je,qn),_a===null?dn=Ia:_a.sibling=Ia,_a=Ia,Jr=da}if(qn===ht.length)return f(rt,Jr),Gn&&uo(rt,qn),dn;if(Jr===null){for(;qn<ht.length;qn++)Jr=Tt(rt,ht[qn],Ot),Jr!==null&&(Je=D(Jr,Je,qn),_a===null?dn=Jr:_a.sibling=Jr,_a=Jr);return Gn&&uo(rt,qn),dn}for(Jr=v(Jr);qn<ht.length;qn++)da=mt(Jr,rt,qn,ht[qn],Ot),da!==null&&(o&&da.alternate!==null&&Jr.delete(da.key===null?qn:da.key),Je=D(da,Je,qn),_a===null?dn=da:_a.sibling=da,_a=da);return o&&Jr.forEach(function(cf){return l(rt,cf)}),Gn&&uo(rt,qn),dn}function xn(rt,Je,ht,Ot){if(ht==null)throw Error(a(151));for(var dn=null,_a=null,Jr=Je,qn=Je=0,da=null,Ia=ht.next();Jr!==null&&!Ia.done;qn++,Ia=ht.next()){Jr.index>qn?(da=Jr,Jr=null):da=Jr.sibling;var cf=ut(rt,Jr,Ia.value,Ot);if(cf===null){Jr===null&&(Jr=da);break}o&&Jr&&cf.alternate===null&&l(rt,Jr),Je=D(cf,Je,qn),_a===null?dn=cf:_a.sibling=cf,_a=cf,Jr=da}if(Ia.done)return f(rt,Jr),Gn&&uo(rt,qn),dn;if(Jr===null){for(;!Ia.done;qn++,Ia=ht.next())Ia=Tt(rt,Ia.value,Ot),Ia!==null&&(Je=D(Ia,Je,qn),_a===null?dn=Ia:_a.sibling=Ia,_a=Ia);return Gn&&uo(rt,qn),dn}for(Jr=v(Jr);!Ia.done;qn++,Ia=ht.next())Ia=mt(Jr,rt,qn,Ia.value,Ot),Ia!==null&&(o&&Ia.alternate!==null&&Jr.delete(Ia.key===null?qn:Ia.key),Je=D(Ia,Je,qn),_a===null?dn=Ia:_a.sibling=Ia,_a=Ia);return o&&Jr.forEach(function(EA){return l(rt,EA)}),Gn&&uo(rt,qn),dn}function fs(rt,Je,ht,Ot){if(typeof ht=="object"&&ht!==null&&ht.type===V&&ht.key===null&&(ht=ht.props.children),typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case k:e:{for(var dn=ht.key;Je!==null;){if(Je.key===dn){if(dn=ht.type,dn===V){if(Je.tag===7){f(rt,Je.sibling),Ot=E(Je,ht.props.children),Ot.return=rt,rt=Ot;break e}}else if(Je.elementType===dn||typeof dn=="object"&&dn!==null&&dn.$$typeof===ke&&st(dn)===Je.type){f(rt,Je.sibling),Ot=E(Je,ht.props),An(Ot,ht),Ot.return=rt,rt=Ot;break e}f(rt,Je);break}else l(rt,Je);Je=Je.sibling}ht.type===V?(Ot=co(ht.props.children,rt.mode,Ot,ht.key),Ot.return=rt,rt=Ot):(Ot=wu(ht.type,ht.key,ht.props,null,rt.mode,Ot),An(Ot,ht),Ot.return=rt,rt=Ot)}return Q(rt);case M:e:{for(dn=ht.key;Je!==null;){if(Je.key===dn)if(Je.tag===4&&Je.stateNode.containerInfo===ht.containerInfo&&Je.stateNode.implementation===ht.implementation){f(rt,Je.sibling),Ot=E(Je,ht.children||[]),Ot.return=rt,rt=Ot;break e}else{f(rt,Je);break}else l(rt,Je);Je=Je.sibling}Ot=Su(ht,rt.mode,Ot),Ot.return=rt,rt=Ot}return Q(rt);case ke:return ht=st(ht),fs(rt,Je,ht,Ot)}if(Be(ht))return Fr(rt,Je,ht,Ot);if(K(ht)){if(dn=K(ht),typeof dn!="function")throw Error(a(150));return ht=dn.call(ht),xn(rt,Je,ht,Ot)}if(typeof ht.then=="function")return fs(rt,Je,yr(ht),Ot);if(ht.$$typeof===W)return fs(rt,Je,qh(rt,ht),Ot);Er(rt,ht)}return typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint"?(ht=""+ht,Je!==null&&Je.tag===6?(f(rt,Je.sibling),Ot=E(Je,ht),Ot.return=rt,rt=Ot):(f(rt,Je),Ot=uh(ht,rt.mode,Ot),Ot.return=rt,rt=Ot),Q(rt)):f(rt,Je)}return function(rt,Je,ht,Ot){try{Ir=0;var dn=fs(rt,Je,ht,Ot);return Lt=null,dn}catch(Jr){if(Jr===Ke||Jr===Fe)throw Jr;var _a=La(29,Jr,null,rt.mode);return _a.lanes=Ot,_a.return=rt,_a}}}var za=Pn(!0),En=Pn(!1),pr=!1;function sr(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $a(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function qr(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function In(o,l,f){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(Na&2)!==0){var E=v.pending;return E===null?l.next=l:(l.next=E.next,E.next=l),v.pending=l,l=$i(o),sa(o,null,f),l}return xc(o,v,l,f),$i(o)}function ya(o,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var v=l.lanes;v&=o.pendingLanes,f|=v,l.lanes=f,pa(o,f)}}function Ys(o,l){var f=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,f===v)){var E=null,D=null;if(f=f.firstBaseUpdate,f!==null){do{var Q={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};D===null?E=D=Q:D=D.next=Q,f=f.next}while(f!==null);D===null?E=D=l:D=D.next=l}else E=D=l;f={baseState:v.baseState,firstBaseUpdate:E,lastBaseUpdate:D,shared:v.shared,callbacks:v.callbacks},o.updateQueue=f;return}o=f.lastBaseUpdate,o===null?f.firstBaseUpdate=l:o.next=l,f.lastBaseUpdate=l}var hi=!1;function Ma(){if(hi){var o=_;if(o!==null)throw o}}function _s(o,l,f,v){hi=!1;var E=o.updateQueue;pr=!1;var D=E.firstBaseUpdate,Q=E.lastBaseUpdate,me=E.shared.pending;if(me!==null){E.shared.pending=null;var Me=me,at=Me.next;Me.next=null,Q===null?D=at:Q.next=at,Q=Me;var St=o.alternate;St!==null&&(St=St.updateQueue,me=St.lastBaseUpdate,me!==Q&&(me===null?St.firstBaseUpdate=at:me.next=at,St.lastBaseUpdate=Me))}if(D!==null){var Tt=E.baseState;Q=0,St=at=Me=null,me=D;do{var ut=me.lane&-536870913,mt=ut!==me.lane;if(mt?(ea&ut)===ut:(v&ut)===ut){ut!==0&&ut===C&&(hi=!0),St!==null&&(St=St.next={lane:0,tag:me.tag,payload:me.payload,callback:null,next:null});e:{var Fr=o,xn=me;ut=l;var fs=f;switch(xn.tag){case 1:if(Fr=xn.payload,typeof Fr=="function"){Tt=Fr.call(fs,Tt,ut);break e}Tt=Fr;break e;case 3:Fr.flags=Fr.flags&-65537|128;case 0:if(Fr=xn.payload,ut=typeof Fr=="function"?Fr.call(fs,Tt,ut):Fr,ut==null)break e;Tt=I({},Tt,ut);break e;case 2:pr=!0}}ut=me.callback,ut!==null&&(o.flags|=64,mt&&(o.flags|=8192),mt=E.callbacks,mt===null?E.callbacks=[ut]:mt.push(ut))}else mt={lane:ut,tag:me.tag,payload:me.payload,callback:me.callback,next:null},St===null?(at=St=mt,Me=Tt):St=St.next=mt,Q|=ut;if(me=me.next,me===null){if(me=E.shared.pending,me===null)break;mt=me,me=mt.next,mt.next=null,E.lastBaseUpdate=mt,E.shared.pending=null}}while(!0);St===null&&(Me=Tt),E.baseState=Me,E.firstBaseUpdate=at,E.lastBaseUpdate=St,D===null&&(E.shared.lanes=0),Ou|=Q,o.lanes=Q,o.memoizedState=Tt}}function Ti(o,l){if(typeof o!="function")throw Error(a(191,o));o.call(l)}function Is(o,l){var f=o.callbacks;if(f!==null)for(o.callbacks=null,o=0;o<f.length;o++)Ti(f[o],l)}var Dn=X(null),Hn=X(0);function hs(o,l){o=ju,ae(Hn,o),ae(Dn,l),ju=o|l.baseLanes}function ua(){ae(Hn,ju),ae(Dn,Dn.current)}function ni(){ju=Hn.current,H(Dn),H(Hn)}var ws=X(null),ia=null;function ds(o){var l=o.alternate;ae(Zn,Zn.current&1),ae(ws,o),ia===null&&(l===null||Dn.current!==null||l.memoizedState!==null)&&(ia=o)}function va(o){ae(Zn,Zn.current),ae(ws,o),ia===null&&(ia=o)}function Ds(o){o.tag===22?(ae(Zn,Zn.current),ae(ws,o),ia===null&&(ia=o)):zs()}function zs(){ae(Zn,Zn.current),ae(ws,ws.current)}function oa(o){H(ws),ia===o&&(ia=null),H(Zn)}var Zn=X(0);function di(o){for(var l=o;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||D1(f)||lf(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var es=0,Zr=null,Kr=null,Vn=null,eo=!1,Fo=!1,Gi=!1,$s=0,Ec=0,kc=null,Wh=0;function qa(){throw Error(a(321))}function Of(o,l){if(l===null)return!1;for(var f=0;f<l.length&&f<o.length;f++)if(!Ai(o[f],l[f]))return!1;return!0}function jd(o,l,f,v,E,D){return es=D,Zr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Ee.H=o===null||o.memoizedState===null?ig:_p,Gi=!1,D=f(v,E),Gi=!1,Fo&&(D=_c(l,f,v,E)),Od(o),D}function Od(o){Ee.H=Vf;var l=Kr!==null&&Kr.next!==null;if(es=0,Vn=Kr=Zr=null,eo=!1,Ec=0,kc=null,l)throw Error(a(300));o===null||pi||(o=o.dependencies,o!==null&&Yl(o)&&(pi=!0))}function _c(o,l,f,v){Zr=o;var E=0;do{if(Fo&&(kc=null),Ec=0,Fo=!1,25<=E)throw Error(a(301));if(E+=1,Vn=Kr=null,o.updateQueue!=null){var D=o.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Ee.H=og,D=l(f,v)}while(Fo);return D}function xp(){var o=Ee.H,l=o.useState()[0];return l=typeof l.then=="function"?Xc(l):l,o=o.useState()[0],(Kr!==null?Kr.memoizedState:null)!==o&&(Zr.flags|=1024),l}function Lf(){var o=$s!==0;return $s=0,o}function Pf(o,l,f){l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~f}function fh(o){if(eo){for(o=o.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}eo=!1}es=0,Vn=Kr=Zr=null,Fo=!1,Ec=$s=0,kc=null}function fi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?Zr.memoizedState=Vn=o:Vn=Vn.next=o,Vn}function Fs(){if(Kr===null){var o=Zr.alternate;o=o!==null?o.memoizedState:null}else o=Kr.next;var l=Vn===null?Zr.memoizedState:Vn.next;if(l!==null)Vn=l,Kr=o;else{if(o===null)throw Zr.alternate===null?Error(a(467)):Error(a(310));Kr=o,o={memoizedState:Kr.memoizedState,baseState:Kr.baseState,baseQueue:Kr.baseQueue,queue:Kr.queue,next:null},Vn===null?Zr.memoizedState=Vn=o:Vn=Vn.next=o}return Vn}function Kh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xc(o){var l=Ec;return Ec+=1,kc===null&&(kc=[]),o=At(kc,o,l),l=Zr,(Vn===null?l.memoizedState:Vn.next)===null&&(l=l.alternate,Ee.H=l===null||l.memoizedState===null?ig:_p),o}function Tu(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Xc(o);if(o.$$typeof===W)return Ks(o)}throw Error(a(438,String(o)))}function Eu(o){var l=null,f=Zr.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var v=Zr.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(l={data:v.data.map(function(E){return E.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Kh(),Zr.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(o),v=0;v<o;v++)f[v]=Oe;return l.index++,f}function Jl(o,l){return typeof l=="function"?l(o):l}function Yh(o){var l=Fs();return fo(l,Kr,o)}function fo(o,l,f){var v=o.queue;if(v===null)throw Error(a(311));v.lastRenderedReducer=f;var E=o.baseQueue,D=v.pending;if(D!==null){if(E!==null){var Q=E.next;E.next=D.next,D.next=Q}l.baseQueue=E=D,v.pending=null}if(D=o.baseState,E===null)o.memoizedState=D;else{l=E.next;var me=Q=null,Me=null,at=l,St=!1;do{var Tt=at.lane&-536870913;if(Tt!==at.lane?(ea&Tt)===Tt:(es&Tt)===Tt){var ut=at.revertLane;if(ut===0)Me!==null&&(Me=Me.next={lane:0,revertLane:0,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),Tt===C&&(St=!0);else if((es&ut)===ut){at=at.next,ut===C&&(St=!0);continue}else Tt={lane:0,revertLane:at.revertLane,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},Me===null?(me=Me=Tt,Q=D):Me=Me.next=Tt,Zr.lanes|=ut,Ou|=ut;Tt=at.action,Gi&&f(D,Tt),D=at.hasEagerState?at.eagerState:f(D,Tt)}else ut={lane:Tt,revertLane:at.revertLane,gesture:at.gesture,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},Me===null?(me=Me=ut,Q=D):Me=Me.next=ut,Zr.lanes|=Tt,Ou|=Tt;at=at.next}while(at!==null&&at!==l);if(Me===null?Q=D:Me.next=me,!Ai(D,o.memoizedState)&&(pi=!0,St&&(f=_,f!==null)))throw f;o.memoizedState=D,o.baseState=Q,o.baseQueue=Me,v.lastRenderedState=D}return E===null&&(v.lanes=0),[o.memoizedState,v.dispatch]}function Ld(o){var l=Fs(),f=l.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=o;var v=f.dispatch,E=f.pending,D=l.memoizedState;if(E!==null){f.pending=null;var Q=E=E.next;do D=o(D,Q.action),Q=Q.next;while(Q!==E);Ai(D,l.memoizedState)||(pi=!0),l.memoizedState=D,l.baseQueue===null&&(l.baseState=D),f.lastRenderedState=D}return[D,v]}function Pd(o,l,f){var v=Zr,E=Fs(),D=Gn;if(D){if(f===void 0)throw Error(a(407));f=f()}else f=l();var Q=!Ai((Kr||E).memoizedState,f);if(Q&&(E.memoizedState=f,pi=!0),E=E.queue,zf(Mf.bind(null,v,E,o),[o]),E.getSnapshot!==l||Q||Vn!==null&&Vn.memoizedState.tag&1){if(v.flags|=2048,Rs(9,{destroy:void 0},Md.bind(null,v,E,f,l),null),ts===null)throw Error(a(349));D||(es&127)!==0||Ql(v,l,f)}return f}function Ql(o,l,f){o.flags|=16384,o={getSnapshot:l,value:f},l=Zr.updateQueue,l===null?(l=Kh(),Zr.updateQueue=l,l.stores=[o]):(f=l.stores,f===null?l.stores=[o]:f.push(o))}function Md(o,l,f,v){l.value=f,l.getSnapshot=v,Ud(l)&&Jh(o)}function Mf(o,l,f){return f(function(){Ud(l)&&Jh(o)})}function Ud(o){var l=o.getSnapshot;o=o.value;try{var f=l();return!Ai(o,f)}catch{return!0}}function Jh(o){var l=lo(o,2);l!==null&&Lo(l,o,2)}function Ic(o){var l=fi();if(typeof o=="function"){var f=o;if(o=f(),Gi){xr(!0);try{f()}finally{xr(!1)}}}return l.memoizedState=l.baseState=o,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:o},l}function Uf(o,l,f,v){return o.baseState=f,fo(o,Kr,typeof v=="function"?v:Jl)}function Bf(o,l,f,v,E){if(q0(o))throw Error(a(485));if(o=l.action,o!==null){var D={payload:E,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){D.listeners.push(Q)}};Ee.T!==null?f(!0):D.isTransition=!1,v(D),f=l.pending,f===null?(D.next=l.pending=D,ku(l,D)):(D.next=f.next,l.pending=f.next=D)}}function ku(o,l){var f=l.action,v=l.payload,E=o.state;if(l.isTransition){var D=Ee.T,Q={};Ee.T=Q;try{var me=f(E,v),Me=Ee.S;Me!==null&&Me(Q,me),Hf(o,l,me)}catch(at){Zc(o,l,at)}finally{D!==null&&Q.types!==null&&(D.types=Q.types),Ee.T=D}}else try{D=f(E,v),Hf(o,l,D)}catch(at){Zc(o,l,at)}}function Hf(o,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(v){B0(o,l,v)},function(v){return Zc(o,l,v)}):B0(o,l,f)}function B0(o,l,f){l.status="fulfilled",l.value=f,Qh(l),o.state=f,l=o.pending,l!==null&&(f=l.next,f===l?o.pending=null:(f=f.next,l.next=f,ku(o,f)))}function Zc(o,l,f){var v=o.pending;if(o.pending=null,v!==null){v=v.next;do l.status="rejected",l.reason=f,Qh(l),l=l.next;while(l!==v)}o.action=null}function Qh(o){o=o.listeners;for(var l=0;l<o.length;l++)(0,o[l])()}function eu(o,l){return l}function po(o,l){if(Gn){var f=ts.formState;if(f!==null){e:{var v=Zr;if(Gn){if(Ha){t:{for(var E=Ha,D=_n;E.nodeType!==8;){if(!D){E=null;break t}if(E=kl(E.nextSibling),E===null){E=null;break t}}D=E.data,E=D==="F!"||D==="F"?E:null}if(E){Ha=kl(E.nextSibling),v=E.data==="F!";break e}}Pa(v)}v=!1}v&&(l=f[0])}}return f=fi(),f.memoizedState=f.baseState=l,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eu,lastRenderedState:l},f.queue=v,f=qd.bind(null,Zr,v),v.dispatch=f,v=Ic(!1),D=kp.bind(null,Zr,!1,v.queue),v=fi(),E={state:l,dispatch:null,action:o,pending:null},v.queue=E,f=Bf.bind(null,Zr,E,D,f),E.dispatch=f,v.memoizedState=o,[l,f,!1]}function tl(o){var l=Fs();return Xl(l,Kr,o)}function Xl(o,l,f){if(l=fo(o,l,eu)[0],o=Yh(Jl)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var v=Xc(l)}catch(Q){throw Q===Ke?Fe:Q}else v=l;l=Fs();var E=l.queue,D=E.dispatch;return f!==l.memoizedState&&(Zr.flags|=2048,Rs(9,{destroy:void 0},Bd.bind(null,E,f),null)),[v,D,o]}function Bd(o,l){o.action=l}function Hd(o){var l=Fs(),f=Kr;if(f!==null)return Xl(l,f,o);Fs(),l=l.memoizedState,f=Fs();var v=f.queue.dispatch;return f.memoizedState=o,[l,v,!1]}function Rs(o,l,f,v){return o={tag:o,create:f,deps:v,inst:l,next:null},l=Zr.updateQueue,l===null&&(l=Kh(),Zr.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=o.next=o:(v=f.next,f.next=o,o.next=v,l.lastEffect=o),o}function ph(){return Fs().memoizedState}function Zl(o,l,f,v){var E=fi();Zr.flags|=o,E.memoizedState=Rs(1|l,{destroy:void 0},f,v===void 0?null:v)}function Dc(o,l,f,v){var E=Fs();v=v===void 0?null:v;var D=E.memoizedState.inst;Kr!==null&&v!==null&&Of(v,Kr.memoizedState.deps)?E.memoizedState=Rs(l,D,f,v):(Zr.flags|=o,E.memoizedState=Rs(1|l,D,f,v))}function H0(o,l){Zl(8390656,8,o,l)}function zf(o,l){Dc(2048,8,o,l)}function mh(o){Zr.flags|=4;var l=Zr.updateQueue;if(l===null)l=Kh(),Zr.updateQueue=l,l.events=[o];else{var f=l.events;f===null?l.events=[o]:f.push(o)}}function wp(o){var l=Fs().memoizedState;return mh({ref:l,nextImpl:o}),function(){if((Na&2)!==0)throw Error(a(440));return l.impl.apply(void 0,arguments)}}function zd(o,l){return Dc(4,2,o,l)}function Xh(o,l){return Dc(4,4,o,l)}function Xm(o,l){if(typeof l=="function"){o=o();var f=l(o);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function $f(o,l,f){f=f!=null?f.concat([o]):null,Dc(4,4,Xm.bind(null,l,o),f)}function $d(){}function Sp(o,l){var f=Fs();l=l===void 0?null:l;var v=f.memoizedState;return l!==null&&Of(l,v[1])?v[0]:(f.memoizedState=[o,l],o)}function Ap(o,l){var f=Fs();l=l===void 0?null:l;var v=f.memoizedState;if(l!==null&&Of(l,v[1]))return v[0];if(v=o(),Gi){xr(!0);try{o()}finally{xr(!1)}}return f.memoizedState=[v,l],v}function z0(o,l,f){return f===void 0||(es&1073741824)!==0&&(ea&261930)===0?o.memoizedState=l:(o.memoizedState=f,o=kg(),Zr.lanes|=o,Ou|=o,f)}function Cp(o,l,f,v){return Ai(f,l)?f:Dn.current!==null?(o=z0(o,f,v),Ai(o,l)||(pi=!0),o):(es&42)===0||(es&1073741824)!==0&&(ea&261930)===0?(pi=!0,o.memoizedState=f):(o=kg(),Zr.lanes|=o,Ou|=o,l)}function Np(o,l,f,v,E){var D=Pe.p;Pe.p=D!==0&&8>D?D:8;var Q=Ee.T,me={};Ee.T=me,kp(o,!1,l,f);try{var Me=E(),at=Ee.S;if(at!==null&&at(me,Me),Me!==null&&typeof Me=="object"&&typeof Me.then=="function"){var St=oe(Me,v);Gf(o,l,St,Oo(o))}else Gf(o,l,v,Oo(o))}catch(Tt){Gf(o,l,{then:function(){},status:"rejected",reason:Tt},Oo())}finally{Pe.p=D,Q!==null&&me.types!==null&&(Q.types=me.types),Ee.T=Q}}function qf(){}function Tp(o,l,f,v){if(o.tag!==5)throw Error(a(476));var E=Ep(o).queue;Np(o,E,l,Ue,f===null?qf:function(){return Zm(o),f(v)})}function Ep(o){var l=o.memoizedState;if(l!==null)return l;l={memoizedState:Ue,baseState:Ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:Ue},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:f},next:null},o.memoizedState=l,o=o.alternate,o!==null&&(o.memoizedState=l),l}function Zm(o){var l=Ep(o);l.next===null&&(l=o.alternate.memoizedState),Gf(o,l.next.queue,{},Oo())}function $0(){return Ks(dr)}function eg(){return Fs().memoizedState}function tg(){return Fs().memoizedState}function rg(o){for(var l=o.return;l!==null;){switch(l.tag){case 24:case 3:var f=Oo();o=qr(f);var v=In(l,o,f);v!==null&&(Lo(v,l,f),ya(v,l,f)),l={cache:Tc()},o.payload=l;return}l=l.return}}function ng(o,l,f){var v=Oo();f={lane:v,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},q0(o)?ag(l,f):(f=Jc(o,l,f,v),f!==null&&(Lo(f,o,v),sg(f,l,v)))}function qd(o,l,f){var v=Oo();Gf(o,l,f,v)}function Gf(o,l,f,v){var E={lane:v,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(q0(o))ag(l,E);else{var D=o.alternate;if(o.lanes===0&&(D===null||D.lanes===0)&&(D=l.lastRenderedReducer,D!==null))try{var Q=l.lastRenderedState,me=D(Q,f);if(E.hasEagerState=!0,E.eagerState=me,Ai(me,Q))return xc(o,l,E,0),ts===null&&Cn(),!1}catch{}if(f=Jc(o,l,E,v),f!==null)return Lo(f,o,v),sg(f,l,v),!0}return!1}function kp(o,l,f,v){if(v={lane:2,revertLane:Wn(),gesture:null,action:v,hasEagerState:!1,eagerState:null,next:null},q0(o)){if(l)throw Error(a(479))}else l=Jc(o,f,v,2),l!==null&&Lo(l,o,2)}function q0(o){var l=o.alternate;return o===Zr||l!==null&&l===Zr}function ag(o,l){Fo=eo=!0;var f=o.pending;f===null?l.next=l:(l.next=f.next,f.next=l),o.pending=l}function sg(o,l,f){if((f&4194048)!==0){var v=l.lanes;v&=o.pendingLanes,f|=v,l.lanes=f,pa(o,f)}}var Vf={readContext:Ks,use:Tu,useCallback:qa,useContext:qa,useEffect:qa,useImperativeHandle:qa,useLayoutEffect:qa,useInsertionEffect:qa,useMemo:qa,useReducer:qa,useRef:qa,useState:qa,useDebugValue:qa,useDeferredValue:qa,useTransition:qa,useSyncExternalStore:qa,useId:qa,useHostTransitionStatus:qa,useFormState:qa,useActionState:qa,useOptimistic:qa,useMemoCache:qa,useCacheRefresh:qa};Vf.useEffectEvent=qa;var ig={readContext:Ks,use:Tu,useCallback:function(o,l){return fi().memoizedState=[o,l===void 0?null:l],o},useContext:Ks,useEffect:H0,useImperativeHandle:function(o,l,f){f=f!=null?f.concat([o]):null,Zl(4194308,4,Xm.bind(null,l,o),f)},useLayoutEffect:function(o,l){return Zl(4194308,4,o,l)},useInsertionEffect:function(o,l){Zl(4,2,o,l)},useMemo:function(o,l){var f=fi();l=l===void 0?null:l;var v=o();if(Gi){xr(!0);try{o()}finally{xr(!1)}}return f.memoizedState=[v,l],v},useReducer:function(o,l,f){var v=fi();if(f!==void 0){var E=f(l);if(Gi){xr(!0);try{f(l)}finally{xr(!1)}}}else E=l;return v.memoizedState=v.baseState=E,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:E},v.queue=o,o=o.dispatch=ng.bind(null,Zr,o),[v.memoizedState,o]},useRef:function(o){var l=fi();return o={current:o},l.memoizedState=o},useState:function(o){o=Ic(o);var l=o.queue,f=qd.bind(null,Zr,l);return l.dispatch=f,[o.memoizedState,f]},useDebugValue:$d,useDeferredValue:function(o,l){var f=fi();return z0(f,o,l)},useTransition:function(){var o=Ic(!1);return o=Np.bind(null,Zr,o.queue,!0,!1),fi().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,l,f){var v=Zr,E=fi();if(Gn){if(f===void 0)throw Error(a(407));f=f()}else{if(f=l(),ts===null)throw Error(a(349));(ea&127)!==0||Ql(v,l,f)}E.memoizedState=f;var D={value:f,getSnapshot:l};return E.queue=D,H0(Mf.bind(null,v,D,o),[o]),v.flags|=2048,Rs(9,{destroy:void 0},Md.bind(null,v,D,f,l),null),f},useId:function(){var o=fi(),l=ts.identifierPrefix;if(Gn){var f=Io,v=el;f=(v&~(1<<32-an(v)-1)).toString(32)+f,l="_"+l+"R_"+f,f=$s++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=Wh++,l="_"+l+"r_"+f.toString(32)+"_";return o.memoizedState=l},useHostTransitionStatus:$0,useFormState:po,useActionState:po,useOptimistic:function(o){var l=fi();l.memoizedState=l.baseState=o;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=kp.bind(null,Zr,!0,f),f.dispatch=l,[o,l]},useMemoCache:Eu,useCacheRefresh:function(){return fi().memoizedState=rg.bind(null,Zr)},useEffectEvent:function(o){var l=fi(),f={impl:o};return l.memoizedState=f,function(){if((Na&2)!==0)throw Error(a(440));return f.impl.apply(void 0,arguments)}}},_p={readContext:Ks,use:Tu,useCallback:Sp,useContext:Ks,useEffect:zf,useImperativeHandle:$f,useInsertionEffect:zd,useLayoutEffect:Xh,useMemo:Ap,useReducer:Yh,useRef:ph,useState:function(){return Yh(Jl)},useDebugValue:$d,useDeferredValue:function(o,l){var f=Fs();return Cp(f,Kr.memoizedState,o,l)},useTransition:function(){var o=Yh(Jl)[0],l=Fs().memoizedState;return[typeof o=="boolean"?o:Xc(o),l]},useSyncExternalStore:Pd,useId:eg,useHostTransitionStatus:$0,useFormState:tl,useActionState:tl,useOptimistic:function(o,l){var f=Fs();return Uf(f,Kr,o,l)},useMemoCache:Eu,useCacheRefresh:tg};_p.useEffectEvent=wp;var og={readContext:Ks,use:Tu,useCallback:Sp,useContext:Ks,useEffect:zf,useImperativeHandle:$f,useInsertionEffect:zd,useLayoutEffect:Xh,useMemo:Ap,useReducer:Ld,useRef:ph,useState:function(){return Ld(Jl)},useDebugValue:$d,useDeferredValue:function(o,l){var f=Fs();return Kr===null?z0(f,o,l):Cp(f,Kr.memoizedState,o,l)},useTransition:function(){var o=Ld(Jl)[0],l=Fs().memoizedState;return[typeof o=="boolean"?o:Xc(o),l]},useSyncExternalStore:Pd,useId:eg,useHostTransitionStatus:$0,useFormState:Hd,useActionState:Hd,useOptimistic:function(o,l){var f=Fs();return Kr!==null?Uf(f,Kr,o,l):(f.baseState=o,[o,f.queue.dispatch])},useMemoCache:Eu,useCacheRefresh:tg};og.useEffectEvent=wp;function Ip(o,l,f,v){l=o.memoizedState,f=f(v,l),f=f==null?l:I({},l,f),o.memoizedState=f,o.lanes===0&&(o.updateQueue.baseState=f)}var Dp={enqueueSetState:function(o,l,f){o=o._reactInternals;var v=Oo(),E=qr(v);E.payload=l,f!=null&&(E.callback=f),l=In(o,E,v),l!==null&&(Lo(l,o,v),ya(l,o,v))},enqueueReplaceState:function(o,l,f){o=o._reactInternals;var v=Oo(),E=qr(v);E.tag=1,E.payload=l,f!=null&&(E.callback=f),l=In(o,E,v),l!==null&&(Lo(l,o,v),ya(l,o,v))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var f=Oo(),v=qr(f);v.tag=2,l!=null&&(v.callback=l),l=In(o,v,f),l!==null&&(Lo(l,o,f),ya(l,o,f))}};function lg(o,l,f,v,E,D,Q){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,D,Q):l.prototype&&l.prototype.isPureReactComponent?!$l(f,v)||!$l(E,D):!0}function cg(o,l,f,v){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,v),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,v),l.state!==o&&Dp.enqueueReplaceState(l,l.state,null)}function gh(o,l){var f=l;if("ref"in l){f={};for(var v in l)v!=="ref"&&(f[v]=l[v])}if(o=o.defaultProps){f===l&&(f=I({},f));for(var E in o)f[E]===void 0&&(f[E]=o[E])}return f}function G0(o){bu(o)}function ug(o){console.error(o)}function hg(o){bu(o)}function V0(o,l){try{var f=o.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(v){setTimeout(function(){throw v})}}function Fp(o,l,f){try{var v=o.onCaughtError;v(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function yh(o,l,f){return f=qr(f),f.tag=3,f.payload={element:null},f.callback=function(){V0(o,l)},f}function Rp(o){return o=qr(o),o.tag=3,o}function jp(o,l,f,v){var E=f.type.getDerivedStateFromError;if(typeof E=="function"){var D=v.value;o.payload=function(){return E(D)},o.callback=function(){Fp(l,f,v)}}var Q=f.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(o.callback=function(){Fp(l,f,v),typeof E!="function"&&(wh===null?wh=new Set([this]):wh.add(this));var me=v.stack;this.componentDidCatch(v.value,{componentStack:me!==null?me:""})})}function dg(o,l,f,v,E){if(f.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(l=f.alternate,l!==null&&Ni(l,f,E,!0),f=ws.current,f!==null){switch(f.tag){case 31:case 13:return ia===null?d1():f.alternate===null&&qs===0&&(qs=3),f.flags&=-257,f.flags|=65536,f.lanes=E,v===Ze?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([v]):l.add(v),p1(o,v,E)),!1;case 22:return f.flags|=65536,v===Ze?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([v])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([v]):f.add(v)),p1(o,v,E)),!1}throw Error(a(435,f.tag))}return p1(o,v,E),d1(),!1}if(Gn)return l=ws.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=E,v!==Za&&(o=Error(a(422),{cause:v}),Vl(Eo(o,f)))):(v!==Za&&(l=Error(a(423),{cause:v}),Vl(Eo(l,f))),o=o.current.alternate,o.flags|=65536,E&=-E,o.lanes|=E,v=Eo(v,f),E=yh(o.stateNode,v,E),Ys(o,E),qs!==4&&(qs=2)),!1;var D=Error(a(520),{cause:v});if(D=Eo(D,f),r0===null?r0=[D]:r0.push(D),qs!==4&&(qs=2),l===null)return!0;v=Eo(v,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,o=E&-E,f.lanes|=o,o=yh(f.stateNode,v,o),Ys(f,o),!1;case 1:if(l=f.type,D=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(wh===null||!wh.has(D))))return f.flags|=65536,E&=-E,f.lanes|=E,E=Rp(E),jp(E,o,f,v),Ys(f,E),!1}f=f.return}while(f!==null);return!1}var Op=Error(a(461)),pi=!1;function Vi(o,l,f,v){l.child=o===null?En(l,null,f,v):za(l,o.child,f,v)}function W0(o,l,f,v,E){f=f.render;var D=l.ref;if("ref"in v){var Q={};for(var me in v)me!=="ref"&&(Q[me]=v[me])}else Q=v;return Nc(l),v=jd(o,l,f,Q,D,E),me=Lf(),o!==null&&!pi?(Pf(o,l,E),_u(o,l,E)):(Gn&&me&&Rd(l),l.flags|=1,Vi(o,l,v,E),l.child)}function Lp(o,l,f,v,E){if(o===null){var D=f.type;return typeof D=="function"&&!Dd(D)&&D.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=D,Zh(o,l,D,v,E)):(o=wu(f.type,null,v,l,l.mode,E),o.ref=l.ref,o.return=l,l.child=o)}if(D=o.child,!td(o,E)){var Q=D.memoizedProps;if(f=f.compare,f=f!==null?f:$l,f(Q,v)&&o.ref===l.ref)return _u(o,l,E)}return l.flags|=1,o=To(D,v),o.ref=l.ref,o.return=l,l.child=o}function Zh(o,l,f,v,E){if(o!==null){var D=o.memoizedProps;if($l(D,v)&&o.ref===l.ref)if(pi=!1,l.pendingProps=v=D,td(o,E))(o.flags&131072)!==0&&(pi=!0);else return l.lanes=o.lanes,_u(o,l,E)}return Y0(o,l,f,v,E)}function fg(o,l,f,v){var E=v.children,D=o!==null?o.memoizedState:null;if(o===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),v.mode==="hidden"){if((l.flags&128)!==0){if(D=D!==null?D.baseLanes|f:f,o!==null){for(v=l.child=o.child,E=0;v!==null;)E=E|v.lanes|v.childLanes,v=v.sibling;v=E&~D}else v=0,l.child=null;return K0(o,l,D,f,v)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},o!==null&&Ne(l,D!==null?D.cachePool:null),D!==null?hs(l,D):ua(),Ds(l);else return v=l.lanes=536870912,K0(o,l,D!==null?D.baseLanes|f:f,f,v)}else D!==null?(Ne(l,D.cachePool),hs(l,D),zs(),l.memoizedState=null):(o!==null&&Ne(l,null),ua(),zs());return Vi(o,l,E,f),l.child}function ed(o,l){return o!==null&&o.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function K0(o,l,f,v,E){var D=Se();return D=D===null?null:{parent:Hs._currentValue,pool:D},l.memoizedState={baseLanes:f,cachePool:D},o!==null&&Ne(l,null),ua(),Ds(l),o!==null&&Ni(o,l,v,!0),l.childLanes=E,null}function Wf(o,l){return l=Yf({mode:l.mode,children:l.children},o.mode),l.ref=o.ref,o.child=l,l.return=o,l}function Pp(o,l,f){return za(l,o.child,null,f),o=Wf(l,l.pendingProps),o.flags|=2,oa(l),l.memoizedState=null,o}function mi(o,l,f){var v=l.pendingProps,E=(l.flags&128)!==0;if(l.flags&=-129,o===null){if(Gn){if(v.mode==="hidden")return o=Wf(l,v),l.lanes=536870912,ed(null,o);if(va(l),(o=Ha)?(o=I1(o,_n),o=o!==null&&o.data==="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:Sc!==null?{id:el,overflow:Io}:null,retryLane:536870912,hydrationErrors:null},f=Hh(o),f.return=l,l.child=f,ci=l,Ha=null)):o=null,o===null)throw Pa(l);return l.lanes=536870912,null}return Wf(l,v)}var D=o.memoizedState;if(D!==null){var Q=D.dehydrated;if(va(l),E)if(l.flags&256)l.flags&=-257,l=Pp(o,l,f);else if(l.memoizedState!==null)l.child=o.child,l.flags|=128,l=null;else throw Error(a(558));else if(pi||Ni(o,l,f,!1),E=(f&o.childLanes)!==0,pi||E){if(v=ts,v!==null&&(Q=Ri(v,f),Q!==0&&Q!==D.retryLane))throw D.retryLane=Q,lo(o,Q),Lo(v,o,Q),Op;d1(),l=Pp(o,l,f)}else o=D.treeContext,Ha=kl(Q.nextSibling),ci=l,Gn=!0,ks=null,_n=!1,o!==null&&Rf(l,o),l=Wf(l,v),l.flags|=4096;return l}return o=To(o.child,{mode:v.mode,children:v.children}),o.ref=l.ref,l.child=o,o.return=l,o}function Fc(o,l){var f=l.ref;if(f===null)o!==null&&o.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(a(284));(o===null||o.ref!==f)&&(l.flags|=4194816)}}function Y0(o,l,f,v,E){return Nc(l),f=jd(o,l,f,v,void 0,E),v=Lf(),o!==null&&!pi?(Pf(o,l,E),_u(o,l,E)):(Gn&&v&&Rd(l),l.flags|=1,Vi(o,l,f,E),l.child)}function Mp(o,l,f,v,E,D){return Nc(l),l.updateQueue=null,f=_c(l,v,f,E),Od(o),v=Lf(),o!==null&&!pi?(Pf(o,l,D),_u(o,l,D)):(Gn&&v&&Rd(l),l.flags|=1,Vi(o,l,f,D),l.child)}function Up(o,l,f,v,E){if(Nc(l),l.stateNode===null){var D=li,Q=f.contextType;typeof Q=="object"&&Q!==null&&(D=Ks(Q)),D=new f(v,D),l.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Dp,l.stateNode=D,D._reactInternals=l,D=l.stateNode,D.props=v,D.state=l.memoizedState,D.refs={},sr(l),Q=f.contextType,D.context=typeof Q=="object"&&Q!==null?Ks(Q):li,D.state=l.memoizedState,Q=f.getDerivedStateFromProps,typeof Q=="function"&&(Ip(l,f,Q,v),D.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(Q=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),Q!==D.state&&Dp.enqueueReplaceState(D,D.state,null),_s(l,v,D,E),Ma(),D.state=l.memoizedState),typeof D.componentDidMount=="function"&&(l.flags|=4194308),v=!0}else if(o===null){D=l.stateNode;var me=l.memoizedProps,Me=gh(f,me);D.props=Me;var at=D.context,St=f.contextType;Q=li,typeof St=="object"&&St!==null&&(Q=Ks(St));var Tt=f.getDerivedStateFromProps;St=typeof Tt=="function"||typeof D.getSnapshotBeforeUpdate=="function",me=l.pendingProps!==me,St||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(me||at!==Q)&&cg(l,D,v,Q),pr=!1;var ut=l.memoizedState;D.state=ut,_s(l,v,D,E),Ma(),at=l.memoizedState,me||ut!==at||pr?(typeof Tt=="function"&&(Ip(l,f,Tt,v),at=l.memoizedState),(Me=pr||lg(l,f,Me,v,ut,at,Q))?(St||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(l.flags|=4194308)):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=v,l.memoizedState=at),D.props=v,D.state=at,D.context=Q,v=Me):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),v=!1)}else{D=l.stateNode,$a(o,l),Q=l.memoizedProps,St=gh(f,Q),D.props=St,Tt=l.pendingProps,ut=D.context,at=f.contextType,Me=li,typeof at=="object"&&at!==null&&(Me=Ks(at)),me=f.getDerivedStateFromProps,(at=typeof me=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Q!==Tt||ut!==Me)&&cg(l,D,v,Me),pr=!1,ut=l.memoizedState,D.state=ut,_s(l,v,D,E),Ma();var mt=l.memoizedState;Q!==Tt||ut!==mt||pr||o!==null&&o.dependencies!==null&&Yl(o.dependencies)?(typeof me=="function"&&(Ip(l,f,me,v),mt=l.memoizedState),(St=pr||lg(l,f,St,v,ut,mt,Me)||o!==null&&o.dependencies!==null&&Yl(o.dependencies))?(at||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(v,mt,Me),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(v,mt,Me)),typeof D.componentDidUpdate=="function"&&(l.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof D.componentDidUpdate!="function"||Q===o.memoizedProps&&ut===o.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Q===o.memoizedProps&&ut===o.memoizedState||(l.flags|=1024),l.memoizedProps=v,l.memoizedState=mt),D.props=v,D.state=mt,D.context=Me,v=St):(typeof D.componentDidUpdate!="function"||Q===o.memoizedProps&&ut===o.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Q===o.memoizedProps&&ut===o.memoizedState||(l.flags|=1024),v=!1)}return D=v,Fc(o,l),v=(l.flags&128)!==0,D||v?(D=l.stateNode,f=v&&typeof f.getDerivedStateFromError!="function"?null:D.render(),l.flags|=1,o!==null&&v?(l.child=za(l,o.child,null,E),l.child=za(l,null,f,E)):Vi(o,l,f,E),l.memoizedState=D.state,o=l.child):o=_u(o,l,E),o}function pg(o,l,f,v){return Sl(),l.flags|=256,Vi(o,l,f,v),l.child}var J0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Q0(o){return{baseLanes:o,cachePool:Re()}}function Bp(o,l,f){return o=o!==null?o.childLanes&~f:0,l&&(o|=Nl),o}function Gd(o,l,f){var v=l.pendingProps,E=!1,D=(l.flags&128)!==0,Q;if((Q=D)||(Q=o!==null&&o.memoizedState===null?!1:(Zn.current&2)!==0),Q&&(E=!0,l.flags&=-129),Q=(l.flags&32)!==0,l.flags&=-33,o===null){if(Gn){if(E?ds(l):zs(),(o=Ha)?(o=I1(o,_n),o=o!==null&&o.data!=="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:Sc!==null?{id:el,overflow:Io}:null,retryLane:536870912,hydrationErrors:null},f=Hh(o),f.return=l,l.child=f,ci=l,Ha=null)):o=null,o===null)throw Pa(l);return lf(o)?l.lanes=32:l.lanes=536870912,null}var me=v.children;return v=v.fallback,E?(zs(),E=l.mode,me=Yf({mode:"hidden",children:me},E),v=co(v,E,f,null),me.return=l,v.return=l,me.sibling=v,l.child=me,v=l.child,v.memoizedState=Q0(f),v.childLanes=Bp(o,Q,f),l.memoizedState=J0,ed(null,v)):(ds(l),Kf(l,me))}var Me=o.memoizedState;if(Me!==null&&(me=Me.dehydrated,me!==null)){if(D)l.flags&256?(ds(l),l.flags&=-257,l=Hp(o,l,f)):l.memoizedState!==null?(zs(),l.child=o.child,l.flags|=128,l=null):(zs(),me=v.fallback,E=l.mode,v=Yf({mode:"visible",children:v.children},E),me=co(me,E,f,null),me.flags|=2,v.return=l,me.return=l,v.sibling=me,l.child=v,za(l,o.child,null,f),v=l.child,v.memoizedState=Q0(f),v.childLanes=Bp(o,Q,f),l.memoizedState=J0,l=ed(null,v));else if(ds(l),lf(me)){if(Q=me.nextSibling&&me.nextSibling.dataset,Q)var at=Q.dgst;Q=at,v=Error(a(419)),v.stack="",v.digest=Q,Vl({value:v,source:null,stack:null}),l=Hp(o,l,f)}else if(pi||Ni(o,l,f,!1),Q=(f&o.childLanes)!==0,pi||Q){if(Q=ts,Q!==null&&(v=Ri(Q,f),v!==0&&v!==Me.retryLane))throw Me.retryLane=v,lo(o,v),Lo(Q,o,v),Op;D1(me)||d1(),l=Hp(o,l,f)}else D1(me)?(l.flags|=192,l.child=o.child,l=null):(o=Me.treeContext,Ha=kl(me.nextSibling),ci=l,Gn=!0,ks=null,_n=!1,o!==null&&Rf(l,o),l=Kf(l,v.children),l.flags|=4096);return l}return E?(zs(),me=v.fallback,E=l.mode,Me=o.child,at=Me.sibling,v=To(Me,{mode:"hidden",children:v.children}),v.subtreeFlags=Me.subtreeFlags&65011712,at!==null?me=To(at,me):(me=co(me,E,f,null),me.flags|=2),me.return=l,v.return=l,v.sibling=me,l.child=v,ed(null,v),v=l.child,me=o.child.memoizedState,me===null?me=Q0(f):(E=me.cachePool,E!==null?(Me=Hs._currentValue,E=E.parent!==Me?{parent:Me,pool:Me}:E):E=Re(),me={baseLanes:me.baseLanes|f,cachePool:E}),v.memoizedState=me,v.childLanes=Bp(o,Q,f),l.memoizedState=J0,ed(o.child,v)):(ds(l),f=o.child,o=f.sibling,f=To(f,{mode:"visible",children:v.children}),f.return=l,f.sibling=null,o!==null&&(Q=l.deletions,Q===null?(l.deletions=[o],l.flags|=16):Q.push(o)),l.child=f,l.memoizedState=null,f)}function Kf(o,l){return l=Yf({mode:"visible",children:l},o.mode),l.return=o,o.child=l}function Yf(o,l){return o=La(22,o,null,l),o.lanes=0,o}function Hp(o,l,f){return za(l,o.child,null,f),o=Kf(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function zp(o,l,f){o.lanes|=l;var v=o.alternate;v!==null&&(v.lanes|=l),Cu(o.return,l,f)}function $p(o,l,f,v,E,D){var Q=o.memoizedState;Q===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:v,tail:f,tailMode:E,treeForkCount:D}:(Q.isBackwards=l,Q.rendering=null,Q.renderingStartTime=0,Q.last=v,Q.tail=f,Q.tailMode=E,Q.treeForkCount=D)}function mg(o,l,f){var v=l.pendingProps,E=v.revealOrder,D=v.tail;v=v.children;var Q=Zn.current,me=(Q&2)!==0;if(me?(Q=Q&1|2,l.flags|=128):Q&=1,ae(Zn,Q),Vi(o,l,v,f),v=Gn?dh:0,!me&&o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&zp(o,f,l);else if(o.tag===19)zp(o,f,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(E){case"forwards":for(f=l.child,E=null;f!==null;)o=f.alternate,o!==null&&di(o)===null&&(E=f),f=f.sibling;f=E,f===null?(E=l.child,l.child=null):(E=f.sibling,f.sibling=null),$p(l,!1,E,f,D,v);break;case"backwards":case"unstable_legacy-backwards":for(f=null,E=l.child,l.child=null;E!==null;){if(o=E.alternate,o!==null&&di(o)===null){l.child=E;break}o=E.sibling,E.sibling=f,f=E,E=o}$p(l,!0,f,null,D,v);break;case"together":$p(l,!1,null,null,void 0,v);break;default:l.memoizedState=null}return l.child}function _u(o,l,f){if(o!==null&&(l.dependencies=o.dependencies),Ou|=l.lanes,(f&l.childLanes)===0)if(o!==null){if(Ni(o,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(o!==null&&l.child!==o.child)throw Error(a(153));if(l.child!==null){for(o=l.child,f=To(o,o.pendingProps),l.child=f,f.return=l;o.sibling!==null;)o=o.sibling,f=f.sibling=To(o,o.pendingProps),f.return=l;f.sibling=null}return l.child}function td(o,l){return(o.lanes&l)!==0?!0:(o=o.dependencies,!!(o!==null&&Yl(o)))}function Jf(o,l,f){switch(l.tag){case 3:ze(l,l.stateNode.containerInfo),Al(l,Hs,o.memoizedState.cache),Sl();break;case 27:case 5:Ve(l);break;case 4:ze(l,l.stateNode.containerInfo);break;case 10:Al(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,va(l),null;break;case 13:var v=l.memoizedState;if(v!==null)return v.dehydrated!==null?(ds(l),l.flags|=128,null):(f&l.child.childLanes)!==0?Gd(o,l,f):(ds(l),o=_u(o,l,f),o!==null?o.sibling:null);ds(l);break;case 19:var E=(o.flags&128)!==0;if(v=(f&l.childLanes)!==0,v||(Ni(o,l,f,!1),v=(f&l.childLanes)!==0),E){if(v)return mg(o,l,f);l.flags|=128}if(E=l.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),ae(Zn,Zn.current),v)break;return null;case 22:return l.lanes=0,fg(o,l,f,l.pendingProps);case 24:Al(l,Hs,o.memoizedState.cache)}return _u(o,l,f)}function gg(o,l,f){if(o!==null)if(o.memoizedProps!==l.pendingProps)pi=!0;else{if(!td(o,f)&&(l.flags&128)===0)return pi=!1,Jf(o,l,f);pi=(o.flags&131072)!==0}else pi=!1,Gn&&(l.flags&1048576)!==0&&zh(l,dh,l.index);switch(l.lanes=0,l.tag){case 16:e:{var v=l.pendingProps;if(o=st(l.elementType),l.type=o,typeof o=="function")Dd(o)?(v=gh(o,v),l.tag=1,l=Up(null,l,o,v,f)):(l.tag=0,l=Y0(null,l,o,v,f));else{if(o!=null){var E=o.$$typeof;if(E===re){l.tag=11,l=W0(null,l,o,v,f);break e}else if(E===De){l.tag=14,l=Lp(null,l,o,v,f);break e}}throw l=Ce(o)||o,Error(a(306,l,""))}}return l;case 0:return Y0(o,l,l.type,l.pendingProps,f);case 1:return v=l.type,E=gh(v,l.pendingProps),Up(o,l,v,E,f);case 3:e:{if(ze(l,l.stateNode.containerInfo),o===null)throw Error(a(387));v=l.pendingProps;var D=l.memoizedState;E=D.element,$a(o,l),_s(l,v,null,f);var Q=l.memoizedState;if(v=Q.cache,Al(l,Hs,v),v!==D.cache&&Qc(l,[Hs],f,!0),Ma(),v=Q.element,D.isDehydrated)if(D={element:v,isDehydrated:!1,cache:Q.cache},l.updateQueue.baseState=D,l.memoizedState=D,l.flags&256){l=pg(o,l,v,f);break e}else if(v!==E){E=Eo(Error(a(424)),l),Vl(E),l=pg(o,l,v,f);break e}else for(o=l.stateNode.containerInfo,o.nodeType===9?o=o.body:o=o.nodeName==="HTML"?o.ownerDocument.body:o,Ha=kl(o.firstChild),ci=l,Gn=!0,ks=null,_n=!0,f=En(l,null,v,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Sl(),v===E){l=_u(o,l,f);break e}Vi(o,l,v,f)}l=l.child}return l;case 26:return Fc(o,l),o===null?(f=ne(l.type,null,l.pendingProps,null))?l.memoizedState=f:Gn||(f=l.type,o=l.pendingProps,v=d0(ye.current).createElement(f),v[Fa]=l,v[vn]=o,Yi(v,f,o),ys(v),l.stateNode=v):l.memoizedState=ne(l.type,o.memoizedProps,l.pendingProps,o.memoizedState),null;case 27:return Ve(l),o===null&&Gn&&(v=l.stateNode=s(l.type,l.pendingProps,ye.current),ci=l,_n=!0,E=Ha,Uu(l.type)?(Ch=E,Ha=kl(v.firstChild)):Ha=E),Vi(o,l,l.pendingProps.children,f),Fc(o,l),o===null&&(l.flags|=4194304),l.child;case 5:return o===null&&Gn&&((E=v=Ha)&&(v=_1(v,l.type,l.pendingProps,_n),v!==null?(l.stateNode=v,ci=l,Ha=kl(v.firstChild),_n=!1,E=!0):E=!1),E||Pa(l)),Ve(l),E=l.type,D=l.pendingProps,Q=o!==null?o.memoizedProps:null,v=D.children,of(E,D)?v=null:Q!==null&&of(E,Q)&&(l.flags|=32),l.memoizedState!==null&&(E=jd(o,l,xp,null,null,f),dr._currentValue=E),Fc(o,l),Vi(o,l,v,f),l.child;case 6:return o===null&&Gn&&((o=f=Ha)&&(f=mm(f,l.pendingProps,_n),f!==null?(l.stateNode=f,ci=l,Ha=null,o=!0):o=!1),o||Pa(l)),null;case 13:return Gd(o,l,f);case 4:return ze(l,l.stateNode.containerInfo),v=l.pendingProps,o===null?l.child=za(l,null,v,f):Vi(o,l,v,f),l.child;case 11:return W0(o,l,l.type,l.pendingProps,f);case 7:return Vi(o,l,l.pendingProps,f),l.child;case 8:return Vi(o,l,l.pendingProps.children,f),l.child;case 12:return Vi(o,l,l.pendingProps.children,f),l.child;case 10:return v=l.pendingProps,Al(l,l.type,v.value),Vi(o,l,v.children,f),l.child;case 9:return E=l.type._context,v=l.pendingProps.children,Nc(l),E=Ks(E),v=v(E),l.flags|=1,Vi(o,l,v,f),l.child;case 14:return Lp(o,l,l.type,l.pendingProps,f);case 15:return Zh(o,l,l.type,l.pendingProps,f);case 19:return mg(o,l,f);case 31:return mi(o,l,f);case 22:return fg(o,l,f,l.pendingProps);case 24:return Nc(l),v=Ks(Hs),o===null?(E=Se(),E===null&&(E=ts,D=Tc(),E.pooledCache=D,D.refCount++,D!==null&&(E.pooledCacheLanes|=f),E=D),l.memoizedState={parent:v,cache:E},sr(l),Al(l,Hs,E)):((o.lanes&f)!==0&&($a(o,l),_s(l,null,null,f),Ma()),E=o.memoizedState,D=l.memoizedState,E.parent!==v?(E={parent:v,cache:v},l.memoizedState=E,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=E),Al(l,Hs,v)):(v=D.cache,Al(l,Hs,v),v!==E.cache&&Qc(l,[Hs],f,!0))),Vi(o,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(a(156,l.tag))}function tu(o){o.flags|=4}function X0(o,l,f,v,E){if((l=(o.mode&32)!==0)&&(l=!1),l){if(o.flags|=16777216,(E&335544128)===E)if(o.stateNode.complete)o.flags|=8192;else if(Dg())o.flags|=8192;else throw wt=Ze,ot}else o.flags&=-16777217}function mo(o,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!Zt(l))if(Dg())o.flags|=8192;else throw wt=Ze,ot}function Vd(o,l){l!==null&&(o.flags|=4),o.flags&16384&&(l=o.tag!==22?fa():536870912,o.lanes|=l,ef|=l)}function Qf(o,l){if(!Gn)switch(o.tailMode){case"hidden":l=o.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?o.tail=null:f.sibling=null;break;case"collapsed":f=o.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Ga(o){var l=o.alternate!==null&&o.alternate.child===o.child,f=0,v=0;if(l)for(var E=o.child;E!==null;)f|=E.lanes|E.childLanes,v|=E.subtreeFlags&65011712,v|=E.flags&65011712,E.return=o,E=E.sibling;else for(E=o.child;E!==null;)f|=E.lanes|E.childLanes,v|=E.subtreeFlags,v|=E.flags,E.return=o,E=E.sibling;return o.subtreeFlags|=v,o.childLanes=f,l}function Gy(o,l,f){var v=l.pendingProps;switch($h(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(l),null;case 1:return Ga(l),null;case 3:return f=l.stateNode,v=null,o!==null&&(v=o.memoizedState.cache),l.memoizedState.cache!==v&&(l.flags|=2048),Do(Hs),pe(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(ui(l)?tu(l):o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ac())),Ga(l),null;case 26:var E=l.type,D=l.memoizedState;return o===null?(tu(l),D!==null?(Ga(l),mo(l,D)):(Ga(l),X0(l,E,null,v,f))):D?D!==o.memoizedState?(tu(l),Ga(l),mo(l,D)):(Ga(l),l.flags&=-16777217):(o=o.memoizedProps,o!==v&&tu(l),Ga(l),X0(l,E,o,v,f)),null;case 27:if(yt(l),f=ye.current,E=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==v&&tu(l);else{if(!v){if(l.stateNode===null)throw Error(a(166));return Ga(l),null}o=Z.current,ui(l)?ho(l):(o=s(E,v,f),l.stateNode=o,tu(l))}return Ga(l),null;case 5:if(yt(l),E=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==v&&tu(l);else{if(!v){if(l.stateNode===null)throw Error(a(166));return Ga(l),null}if(D=Z.current,ui(l))ho(l);else{var Q=d0(ye.current);switch(D){case 1:D=Q.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:D=Q.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":D=Q.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":D=Q.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":D=Q.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof v.is=="string"?Q.createElement("select",{is:v.is}):Q.createElement("select"),v.multiple?D.multiple=!0:v.size&&(D.size=v.size);break;default:D=typeof v.is=="string"?Q.createElement(E,{is:v.is}):Q.createElement(E)}}D[Fa]=l,D[vn]=v;e:for(Q=l.child;Q!==null;){if(Q.tag===5||Q.tag===6)D.appendChild(Q.stateNode);else if(Q.tag!==4&&Q.tag!==27&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===l)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===l)break e;Q=Q.return}Q.sibling.return=Q.return,Q=Q.sibling}l.stateNode=D;e:switch(Yi(D,E,v),E){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}v&&tu(l)}}return Ga(l),X0(l,l.type,o===null?null:o.memoizedProps,l.pendingProps,f),null;case 6:if(o&&l.stateNode!=null)o.memoizedProps!==v&&tu(l);else{if(typeof v!="string"&&l.stateNode===null)throw Error(a(166));if(o=ye.current,ui(l)){if(o=l.stateNode,f=l.memoizedProps,v=null,E=ci,E!==null)switch(E.tag){case 27:case 5:v=E.memoizedProps}o[Fa]=l,o=!!(o.nodeValue===f||v!==null&&v.suppressHydrationWarning===!0||om(o.nodeValue,f)),o||Pa(l,!0)}else o=d0(o).createTextNode(v),o[Fa]=l,l.stateNode=o}return Ga(l),null;case 31:if(f=l.memoizedState,o===null||o.memoizedState!==null){if(v=ui(l),f!==null){if(o===null){if(!v)throw Error(a(318));if(o=l.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(a(557));o[Fa]=l}else Sl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ga(l),o=!1}else f=Ac(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=f),o=!0;if(!o)return l.flags&256?(oa(l),l):(oa(l),null);if((l.flags&128)!==0)throw Error(a(558))}return Ga(l),null;case 13:if(v=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(E=ui(l),v!==null&&v.dehydrated!==null){if(o===null){if(!E)throw Error(a(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(a(317));E[Fa]=l}else Sl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ga(l),E=!1}else E=Ac(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=E),E=!0;if(!E)return l.flags&256?(oa(l),l):(oa(l),null)}return oa(l),(l.flags&128)!==0?(l.lanes=f,l):(f=v!==null,o=o!==null&&o.memoizedState!==null,f&&(v=l.child,E=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(E=v.alternate.memoizedState.cachePool.pool),D=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(D=v.memoizedState.cachePool.pool),D!==E&&(v.flags|=2048)),f!==o&&f&&(l.child.flags|=8192),Vd(l,l.updateQueue),Ga(l),null);case 4:return pe(),o===null&&sm(l.stateNode.containerInfo),Ga(l),null;case 10:return Do(l.type),Ga(l),null;case 19:if(H(Zn),v=l.memoizedState,v===null)return Ga(l),null;if(E=(l.flags&128)!==0,D=v.rendering,D===null)if(E)Qf(v,!1);else{if(qs!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(D=di(o),D!==null){for(l.flags|=128,Qf(v,!1),o=D.updateQueue,l.updateQueue=o,Vd(l,o),l.subtreeFlags=0,o=f,f=l.child;f!==null;)xu(f,o),f=f.sibling;return ae(Zn,Zn.current&1|2),Gn&&uo(l,v.treeForkCount),l.child}o=o.sibling}v.tail!==null&&er()>o1&&(l.flags|=128,E=!0,Qf(v,!1),l.lanes=4194304)}else{if(!E)if(o=di(D),o!==null){if(l.flags|=128,E=!0,o=o.updateQueue,l.updateQueue=o,Vd(l,o),Qf(v,!0),v.tail===null&&v.tailMode==="hidden"&&!D.alternate&&!Gn)return Ga(l),null}else 2*er()-v.renderingStartTime>o1&&f!==536870912&&(l.flags|=128,E=!0,Qf(v,!1),l.lanes=4194304);v.isBackwards?(D.sibling=l.child,l.child=D):(o=v.last,o!==null?o.sibling=D:l.child=D,v.last=D)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=er(),o.sibling=null,f=Zn.current,ae(Zn,E?f&1|2:f&1),Gn&&uo(l,v.treeForkCount),o):(Ga(l),null);case 22:case 23:return oa(l),ni(),v=l.memoizedState!==null,o!==null?o.memoizedState!==null!==v&&(l.flags|=8192):v&&(l.flags|=8192),v?(f&536870912)!==0&&(l.flags&128)===0&&(Ga(l),l.subtreeFlags&6&&(l.flags|=8192)):Ga(l),f=l.updateQueue,f!==null&&Vd(l,f.retryQueue),f=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),v=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(v=l.memoizedState.cachePool.pool),v!==f&&(l.flags|=2048),o!==null&&H(ge),null;case 24:return f=null,o!==null&&(f=o.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Do(Hs),Ga(l),null;case 25:return null;case 30:return null}throw Error(a(156,l.tag))}function Z0(o,l){switch($h(l),l.tag){case 1:return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return Do(Hs),pe(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 26:case 27:case 5:return yt(l),null;case 31:if(l.memoizedState!==null){if(oa(l),l.alternate===null)throw Error(a(340));Sl()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 13:if(oa(l),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(a(340));Sl()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return H(Zn),null;case 4:return pe(),null;case 10:return Do(l.type),null;case 22:case 23:return oa(l),ni(),o!==null&&H(ge),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 24:return Do(Hs),null;case 25:return null;default:return null}}function yg(o,l){switch($h(l),l.tag){case 3:Do(Hs),pe();break;case 26:case 27:case 5:yt(l);break;case 4:pe();break;case 31:l.memoizedState!==null&&oa(l);break;case 13:oa(l);break;case 19:H(Zn);break;case 10:Do(l.type);break;case 22:case 23:oa(l),ni(),o!==null&&H(ge);break;case 24:Do(Hs)}}function Xf(o,l){try{var f=l.updateQueue,v=f!==null?f.lastEffect:null;if(v!==null){var E=v.next;f=E;do{if((f.tag&o)===o){v=void 0;var D=f.create,Q=f.inst;v=D(),Q.destroy=v}f=f.next}while(f!==E)}}catch(me){ka(l,l.return,me)}}function vh(o,l,f){try{var v=l.updateQueue,E=v!==null?v.lastEffect:null;if(E!==null){var D=E.next;v=D;do{if((v.tag&o)===o){var Q=v.inst,me=Q.destroy;if(me!==void 0){Q.destroy=void 0,E=l;var Me=f,at=me;try{at()}catch(St){ka(E,Me,St)}}}v=v.next}while(v!==D)}}catch(St){ka(l,l.return,St)}}function qp(o){var l=o.updateQueue;if(l!==null){var f=o.stateNode;try{Is(l,f)}catch(v){ka(o,o.return,v)}}}function vg(o,l,f){f.props=gh(o.type,o.memoizedProps),f.state=o.memoizedState;try{f.componentWillUnmount()}catch(v){ka(o,l,v)}}function Wd(o,l){try{var f=o.ref;if(f!==null){switch(o.tag){case 26:case 27:case 5:var v=o.stateNode;break;case 30:v=o.stateNode;break;default:v=o.stateNode}typeof f=="function"?o.refCleanup=f(v):f.current=v}}catch(E){ka(o,l,E)}}function ec(o,l){var f=o.ref,v=o.refCleanup;if(f!==null)if(typeof v=="function")try{v()}catch(E){ka(o,l,E)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(E){ka(o,l,E)}else f.current=null}function Kd(o){var l=o.type,f=o.memoizedProps,v=o.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&v.focus();break e;case"img":f.src?v.src=f.src:f.srcSet&&(v.srcset=f.srcSet)}}catch(E){ka(o,o.return,E)}}function bh(o,l,f){try{var v=o.stateNode;cm(v,o.type,f,l),v[vn]=l}catch(E){ka(o,o.return,E)}}function Yd(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Uu(o.type)||o.tag===4}function Zf(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Yd(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Uu(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Jd(o,l,f){var v=o.tag;if(v===5||v===6)o=o.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(o,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(o),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=ao));else if(v!==4&&(v===27&&Uu(o.type)&&(f=o.stateNode,l=null),o=o.child,o!==null))for(Jd(o,l,f),o=o.sibling;o!==null;)Jd(o,l,f),o=o.sibling}function ru(o,l,f){var v=o.tag;if(v===5||v===6)o=o.stateNode,l?f.insertBefore(o,l):f.appendChild(o);else if(v!==4&&(v===27&&Uu(o.type)&&(f=o.stateNode),o=o.child,o!==null))for(ru(o,l,f),o=o.sibling;o!==null;)ru(o,l,f),o=o.sibling}function Iu(o){var l=o.stateNode,f=o.memoizedProps;try{for(var v=o.type,E=l.attributes;E.length;)l.removeAttributeNode(E[0]);Yi(l,v,f),l[Fa]=o,l[vn]=f}catch(D){ka(o,o.return,D)}}var nu=!1,gi=!1,Gp=!1,bg=typeof WeakSet=="function"?WeakSet:Set,Wi=null;function Vy(o,l){if(o=o.containerInfo,sf=la,o=wl(o),Xo(o)){if("selectionStart"in o)var f={start:o.selectionStart,end:o.selectionEnd};else e:{f=(f=o.ownerDocument)&&f.defaultView||window;var v=f.getSelection&&f.getSelection();if(v&&v.rangeCount!==0){f=v.anchorNode;var E=v.anchorOffset,D=v.focusNode;v=v.focusOffset;try{f.nodeType,D.nodeType}catch{f=null;break e}var Q=0,me=-1,Me=-1,at=0,St=0,Tt=o,ut=null;t:for(;;){for(var mt;Tt!==f||E!==0&&Tt.nodeType!==3||(me=Q+E),Tt!==D||v!==0&&Tt.nodeType!==3||(Me=Q+v),Tt.nodeType===3&&(Q+=Tt.nodeValue.length),(mt=Tt.firstChild)!==null;)ut=Tt,Tt=mt;for(;;){if(Tt===o)break t;if(ut===f&&++at===E&&(me=Q),ut===D&&++St===v&&(Me=Q),(mt=Tt.nextSibling)!==null)break;Tt=ut,ut=Tt.parentNode}Tt=mt}f=me===-1||Me===-1?null:{start:me,end:Me}}else f=null}f=f||{start:0,end:0}}else f=null;for(A1={focusedElem:o,selectionRange:f},la=!1,Wi=l;Wi!==null;)if(l=Wi,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,Wi=o;else for(;Wi!==null;){switch(l=Wi,D=l.alternate,o=l.flags,l.tag){case 0:if((o&4)!==0&&(o=l.updateQueue,o=o!==null?o.events:null,o!==null))for(f=0;f<o.length;f++)E=o[f],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&D!==null){o=void 0,f=l,E=D.memoizedProps,D=D.memoizedState,v=f.stateNode;try{var Fr=gh(f.type,E);o=v.getSnapshotBeforeUpdate(Fr,D),v.__reactInternalSnapshotBeforeUpdate=o}catch(xn){ka(f,f.return,xn)}}break;case 3:if((o&1024)!==0){if(o=l.stateNode.containerInfo,f=o.nodeType,f===9)k1(o);else if(f===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":k1(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(a(163))}if(o=l.sibling,o!==null){o.return=l.return,Wi=o;break}Wi=l.return}}function xg(o,l,f){var v=f.flags;switch(f.tag){case 0:case 11:case 15:au(o,f),v&4&&Xf(5,f);break;case 1:if(au(o,f),v&4)if(o=f.stateNode,l===null)try{o.componentDidMount()}catch(Q){ka(f,f.return,Q)}else{var E=gh(f.type,l.memoizedProps);l=l.memoizedState;try{o.componentDidUpdate(E,l,o.__reactInternalSnapshotBeforeUpdate)}catch(Q){ka(f,f.return,Q)}}v&64&&qp(f),v&512&&Wd(f,f.return);break;case 3:if(au(o,f),v&64&&(o=f.updateQueue,o!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{Is(o,l)}catch(Q){ka(f,f.return,Q)}}break;case 27:l===null&&v&4&&Iu(f);case 26:case 5:au(o,f),l===null&&v&4&&Kd(f),v&512&&Wd(f,f.return);break;case 12:au(o,f);break;case 31:au(o,f),v&4&&e1(o,f);break;case 13:au(o,f),v&4&&Ag(o,f),v&64&&(o=f.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(f=Bg.bind(null,f),gm(o,f))));break;case 22:if(v=f.memoizedState!==null||nu,!v){l=l!==null&&l.memoizedState!==null||gi,E=nu;var D=gi;nu=v,(gi=l)&&!D?Fu(o,f,(f.subtreeFlags&8772)!==0):au(o,f),nu=E,gi=D}break;case 30:break;default:au(o,f)}}function wg(o){var l=o.alternate;l!==null&&(o.alternate=null,wg(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&uc(l)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Ss=null,rl=!1;function Du(o,l,f){for(f=f.child;f!==null;)Sg(o,l,f),f=f.sibling}function Sg(o,l,f){if(Qr&&typeof Qr.onCommitFiberUnmount=="function")try{Qr.onCommitFiberUnmount(Nn,f)}catch{}switch(f.tag){case 26:gi||ec(f,l),Du(o,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:gi||ec(f,l);var v=Ss,E=rl;Uu(f.type)&&(Ss=f.stateNode,rl=!1),Du(o,l,f),c(f.stateNode),Ss=v,rl=E;break;case 5:gi||ec(f,l);case 6:if(v=Ss,E=rl,Ss=null,Du(o,l,f),Ss=v,rl=E,Ss!==null)if(rl)try{(Ss.nodeType===9?Ss.body:Ss.nodeName==="HTML"?Ss.ownerDocument.body:Ss).removeChild(f.stateNode)}catch(D){ka(f,l,D)}else try{Ss.removeChild(f.stateNode)}catch(D){ka(f,l,D)}break;case 18:Ss!==null&&(rl?(o=Ss,E1(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,f.stateNode),Br(o)):E1(Ss,f.stateNode));break;case 4:v=Ss,E=rl,Ss=f.stateNode.containerInfo,rl=!0,Du(o,l,f),Ss=v,rl=E;break;case 0:case 11:case 14:case 15:vh(2,f,l),gi||vh(4,f,l),Du(o,l,f);break;case 1:gi||(ec(f,l),v=f.stateNode,typeof v.componentWillUnmount=="function"&&vg(f,l,v)),Du(o,l,f);break;case 21:Du(o,l,f);break;case 22:gi=(v=gi)||f.memoizedState!==null,Du(o,l,f),gi=v;break;default:Du(o,l,f)}}function e1(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{Br(o)}catch(f){ka(l,l.return,f)}}}function Ag(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Br(o)}catch(f){ka(l,l.return,f)}}function Wy(o){switch(o.tag){case 31:case 13:case 19:var l=o.stateNode;return l===null&&(l=o.stateNode=new bg),l;case 22:return o=o.stateNode,l=o._retryCache,l===null&&(l=o._retryCache=new bg),l;default:throw Error(a(435,o.tag))}}function t1(o,l){var f=Wy(o);l.forEach(function(v){if(!f.has(v)){f.add(v);var E=Hg.bind(null,o,v);v.then(E,E)}})}function Ro(o,l){var f=l.deletions;if(f!==null)for(var v=0;v<f.length;v++){var E=f[v],D=o,Q=l,me=Q;e:for(;me!==null;){switch(me.tag){case 27:if(Uu(me.type)){Ss=me.stateNode,rl=!1;break e}break;case 5:Ss=me.stateNode,rl=!1;break e;case 3:case 4:Ss=me.stateNode.containerInfo,rl=!0;break e}me=me.return}if(Ss===null)throw Error(a(160));Sg(D,Q,E),Ss=null,rl=!1,D=E.alternate,D!==null&&(D.return=null),E.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Vp(l,o),l=l.sibling}var tc=null;function Vp(o,l){var f=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Ro(l,o),jo(o),v&4&&(vh(3,o,o.return),Xf(3,o),vh(5,o,o.return));break;case 1:Ro(l,o),jo(o),v&512&&(gi||f===null||ec(f,f.return)),v&64&&nu&&(o=o.updateQueue,o!==null&&(v=o.callbacks,v!==null&&(f=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=f===null?v:f.concat(v))));break;case 26:var E=tc;if(Ro(l,o),jo(o),v&512&&(gi||f===null||ec(f,f.return)),v&4){var D=f!==null?f.memoizedState:null;if(v=o.memoizedState,f===null)if(v===null)if(o.stateNode===null){e:{v=o.type,f=o.memoizedProps,E=E.ownerDocument||E;t:switch(v){case"title":D=E.getElementsByTagName("title")[0],(!D||D[Oi]||D[Fa]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=E.createElement(v),E.head.insertBefore(D,E.querySelector("head > title"))),Yi(D,v,f),D[Fa]=o,ys(D),v=D;break e;case"link":var Q=qt("link","href",E).get(v+(f.href||""));if(Q){for(var me=0;me<Q.length;me++)if(D=Q[me],D.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&D.getAttribute("rel")===(f.rel==null?null:f.rel)&&D.getAttribute("title")===(f.title==null?null:f.title)&&D.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){Q.splice(me,1);break t}}D=E.createElement(v),Yi(D,v,f),E.head.appendChild(D);break;case"meta":if(Q=qt("meta","content",E).get(v+(f.content||""))){for(me=0;me<Q.length;me++)if(D=Q[me],D.getAttribute("content")===(f.content==null?null:""+f.content)&&D.getAttribute("name")===(f.name==null?null:f.name)&&D.getAttribute("property")===(f.property==null?null:f.property)&&D.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&D.getAttribute("charset")===(f.charSet==null?null:f.charSet)){Q.splice(me,1);break t}}D=E.createElement(v),Yi(D,v,f),E.head.appendChild(D);break;default:throw Error(a(468,v))}D[Fa]=o,ys(D),v=D}o.stateNode=v}else hr(E,o.type,o.stateNode);else o.stateNode=Xe(E,v,o.memoizedProps);else D!==v?(D===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):D.count--,v===null?hr(E,o.type,o.stateNode):Xe(E,v,o.memoizedProps)):v===null&&o.stateNode!==null&&bh(o,o.memoizedProps,f.memoizedProps)}break;case 27:Ro(l,o),jo(o),v&512&&(gi||f===null||ec(f,f.return)),f!==null&&v&4&&bh(o,o.memoizedProps,f.memoizedProps);break;case 5:if(Ro(l,o),jo(o),v&512&&(gi||f===null||ec(f,f.return)),o.flags&32){E=o.stateNode;try{Wo(E,"")}catch(Fr){ka(o,o.return,Fr)}}v&4&&o.stateNode!=null&&(E=o.memoizedProps,bh(o,E,f!==null?f.memoizedProps:E)),v&1024&&(Gp=!0);break;case 6:if(Ro(l,o),jo(o),v&4){if(o.stateNode===null)throw Error(a(162));v=o.memoizedProps,f=o.stateNode;try{f.nodeValue=v}catch(Fr){ka(o,o.return,Fr)}}break;case 3:if(ft=null,E=tc,tc=g(l.containerInfo),Ro(l,o),tc=E,jo(o),v&4&&f!==null&&f.memoizedState.isDehydrated)try{Br(l.containerInfo)}catch(Fr){ka(o,o.return,Fr)}Gp&&(Gp=!1,Wp(o));break;case 4:v=tc,tc=g(o.stateNode.containerInfo),Ro(l,o),jo(o),tc=v;break;case 12:Ro(l,o),jo(o);break;case 31:Ro(l,o),jo(o),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,t1(o,v)));break;case 13:Ro(l,o),jo(o),o.child.flags&8192&&o.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(i1=er()),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,t1(o,v)));break;case 22:E=o.memoizedState!==null;var Me=f!==null&&f.memoizedState!==null,at=nu,St=gi;if(nu=at||E,gi=St||Me,Ro(l,o),gi=St,nu=at,jo(o),v&8192)e:for(l=o.stateNode,l._visibility=E?l._visibility&-2:l._visibility|1,E&&(f===null||Me||nu||gi||xh(o)),f=null,l=o;;){if(l.tag===5||l.tag===26){if(f===null){Me=f=l;try{if(D=Me.stateNode,E)Q=D.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{me=Me.stateNode;var Tt=Me.memoizedProps.style,ut=Tt!=null&&Tt.hasOwnProperty("display")?Tt.display:null;me.style.display=ut==null||typeof ut=="boolean"?"":(""+ut).trim()}}catch(Fr){ka(Me,Me.return,Fr)}}}else if(l.tag===6){if(f===null){Me=l;try{Me.stateNode.nodeValue=E?"":Me.memoizedProps}catch(Fr){ka(Me,Me.return,Fr)}}}else if(l.tag===18){if(f===null){Me=l;try{var mt=Me.stateNode;E?pm(mt,!0):pm(Me.stateNode,!1)}catch(Fr){ka(Me,Me.return,Fr)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===o)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break e;for(;l.sibling===null;){if(l.return===null||l.return===o)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}v&4&&(v=o.updateQueue,v!==null&&(f=v.retryQueue,f!==null&&(v.retryQueue=null,t1(o,f))));break;case 19:Ro(l,o),jo(o),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,t1(o,v)));break;case 30:break;case 21:break;default:Ro(l,o),jo(o)}}function jo(o){var l=o.flags;if(l&2){try{for(var f,v=o.return;v!==null;){if(Yd(v)){f=v;break}v=v.return}if(f==null)throw Error(a(160));switch(f.tag){case 27:var E=f.stateNode,D=Zf(o);ru(o,D,E);break;case 5:var Q=f.stateNode;f.flags&32&&(Wo(Q,""),f.flags&=-33);var me=Zf(o);ru(o,me,Q);break;case 3:case 4:var Me=f.stateNode.containerInfo,at=Zf(o);Jd(o,at,Me);break;default:throw Error(a(161))}}catch(St){ka(o,o.return,St)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function Wp(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var l=o;Wp(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),o=o.sibling}}function au(o,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)xg(o,l.alternate,l),l=l.sibling}function xh(o){for(o=o.child;o!==null;){var l=o;switch(l.tag){case 0:case 11:case 14:case 15:vh(4,l,l.return),xh(l);break;case 1:ec(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&vg(l,l.return,f),xh(l);break;case 27:c(l.stateNode);case 26:case 5:ec(l,l.return),xh(l);break;case 22:l.memoizedState===null&&xh(l);break;case 30:xh(l);break;default:xh(l)}o=o.sibling}}function Fu(o,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var v=l.alternate,E=o,D=l,Q=D.flags;switch(D.tag){case 0:case 11:case 15:Fu(E,D,f),Xf(4,D);break;case 1:if(Fu(E,D,f),v=D,E=v.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(at){ka(v,v.return,at)}if(v=D,E=v.updateQueue,E!==null){var me=v.stateNode;try{var Me=E.shared.hiddenCallbacks;if(Me!==null)for(E.shared.hiddenCallbacks=null,E=0;E<Me.length;E++)Ti(Me[E],me)}catch(at){ka(v,v.return,at)}}f&&Q&64&&qp(D),Wd(D,D.return);break;case 27:Iu(D);case 26:case 5:Fu(E,D,f),f&&v===null&&Q&4&&Kd(D),Wd(D,D.return);break;case 12:Fu(E,D,f);break;case 31:Fu(E,D,f),f&&Q&4&&e1(E,D);break;case 13:Fu(E,D,f),f&&Q&4&&Ag(E,D);break;case 22:D.memoizedState===null&&Fu(E,D,f),Wd(D,D.return);break;case 30:break;default:Fu(E,D,f)}l=l.sibling}}function Kp(o,l){var f=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),o=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(o=l.memoizedState.cachePool.pool),o!==f&&(o!=null&&o.refCount++,f!=null&&Nu(f))}function r1(o,l){o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Nu(o))}function Rc(o,l,f,v){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)e0(o,l,f,v),l=l.sibling}function e0(o,l,f,v){var E=l.flags;switch(l.tag){case 0:case 11:case 15:Rc(o,l,f,v),E&2048&&Xf(9,l);break;case 1:Rc(o,l,f,v);break;case 3:Rc(o,l,f,v),E&2048&&(o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Nu(o)));break;case 12:if(E&2048){Rc(o,l,f,v),o=l.stateNode;try{var D=l.memoizedProps,Q=D.id,me=D.onPostCommit;typeof me=="function"&&me(Q,l.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(Me){ka(l,l.return,Me)}}else Rc(o,l,f,v);break;case 31:Rc(o,l,f,v);break;case 13:Rc(o,l,f,v);break;case 23:break;case 22:D=l.stateNode,Q=l.alternate,l.memoizedState!==null?D._visibility&2?Rc(o,l,f,v):Xd(o,l):D._visibility&2?Rc(o,l,f,v):(D._visibility|=2,Qd(o,l,f,v,(l.subtreeFlags&10256)!==0||!1)),E&2048&&Kp(Q,l);break;case 24:Rc(o,l,f,v),E&2048&&r1(l.alternate,l);break;default:Rc(o,l,f,v)}}function Qd(o,l,f,v,E){for(E=E&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var D=o,Q=l,me=f,Me=v,at=Q.flags;switch(Q.tag){case 0:case 11:case 15:Qd(D,Q,me,Me,E),Xf(8,Q);break;case 23:break;case 22:var St=Q.stateNode;Q.memoizedState!==null?St._visibility&2?Qd(D,Q,me,Me,E):Xd(D,Q):(St._visibility|=2,Qd(D,Q,me,Me,E)),E&&at&2048&&Kp(Q.alternate,Q);break;case 24:Qd(D,Q,me,Me,E),E&&at&2048&&r1(Q.alternate,Q);break;default:Qd(D,Q,me,Me,E)}l=l.sibling}}function Xd(o,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=o,v=l,E=v.flags;switch(v.tag){case 22:Xd(f,v),E&2048&&Kp(v.alternate,v);break;case 24:Xd(f,v),E&2048&&r1(v.alternate,v);break;default:Xd(f,v)}l=l.sibling}}var su=8192;function Zd(o,l,f){if(o.subtreeFlags&su)for(o=o.child;o!==null;)Yp(o,l,f),o=o.sibling}function Yp(o,l,f){switch(o.tag){case 26:Zd(o,l,f),o.flags&su&&o.memoizedState!==null&&tr(f,tc,o.memoizedState,o.memoizedProps);break;case 5:Zd(o,l,f);break;case 3:case 4:var v=tc;tc=g(o.stateNode.containerInfo),Zd(o,l,f),tc=v;break;case 22:o.memoizedState===null&&(v=o.alternate,v!==null&&v.memoizedState!==null?(v=su,su=16777216,Zd(o,l,f),su=v):Zd(o,l,f));break;default:Zd(o,l,f)}}function Cg(o){var l=o.alternate;if(l!==null&&(o=l.child,o!==null)){l.child=null;do l=o.sibling,o.sibling=null,o=l;while(o!==null)}}function t0(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var v=l[f];Wi=v,Tg(v,o)}Cg(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Ng(o),o=o.sibling}function Ng(o){switch(o.tag){case 0:case 11:case 15:t0(o),o.flags&2048&&vh(9,o,o.return);break;case 3:t0(o);break;case 12:t0(o);break;case 22:var l=o.stateNode;o.memoizedState!==null&&l._visibility&2&&(o.return===null||o.return.tag!==13)?(l._visibility&=-3,n1(o)):t0(o);break;default:t0(o)}}function n1(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var v=l[f];Wi=v,Tg(v,o)}Cg(o)}for(o=o.child;o!==null;){switch(l=o,l.tag){case 0:case 11:case 15:vh(8,l,l.return),n1(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,n1(l));break;default:n1(l)}o=o.sibling}}function Tg(o,l){for(;Wi!==null;){var f=Wi;switch(f.tag){case 0:case 11:case 15:vh(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var v=f.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:Nu(f.memoizedState.cache)}if(v=f.child,v!==null)v.return=f,Wi=v;else e:for(f=o;Wi!==null;){v=Wi;var E=v.sibling,D=v.return;if(wg(v),v===f){Wi=null;break e}if(E!==null){E.return=D,Wi=E;break e}Wi=D}}}var Ky={getCacheForType:function(o){var l=Ks(Hs),f=l.data.get(o);return f===void 0&&(f=o(),l.data.set(o,f)),f},cacheSignal:function(){return Ks(Hs).controller.signal}},Yy=typeof WeakMap=="function"?WeakMap:Map,Na=0,ts=null,zn=null,ea=0,Ua=0,Cl=null,Ru=!1,rd=!1,a1=!1,ju=0,qs=0,Ou=0,nd=0,s1=0,Nl=0,ef=0,r0=null,nl=null,Jp=!1,i1=0,Eg=0,o1=1/0,l1=null,wh=null,Ei=0,Sh=null,tf=null,Tl=0,c1=0,u1=null,rc=null,n0=0,a0=null;function Oo(){return(Na&2)!==0&&ea!==0?ea&-ea:Ee.T!==null?Wn():Ms()}function kg(){if(Nl===0)if((ea&536870912)===0||Gn){var o=xa;xa<<=1,(xa&3932160)===0&&(xa=262144),Nl=o}else Nl=536870912;return o=ws.current,o!==null&&(o.flags|=32),Nl}function Lo(o,l,f){(o===ts&&(Ua===2||Ua===9)||o.cancelPendingCommit!==null)&&(Po(o,0),Ah(o,ea,Nl,!1)),Yr(o,f),((Na&2)===0||o!==ts)&&(o===ts&&((Na&2)===0&&(nd|=f),qs===4&&Ah(o,ea,Nl,!1)),Ki(o))}function _g(o,l,f){if((Na&6)!==0)throw Error(a(327));var v=!f&&(l&127)===0&&(l&o.expiredLanes)===0||bo(o,l),E=v?ir(o,l):ad(o,l,!0),D=v;do{if(E===0){rd&&!v&&Ah(o,l,0,!1);break}else{if(f=o.current.alternate,D&&!Jy(f)){E=ad(o,l,!1),D=!1;continue}if(E===2){if(D=l,o.errorRecoveryDisabledLanes&D)var Q=0;else Q=o.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){l=Q;e:{var me=o;E=r0;var Me=me.current.memoizedState.isDehydrated;if(Me&&(Po(me,Q).flags|=256),Q=ad(me,Q,!1),Q!==2){if(a1&&!Me){me.errorRecoveryDisabledLanes|=D,nd|=D,E=4;break e}D=nl,nl=E,D!==null&&(nl===null?nl=D:nl.push.apply(nl,D))}E=Q}if(D=!1,E!==2)continue}}if(E===1){Po(o,0),Ah(o,l,0,!0);break}e:{switch(v=o,D=E,D){case 0:case 1:throw Error(a(345));case 4:if((l&4194048)!==l)break;case 6:Ah(v,l,Nl,!Ru);break e;case 2:nl=null;break;case 3:case 5:break;default:throw Error(a(329))}if((l&62914560)===l&&(E=i1+300-er(),10<E)){if(Ah(v,l,Nl,!Ru),Jt(v,0,!0)!==0)break e;Tl=l,v.timeoutHandle=N1(Ig.bind(null,v,f,nl,l1,Jp,l,Nl,nd,ef,Ru,D,"Throttled",-0,0),E);break e}Ig(v,f,nl,l1,Jp,l,Nl,nd,ef,Ru,D,null,-0,0)}}break}while(!0);Ki(o)}function Ig(o,l,f,v,E,D,Q,me,Me,at,St,Tt,ut,mt){if(o.timeoutHandle=-1,Tt=l.subtreeFlags,Tt&8192||(Tt&16785408)===16785408){Tt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ao},Yp(l,D,Tt);var Fr=(D&62914560)===D?i1-er():(D&4194048)===D?Eg-er():0;if(Fr=Bt(Tt,Fr),Fr!==null){Tl=D,o.cancelPendingCommit=Fr(Og.bind(null,o,l,D,f,v,E,Q,me,Me,St,Tt,null,ut,mt)),Ah(o,D,Q,!at);return}}Og(o,l,D,f,v,E,Q,me,Me)}function Jy(o){for(var l=o;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var v=0;v<f.length;v++){var E=f[v],D=E.getSnapshot;E=E.value;try{if(!Ai(D(),E))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ah(o,l,f,v){l&=~s1,l&=~nd,o.suspendedLanes|=l,o.pingedLanes&=~l,v&&(o.warmLanes|=l),v=o.expirationTimes;for(var E=l;0<E;){var D=31-an(E),Q=1<<D;v[D]=-1,E&=~Q}f!==0&&wo(o,f,l)}function h1(){return(Na&6)===0?(id(0),!1):!0}function Qp(){if(zn!==null){if(Ua===0)var o=zn.return;else o=zn,Kl=Cc=null,fh(o),Lt=null,Ir=0,o=zn;for(;o!==null;)yg(o.alternate,o),o=o.return;zn=null}}function Po(o,l){var f=o.timeoutHandle;f!==-1&&(o.timeoutHandle=-1,Vg(f)),f=o.cancelPendingCommit,f!==null&&(o.cancelPendingCommit=null,f()),Tl=0,Qp(),ts=o,zn=f=To(o.current,null),ea=l,Ua=0,Cl=null,Ru=!1,rd=bo(o,l),a1=!1,ef=Nl=s1=nd=Ou=qs=0,nl=r0=null,Jp=!1,(l&8)!==0&&(l|=l&32);var v=o.entangledLanes;if(v!==0)for(o=o.entanglements,v&=l;0<v;){var E=31-an(v),D=1<<E;l|=o[E],v&=~D}return ju=l,Cn(),f}function s0(o,l){Zr=null,Ee.H=Vf,l===Ke||l===Fe?(l=kt(),Ua=3):l===ot?(l=kt(),Ua=4):Ua=l===Op?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Cl=l,zn===null&&(qs=1,V0(o,Eo(l,o.current)))}function Dg(){var o=ws.current;return o===null?!0:(ea&4194048)===ea?ia===null:(ea&62914560)===ea||(ea&536870912)!==0?o===ia:!1}function rf(){var o=Ee.H;return Ee.H=Vf,o===null?Vf:o}function i0(){var o=Ee.A;return Ee.A=Ky,o}function d1(){qs=4,Ru||(ea&4194048)!==ea&&ws.current!==null||(rd=!0),(Ou&134217727)===0&&(nd&134217727)===0||ts===null||Ah(ts,ea,Nl,!1)}function ad(o,l,f){var v=Na;Na|=2;var E=rf(),D=i0();(ts!==o||ea!==l)&&(l1=null,Po(o,l)),l=!1;var Q=qs;e:do try{if(Ua!==0&&zn!==null){var me=zn,Me=Cl;switch(Ua){case 8:Qp(),Q=6;break e;case 3:case 2:case 9:case 6:ws.current===null&&(l=!0);var at=Ua;if(Ua=0,Cl=null,nf(o,me,Me,at),f&&rd){Q=0;break e}break;default:at=Ua,Ua=0,Cl=null,nf(o,me,Me,at)}}Xp(),Q=qs;break}catch(St){s0(o,St)}while(!0);return l&&o.shellSuspendCounter++,Kl=Cc=null,Na=v,Ee.H=E,Ee.A=D,zn===null&&(ts=null,ea=0,Cn()),Q}function Xp(){for(;zn!==null;)Fg(zn)}function ir(o,l){var f=Na;Na|=2;var v=rf(),E=i0();ts!==o||ea!==l?(l1=null,o1=er()+500,Po(o,l)):rd=bo(o,l);e:do try{if(Ua!==0&&zn!==null){l=zn;var D=Cl;t:switch(Ua){case 1:Ua=0,Cl=null,nf(o,l,D,1);break;case 2:case 9:if(nt(D)){Ua=0,Cl=null,Rg(l);break}l=function(){Ua!==2&&Ua!==9||ts!==o||(Ua=7),Ki(o)},D.then(l,l);break e;case 3:Ua=7;break e;case 4:Ua=5;break e;case 7:nt(D)?(Ua=0,Cl=null,Rg(l)):(Ua=0,Cl=null,nf(o,l,D,7));break;case 5:var Q=null;switch(zn.tag){case 26:Q=zn.memoizedState;case 5:case 27:var me=zn;if(Q?Zt(Q):me.stateNode.complete){Ua=0,Cl=null;var Me=me.sibling;if(Me!==null)zn=Me;else{var at=me.return;at!==null?(zn=at,f1(at)):zn=null}break t}}Ua=0,Cl=null,nf(o,l,D,5);break;case 6:Ua=0,Cl=null,nf(o,l,D,6);break;case 8:Qp(),qs=6;break e;default:throw Error(a(462))}}o0();break}catch(St){s0(o,St)}while(!0);return Kl=Cc=null,Ee.H=v,Ee.A=E,Na=f,zn!==null?0:(ts=null,ea=0,Cn(),qs)}function o0(){for(;zn!==null&&!Rt();)Fg(zn)}function Fg(o){var l=gg(o.alternate,o,ju);o.memoizedProps=o.pendingProps,l===null?f1(o):zn=l}function Rg(o){var l=o,f=l.alternate;switch(l.tag){case 15:case 0:l=Mp(f,l,l.pendingProps,l.type,void 0,ea);break;case 11:l=Mp(f,l,l.pendingProps,l.type.render,l.ref,ea);break;case 5:fh(l);default:yg(f,l),l=zn=xu(l,ju),l=gg(f,l,ju)}o.memoizedProps=o.pendingProps,l===null?f1(o):zn=l}function nf(o,l,f,v){Kl=Cc=null,fh(l),Lt=null,Ir=0;var E=l.return;try{if(dg(o,E,l,f,ea)){qs=1,V0(o,Eo(f,o.current)),zn=null;return}}catch(D){if(E!==null)throw zn=E,D;qs=1,V0(o,Eo(f,o.current)),zn=null;return}l.flags&32768?(Gn||v===1?o=!0:rd||(ea&536870912)!==0?o=!1:(Ru=o=!0,(v===2||v===9||v===3||v===6)&&(v=ws.current,v!==null&&v.tag===13&&(v.flags|=16384))),jg(l,o)):f1(l)}function f1(o){var l=o;do{if((l.flags&32768)!==0){jg(l,Ru);return}o=l.return;var f=Gy(l.alternate,l,ju);if(f!==null){zn=f;return}if(l=l.sibling,l!==null){zn=l;return}zn=l=o}while(l!==null);qs===0&&(qs=5)}function jg(o,l){do{var f=Z0(o.alternate,o);if(f!==null){f.flags&=32767,zn=f;return}if(f=o.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(o=o.sibling,o!==null)){zn=o;return}zn=o=f}while(o!==null);qs=6,zn=null}function Og(o,l,f,v,E,D,Q,me,Me){o.cancelPendingCommit=null;do l0();while(Ei!==0);if((Na&6)!==0)throw Error(a(327));if(l!==null){if(l===o.current)throw Error(a(177));if(D=l.lanes|l.childLanes,D|=Uh,qo(o,f,D,Q,me,Me),o===ts&&(zn=ts=null,ea=0),tf=l,Sh=o,Tl=f,c1=D,u1=E,rc=v,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,zg(kr,function(){return em(),null})):(o.callbackNode=null,o.callbackPriority=0),v=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||v){v=Ee.T,Ee.T=null,E=Pe.p,Pe.p=2,Q=Na,Na|=4;try{Vy(o,l,f)}finally{Na=Q,Pe.p=E,Ee.T=v}}Ei=1,Lg(),Pg(),Mg()}}function Lg(){if(Ei===1){Ei=0;var o=Sh,l=tf,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=Ee.T,Ee.T=null;var v=Pe.p;Pe.p=2;var E=Na;Na|=4;try{Vp(l,o);var D=A1,Q=wl(o.containerInfo),me=D.focusedElem,Me=D.selectionRange;if(Q!==me&&me&&me.ownerDocument&&yc(me.ownerDocument.documentElement,me)){if(Me!==null&&Xo(me)){var at=Me.start,St=Me.end;if(St===void 0&&(St=at),"selectionStart"in me)me.selectionStart=at,me.selectionEnd=Math.min(St,me.value.length);else{var Tt=me.ownerDocument||document,ut=Tt&&Tt.defaultView||window;if(ut.getSelection){var mt=ut.getSelection(),Fr=me.textContent.length,xn=Math.min(Me.start,Fr),fs=Me.end===void 0?xn:Math.min(Me.end,Fr);!mt.extend&&xn>fs&&(Q=fs,fs=xn,xn=Q);var rt=gc(me,xn),Je=gc(me,fs);if(rt&&Je&&(mt.rangeCount!==1||mt.anchorNode!==rt.node||mt.anchorOffset!==rt.offset||mt.focusNode!==Je.node||mt.focusOffset!==Je.offset)){var ht=Tt.createRange();ht.setStart(rt.node,rt.offset),mt.removeAllRanges(),xn>fs?(mt.addRange(ht),mt.extend(Je.node,Je.offset)):(ht.setEnd(Je.node,Je.offset),mt.addRange(ht))}}}}for(Tt=[],mt=me;mt=mt.parentNode;)mt.nodeType===1&&Tt.push({element:mt,left:mt.scrollLeft,top:mt.scrollTop});for(typeof me.focus=="function"&&me.focus(),me=0;me<Tt.length;me++){var Ot=Tt[me];Ot.element.scrollLeft=Ot.left,Ot.element.scrollTop=Ot.top}}la=!!sf,A1=sf=null}finally{Na=E,Pe.p=v,Ee.T=f}}o.current=l,Ei=2}}function Pg(){if(Ei===2){Ei=0;var o=Sh,l=tf,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=Ee.T,Ee.T=null;var v=Pe.p;Pe.p=2;var E=Na;Na|=4;try{xg(o,l.alternate,l)}finally{Na=E,Pe.p=v,Ee.T=f}}Ei=3}}function Mg(){if(Ei===4||Ei===3){Ei=0,Ct();var o=Sh,l=tf,f=Tl,v=rc;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Ei=5:(Ei=0,tf=Sh=null,Zp(o,o.pendingLanes));var E=o.pendingLanes;if(E===0&&(wh=null),Ps(f),l=l.stateNode,Qr&&typeof Qr.onCommitFiberRoot=="function")try{Qr.onCommitFiberRoot(Nn,l,void 0,(l.current.flags&128)===128)}catch{}if(v!==null){l=Ee.T,E=Pe.p,Pe.p=2,Ee.T=null;try{for(var D=o.onRecoverableError,Q=0;Q<v.length;Q++){var me=v[Q];D(me.value,{componentStack:me.stack})}}finally{Ee.T=l,Pe.p=E}}(Tl&3)!==0&&l0(),Ki(o),E=o.pendingLanes,(f&261930)!==0&&(E&42)!==0?o===a0?n0++:(n0=0,a0=o):n0=0,id(0)}}function Zp(o,l){(o.pooledCacheLanes&=l)===0&&(l=o.pooledCache,l!=null&&(o.pooledCache=null,Nu(l)))}function l0(){return Lg(),Pg(),Mg(),em()}function em(){if(Ei!==5)return!1;var o=Sh,l=c1;c1=0;var f=Ps(Tl),v=Ee.T,E=Pe.p;try{Pe.p=32>f?32:f,Ee.T=null,f=u1,u1=null;var D=Sh,Q=Tl;if(Ei=0,tf=Sh=null,Tl=0,(Na&6)!==0)throw Error(a(331));var me=Na;if(Na|=4,Ng(D.current),e0(D,D.current,Q,f),Na=me,id(0,!1),Qr&&typeof Qr.onPostCommitFiberRoot=="function")try{Qr.onPostCommitFiberRoot(Nn,D)}catch{}return!0}finally{Pe.p=E,Ee.T=v,Zp(o,l)}}function tm(o,l,f){l=Eo(f,l),l=yh(o.stateNode,l,2),o=In(o,l,2),o!==null&&(Yr(o,2),Ki(o))}function ka(o,l,f){if(o.tag===3)tm(o,o,f);else for(;l!==null;){if(l.tag===3){tm(l,o,f);break}else if(l.tag===1){var v=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(wh===null||!wh.has(v))){o=Eo(f,o),f=Rp(2),v=In(l,f,2),v!==null&&(jp(f,v,l,o),Yr(v,2),Ki(v));break}}l=l.return}}function p1(o,l,f){var v=o.pingCache;if(v===null){v=o.pingCache=new Yy;var E=new Set;v.set(l,E)}else E=v.get(l),E===void 0&&(E=new Set,v.set(l,E));E.has(f)||(a1=!0,E.add(f),o=Ug.bind(null,o,l,f),l.then(o,o))}function Ug(o,l,f){var v=o.pingCache;v!==null&&v.delete(l),o.pingedLanes|=o.suspendedLanes&f,o.warmLanes&=~f,ts===o&&(ea&f)===f&&(qs===4||qs===3&&(ea&62914560)===ea&&300>er()-i1?(Na&2)===0&&Po(o,0):s1|=f,ef===ea&&(ef=0)),Ki(o)}function rm(o,l){l===0&&(l=fa()),o=lo(o,l),o!==null&&(Yr(o,l),Ki(o))}function Bg(o){var l=o.memoizedState,f=0;l!==null&&(f=l.retryLane),rm(o,f)}function Hg(o,l){var f=0;switch(o.tag){case 31:case 13:var v=o.stateNode,E=o.memoizedState;E!==null&&(f=E.retryLane);break;case 19:v=o.stateNode;break;case 22:v=o.stateNode._retryCache;break;default:throw Error(a(314))}v!==null&&v.delete(l),rm(o,f)}function zg(o,l){return zr(o,l)}var c0=null,sd=null,m1=!1,g1=!1,y1=!1,Lu=0;function Ki(o){o!==sd&&o.next===null&&(sd===null?c0=sd=o:sd=sd.next=o),g1=!0,m1||(m1=!0,js())}function id(o,l){if(!y1&&g1){y1=!0;do for(var f=!1,v=c0;v!==null;){if(o!==0){var E=v.pendingLanes;if(E===0)var D=0;else{var Q=v.suspendedLanes,me=v.pingedLanes;D=(1<<31-an(42|o)+1)-1,D&=E&~(Q&~me),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(f=!0,ha(v,D))}else D=ea,D=Jt(v,v===ts?D:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(D&3)===0||bo(v,D)||(f=!0,ha(v,D));v=v.next}while(f);y1=!1}}function $g(){Pu()}function Pu(){g1=m1=!1;var o=0;Lu!==0&&C1()&&(o=Lu);for(var l=er(),f=null,v=c0;v!==null;){var E=v.next,D=nm(v,l);D===0?(v.next=null,f===null?c0=E:f.next=E,E===null&&(sd=f)):(f=v,(o!==0||(D&3)!==0)&&(g1=!0)),v=E}Ei!==0&&Ei!==5||id(o),Lu!==0&&(Lu=0)}function nm(o,l){for(var f=o.suspendedLanes,v=o.pingedLanes,E=o.expirationTimes,D=o.pendingLanes&-62914561;0<D;){var Q=31-an(D),me=1<<Q,Me=E[Q];Me===-1?((me&f)===0||(me&v)!==0)&&(E[Q]=Vs(me,l)):Me<=l&&(o.expiredLanes|=me),D&=~me}if(l=ts,f=ea,f=Jt(o,o===l?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v=o.callbackNode,f===0||o===l&&(Ua===2||Ua===9)||o.cancelPendingCommit!==null)return v!==null&&v!==null&&Qe(v),o.callbackNode=null,o.callbackPriority=0;if((f&3)===0||bo(o,f)){if(l=f&-f,l===o.callbackPriority)return l;switch(v!==null&&Qe(v),Ps(f)){case 2:case 8:f=Sr;break;case 32:f=kr;break;case 268435456:f=_r;break;default:f=kr}return v=af.bind(null,o),f=zr(f,v),o.callbackPriority=l,o.callbackNode=f,l}return v!==null&&v!==null&&Qe(v),o.callbackPriority=2,o.callbackNode=null,2}function af(o,l){if(Ei!==0&&Ei!==5)return o.callbackNode=null,o.callbackPriority=0,null;var f=o.callbackNode;if(l0()&&o.callbackNode!==f)return null;var v=ea;return v=Jt(o,o===ts?v:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v===0?null:(_g(o,v,l),nm(o,er()),o.callbackNode!=null&&o.callbackNode===f?af.bind(null,o):null)}function ha(o,l){if(l0())return null;_g(o,l,!0)}function js(){T1(function(){(Na&6)!==0?zr(ur,$g):Pu()})}function Wn(){if(Lu===0){var o=C;o===0&&(o=gn,gn<<=1,(gn&261888)===0&&(gn=256)),Lu=o}return Lu}function Os(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Mi(""+o)}function v1(o,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,o.id&&f.setAttribute("form",o.id),l.parentNode.insertBefore(f,l),o=new FormData(o),f.parentNode.removeChild(f),o}function nc(o,l,f,v,E){if(l==="submit"&&f&&f.stateNode===E){var D=Os((E[vn]||null).action),Q=v.submitter;Q&&(l=(l=Q[vn]||null)?Os(l.formAction):Q.getAttribute("formAction"),l!==null&&(D=l,Q=null));var me=new Co("action","action",null,v,E);o.push({event:me,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(Lu!==0){var Me=Q?v1(E,Q):new FormData(E);Tp(f,{pending:!0,data:Me,method:E.method,action:D},null,Me)}}else typeof D=="function"&&(me.preventDefault(),Me=Q?v1(E,Q):new FormData(E),Tp(f,{pending:!0,data:Me,method:E.method,action:D},D,Me))},currentTarget:E}]})}}for(var Mu=0;Mu<Zi.length;Mu++){var al=Zi[Mu],od=al.toLowerCase(),Qy=al[0].toUpperCase()+al.slice(1);No(od,"on"+Qy)}No(Yc,"onAnimationEnd"),No(ch,"onAnimationIteration"),No(If,"onAnimationStart"),No("dblclick","onDoubleClick"),No("focusin","onFocus"),No("focusout","onBlur"),No(_d,"onTransitionRun"),No(Id,"onTransitionStart"),No(Df,"onTransitionCancel"),No(Ff,"onTransitionEnd"),mn("onMouseEnter",["mouseout","mouseover"]),mn("onMouseLeave",["mouseout","mouseover"]),mn("onPointerEnter",["pointerout","pointerover"]),mn("onPointerLeave",["pointerout","pointerover"]),Vo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),am=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ld));function qg(o,l){l=(l&4)!==0;for(var f=0;f<o.length;f++){var v=o[f],E=v.event;v=v.listeners;e:{var D=void 0;if(l)for(var Q=v.length-1;0<=Q;Q--){var me=v[Q],Me=me.instance,at=me.currentTarget;if(me=me.listener,Me!==D&&E.isPropagationStopped())break e;D=me,E.currentTarget=at;try{D(E)}catch(St){bu(St)}E.currentTarget=null,D=Me}else for(Q=0;Q<v.length;Q++){if(me=v[Q],Me=me.instance,at=me.currentTarget,me=me.listener,Me!==D&&E.isPropagationStopped())break e;D=me,E.currentTarget=at;try{D(E)}catch(St){bu(St)}E.currentTarget=null,D=Me}}}}function hn(o,l){var f=l[jn];f===void 0&&(f=l[jn]=new Set);var v=o+"__bubble";f.has(v)||(Gg(l,o,2,!1),f.add(v))}function b1(o,l,f){var v=0;l&&(v|=4),Gg(f,o,v,l)}var x1="_reactListening"+Math.random().toString(36).slice(2);function sm(o){if(!o[x1]){o[x1]=!0,ss.forEach(function(f){f!=="selectionchange"&&(am.has(f)||b1(f,!1,o),b1(f,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[x1]||(l[x1]=!0,b1("selectionchange",!1,l))}}function Gg(o,l,f,v){switch(He(l)){case 2:var E=ki;break;case 8:E=ac;break;default:E=Ie}f=E.bind(null,l,f,o),E=void 0,!ah||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(E=!0),v?E!==void 0?o.addEventListener(l,f,{capture:!0,passive:E}):o.addEventListener(l,f,!0):E!==void 0?o.addEventListener(l,f,{passive:E}):o.addEventListener(l,f,!1)}function w1(o,l,f,v,E){var D=v;if((l&1)===0&&(l&2)===0&&v!==null)e:for(;;){if(v===null)return;var Q=v.tag;if(Q===3||Q===4){var me=v.stateNode.containerInfo;if(me===E)break;if(Q===4)for(Q=v.return;Q!==null;){var Me=Q.tag;if((Me===3||Me===4)&&Q.stateNode.containerInfo===E)return;Q=Q.return}for(;me!==null;){if(Q=gl(me),Q===null)return;if(Me=Q.tag,Me===5||Me===6||Me===26||Me===27){v=D=Q;continue e}me=me.parentNode}}v=v.return}kd(function(){var at=D,St=Xn(f),Tt=[];e:{var ut=vu.get(o);if(ut!==void 0){var mt=Co,Fr=o;switch(o){case"keypress":if(Ui(f)===0)break e;case"keydown":case"keyup":mt=On;break;case"focusin":Fr="focus",mt=Pl;break;case"focusout":Fr="blur",mt=Pl;break;case"beforeblur":case"afterblur":mt=Pl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=ih;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=Ll;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=ei;break;case Yc:case ch:case If:mt=j;break;case Ff:mt=Si;break;case"scroll":case"scrollend":mt=gu;break;case"wheel":mt=Ra;break;case"copy":case"cut":case"paste":mt=je;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=Ja;break;case"toggle":case"beforetoggle":mt=xt}var xn=(l&4)!==0,fs=!xn&&(o==="scroll"||o==="scrollend"),rt=xn?ut!==null?ut+"Capture":null:ut;xn=[];for(var Je=at,ht;Je!==null;){var Ot=Je;if(ht=Ot.stateNode,Ot=Ot.tag,Ot!==5&&Ot!==26&&Ot!==27||ht===null||rt===null||(Ot=Ao(Je,rt),Ot!=null&&xn.push(u0(Je,Ot,ht))),fs)break;Je=Je.return}0<xn.length&&(ut=new mt(ut,Fr,null,f,St),Tt.push({event:ut,listeners:xn}))}}if((l&7)===0){e:{if(ut=o==="mouseover"||o==="pointerover",mt=o==="mouseout"||o==="pointerout",ut&&f!==Ko&&(Fr=f.relatedTarget||f.fromElement)&&(gl(Fr)||Fr[Cs]))break e;if((mt||ut)&&(ut=St.window===St?St:(ut=St.ownerDocument)?ut.defaultView||ut.parentWindow:window,mt?(Fr=f.relatedTarget||f.toElement,mt=at,Fr=Fr?gl(Fr):null,Fr!==null&&(fs=e(Fr),xn=Fr.tag,Fr!==fs||xn!==5&&xn!==27&&xn!==6)&&(Fr=null)):(mt=null,Fr=at),mt!==Fr)){if(xn=ih,Ot="onMouseLeave",rt="onMouseEnter",Je="mouse",(o==="pointerout"||o==="pointerover")&&(xn=Ja,Ot="onPointerLeave",rt="onPointerEnter",Je="pointer"),fs=mt==null?ut:$c(mt),ht=Fr==null?ut:$c(Fr),ut=new xn(Ot,Je+"leave",mt,f,St),ut.target=fs,ut.relatedTarget=ht,Ot=null,gl(St)===at&&(xn=new xn(rt,Je+"enter",Fr,f,St),xn.target=ht,xn.relatedTarget=fs,Ot=xn),fs=Ot,mt&&Fr)t:{for(xn=im,rt=mt,Je=Fr,ht=0,Ot=rt;Ot;Ot=xn(Ot))ht++;Ot=0;for(var dn=Je;dn;dn=xn(dn))Ot++;for(;0<ht-Ot;)rt=xn(rt),ht--;for(;0<Ot-ht;)Je=xn(Je),Ot--;for(;ht--;){if(rt===Je||Je!==null&&rt===Je.alternate){xn=rt;break t}rt=xn(rt),Je=xn(Je)}xn=null}else xn=null;mt!==null&&S1(Tt,ut,mt,xn,!1),Fr!==null&&fs!==null&&S1(Tt,fs,Fr,xn,!0)}}e:{if(ut=at?$c(at):window,mt=ut.nodeName&&ut.nodeName.toLowerCase(),mt==="select"||mt==="input"&&ut.type==="file")var _a=mc;else if(ti(ut))if(ri)_a=Bi;else{_a=ca;var Jr=lh}else mt=ut.nodeName,!mt||mt.toLowerCase()!=="input"||ut.type!=="checkbox"&&ut.type!=="radio"?at&&mu(at.elementType)&&(_a=mc):_a=zl;if(_a&&(_a=_a(o,at))){rn(Tt,_a,f,St);break e}Jr&&Jr(o,ut,at),o==="focusout"&&at&&ut.type==="number"&&at.memoizedProps.value!=null&&aa(ut,"number",ut.value)}switch(Jr=at?$c(at):window,o){case"focusin":(ti(Jr)||Jr.contentEditable==="true")&&(oo=Jr,ql=at,Ts=null);break;case"focusout":Ts=ql=oo=null;break;case"mousedown":Ci=!0;break;case"contextmenu":case"mouseup":case"dragend":Ci=!1,Sn(Tt,f,St);break;case"selectionchange":if(vc)break;case"keydown":case"keyup":Sn(Tt,f,St)}var qn;if(xs)e:{switch(o){case"compositionstart":var da="onCompositionStart";break e;case"compositionend":da="onCompositionEnd";break e;case"compositionupdate":da="onCompositionUpdate";break e}da=void 0}else Qo?Hl(o,f)&&(da="onCompositionEnd"):o==="keydown"&&f.keyCode===229&&(da="onCompositionStart");da&&(Ul&&f.locale!=="ko"&&(Qo||da!=="onCompositionStart"?da==="onCompositionEnd"&&Qo&&(qn=sh()):(wi=St,Xt="value"in wi?wi.value:wi.textContent,Qo=!0)),Jr=h0(at,da),0<Jr.length&&(da=new tt(da,o,null,f,St),Tt.push({event:da,listeners:Jr}),qn?da.data=qn:(qn=ja(f),qn!==null&&(da.data=qn)))),(qn=bl?Ln(o,f):ga(o,f))&&(da=h0(at,"onBeforeInput"),0<da.length&&(Jr=new tt("onBeforeInput","beforeinput",null,f,St),Tt.push({event:Jr,listeners:da}),Jr.data=qn)),nc(Tt,o,at,f,St)}qg(Tt,l)})}function u0(o,l,f){return{instance:o,listener:l,currentTarget:f}}function h0(o,l){for(var f=l+"Capture",v=[];o!==null;){var E=o,D=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||D===null||(E=Ao(o,f),E!=null&&v.unshift(u0(o,E,D)),E=Ao(o,l),E!=null&&v.push(u0(o,E,D))),o.tag===3)return v;o=o.return}return[]}function im(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function S1(o,l,f,v,E){for(var D=l._reactName,Q=[];f!==null&&f!==v;){var me=f,Me=me.alternate,at=me.stateNode;if(me=me.tag,Me!==null&&Me===v)break;me!==5&&me!==26&&me!==27||at===null||(Me=at,E?(at=Ao(f,D),at!=null&&Q.unshift(u0(f,at,Me))):E||(at=Ao(f,D),at!=null&&Q.push(u0(f,at,Me)))),f=f.return}Q.length!==0&&o.push({event:l,listeners:Q})}var Xy=/\r\n?/g,Zy=/\u0000|\uFFFD/g;function El(o){return(typeof o=="string"?o:""+o).replace(Xy,`
`).replace(Zy,"")}function om(o,l){return l=El(l),El(o)===l}function Va(o,l,f,v,E,D){switch(f){case"children":typeof v=="string"?l==="body"||l==="textarea"&&v===""||Wo(o,v):(typeof v=="number"||typeof v=="bigint")&&l!=="body"&&Wo(o,""+v);break;case"className":os(o,"class",v);break;case"tabIndex":os(o,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":os(o,f,v);break;case"style":Ea(o,v,D);break;case"data":if(l!=="object"){os(o,"data",v);break}case"src":case"href":if(v===""&&(l!=="a"||f!=="href")){o.removeAttribute(f);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(f);break}v=Mi(""+v),o.setAttribute(f,v);break;case"action":case"formAction":if(typeof v=="function"){o.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(f==="formAction"?(l!=="input"&&Va(o,l,"name",E.name,E,null),Va(o,l,"formEncType",E.formEncType,E,null),Va(o,l,"formMethod",E.formMethod,E,null),Va(o,l,"formTarget",E.formTarget,E,null)):(Va(o,l,"encType",E.encType,E,null),Va(o,l,"method",E.method,E,null),Va(o,l,"target",E.target,E,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(f);break}v=Mi(""+v),o.setAttribute(f,v);break;case"onClick":v!=null&&(o.onclick=ao);break;case"onScroll":v!=null&&hn("scroll",o);break;case"onScrollEnd":v!=null&&hn("scrollend",o);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(a(61));if(f=v.__html,f!=null){if(E.children!=null)throw Error(a(60));o.innerHTML=f}}break;case"multiple":o.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":o.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){o.removeAttribute("xlink:href");break}f=Mi(""+v),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(f,""+v):o.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(f,""):o.removeAttribute(f);break;case"capture":case"download":v===!0?o.setAttribute(f,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(f,v):o.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?o.setAttribute(f,v):o.removeAttribute(f);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?o.removeAttribute(f):o.setAttribute(f,v);break;case"popover":hn("beforetoggle",o),hn("toggle",o),So(o,"popover",v);break;case"xlinkActuate":yl(o,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":yl(o,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":yl(o,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":yl(o,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":yl(o,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":yl(o,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":yl(o,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":yl(o,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":yl(o,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":So(o,"is",v);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=nh.get(f)||f,So(o,f,v))}}function lm(o,l,f,v,E,D){switch(f){case"style":Ea(o,v,D);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(a(61));if(f=v.__html,f!=null){if(E.children!=null)throw Error(a(60));o.innerHTML=f}}break;case"children":typeof v=="string"?Wo(o,v):(typeof v=="number"||typeof v=="bigint")&&Wo(o,""+v);break;case"onScroll":v!=null&&hn("scroll",o);break;case"onScrollEnd":v!=null&&hn("scrollend",o);break;case"onClick":v!=null&&(o.onclick=ao);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ya.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(E=f.endsWith("Capture"),l=f.slice(2,E?f.length-7:void 0),D=o[vn]||null,D=D!=null?D[f]:null,typeof D=="function"&&o.removeEventListener(l,D,E),typeof v=="function")){typeof D!="function"&&D!==null&&(f in o?o[f]=null:o.hasAttribute(f)&&o.removeAttribute(f)),o.addEventListener(l,v,E);break e}f in o?o[f]=v:v===!0?o.setAttribute(f,""):So(o,f,v)}}}function Yi(o,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":hn("error",o),hn("load",o);var v=!1,E=!1,D;for(D in f)if(f.hasOwnProperty(D)){var Q=f[D];if(Q!=null)switch(D){case"src":v=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Va(o,l,D,Q,f,null)}}E&&Va(o,l,"srcSet",f.srcSet,f,null),v&&Va(o,l,"src",f.src,f,null);return;case"input":hn("invalid",o);var me=D=Q=E=null,Me=null,at=null;for(v in f)if(f.hasOwnProperty(v)){var St=f[v];if(St!=null)switch(v){case"name":E=St;break;case"type":Q=St;break;case"checked":Me=St;break;case"defaultChecked":at=St;break;case"value":D=St;break;case"defaultValue":me=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(a(137,l));break;default:Va(o,l,v,St,f,null)}}Td(o,D,me,Me,at,Q,E,!1);return;case"select":hn("invalid",o),v=Q=D=null;for(E in f)if(f.hasOwnProperty(E)&&(me=f[E],me!=null))switch(E){case"value":D=me;break;case"defaultValue":Q=me;break;case"multiple":v=me;default:Va(o,l,E,me,f,null)}l=D,f=Q,o.multiple=!!v,l!=null?Pi(o,!!v,l,!1):f!=null&&Pi(o,!!v,f,!0);return;case"textarea":hn("invalid",o),D=E=v=null;for(Q in f)if(f.hasOwnProperty(Q)&&(me=f[Q],me!=null))switch(Q){case"value":v=me;break;case"defaultValue":E=me;break;case"children":D=me;break;case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(91));break;default:Va(o,l,Q,me,f,null)}pu(o,v,E,D);return;case"option":for(Me in f)f.hasOwnProperty(Me)&&(v=f[Me],v!=null)&&(Me==="selected"?o.selected=v&&typeof v!="function"&&typeof v!="symbol":Va(o,l,Me,v,f,null));return;case"dialog":hn("beforetoggle",o),hn("toggle",o),hn("cancel",o),hn("close",o);break;case"iframe":case"object":hn("load",o);break;case"video":case"audio":for(v=0;v<ld.length;v++)hn(ld[v],o);break;case"image":hn("error",o),hn("load",o);break;case"details":hn("toggle",o);break;case"embed":case"source":case"link":hn("error",o),hn("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(at in f)if(f.hasOwnProperty(at)&&(v=f[at],v!=null))switch(at){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Va(o,l,at,v,f,null)}return;default:if(mu(l)){for(St in f)f.hasOwnProperty(St)&&(v=f[St],v!==void 0&&lm(o,l,St,v,f,void 0));return}}for(me in f)f.hasOwnProperty(me)&&(v=f[me],v!=null&&Va(o,l,me,v,f,null))}function cm(o,l,f,v){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,D=null,Q=null,me=null,Me=null,at=null,St=null;for(mt in f){var Tt=f[mt];if(f.hasOwnProperty(mt)&&Tt!=null)switch(mt){case"checked":break;case"value":break;case"defaultValue":Me=Tt;default:v.hasOwnProperty(mt)||Va(o,l,mt,null,v,Tt)}}for(var ut in v){var mt=v[ut];if(Tt=f[ut],v.hasOwnProperty(ut)&&(mt!=null||Tt!=null))switch(ut){case"type":D=mt;break;case"name":E=mt;break;case"checked":at=mt;break;case"defaultChecked":St=mt;break;case"value":Q=mt;break;case"defaultValue":me=mt;break;case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(a(137,l));break;default:mt!==Tt&&Va(o,l,ut,mt,v,Tt)}}qc(o,Q,me,Me,at,St,D,E);return;case"select":mt=Q=me=ut=null;for(D in f)if(Me=f[D],f.hasOwnProperty(D)&&Me!=null)switch(D){case"value":break;case"multiple":mt=Me;default:v.hasOwnProperty(D)||Va(o,l,D,null,v,Me)}for(E in v)if(D=v[E],Me=f[E],v.hasOwnProperty(E)&&(D!=null||Me!=null))switch(E){case"value":ut=D;break;case"defaultValue":me=D;break;case"multiple":Q=D;default:D!==Me&&Va(o,l,E,D,v,Me)}l=me,f=Q,v=mt,ut!=null?Pi(o,!!f,ut,!1):!!v!=!!f&&(l!=null?Pi(o,!!f,l,!0):Pi(o,!!f,f?[]:"",!1));return;case"textarea":mt=ut=null;for(me in f)if(E=f[me],f.hasOwnProperty(me)&&E!=null&&!v.hasOwnProperty(me))switch(me){case"value":break;case"children":break;default:Va(o,l,me,null,v,E)}for(Q in v)if(E=v[Q],D=f[Q],v.hasOwnProperty(Q)&&(E!=null||D!=null))switch(Q){case"value":ut=E;break;case"defaultValue":mt=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(a(91));break;default:E!==D&&Va(o,l,Q,E,v,D)}rh(o,ut,mt);return;case"option":for(var Fr in f)ut=f[Fr],f.hasOwnProperty(Fr)&&ut!=null&&!v.hasOwnProperty(Fr)&&(Fr==="selected"?o.selected=!1:Va(o,l,Fr,null,v,ut));for(Me in v)ut=v[Me],mt=f[Me],v.hasOwnProperty(Me)&&ut!==mt&&(ut!=null||mt!=null)&&(Me==="selected"?o.selected=ut&&typeof ut!="function"&&typeof ut!="symbol":Va(o,l,Me,ut,v,mt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xn in f)ut=f[xn],f.hasOwnProperty(xn)&&ut!=null&&!v.hasOwnProperty(xn)&&Va(o,l,xn,null,v,ut);for(at in v)if(ut=v[at],mt=f[at],v.hasOwnProperty(at)&&ut!==mt&&(ut!=null||mt!=null))switch(at){case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(a(137,l));break;default:Va(o,l,at,ut,v,mt)}return;default:if(mu(l)){for(var fs in f)ut=f[fs],f.hasOwnProperty(fs)&&ut!==void 0&&!v.hasOwnProperty(fs)&&lm(o,l,fs,void 0,v,ut);for(St in v)ut=v[St],mt=f[St],!v.hasOwnProperty(St)||ut===mt||ut===void 0&&mt===void 0||lm(o,l,St,ut,v,mt);return}}for(var rt in f)ut=f[rt],f.hasOwnProperty(rt)&&ut!=null&&!v.hasOwnProperty(rt)&&Va(o,l,rt,null,v,ut);for(Tt in v)ut=v[Tt],mt=f[Tt],!v.hasOwnProperty(Tt)||ut===mt||ut==null&&mt==null||Va(o,l,Tt,ut,v,mt)}function um(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function hm(){if(typeof performance.getEntriesByType=="function"){for(var o=0,l=0,f=performance.getEntriesByType("resource"),v=0;v<f.length;v++){var E=f[v],D=E.transferSize,Q=E.initiatorType,me=E.duration;if(D&&me&&um(Q)){for(Q=0,me=E.responseEnd,v+=1;v<f.length;v++){var Me=f[v],at=Me.startTime;if(at>me)break;var St=Me.transferSize,Tt=Me.initiatorType;St&&um(Tt)&&(Me=Me.responseEnd,Q+=St*(Me<me?1:(me-at)/(Me-at)))}if(--v,l+=8*(D+Q)/(E.duration/1e3),o++,10<o)break}}if(0<o)return l/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var sf=null,A1=null;function d0(o){return o.nodeType===9?o:o.ownerDocument}function dm(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jc(o,l){if(o===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&l==="foreignObject"?0:o}function of(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var f0=null;function C1(){var o=window.event;return o&&o.type==="popstate"?o===f0?!1:(f0=o,!0):(f0=null,!1)}var N1=typeof setTimeout=="function"?setTimeout:void 0,Vg=typeof clearTimeout=="function"?clearTimeout:void 0,fm=typeof Promise=="function"?Promise:void 0,T1=typeof queueMicrotask=="function"?queueMicrotask:typeof fm<"u"?function(o){return fm.resolve(null).then(o).catch(Wg)}:N1;function Wg(o){setTimeout(function(){throw o})}function Uu(o){return o==="head"}function E1(o,l){var f=l,v=0;do{var E=f.nextSibling;if(o.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"||f==="/&"){if(v===0){o.removeChild(E),Br(l);return}v--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")v++;else if(f==="html")c(o.ownerDocument.documentElement);else if(f==="head"){f=o.ownerDocument.head,c(f);for(var D=f.firstChild;D;){var Q=D.nextSibling,me=D.nodeName;D[Oi]||me==="SCRIPT"||me==="STYLE"||me==="LINK"&&D.rel.toLowerCase()==="stylesheet"||f.removeChild(D),D=Q}}else f==="body"&&c(o.ownerDocument.body);f=E}while(f);Br(l)}function pm(o,l){var f=o;o=0;do{var v=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),v&&v.nodeType===8)if(f=v.data,f==="/$"){if(o===0)break;o--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||o++;f=v}while(f)}function k1(o){var l=o.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":k1(f),uc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}o.removeChild(f)}}function _1(o,l,f,v){for(;o.nodeType===1;){var E=f;if(o.nodeName.toLowerCase()!==l.toLowerCase()){if(!v&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(v){if(!o[Oi])switch(l){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(D=o.getAttribute("rel"),D==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(D!==E.rel||o.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||o.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||o.getAttribute("title")!==(E.title==null?null:E.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(D=o.getAttribute("src"),(D!==(E.src==null?null:E.src)||o.getAttribute("type")!==(E.type==null?null:E.type)||o.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&D&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(l==="input"&&o.type==="hidden"){var D=E.name==null?null:""+E.name;if(E.type==="hidden"&&o.getAttribute("name")===D)return o}else return o;if(o=kl(o.nextSibling),o===null)break}return null}function mm(o,l,f){if(l==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!f||(o=kl(o.nextSibling),o===null))return null;return o}function I1(o,l){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!l||(o=kl(o.nextSibling),o===null))return null;return o}function D1(o){return o.data==="$?"||o.data==="$~"}function lf(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function gm(o,l){var f=o.ownerDocument;if(o.data==="$~")o._reactRetry=l;else if(o.data!=="$?"||f.readyState!=="loading")l();else{var v=function(){l(),f.removeEventListener("DOMContentLoaded",v)};f.addEventListener("DOMContentLoaded",v),o._reactRetry=v}}function kl(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return o}var Ch=null;function ta(o){o=o.nextSibling;for(var l=0;o;){if(o.nodeType===8){var f=o.data;if(f==="/$"||f==="/&"){if(l===0)return kl(o.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}o=o.nextSibling}return null}function Kg(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var f=o.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return o;l--}else f!=="/$"&&f!=="/&"||l++}o=o.previousSibling}return null}function s(o,l,f){switch(l=d0(f),o){case"html":if(o=l.documentElement,!o)throw Error(a(452));return o;case"head":if(o=l.head,!o)throw Error(a(453));return o;case"body":if(o=l.body,!o)throw Error(a(454));return o;default:throw Error(a(451))}}function c(o){for(var l=o.attributes;l.length;)o.removeAttributeNode(l[0]);uc(o)}var u=new Map,d=new Set;function g(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var x=Pe.d;Pe.d={f:b,r:S,D:F,C:O,L,m:B,X:G,S:ee,M:he};function b(){var o=x.f(),l=h1();return o||l}function S(o){var l=Go(o);l!==null&&l.tag===5&&l.type==="form"?Zm(l):x.r(o)}var N=typeof document>"u"?null:document;function T(o,l,f){var v=N;if(v&&typeof l=="string"&&l){var E=cn(l);E='link[rel="'+o+'"][href="'+E+'"]',typeof f=="string"&&(E+='[crossorigin="'+f+'"]'),d.has(E)||(d.add(E),o={rel:o,crossOrigin:f,href:l},v.querySelector(E)===null&&(l=v.createElement("link"),Yi(l,"link",o),ys(l),v.head.appendChild(l)))}}function F(o){x.D(o),T("dns-prefetch",o,null)}function O(o,l){x.C(o,l),T("preconnect",o,l)}function L(o,l,f){x.L(o,l,f);var v=N;if(v&&o&&l){var E='link[rel="preload"][as="'+cn(l)+'"]';l==="image"&&f&&f.imageSrcSet?(E+='[imagesrcset="'+cn(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(E+='[imagesizes="'+cn(f.imageSizes)+'"]')):E+='[href="'+cn(o)+'"]';var D=E;switch(l){case"style":D=J(o);break;case"script":D=$e(o)}u.has(D)||(o=I({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:o,as:l},f),u.set(D,o),v.querySelector(E)!==null||l==="style"&&v.querySelector(ue(D))||l==="script"&&v.querySelector(et(D))||(l=v.createElement("link"),Yi(l,"link",o),ys(l),v.head.appendChild(l)))}}function B(o,l){x.m(o,l);var f=N;if(f&&o){var v=l&&typeof l.as=="string"?l.as:"script",E='link[rel="modulepreload"][as="'+cn(v)+'"][href="'+cn(o)+'"]',D=E;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=$e(o)}if(!u.has(D)&&(o=I({rel:"modulepreload",href:o},l),u.set(D,o),f.querySelector(E)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(et(D)))return}v=f.createElement("link"),Yi(v,"link",o),ys(v),f.head.appendChild(v)}}}function ee(o,l,f){x.S(o,l,f);var v=N;if(v&&o){var E=Us(v).hoistableStyles,D=J(o);l=l||"default";var Q=E.get(D);if(!Q){var me={loading:0,preload:null};if(Q=v.querySelector(ue(D)))me.loading=5;else{o=I({rel:"stylesheet",href:o,"data-precedence":l},f),(f=u.get(D))&&_t(o,f);var Me=Q=v.createElement("link");ys(Me),Yi(Me,"link",o),Me._p=new Promise(function(at,St){Me.onload=at,Me.onerror=St}),Me.addEventListener("load",function(){me.loading|=1}),Me.addEventListener("error",function(){me.loading|=2}),me.loading|=4,lt(Q,l,v)}Q={type:"stylesheet",instance:Q,count:1,state:me},E.set(D,Q)}}}function G(o,l){x.X(o,l);var f=N;if(f&&o){var v=Us(f).hoistableScripts,E=$e(o),D=v.get(E);D||(D=f.querySelector(et(E)),D||(o=I({src:o,async:!0},l),(l=u.get(E))&&Dt(o,l),D=f.createElement("script"),ys(D),Yi(D,"link",o),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},v.set(E,D))}}function he(o,l){x.M(o,l);var f=N;if(f&&o){var v=Us(f).hoistableScripts,E=$e(o),D=v.get(E);D||(D=f.querySelector(et(E)),D||(o=I({src:o,async:!0,type:"module"},l),(l=u.get(E))&&Dt(o,l),D=f.createElement("script"),ys(D),Yi(D,"link",o),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},v.set(E,D))}}function ne(o,l,f,v){var E=(E=ye.current)?g(E):null;if(!E)throw Error(a(446));switch(o){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=J(f.href),f=Us(E).hoistableStyles,v=f.get(l),v||(v={type:"style",instance:null,count:0,state:null},f.set(l,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){o=J(f.href);var D=Us(E).hoistableStyles,Q=D.get(o);if(Q||(E=E.ownerDocument||E,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(o,Q),(D=E.querySelector(ue(o)))&&!D._p&&(Q.instance=D,Q.state.loading=5),u.has(o)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},u.set(o,f),D||we(E,o,f,Q.state))),l&&v===null)throw Error(a(528,""));return Q}if(l&&v!==null)throw Error(a(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=$e(f),f=Us(E).hoistableScripts,v=f.get(l),v||(v={type:"script",instance:null,count:0,state:null},f.set(l,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,o))}}function J(o){return'href="'+cn(o)+'"'}function ue(o){return'link[rel="stylesheet"]['+o+"]"}function be(o){return I({},o,{"data-precedence":o.precedence,precedence:null})}function we(o,l,f,v){o.querySelector('link[rel="preload"][as="style"]['+l+"]")?v.loading=1:(l=o.createElement("link"),v.preload=l,l.addEventListener("load",function(){return v.loading|=1}),l.addEventListener("error",function(){return v.loading|=2}),Yi(l,"link",f),ys(l),o.head.appendChild(l))}function $e(o){return'[src="'+cn(o)+'"]'}function et(o){return"script[async]"+o}function Xe(o,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var v=o.querySelector('style[data-href~="'+cn(f.href)+'"]');if(v)return l.instance=v,ys(v),v;var E=I({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return v=(o.ownerDocument||o).createElement("style"),ys(v),Yi(v,"style",E),lt(v,f.precedence,o),l.instance=v;case"stylesheet":E=J(f.href);var D=o.querySelector(ue(E));if(D)return l.state.loading|=4,l.instance=D,ys(D),D;v=be(f),(E=u.get(E))&&_t(v,E),D=(o.ownerDocument||o).createElement("link"),ys(D);var Q=D;return Q._p=new Promise(function(me,Me){Q.onload=me,Q.onerror=Me}),Yi(D,"link",v),l.state.loading|=4,lt(D,f.precedence,o),l.instance=D;case"script":return D=$e(f.src),(E=o.querySelector(et(D)))?(l.instance=E,ys(E),E):(v=f,(E=u.get(D))&&(v=I({},f),Dt(v,E)),o=o.ownerDocument||o,E=o.createElement("script"),ys(E),Yi(E,"link",v),o.head.appendChild(E),l.instance=E);case"void":return null;default:throw Error(a(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(v=l.instance,l.state.loading|=4,lt(v,f.precedence,o));return l.instance}function lt(o,l,f){for(var v=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=v.length?v[v.length-1]:null,D=E,Q=0;Q<v.length;Q++){var me=v[Q];if(me.dataset.precedence===l)D=me;else if(D!==E)break}D?D.parentNode.insertBefore(o,D.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(o,l.firstChild))}function _t(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.title==null&&(o.title=l.title)}function Dt(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.integrity==null&&(o.integrity=l.integrity)}var ft=null;function qt(o,l,f){if(ft===null){var v=new Map,E=ft=new Map;E.set(f,v)}else E=ft,v=E.get(f),v||(v=new Map,E.set(f,v));if(v.has(o))return v;for(v.set(o,null),f=f.getElementsByTagName(o),E=0;E<f.length;E++){var D=f[E];if(!(D[Oi]||D[Fa]||o==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=D.getAttribute(l)||"";Q=o+Q;var me=v.get(Q);me?me.push(D):v.set(Q,[D])}}return v}function hr(o,l,f){o=o.ownerDocument||o,o.head.insertBefore(f,l==="title"?o.querySelector("head > title"):null)}function lr(o,l,f){if(f===1||l.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(o=l.disabled,typeof l.precedence=="string"&&o==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Zt(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function tr(o,l,f,v){if(f.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var E=J(v.href),D=l.querySelector(ue(E));if(D){l=D._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(o.count++,o=mr.bind(o),l.then(o,o)),f.state.loading|=4,f.instance=D,ys(D);return}D=l.ownerDocument||l,v=be(v),(E=u.get(E))&&_t(v,E),D=D.createElement("link"),ys(D);var Q=D;Q._p=new Promise(function(me,Me){Q.onload=me,Q.onerror=Me}),Yi(D,"link",v),f.instance=D}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(o.count++,f=mr.bind(o),l.addEventListener("load",f),l.addEventListener("error",f))}}var Kt=0;function Bt(o,l){return o.stylesheets&&o.count===0&&Gr(o,o.stylesheets),0<o.count||0<o.imgCount?function(f){var v=setTimeout(function(){if(o.stylesheets&&Gr(o,o.stylesheets),o.unsuspend){var D=o.unsuspend;o.unsuspend=null,D()}},6e4+l);0<o.imgBytes&&Kt===0&&(Kt=62500*hm());var E=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&Gr(o,o.stylesheets),o.unsuspend)){var D=o.unsuspend;o.unsuspend=null,D()}},(o.imgBytes>Kt?50:800)+l);return o.unsuspend=f,function(){o.unsuspend=null,clearTimeout(v),clearTimeout(E)}}:null}function mr(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gr(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Nr=null;function Gr(o,l){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Nr=new Map,l.forEach(Mn,o),Nr=null,mr.call(o))}function Mn(o,l){if(!(l.state.loading&4)){var f=Nr.get(o);if(f)var v=f.get(null);else{f=new Map,Nr.set(o,f);for(var E=o.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<E.length;D++){var Q=E[D];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(f.set(Q.dataset.precedence,Q),v=Q)}v&&f.set(null,v)}E=l.instance,Q=E.getAttribute("data-precedence"),D=f.get(Q)||v,D===v&&f.set(null,E),f.set(Q,E),this.count++,v=mr.bind(this),E.addEventListener("load",v),E.addEventListener("error",v),D?D.parentNode.insertBefore(E,D.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(E,o.firstChild)),l.state.loading|=4}}var dr={$$typeof:W,Provider:null,Consumer:null,_currentValue:Ue,_currentValue2:Ue,_threadCount:0};function Gt(o,l,f,v,E,D,Q,me,Me){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xo(0),this.hiddenUpdates=xo(null),this.identifierPrefix=v,this.onUncaughtError=E,this.onCaughtError=D,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Me,this.incompleteTransitions=new Map}function bn(o,l,f,v,E,D,Q,me,Me,at,St,Tt){return o=new Gt(o,l,f,Q,Me,at,St,Tt,me),l=1,D===!0&&(l|=24),D=La(3,null,null,l),o.current=D,D.stateNode=o,l=Tc(),l.refCount++,o.pooledCache=l,l.refCount++,D.memoizedState={element:v,isDehydrated:f,cache:l},sr(D),o}function Qn(o){return o?(o=li,o):li}function $n(o,l,f,v,E,D){E=Qn(E),v.context===null?v.context=E:v.pendingContext=E,v=qr(l),v.payload={element:f},D=D===void 0?null:D,D!==null&&(v.callback=D),f=In(o,v,l),f!==null&&(Lo(f,o,l),ya(f,o,l))}function Sa(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var f=o.retryLane;o.retryLane=f!==0&&f<l?f:l}}function Ls(o,l){Sa(o,l),(o=o.alternate)&&Sa(o,l)}function We(o){if(o.tag===13||o.tag===31){var l=lo(o,67108864);l!==null&&Lo(l,o,67108864),Ls(o,67108864)}}function Aa(o){if(o.tag===13||o.tag===31){var l=Oo();l=as(l);var f=lo(o,l);f!==null&&Lo(f,o,l),Ls(o,l)}}var la=!0;function ki(o,l,f,v){var E=Ee.T;Ee.T=null;var D=Pe.p;try{Pe.p=2,Ie(o,l,f,v)}finally{Pe.p=D,Ee.T=E}}function ac(o,l,f,v){var E=Ee.T;Ee.T=null;var D=Pe.p;try{Pe.p=8,Ie(o,l,f,v)}finally{Pe.p=D,Ee.T=E}}function Ie(o,l,f,v){if(la){var E=pt(v);if(E===null)w1(o,l,v,qe,f),or(o,v);else if(Pr(E,o,l,f,v))v.stopPropagation();else if(or(o,v),l&4&&-1<gr.indexOf(o)){for(;E!==null;){var D=Go(E);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var Q=Wr(D.pendingLanes);if(Q!==0){var me=D;for(me.pendingLanes|=2,me.entangledLanes|=2;Q;){var Me=1<<31-an(Q);me.entanglements[1]|=Me,Q&=~Me}Ki(D),(Na&6)===0&&(o1=er()+500,id(0))}}break;case 31:case 13:me=lo(D,2),me!==null&&Lo(me,D,2),h1(),Ls(D,2)}if(D=pt(v),D===null&&w1(o,l,v,qe,f),D===E)break;E=D}E!==null&&v.stopPropagation()}else w1(o,l,v,null,f)}}function pt(o){return o=Xn(o),dt(o)}var qe=null;function dt(o){if(qe=null,o=gl(o),o!==null){var l=e(o);if(l===null)o=null;else{var f=l.tag;if(f===13){if(o=p(l),o!==null)return o;o=null}else if(f===31){if(o=m(l),o!==null)return o;o=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null)}}return qe=o,null}function He(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nr()){case ur:return 2;case Sr:return 8;case kr:case ar:return 32;case _r:return 268435456;default:return 32}default:return 32}}var zt=!1,ct=null,gt=null,it=null,Nt=new Map,Vt=new Map,vr=[],gr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function or(o,l){switch(o){case"focusin":case"focusout":ct=null;break;case"dragenter":case"dragleave":gt=null;break;case"mouseover":case"mouseout":it=null;break;case"pointerover":case"pointerout":Nt.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vt.delete(l.pointerId)}}function br(o,l,f,v,E,D){return o===null||o.nativeEvent!==D?(o={blockedOn:l,domEventName:f,eventSystemFlags:v,nativeEvent:D,targetContainers:[E]},l!==null&&(l=Go(l),l!==null&&We(l)),o):(o.eventSystemFlags|=v,l=o.targetContainers,E!==null&&l.indexOf(E)===-1&&l.push(E),o)}function Pr(o,l,f,v,E){switch(l){case"focusin":return ct=br(ct,o,l,f,v,E),!0;case"dragenter":return gt=br(gt,o,l,f,v,E),!0;case"mouseover":return it=br(it,o,l,f,v,E),!0;case"pointerover":var D=E.pointerId;return Nt.set(D,br(Nt.get(D)||null,o,l,f,v,E)),!0;case"gotpointercapture":return D=E.pointerId,Vt.set(D,br(Vt.get(D)||null,o,l,f,v,E)),!0}return!1}function Rr(o){var l=gl(o.target);if(l!==null){var f=e(l);if(f!==null){if(l=f.tag,l===13){if(l=p(f),l!==null){o.blockedOn=l,pl(o.priority,function(){Aa(f)});return}}else if(l===31){if(l=m(f),l!==null){o.blockedOn=l,pl(o.priority,function(){Aa(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){o.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}o.blockedOn=null}function rr(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var f=pt(o.nativeEvent);if(f===null){f=o.nativeEvent;var v=new f.constructor(f.type,f);Ko=v,f.target.dispatchEvent(v),Ko=null}else return l=Go(f),l!==null&&We(l),o.blockedOn=f,!1;l.shift()}return!0}function Wt(o,l,f){rr(o)&&f.delete(l)}function Ur(){zt=!1,ct!==null&&rr(ct)&&(ct=null),gt!==null&&rr(gt)&&(gt=null),it!==null&&rr(it)&&(it=null),Nt.forEach(Wt),Vt.forEach(Wt)}function fr(o,l){o.blockedOn===l&&(o.blockedOn=null,zt||(zt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ur)))}var Yt=null;function Xr(o){Yt!==o&&(Yt=o,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Yt===o&&(Yt=null);for(var l=0;l<o.length;l+=3){var f=o[l],v=o[l+1],E=o[l+2];if(typeof v!="function"){if(dt(v||f)===null)continue;break}var D=Go(f);D!==null&&(o.splice(l,3),l-=3,Tp(D,{pending:!0,data:E,method:f.method,action:v},v,E))}}))}function Br(o){function l(Me){return fr(Me,o)}ct!==null&&fr(ct,o),gt!==null&&fr(gt,o),it!==null&&fr(it,o),Nt.forEach(l),Vt.forEach(l);for(var f=0;f<vr.length;f++){var v=vr[f];v.blockedOn===o&&(v.blockedOn=null)}for(;0<vr.length&&(f=vr[0],f.blockedOn===null);)Rr(f),f.blockedOn===null&&vr.shift();if(f=(o.ownerDocument||o).$$reactFormReplay,f!=null)for(v=0;v<f.length;v+=3){var E=f[v],D=f[v+1],Q=E[vn]||null;if(typeof D=="function")Q||Xr(f);else if(Q){var me=null;if(D&&D.hasAttribute("formAction")){if(E=D,Q=D[vn]||null)me=Q.formAction;else if(dt(E)!==null)continue}else me=Q.action;typeof me=="function"?f[v+1]=me:(f.splice(v,3),v-=3),Xr(f)}}}function Wa(){function o(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(Q){return E=Q})},focusReset:"manual",scroll:"manual"})}function l(){E!==null&&(E(),E=null),v||setTimeout(f,20)}function f(){if(!v&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var v=!1,E=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){v=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),E!==null&&(E(),E=null)}}}function un(o){this._internalRoot=o}Tn.prototype.render=un.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(a(409));var f=l.current,v=Oo();$n(f,v,o,l,null,null)},Tn.prototype.unmount=un.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;$n(o.current,2,null,o,null,null),h1(),l[Cs]=null}};function Tn(o){this._internalRoot=o}Tn.prototype.unstable_scheduleHydration=function(o){if(o){var l=Ms();o={blockedOn:null,target:o,priority:l};for(var f=0;f<vr.length&&l!==0&&l<vr[f].priority;f++);vr.splice(f,0,o),f===0&&Rr(o)}};var Dr=t.version;if(Dr!=="19.2.3")throw Error(a(527,Dr,"19.2.3"));Pe.findDOMNode=function(o){var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(a(188)):(o=Object.keys(o).join(","),Error(a(268,o)));return o=w(l),o=o!==null?A(o):null,o=o===null?null:o.stateNode,o};var Kn={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Ee,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bn=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bn.isDisabled&&Bn.supportsFiber)try{Nn=Bn.inject(Kn),Qr=Bn}catch{}}return vm.createRoot=function(o,l){if(!n(o))throw Error(a(299));var f=!1,v="",E=G0,D=ug,Q=hg;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onUncaughtError!==void 0&&(E=l.onUncaughtError),l.onCaughtError!==void 0&&(D=l.onCaughtError),l.onRecoverableError!==void 0&&(Q=l.onRecoverableError)),l=bn(o,1,!1,null,null,f,v,null,E,D,Q,Wa),o[Cs]=l.current,sm(o),new un(l)},vm.hydrateRoot=function(o,l,f){if(!n(o))throw Error(a(299));var v=!1,E="",D=G0,Q=ug,me=hg,Me=null;return f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(E=f.identifierPrefix),f.onUncaughtError!==void 0&&(D=f.onUncaughtError),f.onCaughtError!==void 0&&(Q=f.onCaughtError),f.onRecoverableError!==void 0&&(me=f.onRecoverableError),f.formState!==void 0&&(Me=f.formState)),l=bn(o,1,!0,l,f??null,v,E,Me,D,Q,me,Wa),l.context=Qn(null),f=l.current,v=Oo(),v=as(v),E=qr(v),E.callback=null,In(f,E,v),f=v,l.current.lanes=f,Yr(l,f),Ki(l),o[Cs]=l.current,sm(o),new Tn(l)},vm.version="19.2.3",vm}var Ix;function MA(){if(Ix)return r5.exports;Ix=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),r5.exports=PA(),r5.exports}var UA=MA();const Pt={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},gf={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},x0={GET:"GET",POST:"POST"},op=[Pt.OPENID_SCOPE,Pt.PROFILE_SCOPE,Pt.OFFLINE_ACCESS_SCOPE],Dx=[...op,Pt.EMAIL_SCOPE],Il={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},Fx={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},bf={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Yg={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Ho={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",NO_SESSION:"no_session"},Bv={CODE:"code",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"},my={QUERY:"query",FRAGMENT:"fragment"},BA={QUERY:"query"},fw={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},Jg={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},Om={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},Bo={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},Hv="appmetadata",HA="client_info",j2="1",O2={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Lc={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Uo={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},rs={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Tm={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Rx={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},F1={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},i5={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},m0={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},zA={Pop:"pop"},pw=300;const L2="unexpected_error",$A="post_request_failed";const jx={[L2]:"Unexpected error in authentication.",[$A]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class gs extends Error{constructor(t,r,a){const n=r?`${t}: ${r}`:t;super(n),Object.setPrototypeOf(this,gs.prototype),this.errorCode=t||Pt.EMPTY_STRING,this.errorMessage=r||Pt.EMPTY_STRING,this.subError=a||Pt.EMPTY_STRING,this.name="AuthError"}setCorrelationId(t){this.correlationId=t}}function q5(i,t){return new gs(i,t?`${jx[i]} ${t}`:jx[i])}const zv="client_info_decoding_error",mw="client_info_empty_error",$v="token_parsing_error",gw="null_or_empty_token",fd="endpoints_resolution_error",yw="network_error",vw="openid_config_error",bw="hash_not_deserialized",np="invalid_state",xw="state_mismatch",G5="state_not_found",ww="nonce_mismatch",qv="auth_time_not_found",Sw="max_age_transpired",qA="multiple_matching_tokens",GA="multiple_matching_accounts",Aw="multiple_matching_appMetadata",Cw="request_cannot_be_made",Nw="cannot_remove_empty_scope",Tw="cannot_append_scopeset",V5="empty_input_scopeset",VA="device_code_polling_cancelled",WA="device_code_expired",KA="device_code_unknown_error",Gv="no_account_in_silent_request",Ew="invalid_cache_record",Vv="invalid_cache_environment",W5="no_account_found",K5="no_crypto_object",YA="unexpected_credential_type",JA="invalid_assertion",QA="invalid_client_credential",xf="token_refresh_required",XA="user_timeout_reached",kw="token_claims_cnf_required_for_signedjwt",_w="authorization_code_missing_from_server_response",Iw="binding_key_not_removed",Dw="end_session_endpoint_not_supported",Wv="key_id_missing",ZA="no_network_connectivity",eC="user_canceled",tC="missing_tenant_id_error",Yn="method_not_implemented",rC="nested_app_auth_bridge_disabled",nC="platform_broker_error";const Ox={[zv]:"The client info could not be parsed/decoded correctly",[mw]:"The client info was empty",[$v]:"Token cannot be parsed",[gw]:"The token is null or empty",[fd]:"Endpoints cannot be resolved",[yw]:"Network request failed",[vw]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[bw]:"The hash parameters could not be deserialized",[np]:"State was not the expected format",[xw]:"State mismatch error",[G5]:"State not found",[ww]:"Nonce mismatch error",[qv]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Sw]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[qA]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[GA]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Aw]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Cw]:"Token request cannot be made without authorization code or refresh token.",[Nw]:"Cannot remove null or empty scope from ScopeSet",[Tw]:"Cannot append ScopeSet",[V5]:"Empty input ScopeSet cannot be processed",[VA]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[WA]:"Device code is expired.",[KA]:"Device code stopped polling for unknown reasons.",[Gv]:"Please pass an account object, silent flow is not supported without account information",[Ew]:"Cache record object was null or undefined.",[Vv]:"Invalid environment when attempting to create cache entry",[W5]:"No account found in cache for given key.",[K5]:"No crypto object detected.",[YA]:"Unexpected credential type.",[JA]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[QA]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[xf]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[XA]:"User defined timeout for device code polling reached",[kw]:"Cannot generate a POP jwt if the token_claims are not populated",[_w]:"Server response does not contain an authorization code to proceed",[Iw]:"Could not remove the credential's binding key from storage.",[Dw]:"The provided authority does not support logout",[Wv]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[ZA]:"No network connectivity. Check your internet connection.",[eC]:"User cancelled the flow.",[tC]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Yn]:"This method has not been implemented",[rC]:"The nested app auth bridge is disabled",[nC]:"An error occurred in the native broker. See the platformBrokerError property for details."};class Kv extends gs{constructor(t,r){super(t,r?`${Ox[t]}: ${r}`:Ox[t]),this.name="ClientAuthError",Object.setPrototypeOf(this,Kv.prototype)}}function Qt(i,t){return new Kv(i,t)}const P2={createNewGuid:()=>{throw Qt(Yn)},base64Decode:()=>{throw Qt(Yn)},base64Encode:()=>{throw Qt(Yn)},base64UrlEncode:()=>{throw Qt(Yn)},encodeKid:()=>{throw Qt(Yn)},async getPublicKeyThumbprint(){throw Qt(Yn)},async removeTokenBindingKey(){throw Qt(Yn)},async clearKeystore(){throw Qt(Yn)},async signJwt(){throw Qt(Yn)},async hashString(){throw Qt(Yn)}};var Qs;(function(i){i[i.Error=0]="Error",i[i.Warning=1]="Warning",i[i.Info=2]="Info",i[i.Verbose=3]="Verbose",i[i.Trace=4]="Trace"})(Qs||(Qs={}));class vd{constructor(t,r,a){this.level=Qs.Info;const n=()=>{},e=t||vd.createDefaultLoggerOptions();this.localCallback=e.loggerCallback||n,this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=typeof e.logLevel=="number"?e.logLevel:Qs.Info,this.correlationId=e.correlationId||Pt.EMPTY_STRING,this.packageName=r||Pt.EMPTY_STRING,this.packageVersion=a||Pt.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Qs.Info}}clone(t,r,a){return new vd({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:a||this.correlationId},t,r)}logMessage(t,r){if(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii)return;const e=`${`[${new Date().toUTCString()}] : [${r.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Qs[r.logLevel]} - ${t}`;this.executeCallback(r.logLevel,e,r.containsPii||!1)}executeCallback(t,r,a){this.localCallback&&this.localCallback(t,r,a)}error(t,r){this.logMessage(t,{logLevel:Qs.Error,containsPii:!1,correlationId:r||Pt.EMPTY_STRING})}errorPii(t,r){this.logMessage(t,{logLevel:Qs.Error,containsPii:!0,correlationId:r||Pt.EMPTY_STRING})}warning(t,r){this.logMessage(t,{logLevel:Qs.Warning,containsPii:!1,correlationId:r||Pt.EMPTY_STRING})}warningPii(t,r){this.logMessage(t,{logLevel:Qs.Warning,containsPii:!0,correlationId:r||Pt.EMPTY_STRING})}info(t,r){this.logMessage(t,{logLevel:Qs.Info,containsPii:!1,correlationId:r||Pt.EMPTY_STRING})}infoPii(t,r){this.logMessage(t,{logLevel:Qs.Info,containsPii:!0,correlationId:r||Pt.EMPTY_STRING})}verbose(t,r){this.logMessage(t,{logLevel:Qs.Verbose,containsPii:!1,correlationId:r||Pt.EMPTY_STRING})}verbosePii(t,r){this.logMessage(t,{logLevel:Qs.Verbose,containsPii:!0,correlationId:r||Pt.EMPTY_STRING})}trace(t,r){this.logMessage(t,{logLevel:Qs.Trace,containsPii:!1,correlationId:r||Pt.EMPTY_STRING})}tracePii(t,r){this.logMessage(t,{logLevel:Qs.Trace,containsPii:!0,correlationId:r||Pt.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const Fw="@azure/msal-common",Yv="15.13.3";const Jv={None:"none"};const Rw="redirect_uri_empty",aC="claims_request_parsing_error",jw="authority_uri_insecure",Am="url_parse_error",Ow="empty_url_error",Lw="empty_input_scopes_error",Qv="invalid_claims",Pw="token_request_empty",Mw="logout_request_empty",sC="invalid_code_challenge_method",Xv="pkce_params_missing",Zv="invalid_cloud_discovery_metadata",Uw="invalid_authority_metadata",Bw="untrusted_authority",gy="missing_ssh_jwk",Hw="missing_ssh_kid",iC="missing_nonce_authentication_header",oC="invalid_authentication_header",zw="cannot_set_OIDCOptions",$w="cannot_allow_platform_broker",qw="authority_mismatch",Gw="invalid_request_method_for_EAR",Vw="invalid_authorize_post_body_parameters",Ww="invalid_platform_broker_configuration";const lC={[Rw]:"A redirect URI is required for all calls, and none has been set.",[aC]:"Could not parse the given claims request object.",[jw]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Am]:"URL could not be parsed into appropriate segments.",[Ow]:"URL was empty or null.",[Lw]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Qv]:"Given claims parameter must be a stringified JSON object.",[Pw]:"Token request was empty and not found in cache.",[Mw]:"The logout request was null or undefined.",[sC]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Xv]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Zv]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Uw]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Bw]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[gy]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Hw]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[iC]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[oC]:"Invalid authentication header provided",[zw]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[$w]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[qw]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[Vw]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[Gw]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST.",[Ww]:"Invalid platform broker configuration. `allowPlatformBrokerWithDOM` can only be enabled when `allowPlatformBroker` is enabled."};class eb extends gs{constructor(t){super(t,lC[t]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,eb.prototype)}}function ms(i){return new eb(i)}class Uc{static isEmptyObj(t){if(t)try{const r=JSON.parse(t);return Object.keys(r).length===0}catch{}return!0}static startsWith(t,r){return t.indexOf(r)===0}static endsWith(t,r){return t.length>=r.length&&t.lastIndexOf(r)===t.length-r.length}static queryStringToObject(t){const r={},a=t.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return a.forEach(e=>{if(e.trim()){const[p,m]=e.split(/=(.+)/g,2);p&&m&&(r[n(p)]=n(m))}}),r}static trimArrayEntries(t){return t.map(r=>r.trim())}static removeEmptyStringsFromArray(t){return t.filter(r=>!!r)}static jsonParseHelper(t){try{return JSON.parse(t)}catch{return null}}static matchPattern(t,r){return new RegExp(t.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(r)}}class ro{constructor(t){const r=t?Uc.trimArrayEntries([...t]):[],a=r?Uc.removeEmptyStringsFromArray(r):[];if(!a||!a.length)throw ms(Lw);this.scopes=new Set,a.forEach(n=>this.scopes.add(n))}static fromString(t){const a=(t||Pt.EMPTY_STRING).split(" ");return new ro(a)}static createSearchScopes(t){const r=t&&t.length>0?t:[...op],a=new ro(r);return a.containsOnlyOIDCScopes()?a.removeScope(Pt.OFFLINE_ACCESS_SCOPE):a.removeOIDCScopes(),a}containsScope(t){const r=this.printScopesLowerCase().split(" "),a=new ro(r);return t?a.scopes.has(t.toLowerCase()):!1}containsScopeSet(t){return!t||t.scopes.size<=0?!1:this.scopes.size>=t.scopes.size&&t.asArray().every(r=>this.containsScope(r))}containsOnlyOIDCScopes(){let t=0;return Dx.forEach(r=>{this.containsScope(r)&&(t+=1)}),this.scopes.size===t}appendScope(t){t&&this.scopes.add(t.trim())}appendScopes(t){try{t.forEach(r=>this.appendScope(r))}catch{throw Qt(Tw)}}removeScope(t){if(!t)throw Qt(Nw);this.scopes.delete(t.trim())}removeOIDCScopes(){Dx.forEach(t=>{this.scopes.delete(t)})}unionScopeSets(t){if(!t)throw Qt(V5);const r=new Set;return t.scopes.forEach(a=>r.add(a.toLowerCase())),this.scopes.forEach(a=>r.add(a.toLowerCase())),r}intersectingScopeSets(t){if(!t)throw Qt(V5);t.containsOnlyOIDCScopes()||t.removeOIDCScopes();const r=this.unionScopeSets(t),a=t.getScopeCount(),n=this.getScopeCount();return r.size<n+a}getScopeCount(){return this.scopes.size}asArray(){const t=[];return this.scopes.forEach(r=>t.push(r)),t}printScopes(){return this.scopes?this.asArray().join(" "):Pt.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function M2(i,t){if(!i)throw Qt(mw);try{const r=t(i);return JSON.parse(r)}catch{throw Qt(zv)}}function G1(i){if(!i)throw Qt(zv);const t=i.split(Om.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?Pt.EMPTY_STRING:t[1]}}function Lx(i,t){return!!i&&!!t&&i===t.split(".")[1]}function yy(i,t,r,a){if(a){const{oid:n,sub:e,tid:p,name:m,tfp:y,acr:w,preferred_username:A,upn:I,login_hint:R}=a,k=p||y||w||"";return{tenantId:k,localAccountId:n||e||"",name:m,username:A||I||"",loginHint:R,isHomeTenant:Lx(k,i)}}else return{tenantId:r,localAccountId:t,username:"",isHomeTenant:Lx(r,i)}}function tb(i,t,r,a){let n=i;if(t){const{isHomeTenant:e,...p}=t;n={...i,...p}}if(r){const{isHomeTenant:e,...p}=yy(i.homeAccountId,i.localAccountId,i.tenantId,r);return n={...n,...p,idTokenClaims:r,idToken:a},n}return n}const qu={Default:0,Adfs:1,Dsts:2,Ciam:3};function rb(i){return i&&(i.tid||i.tfp||i.acr)||null}const oc={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};class Fi{static getAccountInfo(t){return{homeAccountId:t.homeAccountId,environment:t.environment,tenantId:t.realm,username:t.username,localAccountId:t.localAccountId,loginHint:t.loginHint,name:t.name,nativeAccountId:t.nativeAccountId,authorityType:t.authorityType,tenantProfiles:new Map((t.tenantProfiles||[]).map(r=>[r.tenantId,r])),dataBoundary:t.dataBoundary}}isSingleTenant(){return!this.tenantProfiles}static createAccount(t,r,a){const n=new Fi;r.authorityType===qu.Adfs?n.authorityType=Jg.ADFS_ACCOUNT_TYPE:r.protocolMode===oc.OIDC?n.authorityType=Jg.GENERIC_ACCOUNT_TYPE:n.authorityType=Jg.MSSTS_ACCOUNT_TYPE;let e;t.clientInfo&&a&&(e=M2(t.clientInfo,a),e.xms_tdbr&&(n.dataBoundary=e.xms_tdbr==="EU"?"EU":"None")),n.clientInfo=t.clientInfo,n.homeAccountId=t.homeAccountId,n.nativeAccountId=t.nativeAccountId;const p=t.environment||r&&r.getPreferredCache();if(!p)throw Qt(Vv);n.environment=p,n.realm=e?.utid||rb(t.idTokenClaims)||"",n.localAccountId=e?.uid||t.idTokenClaims?.oid||t.idTokenClaims?.sub||"";const m=t.idTokenClaims?.preferred_username||t.idTokenClaims?.upn,y=t.idTokenClaims?.emails?t.idTokenClaims.emails[0]:null;if(n.username=m||y||"",n.loginHint=t.idTokenClaims?.login_hint,n.name=t.idTokenClaims?.name||"",n.cloudGraphHostName=t.cloudGraphHostName,n.msGraphHost=t.msGraphHost,t.tenantProfiles)n.tenantProfiles=t.tenantProfiles;else{const w=yy(t.homeAccountId,n.localAccountId,n.realm,t.idTokenClaims);n.tenantProfiles=[w]}return n}static createFromAccountInfo(t,r,a){const n=new Fi;return n.authorityType=t.authorityType||Jg.GENERIC_ACCOUNT_TYPE,n.homeAccountId=t.homeAccountId,n.localAccountId=t.localAccountId,n.nativeAccountId=t.nativeAccountId,n.realm=t.tenantId,n.environment=t.environment,n.username=t.username,n.name=t.name,n.loginHint=t.loginHint,n.cloudGraphHostName=r,n.msGraphHost=a,n.tenantProfiles=Array.from(t.tenantProfiles?.values()||[]),n.dataBoundary=t.dataBoundary,n}static generateHomeAccountId(t,r,a,n,e){if(!(r===qu.Adfs||r===qu.Dsts)){if(t)try{const p=M2(t,n.base64Decode);if(p.uid&&p.utid)return`${p.uid}.${p.utid}`}catch{}a.warning("No client info in response")}return e?.sub||""}static isAccountEntity(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("localAccountId")&&t.hasOwnProperty("username")&&t.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(t,r,a){if(!t||!r)return!1;let n=!0;if(a){const e=t.idTokenClaims||{},p=r.idTokenClaims||{};n=e.iat===p.iat&&e.nonce===p.nonce}return t.homeAccountId===r.homeAccountId&&t.localAccountId===r.localAccountId&&t.username===r.username&&t.tenantId===r.tenantId&&t.loginHint===r.loginHint&&t.environment===r.environment&&t.nativeAccountId===r.nativeAccountId&&n}}function _h(i,t){const r=cC(i);try{const a=t(r);return JSON.parse(a)}catch{throw Qt($v)}}function Fh(i){if(!i.signin_state)return!1;const t=["kmsi","dvc_dmjd"];return i.signin_state.some(a=>t.includes(a.trim().toLowerCase()))}function cC(i){if(!i)throw Qt(gw);const r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(i);if(!r||r.length<4)throw Qt($v);return r[2]}function Kw(i,t){if(t===0||Date.now()-3e5>i+t)throw Qt(Sw)}function Px(i){if(!i)return i;let t=i.toLowerCase();return Uc.endsWith(t,"?")?t=t.slice(0,-1):Uc.endsWith(t,"?/")&&(t=t.slice(0,-2)),Uc.endsWith(t,"/")||(t+="/"),t}function Yw(i){return i.startsWith("#/")?i.substring(2):i.startsWith("#")||i.startsWith("?")?i.substring(1):i}function U2(i){if(!i||i.indexOf("=")<0)return null;try{const t=Yw(i),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch{throw Qt(bw)}return null}function Lm(i,t=!0,r){const a=new Array;return i.forEach((n,e)=>{!t&&r&&e in r?a.push(`${e}=${n}`):a.push(`${e}=${encodeURIComponent(n)}`)}),a.join("&")}function Mx(i){if(!i)return i;const t=i.split("#")[0];try{const r=new URL(t),a=r.origin+r.pathname+r.search;return Px(a)}catch{return Px(t)}}class Da{get urlString(){return this._urlString}constructor(t){if(this._urlString=t,!this._urlString)throw ms(Ow);t.includes("#")||(this._urlString=Da.canonicalizeUri(t))}static canonicalizeUri(t){if(t){let r=t.toLowerCase();return Uc.endsWith(r,"?")?r=r.slice(0,-1):Uc.endsWith(r,"?/")&&(r=r.slice(0,-2)),Uc.endsWith(r,"/")||(r+="/"),r}return t}validateAsUri(){let t;try{t=this.getUrlComponents()}catch{throw ms(Am)}if(!t.HostNameAndPort||!t.PathSegments)throw ms(Am);if(!t.Protocol||t.Protocol.toLowerCase()!=="https:")throw ms(jw)}static appendQueryString(t,r){return r?t.indexOf("?")<0?`${t}?${r}`:`${t}&${r}`:t}static removeHashFromUrl(t){return Da.canonicalizeUri(t.split("#")[0])}replaceTenantPath(t){const r=this.getUrlComponents(),a=r.PathSegments;return t&&a.length!==0&&(a[0]===bf.COMMON||a[0]===bf.ORGANIZATIONS)&&(a[0]=t),Da.constructAuthorityUriFromObject(r)}getUrlComponents(){const t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=this.urlString.match(t);if(!r)throw ms(Am);const a={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5],QueryString:r[7]};let n=a.AbsolutePath.split("/");return n=n.filter(e=>e&&e.length>0),a.PathSegments=n,a.QueryString&&a.QueryString.endsWith("/")&&(a.QueryString=a.QueryString.substring(0,a.QueryString.length-1)),a}static getDomainFromUrl(t){const r=RegExp("^([^:/?#]+://)?([^/?#]*)"),a=t.match(r);if(!a)throw ms(Am);return a[2]}static getAbsoluteUrl(t,r){if(t[0]===Pt.FORWARD_SLASH){const n=new Da(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t}static constructAuthorityUriFromObject(t){return new Da(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))}static hashContainsKnownProperties(t){return!!U2(t)}}const Jw={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Ux=Jw.endpointMetadata,nb=Jw.instanceDiscoveryMetadata,Qw=new Set;nb.metadata.forEach(i=>{i.aliases.forEach(t=>{Qw.add(t)})});function uC(i,t){let r;const a=i.canonicalAuthority;if(a){const n=new Da(a).getUrlComponents().HostNameAndPort;r=Bx(n,i.cloudDiscoveryMetadata?.metadata,Lc.CONFIG,t)||Bx(n,nb.metadata,Lc.HARDCODED_VALUES,t)||i.knownAuthorities}return r||[]}function Bx(i,t,r,a){if(a?.trace(`getAliasesFromMetadata called with source: ${r}`),i&&t){const n=B2(t,i);if(n)return a?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),n.aliases;a?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function hC(i){return B2(nb.metadata,i)}function B2(i,t){for(let r=0;r<i.length;r++){const a=i[r];if(a.aliases.includes(t))return a}return null}const H2="cache_quota_exceeded",ab="cache_error_unknown";const o5={[H2]:"Exceeded cache storage capacity.",[ab]:"Unexpected error occurred when using cache storage."};class V1 extends gs{constructor(t,r){const a=r||(o5[t]?o5[t]:o5[ab]);super(`${t}: ${a}`),Object.setPrototypeOf(this,V1.prototype),this.name="CacheError",this.errorCode=t,this.errorMessage=a}}function Y5(i){return i instanceof Error?i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED"||i.message.includes("exceeded the quota")?new V1(H2):new V1(i.name,i.message):new V1(ab)}class J5{constructor(t,r,a,n,e){this.clientId=t,this.cryptoImpl=r,this.commonLogger=a.clone(Fw,Yv),this.staticAuthorityOptions=e,this.performanceClient=n}getAllAccounts(t,r){return this.buildTenantProfiles(this.getAccountsFilteredBy(t,r),r,t)}getAccountInfoFilteredBy(t,r){if(Object.keys(t).length===0||Object.values(t).every(n=>!n))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const a=this.getAllAccounts(t,r);return a.length>1?a.sort(e=>e.idTokenClaims?-1:1)[0]:a.length===1?a[0]:null}getBaseAccountInfo(t,r){const a=this.getAccountsFilteredBy(t,r);return a.length>0?Fi.getAccountInfo(a[0]):null}buildTenantProfiles(t,r,a){return t.flatMap(n=>this.getTenantProfilesFromAccountEntity(n,r,a?.tenantId,a))}getTenantedAccountInfoByFilter(t,r,a,n,e){let p=null,m;if(e&&!this.tenantProfileMatchesFilter(a,e))return null;const y=this.getIdToken(t,n,r,a.tenantId);return y&&(m=_h(y.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(m,e))?null:(p=tb(t,a,m,y?.secret),p)}getTenantProfilesFromAccountEntity(t,r,a,n){const e=Fi.getAccountInfo(t);let p=e.tenantProfiles||new Map;const m=this.getTokenKeys();if(a){const w=p.get(a);if(w)p=new Map([[a,w]]);else return[]}const y=[];return p.forEach(w=>{const A=this.getTenantedAccountInfoByFilter(e,m,w,r,n);A&&y.push(A)}),y}tenantProfileMatchesFilter(t,r){return!(r.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(t,r.localAccountId)||r.name&&t.name!==r.name||r.isHomeTenant!==void 0&&t.isHomeTenant!==r.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(t,r){return!(r&&(r.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(t,r.localAccountId)||r.loginHint&&!this.matchLoginHintFromTokenClaims(t,r.loginHint)||r.username&&!this.matchUsername(t.preferred_username,r.username)||r.name&&!this.matchName(t,r.name)||r.sid&&!this.matchSid(t,r.sid)))}async saveCacheRecord(t,r,a,n){if(!t)throw Qt(Ew);try{t.account&&await this.setAccount(t.account,r,a),t.idToken&&n?.idToken!==!1&&await this.setIdTokenCredential(t.idToken,r,a),t.accessToken&&n?.accessToken!==!1&&await this.saveAccessToken(t.accessToken,r,a),t.refreshToken&&n?.refreshToken!==!1&&await this.setRefreshTokenCredential(t.refreshToken,r,a),t.appMetadata&&this.setAppMetadata(t.appMetadata,r)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof gs?e:Y5(e)}}async saveAccessToken(t,r,a){const n={clientId:t.clientId,credentialType:t.credentialType,environment:t.environment,homeAccountId:t.homeAccountId,realm:t.realm,tokenType:t.tokenType,requestedClaimsHash:t.requestedClaimsHash},e=this.getTokenKeys(),p=ro.fromString(t.target);e.accessToken.forEach(m=>{if(!this.accessTokenKeyMatchesFilter(m,n,!1))return;const y=this.getAccessTokenCredential(m,r);y&&this.credentialMatchesFilter(y,n)&&ro.fromString(y.target).intersectingScopeSets(p)&&this.removeAccessToken(m,r)}),await this.setAccessTokenCredential(t,r,a)}getAccountsFilteredBy(t,r){const a=this.getAccountKeys(),n=[];return a.forEach(e=>{const p=this.getAccount(e,r);if(!p||t.homeAccountId&&!this.matchHomeAccountId(p,t.homeAccountId)||t.username&&!this.matchUsername(p.username,t.username)||t.environment&&!this.matchEnvironment(p,t.environment)||t.realm&&!this.matchRealm(p,t.realm)||t.nativeAccountId&&!this.matchNativeAccountId(p,t.nativeAccountId)||t.authorityType&&!this.matchAuthorityType(p,t.authorityType))return;const m={localAccountId:t?.localAccountId,name:t?.name},y=p.tenantProfiles?.filter(w=>this.tenantProfileMatchesFilter(w,m));y&&y.length===0||n.push(p)}),n}credentialMatchesFilter(t,r){return!(r.clientId&&!this.matchClientId(t,r.clientId)||r.userAssertionHash&&!this.matchUserAssertionHash(t,r.userAssertionHash)||typeof r.homeAccountId=="string"&&!this.matchHomeAccountId(t,r.homeAccountId)||r.environment&&!this.matchEnvironment(t,r.environment)||r.realm&&!this.matchRealm(t,r.realm)||r.credentialType&&!this.matchCredentialType(t,r.credentialType)||r.familyId&&!this.matchFamilyId(t,r.familyId)||r.target&&!this.matchTarget(t,r.target)||(r.requestedClaimsHash||t.requestedClaimsHash)&&t.requestedClaimsHash!==r.requestedClaimsHash||t.credentialType===Bo.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(r.tokenType&&!this.matchTokenType(t,r.tokenType)||r.tokenType===rs.SSH&&r.keyId&&!this.matchKeyId(t,r.keyId)))}getAppMetadataFilteredBy(t){const r=this.getKeys(),a={};return r.forEach(n=>{if(!this.isAppMetadata(n))return;const e=this.getAppMetadata(n);e&&(t.environment&&!this.matchEnvironment(e,t.environment)||t.clientId&&!this.matchClientId(e,t.clientId)||(a[n]=e))}),a}getAuthorityMetadataByAlias(t){const r=this.getAuthorityMetadataKeys();let a=null;return r.forEach(n=>{if(!this.isAuthorityMetadata(n)||n.indexOf(this.clientId)===-1)return;const e=this.getAuthorityMetadata(n);e&&e.aliases.indexOf(t)!==-1&&(a=e)}),a}removeAllAccounts(t){this.getAllAccounts({},t).forEach(a=>{this.removeAccount(a,t)})}removeAccount(t,r){this.removeAccountContext(t,r);const a=this.getAccountKeys(),n=e=>e.includes(t.homeAccountId)&&e.includes(t.environment);a.filter(n).forEach(e=>{this.removeItem(e,r),this.performanceClient.incrementFields({accountsRemoved:1},r)})}removeAccountContext(t,r){const a=this.getTokenKeys(),n=e=>e.includes(t.homeAccountId)&&e.includes(t.environment);a.idToken.filter(n).forEach(e=>{this.removeIdToken(e,r)}),a.accessToken.filter(n).forEach(e=>{this.removeAccessToken(e,r)}),a.refreshToken.filter(n).forEach(e=>{this.removeRefreshToken(e,r)})}removeAccessToken(t,r){const a=this.getAccessTokenCredential(t,r);if(this.removeItem(t,r),this.performanceClient.incrementFields({accessTokensRemoved:1},r),!a||a.credentialType.toLowerCase()!==Bo.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||a.tokenType!==rs.POP)return;const n=a.keyId;n&&this.cryptoImpl.removeTokenBindingKey(n).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${n}`,r),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},r)})}removeAppMetadata(t){return this.getKeys().forEach(a=>{this.isAppMetadata(a)&&this.removeItem(a,t)}),!0}getIdToken(t,r,a,n,e){this.commonLogger.trace("CacheManager - getIdToken called");const p={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Bo.ID_TOKEN,clientId:this.clientId,realm:n},m=this.getIdTokensByFilter(p,r,a),y=m.size;if(y<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(y>1){let w=m;if(!n){const A=new Map;m.forEach((R,k)=>{R.realm===t.tenantId&&A.set(k,R)});const I=A.size;if(I<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),m.values().next().value;if(I===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),A.values().next().value;w=A}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),w.forEach((A,I)=>{this.removeIdToken(I,r)}),e&&r&&e.addFields({multiMatchedID:m.size},r),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),m.values().next().value}getIdTokensByFilter(t,r,a){const n=a&&a.idToken||this.getTokenKeys().idToken,e=new Map;return n.forEach(p=>{if(!this.idTokenKeyMatchesFilter(p,{clientId:this.clientId,...t}))return;const m=this.getIdTokenCredential(p,r);m&&this.credentialMatchesFilter(m,t)&&e.set(p,m)}),e}idTokenKeyMatchesFilter(t,r){const a=t.toLowerCase();return!(r.clientId&&a.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&a.indexOf(r.homeAccountId.toLowerCase())===-1)}removeIdToken(t,r){this.removeItem(t,r)}removeRefreshToken(t,r){this.removeItem(t,r)}getAccessToken(t,r,a,n){const e=r.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",e);const p=ro.createSearchScopes(r.scopes),m=r.authenticationScheme||rs.BEARER,y=m.toLowerCase()!==rs.BEARER.toLowerCase()?Bo.ACCESS_TOKEN_WITH_AUTH_SCHEME:Bo.ACCESS_TOKEN,w={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:y,clientId:this.clientId,realm:n||t.tenantId,target:p,tokenType:m,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},A=a&&a.accessToken||this.getTokenKeys().accessToken,I=[];A.forEach(k=>{if(this.accessTokenKeyMatchesFilter(k,w,!0)){const M=this.getAccessTokenCredential(k,e);M&&this.credentialMatchesFilter(M,w)&&I.push(M)}});const R=I.length;return R<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",e),null):R>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",e),I.forEach(k=>{this.removeAccessToken(this.generateCredentialKey(k),e)}),this.performanceClient.addFields({multiMatchedAT:I.length},e),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",e),I[0])}accessTokenKeyMatchesFilter(t,r,a){const n=t.toLowerCase();if(r.clientId&&n.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&n.indexOf(r.homeAccountId.toLowerCase())===-1||r.realm&&n.indexOf(r.realm.toLowerCase())===-1||r.requestedClaimsHash&&n.indexOf(r.requestedClaimsHash.toLowerCase())===-1)return!1;if(r.target){const e=r.target.asArray();for(let p=0;p<e.length;p++){if(a&&!n.includes(e[p].toLowerCase()))return!1;if(!a&&n.includes(e[p].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(t,r){const a=this.getTokenKeys(),n=[];return a.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,t,!0))return;const p=this.getAccessTokenCredential(e,r);p&&this.credentialMatchesFilter(p,t)&&n.push(p)}),n}getRefreshToken(t,r,a,n,e){this.commonLogger.trace("CacheManager - getRefreshToken called");const p=r?j2:void 0,m={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Bo.REFRESH_TOKEN,clientId:this.clientId,familyId:p},y=n&&n.refreshToken||this.getTokenKeys().refreshToken,w=[];y.forEach(I=>{if(this.refreshTokenKeyMatchesFilter(I,m)){const R=this.getRefreshTokenCredential(I,a);R&&this.credentialMatchesFilter(R,m)&&w.push(R)}});const A=w.length;return A<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(A>1&&e&&a&&e.addFields({multiMatchedRT:A},a),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),w[0])}refreshTokenKeyMatchesFilter(t,r){const a=t.toLowerCase();return!(r.familyId&&a.indexOf(r.familyId.toLowerCase())===-1||!r.familyId&&r.clientId&&a.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&a.indexOf(r.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(t){const r={environment:t,clientId:this.clientId},a=this.getAppMetadataFilteredBy(r),n=Object.keys(a).map(p=>a[p]),e=n.length;if(e<1)return null;if(e>1)throw Qt(Aw);return n[0]}isAppMetadataFOCI(t){const r=this.readAppMetadataFromCache(t);return!!(r&&r.familyId===j2)}matchHomeAccountId(t,r){return typeof t.homeAccountId=="string"&&r===t.homeAccountId}matchLocalAccountIdFromTokenClaims(t,r){const a=t.oid||t.sub;return r===a}matchLocalAccountIdFromTenantProfile(t,r){return t.localAccountId===r}matchName(t,r){return r.toLowerCase()===t.name?.toLowerCase()}matchUsername(t,r){return!!(t&&typeof t=="string"&&r?.toLowerCase()===t.toLowerCase())}matchUserAssertionHash(t,r){return!!(t.userAssertionHash&&r===t.userAssertionHash)}matchEnvironment(t,r){if(this.staticAuthorityOptions){const n=uC(this.staticAuthorityOptions,this.commonLogger);if(n.includes(r)&&n.includes(t.environment))return!0}const a=this.getAuthorityMetadataByAlias(r);return!!(a&&a.aliases.indexOf(t.environment)>-1)}matchCredentialType(t,r){return t.credentialType&&r.toLowerCase()===t.credentialType.toLowerCase()}matchClientId(t,r){return!!(t.clientId&&r===t.clientId)}matchFamilyId(t,r){return!!(t.familyId&&r===t.familyId)}matchRealm(t,r){return t.realm?.toLowerCase()===r.toLowerCase()}matchNativeAccountId(t,r){return!!(t.nativeAccountId&&r===t.nativeAccountId)}matchLoginHintFromTokenClaims(t,r){return t.login_hint===r||t.preferred_username===r||t.upn===r}matchSid(t,r){return t.sid===r}matchAuthorityType(t,r){return!!(t.authorityType&&r.toLowerCase()===t.authorityType.toLowerCase())}matchTarget(t,r){return t.credentialType!==Bo.ACCESS_TOKEN&&t.credentialType!==Bo.ACCESS_TOKEN_WITH_AUTH_SCHEME||!t.target?!1:ro.fromString(t.target).containsScopeSet(r)}matchTokenType(t,r){return!!(t.tokenType&&t.tokenType===r)}matchKeyId(t,r){return!!(t.keyId&&t.keyId===r)}isAppMetadata(t){return t.indexOf(Hv)!==-1}isAuthorityMetadata(t){return t.indexOf(O2.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(t){return`${O2.CACHE_KEY}-${this.clientId}-${t}`}static toObject(t,r){for(const a in r)t[a]=r[a];return t}}class dC extends J5{async setAccount(){throw Qt(Yn)}getAccount(){throw Qt(Yn)}async setIdTokenCredential(){throw Qt(Yn)}getIdTokenCredential(){throw Qt(Yn)}async setAccessTokenCredential(){throw Qt(Yn)}getAccessTokenCredential(){throw Qt(Yn)}async setRefreshTokenCredential(){throw Qt(Yn)}getRefreshTokenCredential(){throw Qt(Yn)}setAppMetadata(){throw Qt(Yn)}getAppMetadata(){throw Qt(Yn)}setServerTelemetry(){throw Qt(Yn)}getServerTelemetry(){throw Qt(Yn)}setAuthorityMetadata(){throw Qt(Yn)}getAuthorityMetadata(){throw Qt(Yn)}getAuthorityMetadataKeys(){throw Qt(Yn)}setThrottlingCache(){throw Qt(Yn)}getThrottlingCache(){throw Qt(Yn)}removeItem(){throw Qt(Yn)}getKeys(){throw Qt(Yn)}getAccountKeys(){throw Qt(Yn)}getTokenKeys(){throw Qt(Yn)}generateCredentialKey(){throw Qt(Yn)}generateAccountKey(){throw Qt(Yn)}}const Ye={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},fC={InProgress:1};class Hx{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class Xw{generateId(){return"callback-id"}startMeasurement(t,r){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:fC.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:t,startTimeMs:Date.now(),correlationId:r||""},measurement:new Hx}}startPerformanceMeasurement(){return new Hx}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const Zw={tokenRenewalOffsetSeconds:pw,preventCorsPreflight:!1},pC={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Qs.Info,correlationId:Pt.EMPTY_STRING},mC={claimsBasedCachingEnabled:!1},gC={async sendGetRequestAsync(){throw Qt(Yn)},async sendPostRequestAsync(){throw Qt(Yn)}},yC={sku:Pt.SKU,version:Yv,cpu:Pt.EMPTY_STRING,os:Pt.EMPTY_STRING},vC={clientSecret:Pt.EMPTY_STRING,clientAssertion:void 0},bC={azureCloudInstance:Jv.None,tenant:`${Pt.DEFAULT_COMMON_TENANT}`},xC={application:{appName:"",appVersion:""}};function wC({authOptions:i,systemOptions:t,loggerOptions:r,cacheOptions:a,storageInterface:n,networkInterface:e,cryptoInterface:p,clientCredentials:m,libraryInfo:y,telemetry:w,serverTelemetryManager:A,persistencePlugin:I,serializableCache:R}){const k={...pC,...r};return{authOptions:SC(i),systemOptions:{...Zw,...t},loggerOptions:k,cacheOptions:{...mC,...a},storageInterface:n||new dC(i.clientId,P2,new vd(k),new Xw),networkInterface:e||gC,cryptoInterface:p||P2,clientCredentials:m||vC,libraryInfo:{...yC,...y},telemetry:{...xC,...w},serverTelemetryManager:A||null,persistencePlugin:I||null,serializableCache:R||null}}function SC(i){return{clientCapabilities:[],azureCloudOptions:bC,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...i}}function e6(i){return i.authOptions.authority.options.protocolMode===oc.OIDC}const Vu={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};const E0="client_id",t6="redirect_uri",AC="response_type",CC="response_mode",NC="grant_type",TC="claims",EC="scope",kC="refresh_token",_C="state",IC="nonce",DC="prompt",FC="code",RC="code_challenge",jC="code_challenge_method",OC="code_verifier",LC="client-request-id",PC="x-client-SKU",MC="x-client-VER",UC="x-client-OS",BC="x-client-CPU",HC="x-client-current-telemetry",zC="x-client-last-telemetry",$C="x-ms-lib-capability",qC="x-app-name",GC="x-app-ver",VC="post_logout_redirect_uri",WC="id_token_hint",KC="client_secret",YC="client_assertion",JC="client_assertion_type",r6="token_type",n6="req_cnf",zx="return_spa_code",QC="nativebroker",XC="logout_hint",ZC="sid",eN="login_hint",tN="domain_hint",rN="x-client-xtra-sku",z2="brk_client_id",$2="brk_redirect_uri",Q5="instance_aware",nN="ear_jwk",aN="ear_jwe_crypto";function vy(i,t,r){if(!t)return;const a=i.get(E0);a&&i.has(z2)&&r?.addFields({embeddedClientId:a,embeddedRedirectUri:i.get(t6)},t)}function sb(i,t){i.set(AC,t)}function sN(i,t){i.set(CC,t||BA.QUERY)}function iN(i){i.set(QC,"1")}function ib(i,t,r=!0,a=op){r&&!a.includes("openid")&&!t.includes("openid")&&a.push("openid");const n=r?[...t||[],...a]:t||[],e=new ro(n);i.set(EC,e.printScopes())}function ob(i,t){i.set(E0,t)}function lb(i,t){i.set(t6,t)}function oN(i,t){i.set(VC,t)}function lN(i,t){i.set(WC,t)}function cN(i,t){i.set(tN,t)}function Qg(i,t){i.set(eN,t)}function q2(i,t){i.set(Il.CCS_HEADER,`UPN:${t}`)}function Em(i,t){i.set(Il.CCS_HEADER,`Oid:${t.uid}@${t.utid}`)}function $x(i,t){i.set(ZC,t)}function cb(i,t,r){const a=mN(t,r);try{JSON.parse(a)}catch{throw ms(Qv)}i.set(TC,a)}function ub(i,t){i.set(LC,t)}function hb(i,t){i.set(PC,t.sku),i.set(MC,t.version),t.os&&i.set(UC,t.os),t.cpu&&i.set(BC,t.cpu)}function db(i,t){t?.appName&&i.set(qC,t.appName),t?.appVersion&&i.set(GC,t.appVersion)}function uN(i,t){i.set(DC,t)}function a6(i,t){t&&i.set(_C,t)}function hN(i,t){i.set(IC,t)}function fb(i,t,r){if(t&&r)i.set(RC,t),i.set(jC,r);else throw ms(Xv)}function dN(i,t){i.set(FC,t)}function fN(i,t){i.set(kC,t)}function pN(i,t){i.set(OC,t)}function s6(i,t){i.set(KC,t)}function i6(i,t){t&&i.set(YC,t)}function o6(i,t){t&&i.set(JC,t)}function l6(i,t){i.set(NC,t)}function pb(i){i.set(HA,"1")}function c6(i){i.has(Q5)||i.set(Q5,"true")}function wf(i,t){Object.entries(t).forEach(([r,a])=>{!i.has(r)&&a&&i.set(r,a)})}function mN(i,t){let r;if(!i)r={};else try{r=JSON.parse(i)}catch{throw ms(Qv)}return t&&t.length>0&&(r.hasOwnProperty(Yg.ACCESS_TOKEN)||(r[Yg.ACCESS_TOKEN]={}),r[Yg.ACCESS_TOKEN][Yg.XMS_CC]={values:t}),JSON.stringify(r)}function mb(i,t){t&&(i.set(r6,rs.POP),i.set(n6,t))}function u6(i,t){t&&(i.set(r6,rs.SSH),i.set(n6,t))}function h6(i,t){i.set(HC,t.generateCurrentRequestHeaderValue()),i.set(zC,t.generateLastRequestHeaderValue())}function d6(i){i.set($C,Tm.X_MS_LIB_CAPABILITY_VALUE)}function gN(i,t){i.set(XC,t)}function by(i,t,r){i.has(z2)||i.set(z2,t),i.has($2)||i.set($2,r)}function yN(i,t){i.set(nN,encodeURIComponent(t)),i.set(aN,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}function vN(i,t){Object.entries(t).forEach(([r,a])=>{a&&i.set(r,a)})}function bN(i){return i.hasOwnProperty("authorization_endpoint")&&i.hasOwnProperty("token_endpoint")&&i.hasOwnProperty("issuer")&&i.hasOwnProperty("jwks_uri")}function xN(i){return i.hasOwnProperty("tenant_discovery_endpoint")&&i.hasOwnProperty("metadata")}function wN(i){return i.hasOwnProperty("error")&&i.hasOwnProperty("error_description")}const Bc=(i,t,r,a,n)=>(...e)=>{r.trace(`Executing function ${t}`);const p=a?.startMeasurement(t,n);if(n){const m=t+"CallCount";a?.incrementFields({[m]:1},n)}try{const m=i(...e);return p?.end({success:!0}),r.trace(`Returning result from ${t}`),m}catch(m){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(m))}catch{r.trace("Unable to print error message.")}throw p?.end({success:!1},m),m}},It=(i,t,r,a,n)=>(...e)=>{r.trace(`Executing function ${t}`);const p=a?.startMeasurement(t,n);if(n){const m=t+"CallCount";a?.incrementFields({[m]:1},n)}return a?.setPreQueueTime(t,n),i(...e).then(m=>(r.trace(`Returning result from ${t}`),p?.end({success:!0}),m)).catch(m=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(m))}catch{r.trace("Unable to print error message.")}throw p?.end({success:!1},m),m})};class xy{constructor(t,r,a,n){this.networkInterface=t,this.logger=r,this.performanceClient=a,this.correlationId=n}async detectRegion(t,r){this.performanceClient?.addQueueMeasurement(Ye.RegionDiscoveryDetectRegion,this.correlationId);let a=t;if(a)r.region_source=F1.ENVIRONMENT_VARIABLE;else{const n=xy.IMDS_OPTIONS;try{const e=await It(this.getRegionFromIMDS.bind(this),Ye.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(Pt.IMDS_VERSION,n);if(e.status===gf.SUCCESS&&(a=e.body,r.region_source=F1.IMDS),e.status===gf.BAD_REQUEST){const p=await It(this.getCurrentVersion.bind(this),Ye.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(n);if(!p)return r.region_source=F1.FAILED_AUTO_DETECTION,null;const m=await It(this.getRegionFromIMDS.bind(this),Ye.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(p,n);m.status===gf.SUCCESS&&(a=m.body,r.region_source=F1.IMDS)}}catch{return r.region_source=F1.FAILED_AUTO_DETECTION,null}}return a||(r.region_source=F1.FAILED_AUTO_DETECTION),a||null}async getRegionFromIMDS(t,r){return this.performanceClient?.addQueueMeasurement(Ye.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${Pt.IMDS_ENDPOINT}?api-version=${t}&format=text`,r,Pt.IMDS_TIMEOUT)}async getCurrentVersion(t){this.performanceClient?.addQueueMeasurement(Ye.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${Pt.IMDS_ENDPOINT}?format=json`,t);return r.status===gf.BAD_REQUEST&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}xy.IMDS_OPTIONS={headers:{Metadata:"true"}};function lc(){return Math.round(new Date().getTime()/1e3)}function qx(i){return i.getTime()/1e3}function W1(i){return i?new Date(Number(i)*1e3):new Date}function G2(i,t){const r=Number(i)||0;return lc()+t>r}function Gx(i,t){const r=Number(i)+t*24*60*60*1e3;return Date.now()>r}function SN(i){return Number(i)>lc()}function wy(i,t,r,a,n){return{credentialType:Bo.ID_TOKEN,homeAccountId:i,environment:t,clientId:a,secret:r,realm:n,lastUpdatedAt:Date.now().toString()}}function Sy(i,t,r,a,n,e,p,m,y,w,A,I,R,k,M){const V={homeAccountId:i,credentialType:Bo.ACCESS_TOKEN,secret:r,cachedAt:lc().toString(),expiresOn:p.toString(),extendedExpiresOn:m.toString(),environment:t,clientId:a,realm:n,target:e,tokenType:A||rs.BEARER,lastUpdatedAt:Date.now().toString()};if(I&&(V.userAssertionHash=I),w&&(V.refreshOn=w.toString()),k&&(V.requestedClaims=k,V.requestedClaimsHash=M),V.tokenType?.toLowerCase()!==rs.BEARER.toLowerCase())switch(V.credentialType=Bo.ACCESS_TOKEN_WITH_AUTH_SCHEME,V.tokenType){case rs.POP:const q=_h(r,y);if(!q?.cnf?.kid)throw Qt(kw);V.keyId=q.cnf.kid;break;case rs.SSH:V.keyId=R}return V}function f6(i,t,r,a,n,e,p){const m={credentialType:Bo.REFRESH_TOKEN,homeAccountId:i,environment:t,clientId:a,secret:r,lastUpdatedAt:Date.now().toString()};return e&&(m.userAssertionHash=e),n&&(m.familyId=n),p&&(m.expiresOn=p.toString()),m}function Ay(i){return i.hasOwnProperty("homeAccountId")&&i.hasOwnProperty("environment")&&i.hasOwnProperty("credentialType")&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("secret")}function Vx(i){return i?Ay(i)&&i.hasOwnProperty("realm")&&i.hasOwnProperty("target")&&(i.credentialType===Bo.ACCESS_TOKEN||i.credentialType===Bo.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function AN(i){return i?Ay(i)&&i.hasOwnProperty("realm")&&i.credentialType===Bo.ID_TOKEN:!1}function Wx(i){return i?Ay(i)&&i.credentialType===Bo.REFRESH_TOKEN:!1}function CN(i,t){const r=i.indexOf(Uo.CACHE_KEY)===0;let a=!0;return t&&(a=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&a}function NN(i,t){let r=!1;i&&(r=i.indexOf(Tm.THROTTLING_PREFIX)===0);let a=!0;return t&&(a=t.hasOwnProperty("throttleTime")),r&&a}function TN({environment:i,clientId:t}){return[Hv,i,t].join(Om.CACHE_KEY_SEPARATOR).toLowerCase()}function EN(i,t){return t?i.indexOf(Hv)===0&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"):!1}function kN(i,t){return t?i.indexOf(O2.CACHE_KEY)===0&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"):!1}function Kx(){return lc()+O2.REFRESH_TIME_SECONDS}function Xg(i,t,r){i.authorization_endpoint=t.authorization_endpoint,i.token_endpoint=t.token_endpoint,i.end_session_endpoint=t.end_session_endpoint,i.issuer=t.issuer,i.endpointsFromNetwork=r,i.jwks_uri=t.jwks_uri}function l5(i,t,r){i.aliases=t.aliases,i.preferred_cache=t.preferred_cache,i.preferred_network=t.preferred_network,i.aliasesFromNetwork=r}function Yx(i){return i.expiresAt<=lc()}class hl{constructor(t,r,a,n,e,p,m,y){this.canonicalAuthority=t,this._canonicalAuthority.validateAsUri(),this.networkInterface=r,this.cacheManager=a,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=e,this.performanceClient=m,this.correlationId=p,this.managedIdentity=y||!1,this.regionDiscovery=new xy(r,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(t){if(t.HostNameAndPort.endsWith(Pt.CIAM_AUTH_URL))return qu.Ciam;const r=t.PathSegments;if(r.length)switch(r[0].toLowerCase()){case Pt.ADFS:return qu.Adfs;case Pt.DSTS:return qu.Dsts}return qu.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(t){this._canonicalAuthority=new Da(t),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Qt(fd)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Qt(fd)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Qt(fd)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Qt(Dw);return this.replacePath(this.metadata.end_session_endpoint)}else throw Qt(fd)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Qt(fd)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Qt(fd)}canReplaceTenant(t){return t.PathSegments.length===1&&!hl.reservedTenantDomains.has(t.PathSegments[0])&&this.getAuthorityType(t)===qu.Default&&this.protocolMode!==oc.OIDC}replaceTenant(t){return t.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(t){let r=t;const n=new Da(this.metadata.canonical_authority).getUrlComponents(),e=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((m,y)=>{let w=e[y];if(y===0&&this.canReplaceTenant(n)){const A=new Da(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];w!==A&&(this.logger.verbose(`Replacing tenant domain name ${w} with id ${A}`),w=A)}m!==w&&(r=r.replace(`/${w}/`,`/${m}/`))}),this.replaceTenant(r)}get defaultOpenIdConfigurationEndpoint(){const t=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===qu.Adfs||this.protocolMode===oc.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(t)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Ye.AuthorityResolveEndpointsAsync,this.correlationId);const t=this.getCurrentMetadataEntity(),r=await It(this.updateCloudDiscoveryMetadata.bind(this),Ye.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(t);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,t.preferred_network);const a=await It(this.updateEndpointMetadata.bind(this),Ye.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(t);this.updateCachedMetadata(t,r,{source:a}),this.performanceClient?.addFields({cloudDiscoverySource:r,authorityEndpointSource:a},this.correlationId)}getCurrentMetadataEntity(){let t=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return t||(t={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Kx(),jwks_uri:""}),t}updateCachedMetadata(t,r,a){r!==Lc.CACHE&&a?.source!==Lc.CACHE&&(t.expiresAt=Kx(),t.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(t.preferred_cache);this.cacheManager.setAuthorityMetadata(n,t),this.metadata=t}async updateEndpointMetadata(t){this.performanceClient?.addQueueMeasurement(Ye.AuthorityUpdateEndpointMetadata,this.correlationId);const r=this.updateEndpointMetadataFromLocalSources(t);if(r){if(r.source===Lc.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&r.metadata){const n=await It(this.updateMetadataWithRegionalInformation.bind(this),Ye.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r.metadata);Xg(t,n,!1),t.canonical_authority=this.canonicalAuthority}return r.source}let a=await It(this.getEndpointMetadataFromNetwork.bind(this),Ye.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(a=await It(this.updateMetadataWithRegionalInformation.bind(this),Ye.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(a)),Xg(t,a,!0),Lc.NETWORK;throw Qt(vw,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(t){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const r=this.getEndpointMetadataFromConfig();if(r)return this.logger.verbose("Found endpoint metadata in authority configuration"),Xg(t,r,!1),{source:Lc.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const n=this.getEndpointMetadataFromHardcodedValues();if(n)return Xg(t,n,!1),{source:Lc.HARDCODED_VALUES,metadata:n};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const a=Yx(t);return this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!a?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Lc.CACHE}):(a&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(t){return new Da(t.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw ms(Uw)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Ye.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const t={},r=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${r}`);try{const a=await this.networkInterface.sendGetRequestAsync(r,t);return bN(a.body)?a.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(a){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${a}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Ux?Ux[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(t){this.performanceClient?.addQueueMeasurement(Ye.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const r=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(r){if(r!==Pt.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=i5.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=r,hl.replaceWithRegionalInformation(t,r);const a=await It(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Ye.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=i5.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,hl.replaceWithRegionalInformation(t,a);this.regionDiscoveryMetadata.region_outcome=i5.AUTO_DETECTION_REQUESTED_FAILED}return t}async updateCloudDiscoveryMetadata(t){this.performanceClient?.addQueueMeasurement(Ye.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const r=this.updateCloudDiscoveryMetadataFromLocalSources(t);if(r)return r;const a=await It(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Ye.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return l5(t,a,!0),Lc.NETWORK;throw ms(Bw)}updateCloudDiscoveryMetadataFromLocalSources(t){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||Pt.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||Pt.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${t.canonical_authority||Pt.NOT_APPLICABLE}`);const r=this.getCloudDiscoveryMetadataFromConfig();if(r)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),l5(t,r,!1),Lc.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const n=hC(this.hostnameAndPort);if(n)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),l5(t,n,!1),Lc.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const a=Yx(t);return this.isAuthoritySameType(t)&&t.aliasesFromNetwork&&!a?(this.logger.verbose("Found cloud discovery metadata in the cache."),Lc.CACHE):(a&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===qu.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),hl.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=B2(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),ms(Zv)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),hl.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Ye.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const t=`${Pt.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,r={};let a=null;try{const n=await this.networkInterface.sendGetRequestAsync(t,r);let e,p;if(xN(n.body))e=n.body,p=e.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${e.tenant_discovery_endpoint}`);else if(wN(n.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),e=n.body,e.error===Pt.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${e.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${e.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),p=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),a=B2(p,this.hostnameAndPort)}catch(n){if(n instanceof gs)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${n.errorCode}
Error Description: ${n.errorMessage}`);else{const e=n;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${e.name}
Error Description: ${e.message}`)}return null}return a||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),a=hl.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),a}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(r=>r&&Da.getDomainFromUrl(r).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(t,r){let a;if(r&&r.azureCloudInstance!==Jv.None){const n=r.tenant?r.tenant:Pt.DEFAULT_COMMON_TENANT;a=`${r.azureCloudInstance}/${n}/`}return a||t}static createCloudDiscoveryMetadataFromHost(t){return{preferred_network:t,preferred_cache:t,aliases:[t]}}getPreferredCache(){if(this.managedIdentity)return Pt.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Qt(fd)}isAlias(t){return this.metadata.aliases.indexOf(t)>-1}isAliasOfKnownMicrosoftAuthority(t){return Qw.has(t)}static isPublicCloudAuthority(t){return Pt.KNOWN_PUBLIC_CLOUDS.indexOf(t)>=0}static buildRegionalAuthorityString(t,r,a){const n=new Da(t);n.validateAsUri();const e=n.getUrlComponents();let p=`${r}.${e.HostNameAndPort}`;this.isPublicCloudAuthority(e.HostNameAndPort)&&(p=`${r}.${Pt.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const m=Da.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:p}).urlString;return a?`${m}?${a}`:m}static replaceWithRegionalInformation(t,r){const a={...t};return a.authorization_endpoint=hl.buildRegionalAuthorityString(a.authorization_endpoint,r),a.token_endpoint=hl.buildRegionalAuthorityString(a.token_endpoint,r),a.end_session_endpoint&&(a.end_session_endpoint=hl.buildRegionalAuthorityString(a.end_session_endpoint,r)),a}static transformCIAMAuthority(t){let r=t;const n=new Da(t).getUrlComponents();if(n.PathSegments.length===0&&n.HostNameAndPort.endsWith(Pt.CIAM_AUTH_URL)){const e=n.HostNameAndPort.split(".")[0];r=`${r}${e}${Pt.AAD_TENANT_DOMAIN_SUFFIX}`}return r}}hl.reservedTenantDomains=new Set(["{tenant}","{tenantid}",bf.COMMON,bf.CONSUMERS,bf.ORGANIZATIONS]);function _N(i){const a=new Da(i).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(a){case bf.COMMON:case bf.ORGANIZATIONS:case bf.CONSUMERS:return;default:return a}}function p6(i){return i.endsWith(Pt.FORWARD_SLASH)?i:`${i}${Pt.FORWARD_SLASH}`}function IN(i){const t=i.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch{throw ms(Zv)}return{canonicalAuthority:i.authority?p6(i.authority):void 0,knownAuthorities:i.knownAuthorities,cloudDiscoveryMetadata:r}}async function m6(i,t,r,a,n,e,p){p?.addQueueMeasurement(Ye.AuthorityFactoryCreateDiscoveredInstance,e);const m=hl.transformCIAMAuthority(p6(i)),y=new hl(m,t,r,a,n,e,p);try{return await It(y.resolveEndpointsAsync.bind(y),Ye.AuthorityResolveEndpointsAsync,n,p,e)(),y}catch{throw Qt(fd)}}class O0 extends gs{constructor(t,r,a,n,e){super(t,r,a),this.name="ServerError",this.errorNo=n,this.status=e,Object.setPrototypeOf(this,O0.prototype)}}function Cy(i,t,r){return{clientId:i,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}class Eh{static generateThrottlingStorageKey(t){return`${Tm.THROTTLING_PREFIX}.${JSON.stringify(t)}`}static preProcess(t,r,a){const n=Eh.generateThrottlingStorageKey(r),e=t.getThrottlingCache(n);if(e){if(e.throttleTime<Date.now()){t.removeItem(n,a);return}throw new O0(e.errorCodes?.join(" ")||Pt.EMPTY_STRING,e.errorMessage,e.subError)}}static postProcess(t,r,a,n){if(Eh.checkResponseStatus(a)||Eh.checkResponseForRetryAfter(a)){const e={throttleTime:Eh.calculateThrottleTime(parseInt(a.headers[Il.RETRY_AFTER])),error:a.body.error,errorCodes:a.body.error_codes,errorMessage:a.body.error_description,subError:a.body.suberror};t.setThrottlingCache(Eh.generateThrottlingStorageKey(r),e,n)}}static checkResponseStatus(t){return t.status===429||t.status>=500&&t.status<600}static checkResponseForRetryAfter(t){return t.headers?t.headers.hasOwnProperty(Il.RETRY_AFTER)&&(t.status<200||t.status>=300):!1}static calculateThrottleTime(t){const r=t<=0?0:t,a=Date.now()/1e3;return Math.floor(Math.min(a+(r||Tm.DEFAULT_THROTTLE_TIME_SECONDS),a+Tm.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(t,r,a,n){const e=Cy(r,a,n),p=this.generateThrottlingStorageKey(e);t.removeItem(p,a.correlationId)}}class Ny extends gs{constructor(t,r,a){super(t.errorCode,t.errorMessage,t.subError),Object.setPrototypeOf(this,Ny.prototype),this.name="NetworkError",this.error=t,this.httpStatus=r,this.responseHeaders=a}}function Cm(i,t,r,a){return i.errorMessage=`${i.errorMessage}, additionalErrorInfo: error.name:${a?.name}, error.message:${a?.message}`,new Ny(i,t,r)}class gb{constructor(t,r){this.config=wC(t),this.logger=new vd(this.config.loggerOptions,Fw,Yv),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=r}createTokenRequestHeaders(t){const r={};if(r[Il.CONTENT_TYPE]=Pt.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case Vu.HOME_ACCOUNT_ID:try{const a=G1(t.credential);r[Il.CCS_HEADER]=`Oid:${a.uid}@${a.utid}`}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Vu.UPN:r[Il.CCS_HEADER]=`UPN: ${t.credential}`;break}return r}async executePostToTokenEndpoint(t,r,a,n,e,p){p&&this.performanceClient?.addQueueMeasurement(p,e);const m=await this.sendPostRequest(n,t,{body:r,headers:a},e);return this.config.serverTelemetryManager&&m.status<500&&m.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),m}async sendPostRequest(t,r,a,n){Eh.preProcess(this.cacheManager,t,n);let e;try{e=await It(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Ye.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,n)(r,a);const p=e.headers||{};this.performanceClient?.addFields({refreshTokenSize:e.body.refresh_token?.length||0,httpVerToken:p[Il.X_MS_HTTP_VERSION]||"",requestId:p[Il.X_MS_REQUEST_ID]||""},n)}catch(p){if(p instanceof Ny){const m=p.responseHeaders;throw m&&this.performanceClient?.addFields({httpVerToken:m[Il.X_MS_HTTP_VERSION]||"",requestId:m[Il.X_MS_REQUEST_ID]||"",contentTypeHeader:m[Il.CONTENT_TYPE]||void 0,contentLengthHeader:m[Il.CONTENT_LENGTH]||void 0,httpStatus:p.httpStatus},n),p.error}throw p instanceof gs?p:Qt(yw)}return Eh.postProcess(this.cacheManager,t,e,n),e}async updateAuthority(t,r){this.performanceClient?.addQueueMeasurement(Ye.UpdateTokenEndpointAuthority,r);const a=`https://${t}/${this.authority.tenant}/`,n=await m6(a,this.networkClient,this.cacheManager,this.authority.options,this.logger,r,this.performanceClient);this.authority=n}createTokenQueryParameters(t){const r=new Map;return t.embeddedClientId&&by(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),t.tokenQueryParameters&&wf(r,t.tokenQueryParameters),ub(r,t.correlationId),vy(r,t.correlationId,this.performanceClient),Lm(r)}}const V2="no_tokens_found",g6="native_account_unavailable",yb="refresh_token_expired",vb="ux_not_allowed",DN="interaction_required",FN="consent_required",RN="login_required",Ty="bad_token";const Jx=[DN,FN,RN,Ty,vb],jN=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],ON={[V2]:"No refresh token found in the cache. Please sign-in.",[g6]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[yb]:"Refresh token has expired.",[Ty]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[vb]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Ku extends gs{constructor(t,r,a,n,e,p,m,y){super(t,r,a),Object.setPrototypeOf(this,Ku.prototype),this.timestamp=n||Pt.EMPTY_STRING,this.traceId=e||Pt.EMPTY_STRING,this.correlationId=p||Pt.EMPTY_STRING,this.claims=m||Pt.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=y}}function y6(i,t,r){const a=!!i&&Jx.indexOf(i)>-1,n=!!r&&jN.indexOf(r)>-1,e=!!t&&Jx.some(p=>t.indexOf(p)>-1);return a||e||n}function W2(i){return new Ku(i,ON[i])}class lp{static setRequestState(t,r,a){const n=lp.generateLibraryState(t,a);return r?`${n}${Pt.RESOURCE_DELIM}${r}`:n}static generateLibraryState(t,r){if(!t)throw Qt(K5);const a={id:t.createNewGuid()};r&&(a.meta=r);const n=JSON.stringify(a);return t.base64Encode(n)}static parseRequestState(t,r){if(!t)throw Qt(K5);if(!r)throw Qt(np);try{const a=r.split(Pt.RESOURCE_DELIM),n=a[0],e=a.length>1?a.slice(1).join(Pt.RESOURCE_DELIM):Pt.EMPTY_STRING,p=t.base64Decode(n),m=JSON.parse(p);return{userRequestState:e||Pt.EMPTY_STRING,libraryState:m}}catch{throw Qt(np)}}}const LN={SW:"sw"};class ap{constructor(t,r){this.cryptoUtils=t,this.performanceClient=r}async generateCnf(t,r){this.performanceClient?.addQueueMeasurement(Ye.PopTokenGenerateCnf,t.correlationId);const a=await It(this.generateKid.bind(this),Ye.PopTokenGenerateCnf,r,this.performanceClient,t.correlationId)(t),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(a));return{kid:a.kid,reqCnfString:n}}async generateKid(t){return this.performanceClient?.addQueueMeasurement(Ye.PopTokenGenerateKid,t.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(t),xms_ksl:LN.SW}}async signPopToken(t,r,a){return this.signPayload(t,r,a)}async signPayload(t,r,a,n){const{resourceRequestMethod:e,resourceRequestUri:p,shrClaims:m,shrNonce:y,shrOptions:w}=a,I=(p?new Da(p):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:t,ts:lc(),m:e?.toUpperCase(),u:I?.HostNameAndPort,nonce:y||this.cryptoUtils.createNewGuid(),p:I?.AbsolutePath,q:I?.QueryString?[[],I.QueryString]:void 0,client_claims:m||void 0,...n},r,w,a.correlationId)}}class PN{constructor(t,r){this.cache=t,this.hasChanged=r}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class k0{constructor(t,r,a,n,e,p,m){this.clientId=t,this.cacheStorage=r,this.cryptoObj=a,this.logger=n,this.serializableCache=e,this.persistencePlugin=p,this.performanceClient=m}validateTokenResponse(t,r){if(t.error||t.error_description||t.suberror){const a=`Error(s): ${t.error_codes||Pt.NOT_AVAILABLE} - Timestamp: ${t.timestamp||Pt.NOT_AVAILABLE} - Description: ${t.error_description||Pt.NOT_AVAILABLE} - Correlation ID: ${t.correlation_id||Pt.NOT_AVAILABLE} - Trace ID: ${t.trace_id||Pt.NOT_AVAILABLE}`,n=t.error_codes?.length?t.error_codes[0]:void 0,e=new O0(t.error,a,t.suberror,n,t.status);if(r&&t.status&&t.status>=gf.SERVER_ERROR_RANGE_START&&t.status<=gf.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${e}`);return}else if(r&&t.status&&t.status>=gf.CLIENT_ERROR_RANGE_START&&t.status<=gf.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${e}`);return}throw y6(t.error,t.error_description,t.suberror)?new Ku(t.error,t.error_description,t.suberror,t.timestamp||Pt.EMPTY_STRING,t.trace_id||Pt.EMPTY_STRING,t.correlation_id||Pt.EMPTY_STRING,t.claims||Pt.EMPTY_STRING,n):e}}async handleServerTokenResponse(t,r,a,n,e,p,m,y,w){this.performanceClient?.addQueueMeasurement(Ye.HandleServerTokenResponse,t.correlation_id);let A;if(t.id_token){if(A=_h(t.id_token||Pt.EMPTY_STRING,this.cryptoObj.base64Decode),e&&e.nonce&&A.nonce!==e.nonce)throw Qt(ww);if(n.maxAge||n.maxAge===0){const M=A.auth_time;if(!M)throw Qt(qv);Kw(M,n.maxAge)}}this.homeAccountIdentifier=Fi.generateHomeAccountId(t.client_info||Pt.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,A);let I;e&&e.state&&(I=lp.parseRequestState(this.cryptoObj,e.state)),t.key_id=t.key_id||n.sshKid||void 0;const R=this.generateCacheRecord(t,r,a,n,A,p,e);let k;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),k=new PN(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(k)),m&&!y&&R.account){const M=this.cacheStorage.generateAccountKey(Fi.getAccountInfo(R.account));if(!this.cacheStorage.getAccount(M,n.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await k0.generateAuthenticationResult(this.cryptoObj,r,R,!1,n,A,I,void 0,w)}await this.cacheStorage.saveCacheRecord(R,n.correlationId,Fh(A||{}),n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&k&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(k))}return k0.generateAuthenticationResult(this.cryptoObj,r,R,!1,n,A,I,t,w)}generateCacheRecord(t,r,a,n,e,p,m){const y=r.getPreferredCache();if(!y)throw Qt(Vv);const w=rb(e);let A,I;t.id_token&&e&&(A=wy(this.homeAccountIdentifier,y,t.id_token,this.clientId,w||""),I=bb(this.cacheStorage,r,this.homeAccountIdentifier,this.cryptoObj.base64Decode,n.correlationId,e,t.client_info,y,w,m,void 0,this.logger));let R=null;if(t.access_token){const V=t.scope?ro.fromString(t.scope):new ro(n.scopes||[]),q=(typeof t.expires_in=="string"?parseInt(t.expires_in,10):t.expires_in)||0,U=(typeof t.ext_expires_in=="string"?parseInt(t.ext_expires_in,10):t.ext_expires_in)||0,te=(typeof t.refresh_in=="string"?parseInt(t.refresh_in,10):t.refresh_in)||void 0,W=a+q,re=W+U,xe=te&&te>0?a+te:void 0;R=Sy(this.homeAccountIdentifier,y,t.access_token,this.clientId,w||r.tenant||"",V.printScopes(),W,re,this.cryptoObj.base64Decode,xe,t.token_type,p,t.key_id,n.claims,n.requestedClaimsHash)}let k=null;if(t.refresh_token){let V;if(t.refresh_token_expires_in){const q=typeof t.refresh_token_expires_in=="string"?parseInt(t.refresh_token_expires_in,10):t.refresh_token_expires_in;V=a+q}k=f6(this.homeAccountIdentifier,y,t.refresh_token,this.clientId,t.foci,p,V)}let M=null;return t.foci&&(M={clientId:this.clientId,environment:y,familyId:t.foci}),{account:I,idToken:A,accessToken:R,refreshToken:k,appMetadata:M}}static async generateAuthenticationResult(t,r,a,n,e,p,m,y,w){let A=Pt.EMPTY_STRING,I=[],R=null,k,M,V=Pt.EMPTY_STRING;if(a.accessToken){if(a.accessToken.tokenType===rs.POP&&!e.popKid){const W=new ap(t),{secret:re,keyId:xe}=a.accessToken;if(!xe)throw Qt(Wv);A=await W.signPopToken(re,xe,e)}else A=a.accessToken.secret;I=ro.fromString(a.accessToken.target).asArray(),R=W1(a.accessToken.expiresOn),k=W1(a.accessToken.extendedExpiresOn),a.accessToken.refreshOn&&(M=W1(a.accessToken.refreshOn))}a.appMetadata&&(V=a.appMetadata.familyId===j2?j2:"");const q=p?.oid||p?.sub||"",U=p?.tid||"";y?.spa_accountid&&a.account&&(a.account.nativeAccountId=y?.spa_accountid);const te=a.account?tb(Fi.getAccountInfo(a.account),void 0,p,a.idToken?.secret):null;return{authority:r.canonicalAuthority,uniqueId:q,tenantId:U,scopes:I,account:te,idToken:a?.idToken?.secret||"",idTokenClaims:p||{},accessToken:A,fromCache:n,expiresOn:R,extExpiresOn:k,refreshOn:M,correlationId:e.correlationId,requestId:w||Pt.EMPTY_STRING,familyId:V,tokenType:a.accessToken?.tokenType||Pt.EMPTY_STRING,state:m?m.userRequestState:Pt.EMPTY_STRING,cloudGraphHostName:a.account?.cloudGraphHostName||Pt.EMPTY_STRING,msGraphHost:a.account?.msGraphHost||Pt.EMPTY_STRING,code:y?.spa_code,fromNativeBroker:!1}}}function bb(i,t,r,a,n,e,p,m,y,w,A,I){I?.verbose("setCachedAccount called");const k=i.getAccountKeys().find(te=>te.startsWith(r));let M=null;k&&(M=i.getAccount(k,n));const V=M||Fi.createAccount({homeAccountId:r,idTokenClaims:e,clientInfo:p,environment:m,cloudGraphHostName:w?.cloud_graph_host_name,msGraphHost:w?.msgraph_host,nativeAccountId:A},t,a),q=V.tenantProfiles||[],U=y||V.realm;if(U&&!q.find(te=>te.tenantId===U)){const te=yy(r,V.localAccountId,U,e);q.push(te)}return V.tenantProfiles=q,V}async function v6(i,t,r){return typeof i=="string"?i:i({clientId:t,tokenEndpoint:r})}class b6 extends gb{constructor(t,r){super(t,r),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(t,r){if(this.performanceClient?.addQueueMeasurement(Ye.AuthClientAcquireToken,t.correlationId),!t.code)throw Qt(Cw);const a=lc(),n=await It(this.executeTokenRequest.bind(this),Ye.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,t.correlationId)(this.authority,t),e=n.headers?.[Il.X_MS_REQUEST_ID],p=new k0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return p.validateTokenResponse(n.body),It(p.handleServerTokenResponse.bind(p),Ye.HandleServerTokenResponse,this.logger,this.performanceClient,t.correlationId)(n.body,this.authority,a,t,r,void 0,void 0,void 0,e)}getLogoutUri(t){if(!t)throw ms(Mw);const r=this.createLogoutUrlQueryString(t);return Da.appendQueryString(this.authority.endSessionEndpoint,r)}async executeTokenRequest(t,r){this.performanceClient?.addQueueMeasurement(Ye.AuthClientExecuteTokenRequest,r.correlationId);const a=this.createTokenQueryParameters(r),n=Da.appendQueryString(t.tokenEndpoint,a),e=await It(this.createTokenRequestBody.bind(this),Ye.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,r.correlationId)(r);let p;if(r.clientInfo)try{const w=M2(r.clientInfo,this.cryptoUtils.base64Decode);p={credential:`${w.uid}${Om.CLIENT_INFO_SEPARATOR}${w.utid}`,type:Vu.HOME_ACCOUNT_ID}}catch(w){this.logger.verbose("Could not parse client info for CCS Header: "+w)}const m=this.createTokenRequestHeaders(p||r.ccsCredential),y=Cy(this.config.authOptions.clientId,r);return It(this.executePostToTokenEndpoint.bind(this),Ye.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,r.correlationId)(n,e,m,y,r.correlationId,Ye.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(t){this.performanceClient?.addQueueMeasurement(Ye.AuthClientCreateTokenRequestBody,t.correlationId);const r=new Map;if(ob(r,t.embeddedClientId||t.tokenBodyParameters?.[E0]||this.config.authOptions.clientId),this.includeRedirectUri)lb(r,t.redirectUri);else if(!t.redirectUri)throw ms(Rw);if(ib(r,t.scopes,!0,this.oidcDefaultScopes),dN(r,t.code),hb(r,this.config.libraryInfo),db(r,this.config.telemetry.application),d6(r),this.serverTelemetryManager&&!e6(this.config)&&h6(r,this.serverTelemetryManager),t.codeVerifier&&pN(r,t.codeVerifier),this.config.clientCredentials.clientSecret&&s6(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const n=this.config.clientCredentials.clientAssertion;i6(r,await v6(n.assertion,this.config.authOptions.clientId,t.resourceRequestUri)),o6(r,n.assertionType)}if(l6(r,fw.AUTHORIZATION_CODE_GRANT),pb(r),t.authenticationScheme===rs.POP){const n=new ap(this.cryptoUtils,this.performanceClient);let e;t.popKid?e=this.cryptoUtils.encodeKid(t.popKid):e=(await It(n.generateCnf.bind(n),Ye.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger)).reqCnfString,mb(r,e)}else if(t.authenticationScheme===rs.SSH)if(t.sshJwk)u6(r,t.sshJwk);else throw ms(gy);(!Uc.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&cb(r,t.claims,this.config.authOptions.clientCapabilities);let a;if(t.clientInfo)try{const n=M2(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${n.uid}${Om.CLIENT_INFO_SEPARATOR}${n.utid}`,type:Vu.HOME_ACCOUNT_ID}}catch(n){this.logger.verbose("Could not parse client info for CCS Header: "+n)}else a=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case Vu.HOME_ACCOUNT_ID:try{const n=G1(a.credential);Em(r,n)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Vu.UPN:q2(r,a.credential);break}return t.embeddedClientId&&by(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),t.tokenBodyParameters&&wf(r,t.tokenBodyParameters),t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[zx])&&wf(r,{[zx]:"1"}),vy(r,t.correlationId,this.performanceClient),Lm(r)}createLogoutUrlQueryString(t){const r=new Map;return t.postLogoutRedirectUri&&oN(r,t.postLogoutRedirectUri),t.correlationId&&ub(r,t.correlationId),t.idTokenHint&&lN(r,t.idTokenHint),t.state&&a6(r,t.state),t.logoutHint&&gN(r,t.logoutHint),t.extraQueryParameters&&wf(r,t.extraQueryParameters),this.config.authOptions.instanceAware&&c6(r),Lm(r,this.config.authOptions.encodeExtraQueryParams,t.extraQueryParameters)}}const MN=300;class UN extends gb{constructor(t,r){super(t,r)}async acquireToken(t){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientAcquireToken,t.correlationId);const r=lc(),a=await It(this.executeTokenRequest.bind(this),Ye.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,t.correlationId)(t,this.authority),n=a.headers?.[Il.X_MS_REQUEST_ID],e=new k0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return e.validateTokenResponse(a.body),It(e.handleServerTokenResponse.bind(e),Ye.HandleServerTokenResponse,this.logger,this.performanceClient,t.correlationId)(a.body,this.authority,r,t,void 0,void 0,!0,t.forceCache,n)}async acquireTokenByRefreshToken(t){if(!t)throw ms(Pw);if(this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw Qt(Gv);if(this.cacheManager.isAppMetadataFOCI(t.account.environment))try{return await It(this.acquireTokenWithCachedRefreshToken.bind(this),Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!0)}catch(a){const n=a instanceof Ku&&a.errorCode===V2,e=a instanceof O0&&a.errorCode===Rx.INVALID_GRANT_ERROR&&a.subError===Rx.CLIENT_MISMATCH_ERROR;if(n||e)return It(this.acquireTokenWithCachedRefreshToken.bind(this),Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!1);throw a}return It(this.acquireTokenWithCachedRefreshToken.bind(this),Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,!1)}async acquireTokenWithCachedRefreshToken(t,r){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId);const a=Bc(this.cacheManager.getRefreshToken.bind(this.cacheManager),Ye.CacheManagerGetRefreshToken,this.logger,this.performanceClient,t.correlationId)(t.account,r,t.correlationId,void 0,this.performanceClient);if(!a)throw W2(V2);if(a.expiresOn&&G2(a.expiresOn,t.refreshTokenExpirationOffsetSeconds||MN))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},t.correlationId),W2(yb);const n={...t,refreshToken:a.secret,authenticationScheme:t.authenticationScheme||rs.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:Vu.HOME_ACCOUNT_ID}};try{return await It(this.acquireToken.bind(this),Ye.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(n)}catch(e){if(e instanceof Ku&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},t.correlationId),e.subError===Ty)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const p=this.cacheManager.generateCredentialKey(a);this.cacheManager.removeRefreshToken(p,t.correlationId)}throw e}}async executeTokenRequest(t,r){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientExecuteTokenRequest,t.correlationId);const a=this.createTokenQueryParameters(t),n=Da.appendQueryString(r.tokenEndpoint,a),e=await It(this.createTokenRequestBody.bind(this),Ye.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),p=this.createTokenRequestHeaders(t.ccsCredential),m=Cy(this.config.authOptions.clientId,t);return It(this.executePostToTokenEndpoint.bind(this),Ye.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(n,e,p,m,t.correlationId,Ye.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(t){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientCreateTokenRequestBody,t.correlationId);const r=new Map;if(ob(r,t.embeddedClientId||t.tokenBodyParameters?.[E0]||this.config.authOptions.clientId),t.redirectUri&&lb(r,t.redirectUri),ib(r,t.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),l6(r,fw.REFRESH_TOKEN_GRANT),pb(r),hb(r,this.config.libraryInfo),db(r,this.config.telemetry.application),d6(r),this.serverTelemetryManager&&!e6(this.config)&&h6(r,this.serverTelemetryManager),fN(r,t.refreshToken),this.config.clientCredentials.clientSecret&&s6(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;i6(r,await v6(a.assertion,this.config.authOptions.clientId,t.resourceRequestUri)),o6(r,a.assertionType)}if(t.authenticationScheme===rs.POP){const a=new ap(this.cryptoUtils,this.performanceClient);let n;t.popKid?n=this.cryptoUtils.encodeKid(t.popKid):n=(await It(a.generateCnf.bind(a),Ye.PopTokenGenerateCnf,this.logger,this.performanceClient,t.correlationId)(t,this.logger)).reqCnfString,mb(r,n)}else if(t.authenticationScheme===rs.SSH)if(t.sshJwk)u6(r,t.sshJwk);else throw ms(gy);if((!Uc.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&cb(r,t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case Vu.HOME_ACCOUNT_ID:try{const a=G1(t.ccsCredential.credential);Em(r,a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Vu.UPN:q2(r,t.ccsCredential.credential);break}return t.embeddedClientId&&by(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),t.tokenBodyParameters&&wf(r,t.tokenBodyParameters),vy(r,t.correlationId,this.performanceClient),Lm(r)}}class BN extends gb{constructor(t,r){super(t,r)}async acquireCachedToken(t){this.performanceClient?.addQueueMeasurement(Ye.SilentFlowClientAcquireCachedToken,t.correlationId);let r=m0.NOT_APPLICABLE;if(t.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Uc.isEmptyObj(t.claims))throw this.setCacheOutcome(m0.FORCE_REFRESH_OR_CLAIMS,t.correlationId),Qt(xf);if(!t.account)throw Qt(Gv);const a=t.account.tenantId||_N(t.authority),n=this.cacheManager.getTokenKeys(),e=this.cacheManager.getAccessToken(t.account,t,n,a);if(e){if(SN(e.cachedAt)||G2(e.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(m0.CACHED_ACCESS_TOKEN_EXPIRED,t.correlationId),Qt(xf);e.refreshOn&&G2(e.refreshOn,0)&&(r=m0.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(m0.NO_CACHED_ACCESS_TOKEN,t.correlationId),Qt(xf);const p=t.authority||this.authority.getPreferredCache(),m={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(t.account),t.correlationId),accessToken:e,idToken:this.cacheManager.getIdToken(t.account,t.correlationId,n,a,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(p)};return this.setCacheOutcome(r,t.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await It(this.generateResultFromCacheRecord.bind(this),Ye.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,t.correlationId)(m,t),r]}setCacheOutcome(t,r){this.serverTelemetryManager?.setCacheOutcome(t),this.performanceClient?.addFields({cacheOutcome:t},r),t!==m0.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${t}`)}async generateResultFromCacheRecord(t,r){this.performanceClient?.addQueueMeasurement(Ye.SilentFlowClientGenerateResultFromCacheRecord,r.correlationId);let a;if(t.idToken&&(a=_h(t.idToken.secret,this.config.cryptoInterface.base64Decode)),r.maxAge||r.maxAge===0){const n=a?.auth_time;if(!n)throw Qt(qv);Kw(n,r.maxAge)}return k0.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,r,a)}}const HN={sendGetRequestAsync:()=>Promise.reject(Qt(Yn)),sendPostRequestAsync:()=>Promise.reject(Qt(Yn))};function zN(i,t,r,a){const n=t.correlationId,e=new Map;ob(e,t.embeddedClientId||t.extraQueryParameters?.[E0]||i.clientId);const p=[...t.scopes||[],...t.extraScopesToConsent||[]];if(ib(e,p,!0,i.authority.options.OIDCOptions?.defaultScopes),lb(e,t.redirectUri),ub(e,n),sN(e,t.responseMode),pb(e),t.prompt&&(uN(e,t.prompt),a?.addFields({prompt:t.prompt},n)),t.domainHint&&(cN(e,t.domainHint),a?.addFields({domainHintFromRequest:!0},n)),t.prompt!==Ho.SELECT_ACCOUNT)if(t.sid&&t.prompt===Ho.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),$x(e,t.sid),a?.addFields({sidFromRequest:!0},n);else if(t.account){const m=GN(t.account);let y=VN(t.account);if(y&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),y=null),y){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Qg(e,y),a?.addFields({loginHintFromClaim:!0},n);try{const w=G1(t.account.homeAccountId);Em(e,w)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(m&&t.prompt===Ho.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),$x(e,m),a?.addFields({sidFromClaim:!0},n);try{const w=G1(t.account.homeAccountId);Em(e,w)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Qg(e,t.loginHint),q2(e,t.loginHint),a?.addFields({loginHintFromRequest:!0},n);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Qg(e,t.account.username),a?.addFields({loginHintFromUpn:!0},n);try{const w=G1(t.account.homeAccountId);Em(e,w)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Qg(e,t.loginHint),q2(e,t.loginHint),a?.addFields({loginHintFromRequest:!0},n));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&hN(e,t.nonce),t.state&&a6(e,t.state),(t.claims||i.clientCapabilities&&i.clientCapabilities.length>0)&&cb(e,t.claims,i.clientCapabilities),t.embeddedClientId&&by(e,i.clientId,i.redirectUri),i.instanceAware&&(!t.extraQueryParameters||!Object.keys(t.extraQueryParameters).includes(Q5))&&c6(e),e}function xb(i,t,r,a){const n=Lm(t,r,a);return Da.appendQueryString(i.authorizationEndpoint,n)}function $N(i,t){if(x6(i,t),!i.code)throw Qt(_w);return i}function x6(i,t){if(!i.state||!t)throw i.state?Qt(G5,"Cached State"):Qt(G5,"Server State");let r,a;try{r=decodeURIComponent(i.state)}catch{throw Qt(np,i.state)}try{a=decodeURIComponent(t)}catch{throw Qt(np,i.state)}if(r!==a)throw Qt(xw);if(i.error||i.error_description||i.suberror){const n=qN(i);throw y6(i.error,i.error_description,i.suberror)?new Ku(i.error||"",i.error_description,i.suberror,i.timestamp||"",i.trace_id||"",i.correlation_id||"",i.claims||"",n):new O0(i.error||"",i.error_description,i.suberror,n)}}function qN(i){const t="code=",r=i.error_uri?.lastIndexOf(t);return r&&r>=0?i.error_uri?.substring(r+t.length):void 0}function GN(i){return i.idTokenClaims?.sid||null}function VN(i){return i.loginHint||i.idTokenClaims?.login_hint||null}const Qx=",",w6="|";function WN(i){const{skus:t,libraryName:r,libraryVersion:a,extensionName:n,extensionVersion:e}=i,p=new Map([[0,[r,a]],[2,[n,e]]]);let m=[];if(t?.length){if(m=t.split(Qx),m.length<4)return t}else m=Array.from({length:4},()=>w6);return p.forEach((y,w)=>{y.length===2&&y[0]?.length&&y[1]?.length&&KN({skuArr:m,index:w,skuName:y[0],skuVersion:y[1]})}),m.join(Qx)}function KN(i){const{skuArr:t,index:r,skuName:a,skuVersion:n}=i;r>=t.length||(t[r]=[a,n].join(w6))}class Pm{constructor(t,r){this.cacheOutcome=m0.NOT_APPLICABLE,this.cacheManager=r,this.apiId=t.apiId,this.correlationId=t.correlationId,this.wrapperSKU=t.wrapperSKU||Pt.EMPTY_STRING,this.wrapperVer=t.wrapperVer||Pt.EMPTY_STRING,this.telemetryCacheKey=Uo.CACHE_KEY+Om.CACHE_KEY_SEPARATOR+t.clientId}generateCurrentRequestHeaderValue(){const t=`${this.apiId}${Uo.VALUE_SEPARATOR}${this.cacheOutcome}`,r=[this.wrapperSKU,this.wrapperVer],a=this.getNativeBrokerErrorCode();a?.length&&r.push(`broker_error=${a}`);const n=r.join(Uo.VALUE_SEPARATOR),e=this.getRegionDiscoveryFields(),p=[t,e].join(Uo.VALUE_SEPARATOR);return[Uo.SCHEMA_VERSION,p,n].join(Uo.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const t=this.getLastRequests(),r=Pm.maxErrorsToSend(t),a=t.failedRequests.slice(0,2*r).join(Uo.VALUE_SEPARATOR),n=t.errors.slice(0,r).join(Uo.VALUE_SEPARATOR),e=t.errors.length,p=r<e?Uo.OVERFLOW_TRUE:Uo.OVERFLOW_FALSE,m=[e,p].join(Uo.VALUE_SEPARATOR);return[Uo.SCHEMA_VERSION,t.cacheHits,a,n,m].join(Uo.CATEGORY_SEPARATOR)}cacheFailedRequest(t){const r=this.getLastRequests();r.errors.length>=Uo.MAX_CACHED_ERRORS&&(r.failedRequests.shift(),r.failedRequests.shift(),r.errors.shift()),r.failedRequests.push(this.apiId,this.correlationId),t instanceof Error&&t&&t.toString()?t instanceof gs?t.subError?r.errors.push(t.subError):t.errorCode?r.errors.push(t.errorCode):r.errors.push(t.toString()):r.errors.push(t.toString()):r.errors.push(Uo.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}incrementCacheHits(){const t=this.getLastRequests();return t.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId),t.cacheHits}getLastRequests(){const t={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||t}clearTelemetryCache(){const t=this.getLastRequests(),r=Pm.maxErrorsToSend(t),a=t.errors.length;if(r===a)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:t.failedRequests.slice(r*2),errors:t.errors.slice(r),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(t){let r,a=0,n=0;const e=t.errors.length;for(r=0;r<e;r++){const p=t.failedRequests[2*r]||Pt.EMPTY_STRING,m=t.failedRequests[2*r+1]||Pt.EMPTY_STRING,y=t.errors[r]||Pt.EMPTY_STRING;if(n+=p.toString().length+m.toString().length+y.length+3,n<Uo.MAX_LAST_HEADER_BYTES)a+=1;else break}return a}getRegionDiscoveryFields(){const t=[];return t.push(this.regionUsed||Pt.EMPTY_STRING),t.push(this.regionSource||Pt.EMPTY_STRING),t.push(this.regionOutcome||Pt.EMPTY_STRING),t.join(",")}updateRegionDiscoveryMetadata(t){this.regionUsed=t.region_used,this.regionSource=t.region_source,this.regionOutcome=t.region_outcome}setCacheOutcome(t){this.cacheOutcome=t}setNativeBrokerErrorCode(t){const r=this.getLastRequests();r.nativeBrokerErrorCode=t,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const t=this.getLastRequests();delete t.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}static makeExtraSkuString(t){return WN(t)}}const S6="missing_kid_error",A6="missing_alg_error";const YN={[S6]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[A6]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class wb extends gs{constructor(t,r){super(t,r),this.name="JoseHeaderError",Object.setPrototypeOf(this,wb.prototype)}}function Xx(i){return new wb(i,YN[i])}class Sb{constructor(t){this.typ=t.typ,this.alg=t.alg,this.kid=t.kid}static getShrHeaderString(t){if(!t.kid)throw Xx(S6);if(!t.alg)throw Xx(A6);const r=new Sb({typ:t.typ||zA.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(r)}}const Ab="pkce_not_created",Cb="ear_jwk_empty",C6="ear_jwe_empty",X5="crypto_nonexistent",Ey="empty_navigate_uri",N6="hash_empty_error",Nb="no_state_in_hash",T6="hash_does_not_contain_known_properties",E6="unable_to_parse_state",k6="state_interaction_type_mismatch",_6="interaction_in_progress",I6="popup_window_error",D6="empty_window_error",Mm="user_cancelled",JN="monitor_popup_timeout",F6="monitor_window_timeout",R6="redirect_in_iframe",j6="block_iframe_reload",O6="block_nested_popups",QN="iframe_closed_prematurely",ky="silent_logout_unsupported",L6="no_account_error",XN="silent_prompt_value_error",P6="no_token_request_cache_error",M6="unable_to_parse_token_request_cache_error",ZN="auth_request_not_set_error",eT="invalid_cache_type",_y="non_browser_environment",M1="database_not_open",K2="no_network_connectivity",U6="post_request_failed",B6="get_request_failed",Z5="failed_to_parse_response",H6="unable_to_load_token",Tb="crypto_key_not_found",z6="auth_code_required",$6="auth_code_or_nativeAccountId_required",q6="spa_code_and_nativeAccountId_present",Eb="database_unavailable",G6="unable_to_acquire_token_from_native_platform",V6="native_handshake_timeout",W6="native_extension_not_installed",kb="native_connection_not_established",km="uninitialized_public_client_application",K6="native_prompt_not_supported",Y6="invalid_base64_string",J6="invalid_pop_token_request",Q6="failed_to_build_headers",X6="failed_to_parse_headers",g2="failed_to_decrypt_ear_response",Y2="timed_out";const cd="For more visit: aka.ms/msaljs/browser-errors",tT={[Ab]:"The PKCE code challenge and verifier could not be generated.",[Cb]:"No EAR encryption key provided. This is unexpected.",[C6]:"Server response does not contain ear_jwe property. This is unexpected.",[X5]:"The crypto object or function is not available.",[Ey]:"Navigation URI is empty. Please check stack trace for more info.",[N6]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${cd}`,[Nb]:"Hash does not contain state. Please verify that the request originated from msal.",[T6]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${cd}`,[E6]:"Unable to parse state. Please verify that the request originated from msal.",[k6]:"Hash contains state but the interaction type does not match the caller.",[_6]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${cd}`,[I6]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[D6]:"window.open returned null or undefined window object.",[Mm]:"User cancelled the flow.",[JN]:`Token acquisition in popup failed due to timeout.  ${cd}`,[F6]:`Token acquisition in iframe failed due to timeout.  ${cd}`,[R6]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[j6]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${cd}`,[O6]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[QN]:"The iframe being monitored was closed prematurely.",[ky]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[L6]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[XN]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[P6]:"No token request found in cache.",[M6]:"The cached token request could not be parsed.",[ZN]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[eT]:"Invalid cache type",[_y]:"Login and token requests are not supported in non-browser environments.",[M1]:"Database is not open!",[K2]:"No network connectivity. Check your internet connection.",[U6]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[B6]:"Network request failed. Please check the network trace to determine root cause.",[Z5]:"Failed to parse network response. Check network trace.",[H6]:"Error loading token to cache.",[Tb]:"Cryptographic Key or Keypair not found in browser storage.",[z6]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[$6]:"An authorization code or nativeAccountId must be provided to this flow.",[q6]:"Request cannot contain both spa code and native account id.",[Eb]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[G6]:`Unable to acquire token from native platform.  ${cd}`,[V6]:"Timed out while attempting to establish connection to browser extension",[W6]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[kb]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${cd}`,[km]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${cd}`,[K6]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Y6]:"Invalid base64 encoded string.",[J6]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Q6]:"Failed to build request headers object.",[X6]:"Failed to parse response headers",[g2]:"Failed to decrypt ear response",[Y2]:"The request timed out."};class qm extends gs{constructor(t,r){super(t,tT[t],r),Object.setPrototypeOf(this,qm.prototype),this.name="BrowserAuthError"}}function Tr(i,t){return new qm(i,t)}const ic={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},iu={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS",MICROSOFT_ENTRA_BROKERID:"MicrosoftEntra",DOM_API_NAME:"DOM API",PLATFORM_DOM_APIS:"get-token-and-sign-out",PLATFORM_DOM_PROVIDER:"PlatformAuthDOMHandler",PLATFORM_EXTENSION_PROVIDER:"PlatformAuthExtensionHandler"},bm={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},zo={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},Zx={GET:"GET",POST:"POST"},pf={SIGNIN:"signin",SIGNOUT:"signout"},Qi={ORIGIN_URI:"request.origin",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",VERIFIER:"code.verifier",INTERACTION_STATUS_KEY:"interaction.status",NATIVE_REQUEST:"request.native"},Zg={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Ka={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var pn;(function(i){i.Redirect="redirect",i.Popup="popup",i.Silent="silent",i.None="none"})(pn||(pn={}));const si={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},e4={scopes:op},Z6="jwk",rT={React:"@azure/msal-react"},ev="msal.db",nT=1,aT=`${ev}.keys`,_l={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},sT=[_l.Default,_l.Skip,_l.RefreshTokenAndNetwork];function e2(i){return encodeURIComponent(Um(i).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Af(i){return e8(i).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Um(i){return e8(new TextEncoder().encode(i))}function e8(i){const t=Array.from(i,r=>String.fromCodePoint(r)).join("");return btoa(t)}function Dl(i){return new TextDecoder().decode(Sf(i))}function Sf(i){let t=i.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Tr(Y6)}const r=atob(t);return Uint8Array.from(r,a=>a.codePointAt(0)||0)}const iT="RSASSA-PKCS1-v1_5",cp="AES-GCM",t8="HKDF",_b="SHA-256",oT=2048,lT=new Uint8Array([1,0,1]),t4="0123456789abcdef",r4=new Uint32Array(1),Ib="raw",r8="encrypt",Db="decrypt",cT="deriveKey",uT="crypto_subtle_undefined",Fb={name:iT,hash:_b,modulusLength:oT,publicExponent:lT};function hT(i){if(!window)throw Tr(_y);if(!window.crypto)throw Tr(X5);if(!i&&!window.crypto.subtle)throw Tr(X5,uT)}async function n8(i,t,r){t?.addQueueMeasurement(Ye.Sha256Digest,r);const n=new TextEncoder().encode(i);return window.crypto.subtle.digest(_b,n)}function dT(i){return window.crypto.getRandomValues(i)}function c5(){return window.crypto.getRandomValues(r4),r4[0]}function Yu(){const i=Date.now(),t=c5()*1024+(c5()&1023),r=new Uint8Array(16),a=Math.trunc(t/2**30),n=t&2**30-1,e=c5();r[0]=i/2**40,r[1]=i/2**32,r[2]=i/2**24,r[3]=i/2**16,r[4]=i/2**8,r[5]=i,r[6]=112|a>>>8,r[7]=a,r[8]=128|n>>>24,r[9]=n>>>16,r[10]=n>>>8,r[11]=n,r[12]=e>>>24,r[13]=e>>>16,r[14]=e>>>8,r[15]=e;let p="";for(let m=0;m<r.length;m++)p+=t4.charAt(r[m]>>>4),p+=t4.charAt(r[m]&15),(m===3||m===5||m===7||m===9)&&(p+="-");return p}async function fT(i,t){return window.crypto.subtle.generateKey(Fb,i,t)}async function u5(i){return window.crypto.subtle.exportKey(Z6,i)}async function pT(i,t,r){return window.crypto.subtle.importKey(Z6,i,Fb,t,r)}async function mT(i,t){return window.crypto.subtle.sign(Fb,i,t)}async function Rb(){const i=await a8(),r={alg:"dir",kty:"oct",k:Af(new Uint8Array(i))};return Um(JSON.stringify(r))}async function gT(i){const t=Dl(i),a=JSON.parse(t).k,n=Sf(a);return window.crypto.subtle.importKey(Ib,n,cp,!1,[Db])}async function yT(i,t){const r=t.split(".");if(r.length!==5)throw Tr(g2,"jwe_length");const a=await gT(i).catch(()=>{throw Tr(g2,"import_key")});try{const n=new TextEncoder().encode(r[0]),e=Sf(r[2]),p=Sf(r[3]),m=Sf(r[4]),y=m.byteLength*8,w=new Uint8Array(p.length+m.length);w.set(p),w.set(m,p.length);const A=await window.crypto.subtle.decrypt({name:cp,iv:e,tagLength:y,additionalData:n},a,w);return new TextDecoder().decode(A)}catch{throw Tr(g2,"decrypt")}}async function a8(){const i=await window.crypto.subtle.generateKey({name:cp,length:256},!0,[r8,Db]);return window.crypto.subtle.exportKey(Ib,i)}async function n4(i){return window.crypto.subtle.importKey(Ib,i,t8,!1,[cT])}async function s8(i,t,r){return window.crypto.subtle.deriveKey({name:t8,salt:t,hash:_b,info:new TextEncoder().encode(r)},i,{name:cp,length:256},!1,[r8,Db])}async function vT(i,t,r){const a=new TextEncoder().encode(t),n=window.crypto.getRandomValues(new Uint8Array(16)),e=await s8(i,n,r),p=await window.crypto.subtle.encrypt({name:cp,iv:new Uint8Array(12)},e,a);return{data:Af(new Uint8Array(p)),nonce:Af(n)}}async function a4(i,t,r,a){const n=Sf(a),e=await s8(i,Sf(t),r),p=await window.crypto.subtle.decrypt({name:cp,iv:new Uint8Array(12)},e,n);return new TextDecoder().decode(p)}async function i8(i){const t=await n8(i),r=new Uint8Array(t);return Af(r)}const Iy="storage_not_supported",to="stubbed_public_client_application_called",jb="in_mem_redirect_unavailable";const y2={[Iy]:"Given storage configuration option was not supported.",[to]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[jb]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};y2[Iy],y2[to],y2[jb];class Ob extends gs{constructor(t,r){super(t,r),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Ob.prototype)}}function Ji(i){return new Ob(i,y2[i])}function o8(i){i.location.hash="",typeof i.history.replaceState=="function"&&i.history.replaceState(null,"",`${i.location.origin}${i.location.pathname}${i.location.search}`)}function bT(i){const t=i.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}function Lb(){return window.parent!==window}function xT(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${ic.POPUP_NAME_PREFIX}.`)===0}function md(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function wT(){const t=new Da(window.location.href).getUrlComponents();return`${t.Protocol}//${t.HostNameAndPort}/`}function ST(){if(Da.hashContainsKnownProperties(window.location.hash)&&Lb())throw Tr(j6)}function AT(i){if(Lb()&&!i)throw Tr(R6)}function CT(){if(xT())throw Tr(O6)}function l8(){if(typeof window>"u")throw Tr(_y)}function c8(i){if(!i)throw Tr(km)}function Pb(i){l8(),ST(),CT(),c8(i)}function s4(i,t){if(Pb(i),AT(t.system.allowRedirectInIframe),t.cache.cacheLocation===zo.MemoryStorage&&!t.cache.storeAuthStateInCookie)throw Ji(jb)}function u8(i){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(i).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch{}},1e4)}function NT(){return Yu()}class J2{navigateInternal(t,r){return J2.defaultNavigateWindow(t,r)}navigateExternal(t,r){return J2.defaultNavigateWindow(t,r)}static defaultNavigateWindow(t,r){return r.noHistory?window.location.replace(t):window.location.assign(t),new Promise((a,n)=>{setTimeout(()=>{n(Tr(Y2,"failed_to_redirect"))},r.timeout)})}}class TT{async sendGetRequestAsync(t,r){let a,n={},e=0;const p=i4(r);try{a=await fetch(t,{method:Zx.GET,headers:p})}catch(m){throw Cm(Tr(window.navigator.onLine?B6:K2),void 0,void 0,m)}n=o4(a.headers);try{return e=a.status,{headers:n,body:await a.json(),status:e}}catch(m){throw Cm(Tr(Z5),e,n,m)}}async sendPostRequestAsync(t,r){const a=r&&r.body||"",n=i4(r);let e,p=0,m={};try{e=await fetch(t,{method:Zx.POST,headers:n,body:a})}catch(y){throw Cm(Tr(window.navigator.onLine?U6:K2),void 0,void 0,y)}m=o4(e.headers);try{return p=e.status,{headers:m,body:await e.json(),status:p}}catch(y){throw Cm(Tr(Z5),p,m,y)}}}function i4(i){try{const t=new Headers;if(!(i&&i.headers))return t;const r=i.headers;return Object.entries(r).forEach(([a,n])=>{t.append(a,n)}),t}catch(t){throw Cm(Tr(Q6),void 0,void 0,t)}}function o4(i){try{const t={};return i.forEach((r,a)=>{t[a]=r}),t}catch{throw Tr(X6)}}const ET=6e4,tv=1e4,kT=3e4,h8=2e3;function _T({auth:i,cache:t,system:r,telemetry:a},n){const e={clientId:Pt.EMPTY_STRING,authority:`${Pt.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:Pt.EMPTY_STRING,authorityMetadata:Pt.EMPTY_STRING,redirectUri:typeof window<"u"?md():"",postLogoutRedirectUri:Pt.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:oc.AAD,OIDCOptions:{serverResponseType:my.FRAGMENT,defaultScopes:[Pt.OPENID_SCOPE,Pt.PROFILE_SCOPE,Pt.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Jv.None,tenant:Pt.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},p={cacheLocation:zo.SessionStorage,cacheRetentionDays:5,temporaryCacheLocation:zo.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(t&&t.cacheLocation===zo.LocalStorage),claimsBasedCachingEnabled:!1},m={loggerCallback:()=>{},logLevel:Qs.Info,piiLoggingEnabled:!1},w={...{...Zw,loggerOptions:m,networkClient:n?new TT:HN,navigationClient:new J2,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||ET,iframeHashTimeout:r?.loadFrameTimeout||tv,navigateFrameWait:0,redirectNavigationTimeout:kT,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,allowPlatformBrokerWithDOM:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||h8,pollIntervalMilliseconds:ic.DEFAULT_POLL_INTERVAL_MS},...r,loggerOptions:r?.loggerOptions||m},A={application:{appName:Pt.EMPTY_STRING,appVersion:Pt.EMPTY_STRING},client:new Xw};if(i?.protocolMode!==oc.OIDC&&i?.OIDCOptions&&new vd(w.loggerOptions).warning(JSON.stringify(ms(zw))),i?.protocolMode&&i.protocolMode===oc.OIDC&&w?.allowPlatformBroker)throw ms($w);return{auth:{...e,...i,OIDCOptions:{...e.OIDCOptions,...i?.OIDCOptions}},cache:{...p,...t},system:w,telemetry:{...A,...a}}}const IT="@azure/msal-browser",_0="4.27.0";const dl="msal",d8="browser",l4="|",ul=2,v2=2,DT=`${dl}.${d8}.log.level`,FT=`${dl}.${d8}.log.pii`,c4=`${dl}.version`,u4="account.keys",h4="token.keys";function K1(i=v2){return i<1?`${dl}.${u4}`:`${dl}.${i}.${u4}`}function Y1(i,t=ul){return t<1?`${dl}.${h4}.${i}`:`${dl}.${t}.${h4}.${i}`}class Mb{static loggerCallback(t,r){switch(t){case Qs.Error:console.error(r);return;case Qs.Info:console.info(r);return;case Qs.Verbose:console.debug(r);return;case Qs.Warning:console.warn(r);return;default:console.log(r);return}}constructor(t){this.browserEnvironment=typeof window<"u",this.config=_T(t,this.browserEnvironment);let r;try{r=window[zo.SessionStorage]}catch{}const a=r?.getItem(DT),n=r?.getItem(FT)?.toLowerCase(),e=n==="true"?!0:n==="false"?!1:void 0,p={...this.config.system.loggerOptions},m=a&&Object.keys(Qs).includes(a)?Qs[a]:void 0;m&&(p.loggerCallback=Mb.loggerCallback,p.logLevel=m),e!==void 0&&(p.piiLoggingEnabled=e),this.logger=new vd(p,IT,_0),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class I0 extends Mb{getModuleName(){return I0.MODULE_NAME}getId(){return I0.ID}async initialize(){return this.available=typeof window<"u",this.available}}I0.MODULE_NAME="";I0.ID="StandardOperatingContext";class RT{constructor(){this.dbName=ev,this.version=nT,this.tableName=aT,this.dbOpen=!1}async open(){return new Promise((t,r)=>{const a=window.indexedDB.open(this.dbName,this.version);a.addEventListener("upgradeneeded",n=>{n.target.result.createObjectStore(this.tableName)}),a.addEventListener("success",n=>{const e=n;this.db=e.target.result,this.dbOpen=!0,t()}),a.addEventListener("error",()=>r(Tr(Eb)))})}closeConnection(){const t=this.db;t&&this.dbOpen&&(t.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(t){return await this.validateDbIsOpen(),new Promise((r,a)=>{if(!this.db)return a(Tr(M1));const p=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(t);p.addEventListener("success",m=>{const y=m;this.closeConnection(),r(y.target.result)}),p.addEventListener("error",m=>{this.closeConnection(),a(m)})})}async setItem(t,r){return await this.validateDbIsOpen(),new Promise((a,n)=>{if(!this.db)return n(Tr(M1));const m=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(r,t);m.addEventListener("success",()=>{this.closeConnection(),a()}),m.addEventListener("error",y=>{this.closeConnection(),n(y)})})}async removeItem(t){return await this.validateDbIsOpen(),new Promise((r,a)=>{if(!this.db)return a(Tr(M1));const p=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(t);p.addEventListener("success",()=>{this.closeConnection(),r()}),p.addEventListener("error",m=>{this.closeConnection(),a(m)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(Tr(M1));const e=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();e.addEventListener("success",p=>{const m=p;this.closeConnection(),t(m.target.result)}),e.addEventListener("error",p=>{this.closeConnection(),r(p)})})}async containsKey(t){return await this.validateDbIsOpen(),new Promise((r,a)=>{if(!this.db)return a(Tr(M1));const p=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(t);p.addEventListener("success",m=>{const y=m;this.closeConnection(),r(y.target.result===1)}),p.addEventListener("error",m=>{this.closeConnection(),a(m)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((t,r)=>{const a=window.indexedDB.deleteDatabase(ev),n=setTimeout(()=>r(!1),200);a.addEventListener("success",()=>(clearTimeout(n),t(!0))),a.addEventListener("blocked",()=>(clearTimeout(n),t(!0))),a.addEventListener("error",()=>(clearTimeout(n),r(!1)))})}}class Dy{constructor(){this.cache=new Map}async initialize(){}getItem(t){return this.cache.get(t)||null}getUserData(t){return this.getItem(t)}setItem(t,r){this.cache.set(t,r)}async setUserData(t,r){this.setItem(t,r)}removeItem(t){this.cache.delete(t)}getKeys(){const t=[];return this.cache.forEach((r,a)=>{t.push(a)}),t}containsKey(t){return this.cache.has(t)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}class jT{constructor(t){this.inMemoryCache=new Dy,this.indexedDBCache=new RT,this.logger=t}handleDatabaseAccessError(t){if(t instanceof qm&&t.errorCode===Eb)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw t}async getItem(t){const r=this.inMemoryCache.getItem(t);if(!r)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(t)}catch(a){this.handleDatabaseAccessError(a)}return r}async setItem(t,r){this.inMemoryCache.setItem(t,r);try{await this.indexedDBCache.setItem(t,r)}catch(a){this.handleDatabaseAccessError(a)}}async removeItem(t){this.inMemoryCache.removeItem(t);try{await this.indexedDBCache.removeItem(t)}catch(r){this.handleDatabaseAccessError(r)}}async getKeys(){const t=this.inMemoryCache.getKeys();if(t.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(r){this.handleDatabaseAccessError(r)}return t}async containsKey(t){const r=this.inMemoryCache.containsKey(t);if(!r)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(t)}catch(a){this.handleDatabaseAccessError(a)}return r}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const t=await this.indexedDBCache.deleteDatabase();return t&&this.logger.verbose("Persistent keystore deleted"),t}catch(t){return this.handleDatabaseAccessError(t),!1}}}class bd{constructor(t,r,a){this.logger=t,hT(a??!1),this.cache=new jT(this.logger),this.performanceClient=r}createNewGuid(){return Yu()}base64Encode(t){return Um(t)}base64Decode(t){return Dl(t)}base64UrlEncode(t){return e2(t)}encodeKid(t){return this.base64UrlEncode(JSON.stringify({kid:t}))}async getPublicKeyThumbprint(t){const r=this.performanceClient?.startMeasurement(Ye.CryptoOptsGetPublicKeyThumbprint,t.correlationId),a=await fT(bd.EXTRACTABLE,bd.POP_KEY_USAGES),n=await u5(a.publicKey),e={e:n.e,kty:n.kty,n:n.n},p=d4(e),m=await this.hashString(p),y=await u5(a.privateKey),w=await pT(y,!1,["sign"]);return await this.cache.setItem(m,{privateKey:w,publicKey:a.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),r&&r.end({success:!0}),m}async removeTokenBindingKey(t){if(await this.cache.removeItem(t),await this.cache.containsKey(t))throw Qt(Iw)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(t){return t instanceof Error?this.logger.error(`Clearing keystore failed with error: ${t.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(t,r,a,n){const e=this.performanceClient?.startMeasurement(Ye.CryptoOptsSignJwt,n),p=await this.cache.getItem(r);if(!p)throw Tr(Tb);const m=await u5(p.publicKey),y=d4(m),w=e2(JSON.stringify({kid:r})),A=Sb.getShrHeaderString({...a?.header,alg:m.alg,kid:w}),I=e2(A);t.cnf={jwk:JSON.parse(y)};const R=e2(JSON.stringify(t)),k=`${I}.${R}`,V=new TextEncoder().encode(k),q=await mT(p.privateKey,V),U=Af(new Uint8Array(q)),te=`${k}.${U}`;return e&&e.end({success:!0}),te}async hashString(t){return i8(t)}}bd.POP_KEY_USAGES=["sign","verify"];bd.EXTRACTABLE=!0;function d4(i){return JSON.stringify(i,Object.keys(i).sort())}const OT=1440*60*1e3,rv={Lax:"Lax",None:"None"};class f8{initialize(){return Promise.resolve()}getItem(t){const r=`${encodeURIComponent(t)}`,a=document.cookie.split(";");for(let n=0;n<a.length;n++){const e=a[n],[p,...m]=decodeURIComponent(e).trim().split("="),y=m.join("=");if(p===r)return y}return""}getUserData(){throw Qt(Yn)}setItem(t,r,a,n=!0,e=rv.Lax){let p=`${encodeURIComponent(t)}=${encodeURIComponent(r)};path=/;SameSite=${e};`;if(a){const m=LT(a);p+=`expires=${m};`}(n||e===rv.None)&&(p+="Secure;"),document.cookie=p}async setUserData(){return Promise.reject(Qt(Yn))}removeItem(t){this.setItem(t,"",-1)}getKeys(){const t=document.cookie.split(";"),r=[];return t.forEach(a=>{const n=decodeURIComponent(a).trim().split("=");r.push(n[0])}),r}containsKey(t){return this.getKeys().includes(t)}decryptData(){return Promise.resolve(null)}}function LT(i){const t=new Date;return new Date(t.getTime()+i*OT).toUTCString()}function ff(i,t){const r=i.getItem(K1(t));return r?JSON.parse(r):[]}function Hu(i,t,r){const a=t.getItem(Y1(i,r));if(a){const n=JSON.parse(a);if(n&&n.hasOwnProperty("idToken")&&n.hasOwnProperty("accessToken")&&n.hasOwnProperty("refreshToken"))return n}return{idToken:[],accessToken:[],refreshToken:[]}}function b2(i){return i.hasOwnProperty("id")&&i.hasOwnProperty("nonce")&&i.hasOwnProperty("data")}const f4="msal.cache.encryption",PT="msal.broadcast.cache";class MT{constructor(t,r,a){if(!window.localStorage)throw Ji(Iy);this.memoryStorage=new Dy,this.initialized=!1,this.clientId=t,this.logger=r,this.performanceClient=a,this.broadcast=new BroadcastChannel(PT)}async initialize(t){const r=new f8,a=r.getItem(f4);let n={key:"",id:""};if(a)try{n=JSON.parse(a)}catch{}if(n.key&&n.id){const e=Bc(Sf,Ye.Base64Decode,this.logger,this.performanceClient,t)(n.key);this.encryptionCookie={id:n.id,key:await It(n4,Ye.GenerateHKDF,this.logger,this.performanceClient,t)(e)}}else{const e=Yu(),p=await It(a8,Ye.GenerateBaseKey,this.logger,this.performanceClient,t)(),m=Bc(Af,Ye.UrlEncodeArr,this.logger,this.performanceClient,t)(new Uint8Array(p));this.encryptionCookie={id:e,key:await It(n4,Ye.GenerateHKDF,this.logger,this.performanceClient,t)(p)};const y={id:e,key:m};r.setItem(f4,JSON.stringify(y),0,!0,rv.None)}await It(this.importExistingCache.bind(this),Ye.ImportExistingCache,this.logger,this.performanceClient,t)(t),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(t){return window.localStorage.getItem(t)}getUserData(t){if(!this.initialized)throw Tr(km);return this.memoryStorage.getItem(t)}async decryptData(t,r,a){if(!this.initialized||!this.encryptionCookie)throw Tr(km);if(r.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},a),null;const n=await It(a4,Ye.Decrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,r.nonce,this.getContext(t),r.data);if(!n)return null;try{return{...JSON.parse(n),lastUpdatedAt:r.lastUpdatedAt}}catch{return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},a),null}}setItem(t,r){window.localStorage.setItem(t,r)}async setUserData(t,r,a,n,e){if(!this.initialized||!this.encryptionCookie)throw Tr(km);if(e)this.setItem(t,r);else{const{data:p,nonce:m}=await It(vT,Ye.Encrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,r,this.getContext(t)),y={id:this.encryptionCookie.id,nonce:m,data:p,lastUpdatedAt:n};this.setItem(t,JSON.stringify(y))}this.memoryStorage.setItem(t,r),this.broadcast.postMessage({key:t,value:r,context:this.getContext(t)})}removeItem(t){this.memoryStorage.containsKey(t)&&(this.memoryStorage.removeItem(t),this.broadcast.postMessage({key:t,value:null,context:this.getContext(t)})),window.localStorage.removeItem(t)}getKeys(){return Object.keys(window.localStorage)}containsKey(t){return window.localStorage.hasOwnProperty(t)}clear(){this.memoryStorage.clear(),ff(this).forEach(a=>this.removeItem(a));const r=Hu(this.clientId,this);r.idToken.forEach(a=>this.removeItem(a)),r.accessToken.forEach(a=>this.removeItem(a)),r.refreshToken.forEach(a=>this.removeItem(a)),this.getKeys().forEach(a=>{(a.startsWith(dl)||a.indexOf(this.clientId)!==-1)&&this.removeItem(a)})}async importExistingCache(t){if(!this.encryptionCookie)return;let r=ff(this);r=await this.importArray(r,t),r.length?this.setItem(K1(),JSON.stringify(r)):this.removeItem(K1());const a=Hu(this.clientId,this);a.idToken=await this.importArray(a.idToken,t),a.accessToken=await this.importArray(a.accessToken,t),a.refreshToken=await this.importArray(a.refreshToken,t),a.idToken.length||a.accessToken.length||a.refreshToken.length?this.setItem(Y1(this.clientId),JSON.stringify(a)):this.removeItem(Y1(this.clientId))}async getItemFromEncryptedCache(t,r){if(!this.encryptionCookie)return null;const a=this.getItem(t);if(!a)return null;let n;try{n=JSON.parse(a)}catch{return null}return b2(n)?n.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},r),null):(this.performanceClient.incrementFields({encryptedCacheCount:1},r),It(a4,Ye.Decrypt,this.logger,this.performanceClient,r)(this.encryptionCookie.key,n.nonce,this.getContext(t),n.data)):(this.performanceClient.incrementFields({unencryptedCacheCount:1},r),a)}async importArray(t,r){const a=[],n=[];return t.forEach(e=>{const p=this.getItemFromEncryptedCache(e,r).then(m=>{m?(this.memoryStorage.setItem(e,m),a.push(e)):this.removeItem(e)});n.push(p)}),await Promise.all(n),a}getContext(t){let r="";return t.includes(this.clientId)&&(r=this.clientId),r}updateCache(t){this.logger.trace("Updating internal cache from broadcast event");const r=this.performanceClient.startMeasurement(Ye.LocalStorageUpdated);r.add({isBackground:!0});const{key:a,value:n,context:e}=t.data;if(!a){this.logger.error("Broadcast event missing key"),r.end({success:!1,errorCode:"noKey"});return}if(e&&e!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${e}`),r.end({success:!1,errorCode:"contextMismatch"});return}n?(this.memoryStorage.setItem(a,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(a),this.logger.verbose("Removed item from internal cache")),r.end({success:!0})}}class UT{constructor(){if(!window.sessionStorage)throw Ji(Iy)}async initialize(){}getItem(t){return window.sessionStorage.getItem(t)}getUserData(t){return this.getItem(t)}setItem(t,r){window.sessionStorage.setItem(t,r)}async setUserData(t,r){this.setItem(t,r)}removeItem(t){window.sessionStorage.removeItem(t)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(t){return window.sessionStorage.hasOwnProperty(t)}decryptData(){return Promise.resolve(null)}}const jr={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache",BROKER_CONNECTION_ESTABLISHED:"msal:brokerConnectionEstablished"};function uf(i,t){const r=i.indexOf(t);r>-1&&i.splice(r,1)}class nv extends J5{constructor(t,r,a,n,e,p,m){super(t,a,n,e,m),this.cacheConfig=r,this.logger=n,this.internalStorage=new Dy,this.browserStorage=p4(t,r.cacheLocation,n,e),this.temporaryCacheStorage=p4(t,r.temporaryCacheLocation,n,e),this.cookieStorage=new f8,this.eventHandler=p}async initialize(t){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},t),await this.browserStorage.initialize(t),await this.migrateExistingCache(t),this.trackVersionChanges(t)}async migrateExistingCache(t){let r=ff(this.browserStorage),a=Hu(this.clientId,this.browserStorage);this.performanceClient.addFields({preMigrateAcntCount:r.length,preMigrateATCount:a.accessToken.length,preMigrateITCount:a.idToken.length,preMigrateRTCount:a.refreshToken.length},t);for(let e=0;e<v2;e++){const p=e;await this.removeStaleAccounts(e,p,t)}for(let e=0;e<ul;e++){const p=e;await this.migrateIdTokens(e,p,t)}const n=this.getKMSIValues();for(let e=0;e<ul;e++)await this.migrateAccessTokens(e,n,t),await this.migrateRefreshTokens(e,n,t);r=ff(this.browserStorage),a=Hu(this.clientId,this.browserStorage),this.performanceClient.addFields({postMigrateAcntCount:r.length,postMigrateATCount:a.accessToken.length,postMigrateITCount:a.idToken.length,postMigrateRTCount:a.refreshToken.length},t)}async updateOldEntry(t,r){const a=this.browserStorage.getItem(t),n=this.validateAndParseJson(a||"");if(!n)return this.browserStorage.removeItem(t),null;if(!n.lastUpdatedAt)n.lastUpdatedAt=Date.now().toString(),this.setItem(t,JSON.stringify(n),r);else if(Gx(n.lastUpdatedAt,this.cacheConfig.cacheRetentionDays))return this.browserStorage.removeItem(t),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},r),null;const e=b2(n)?await this.browserStorage.decryptData(t,n,r):n;return!e||!Ay(e)?(this.performanceClient.incrementFields({invalidCacheCount:1},r),null):(Vx(e)||Wx(e))&&e.expiresOn&&G2(e.expiresOn,pw)?(this.browserStorage.removeItem(t),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},r),null):e}async removeStaleAccounts(t,r,a){const n=ff(this.browserStorage,t);if(n.length!==0){for(const e of[...n]){this.performanceClient.incrementFields({oldAcntCount:1},a);const p=this.browserStorage.getItem(e),m=this.validateAndParseJson(p||"");if(!m){uf(n,e);continue}if(m.lastUpdatedAt)Gx(m.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)&&(await this.removeAccountOldSchema(e,m,r,a),uf(n,e));else{m.lastUpdatedAt=Date.now().toString(),this.setItem(e,JSON.stringify(m),a);continue}}this.setAccountKeys(n,a,t)}}async removeAccountOldSchema(t,r,a,n){const p=(b2(r)?await this.browserStorage.decryptData(t,r,n):r)?.homeAccountId;if(p){const m=this.getTokenKeys(a);[...m.idToken].filter(y=>y.includes(p)).forEach(y=>{this.browserStorage.removeItem(y),uf(m.idToken,y)}),[...m.accessToken].filter(y=>y.includes(p)).forEach(y=>{this.browserStorage.removeItem(y),uf(m.accessToken,y)}),[...m.refreshToken].filter(y=>y.includes(p)).forEach(y=>{this.browserStorage.removeItem(y),uf(m.refreshToken,y)}),this.setTokenKeys(m,n,a)}this.performanceClient.incrementFields({expiredAcntRemovedCount:1},n),this.browserStorage.removeItem(t)}getKMSIValues(){const t={},r=this.getTokenKeys().idToken;for(const a of r){const n=this.browserStorage.getUserData(a);if(n){const e=JSON.parse(n),p=_h(e.secret,Dl);p&&(t[e.homeAccountId]=Fh(p))}}return t}async migrateIdTokens(t,r,a){const n=Hu(this.clientId,this.browserStorage,t);if(n.idToken.length===0)return;const e=Hu(this.clientId,this.browserStorage,ul),p=ff(this.browserStorage),m=ff(this.browserStorage,r);for(const y of[...n.idToken]){this.performanceClient.incrementFields({oldITCount:1},a);const w=await this.updateOldEntry(y,a);if(!w){uf(n.idToken,y);continue}const A=p.find(te=>te.includes(w.homeAccountId)),I=m.find(te=>te.includes(w.homeAccountId));let R=null;if(A)R=this.getAccount(A,a);else if(I){const te=this.browserStorage.getItem(I),W=this.validateAndParseJson(te||"");R=W&&b2(W)?await this.browserStorage.decryptData(I,W,a):W}if(!R){this.performanceClient.incrementFields({skipITMigrateCount:1},a);continue}const k=_h(w.secret,Dl),M=this.generateCredentialKey(w),V=this.getIdTokenCredential(M,a),q=Object.keys(k).includes("signin_state"),U=V&&Object.keys(_h(V.secret,Dl)||{}).includes("signin_state");if(!V||w.lastUpdatedAt>V.lastUpdatedAt&&(q||!U)){const te=R.tenantProfiles||[],W=rb(k)||R.realm;if(W&&!te.find(ve=>ve.tenantId===W)){const ve=yy(R.homeAccountId,R.localAccountId,W,k);te.push(ve)}R.tenantProfiles=te;const re=this.generateAccountKey(Fi.getAccountInfo(R)),xe=Fh(k);await this.setUserData(re,JSON.stringify(R),a,R.lastUpdatedAt,xe),p.includes(re)||p.push(re),await this.setUserData(M,JSON.stringify(w),a,w.lastUpdatedAt,xe),this.performanceClient.incrementFields({migratedITCount:1},a),e.idToken.push(M)}}this.setTokenKeys(n,a,t),this.setTokenKeys(e,a),this.setAccountKeys(p,a)}async migrateAccessTokens(t,r,a){const n=Hu(this.clientId,this.browserStorage,t);if(n.accessToken.length===0)return;const e=Hu(this.clientId,this.browserStorage,ul);for(const p of[...n.accessToken]){this.performanceClient.incrementFields({oldATCount:1},a);const m=await this.updateOldEntry(p,a);if(!m){uf(n.accessToken,p);continue}if(!Object.keys(r).includes(m.homeAccountId)){this.performanceClient.incrementFields({skipATMigrateCount:1},a);continue}const y=this.generateCredentialKey(m),w=r[m.homeAccountId];if(!e.accessToken.includes(y))await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,w),this.performanceClient.incrementFields({migratedATCount:1},a),e.accessToken.push(y);else{const A=this.getAccessTokenCredential(y,a);(!A||m.lastUpdatedAt>A.lastUpdatedAt)&&(await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,w),this.performanceClient.incrementFields({migratedATCount:1},a))}}this.setTokenKeys(n,a,t),this.setTokenKeys(e,a)}async migrateRefreshTokens(t,r,a){const n=Hu(this.clientId,this.browserStorage,t);if(n.refreshToken.length===0)return;const e=Hu(this.clientId,this.browserStorage,ul);for(const p of[...n.refreshToken]){this.performanceClient.incrementFields({oldRTCount:1},a);const m=await this.updateOldEntry(p,a);if(!m){uf(n.refreshToken,p);continue}if(!Object.keys(r).includes(m.homeAccountId)){this.performanceClient.incrementFields({skipRTMigrateCount:1},a);continue}const y=this.generateCredentialKey(m),w=r[m.homeAccountId];if(!e.refreshToken.includes(y))await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,w),this.performanceClient.incrementFields({migratedRTCount:1},a),e.refreshToken.push(y);else{const A=this.getRefreshTokenCredential(y,a);(!A||m.lastUpdatedAt>A.lastUpdatedAt)&&(await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,w),this.performanceClient.incrementFields({migratedRTCount:1},a))}}this.setTokenKeys(n,a,t),this.setTokenKeys(e,a)}trackVersionChanges(t){const r=this.browserStorage.getItem(c4);r&&(this.logger.info(`MSAL.js was last initialized by version: ${r}`),this.performanceClient.addFields({previousLibraryVersion:r},t)),r!==_0&&this.setItem(c4,_0,t)}validateAndParseJson(t){if(!t)return null;try{const r=JSON.parse(t);return r&&typeof r=="object"?r:null}catch{return null}}setItem(t,r,a){const n=new Array(ul+1).fill(0),e=[],p=20;for(let m=0;m<=p;m++)try{if(this.browserStorage.setItem(t,r),m>0)for(let y=0;y<=ul;y++){const w=n.slice(0,y).reduce((I,R)=>I+R,0);if(w>=m)break;const A=m>w+n[y]?w+n[y]:m;m>w&&n[y]>0&&this.removeAccessTokenKeys(e.slice(w,A),a,y)}break}catch(y){const w=Y5(y);if(w.errorCode===H2&&m<p){if(!e.length)for(let A=0;A<=ul;A++)if(t===Y1(this.clientId,A)){const I=JSON.parse(r).accessToken;e.push(...I),n[A]=I.length}else{const I=this.getTokenKeys(A).accessToken;e.push(...I),n[A]=I.length}if(e.length<=m)throw w;this.removeAccessToken(e[m],a,!1)}else throw w}}async setUserData(t,r,a,n,e){const p=new Array(ul+1).fill(0),m=[],y=20;for(let w=0;w<=y;w++)try{if(await It(this.browserStorage.setUserData.bind(this.browserStorage),Ye.SetUserData,this.logger,this.performanceClient)(t,r,a,n,e),w>0)for(let A=0;A<=ul;A++){const I=p.slice(0,A).reduce((k,M)=>k+M,0);if(I>=w)break;const R=w>I+p[A]?I+p[A]:w;w>I&&p[A]>0&&this.removeAccessTokenKeys(m.slice(I,R),a,A)}break}catch(A){const I=Y5(A);if(I.errorCode===H2&&w<y){if(!m.length)for(let R=0;R<=ul;R++){const k=this.getTokenKeys(R).accessToken;m.push(...k),p[R]=k.length}if(m.length<=w)throw I;this.removeAccessToken(m[w],a,!1)}else throw I}}getAccount(t,r){this.logger.trace("BrowserCacheManager.getAccount called");const a=this.browserStorage.getUserData(t);if(!a)return this.removeAccountKeyFromMap(t,r),null;const n=this.validateAndParseJson(a);return!n||!Fi.isAccountEntity(n)?null:J5.toObject(new Fi,n)}async setAccount(t,r,a){this.logger.trace("BrowserCacheManager.setAccount called");const n=this.generateAccountKey(Fi.getAccountInfo(t)),e=Date.now().toString();t.lastUpdatedAt=e,await this.setUserData(n,JSON.stringify(t),r,e,a);const p=this.addAccountKeyToMap(n,r);this.performanceClient.addFields({kmsi:a},r),this.cacheConfig.cacheLocation===zo.LocalStorage&&p&&this.eventHandler.emitEvent(jr.ACCOUNT_ADDED,void 0,Fi.getAccountInfo(t))}getAccountKeys(){return ff(this.browserStorage)}setAccountKeys(t,r,a=v2){t.length===0?this.removeItem(K1(a)):this.setItem(K1(a),JSON.stringify(t),r)}addAccountKeyToMap(t,r){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${t}`);const a=this.getAccountKeys();return a.indexOf(t)===-1?(a.push(t),this.setItem(K1(),JSON.stringify(a),r),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(t,r){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${t}`);const a=this.getAccountKeys(),n=a.indexOf(t);n>-1?(a.splice(n,1),this.setAccountKeys(a,r),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(t,r){const a=this.getActiveAccount(r);a?.homeAccountId===t.homeAccountId&&a?.environment===t.environment&&this.setActiveAccount(null,r),super.removeAccount(t,r),this.removeAccountKeyFromMap(this.generateAccountKey(t),r),this.browserStorage.getKeys().forEach(n=>{n.includes(t.homeAccountId)&&n.includes(t.environment)&&this.browserStorage.removeItem(n)}),this.cacheConfig.cacheLocation===zo.LocalStorage&&this.eventHandler.emitEvent(jr.ACCOUNT_REMOVED,void 0,t)}removeIdToken(t,r){super.removeIdToken(t,r);const a=this.getTokenKeys(),n=a.idToken.indexOf(t);n>-1&&(this.logger.info("idToken removed from tokenKeys map"),a.idToken.splice(n,1),this.setTokenKeys(a,r))}removeAccessToken(t,r,a=!0){super.removeAccessToken(t,r),a&&this.removeAccessTokenKeys([t],r)}removeAccessTokenKeys(t,r,a=ul){this.logger.trace("removeAccessTokenKey called");const n=this.getTokenKeys(a);let e=0;if(t.forEach(p=>{const m=n.accessToken.indexOf(p);m>-1&&(n.accessToken.splice(m,1),e++)}),e>0){this.logger.info(`removed ${e} accessToken keys from tokenKeys map`),this.setTokenKeys(n,r,a);return}}removeRefreshToken(t,r){super.removeRefreshToken(t,r);const a=this.getTokenKeys(),n=a.refreshToken.indexOf(t);n>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),a.refreshToken.splice(n,1),this.setTokenKeys(a,r))}getTokenKeys(t=ul){return Hu(this.clientId,this.browserStorage,t)}setTokenKeys(t,r,a=ul){if(t.idToken.length===0&&t.accessToken.length===0&&t.refreshToken.length===0){this.removeItem(Y1(this.clientId,a));return}else this.setItem(Y1(this.clientId,a),JSON.stringify(t),r)}getIdTokenCredential(t,r){const a=this.browserStorage.getUserData(t);if(!a)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(t,r),null;const n=this.validateAndParseJson(a);return!n||!AN(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n)}async setIdTokenCredential(t,r,a){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=this.generateCredentialKey(t),e=Date.now().toString();t.lastUpdatedAt=e,await this.setUserData(n,JSON.stringify(t),r,e,a);const p=this.getTokenKeys();p.idToken.indexOf(n)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),p.idToken.push(n),this.setTokenKeys(p,r))}getAccessTokenCredential(t,r){const a=this.browserStorage.getUserData(t);if(!a)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([t],r),null;const n=this.validateAndParseJson(a);return!n||!Vx(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n)}async setAccessTokenCredential(t,r,a){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=this.generateCredentialKey(t),e=Date.now().toString();t.lastUpdatedAt=e,await this.setUserData(n,JSON.stringify(t),r,e,a);const p=this.getTokenKeys(),m=p.accessToken.indexOf(n);m!==-1&&p.accessToken.splice(m,1),this.logger.trace(`access token ${m===-1?"added to":"updated in"} map`),p.accessToken.push(n),this.setTokenKeys(p,r)}getRefreshTokenCredential(t,r){const a=this.browserStorage.getUserData(t);if(!a)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(t,r),null;const n=this.validateAndParseJson(a);return!n||!Wx(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n)}async setRefreshTokenCredential(t,r,a){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=this.generateCredentialKey(t),e=Date.now().toString();t.lastUpdatedAt=e,await this.setUserData(n,JSON.stringify(t),r,e,a);const p=this.getTokenKeys();p.refreshToken.indexOf(n)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),p.refreshToken.push(n),this.setTokenKeys(p,r))}getAppMetadata(t){const r=this.browserStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(r);return!a||!EN(t,a)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),a)}setAppMetadata(t,r){this.logger.trace("BrowserCacheManager.setAppMetadata called");const a=TN(t);this.setItem(a,JSON.stringify(t),r)}getServerTelemetry(t){const r=this.browserStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const a=this.validateAndParseJson(r);return!a||!CN(t,a)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),a)}setServerTelemetry(t,r,a){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(r),a)}getAuthorityMetadata(t){const r=this.internalStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(r);return a&&kN(t,a)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),a):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(r=>this.isAuthorityMetadata(r))}setWrapperMetadata(t,r){this.internalStorage.setItem(Zg.WRAPPER_SKU,t),this.internalStorage.setItem(Zg.WRAPPER_VER,r)}getWrapperMetadata(){const t=this.internalStorage.getItem(Zg.WRAPPER_SKU)||Pt.EMPTY_STRING,r=this.internalStorage.getItem(Zg.WRAPPER_VER)||Pt.EMPTY_STRING;return[t,r]}setAuthorityMetadata(t,r){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(r))}getActiveAccount(t){const r=this.generateCacheKey(Fx.ACTIVE_ACCOUNT_FILTERS),a=this.browserStorage.getItem(r);if(!a)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const n=this.validateAndParseJson(a);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId},t)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(t,r){const a=this.generateCacheKey(Fx.ACTIVE_ACCOUNT_FILTERS);if(t){this.logger.verbose("setActiveAccount: Active account set");const n={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId,tenantId:t.tenantId,lastUpdatedAt:lc().toString()};this.setItem(a,JSON.stringify(n),r)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(a);this.eventHandler.emitEvent(jr.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(t){const r=this.browserStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const a=this.validateAndParseJson(r);return!a||!NN(t,a)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),a)}setThrottlingCache(t,r,a){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(r),a)}getTemporaryCache(t,r){const a=r?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(a);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(a);if(!n){if(this.cacheConfig.cacheLocation===zo.LocalStorage){const e=this.browserStorage.getItem(a);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(t,r,a){const n=a?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(n,r),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,r,void 0,this.cacheConfig.secureCookies))}removeItem(t){this.browserStorage.removeItem(t)}removeTemporaryItem(t){this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(t))}getKeys(){return this.browserStorage.getKeys()}clear(t){this.removeAllAccounts(t),this.removeAppMetadata(t),this.temporaryCacheStorage.getKeys().forEach(r=>{(r.indexOf(dl)!==-1||r.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(r)}),this.browserStorage.getKeys().forEach(r=>{(r.indexOf(dl)!==-1||r.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(r)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(t){this.performanceClient.addQueueMeasurement(Ye.ClearTokensAndKeysWithClaims,t);const r=this.getTokenKeys();let a=0;r.accessToken.forEach(n=>{const e=this.getAccessTokenCredential(n,t);e?.requestedClaimsHash&&n.includes(e.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(n,t),a++)}),a>0&&this.logger.warning(`${a} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(t){return Uc.startsWith(t,dl)?t:`${dl}.${this.clientId}.${t}`}generateCredentialKey(t){const r=t.credentialType===Bo.REFRESH_TOKEN&&t.familyId||t.clientId,a=t.tokenType&&t.tokenType.toLowerCase()!==rs.BEARER.toLowerCase()?t.tokenType.toLowerCase():"";return[`${dl}.${ul}`,t.homeAccountId,t.environment,t.credentialType,r,t.realm||"",t.target||"",t.requestedClaimsHash||"",a].join(l4).toLowerCase()}generateAccountKey(t){const r=t.homeAccountId.split(".")[1];return[`${dl}.${v2}`,t.homeAccountId,t.environment,r||t.tenantId||""].join(l4).toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Qi.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Qi.VERIFIER)),this.removeTemporaryItem(this.generateCacheKey(Qi.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Qi.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Qi.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(t,r){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const a=Um(JSON.stringify(t));if(this.setTemporaryCache(Qi.REQUEST_PARAMS,a,!0),r){const n=Um(r);this.setTemporaryCache(Qi.VERIFIER,n,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(Qi.REQUEST_PARAMS,!0);if(!t)throw Tr(P6);const r=this.getTemporaryCache(Qi.VERIFIER,!0);let a,n="";try{a=JSON.parse(Dl(t)),r&&(n=Dl(r))}catch(e){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${e}`),Tr(M6)}return[a,n]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const t=this.getTemporaryCache(Qi.NATIVE_REQUEST,!0);if(!t)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const r=this.validateAndParseJson(t);return r||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(t){const r=this.getInteractionInProgress()?.clientId;return t?r===this.clientId:!!r}getInteractionInProgress(){const t=`${dl}.${Qi.INTERACTION_STATUS_KEY}`,r=this.getTemporaryCache(t,!1);try{return r?JSON.parse(r):null}catch{return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(t),this.resetRequestCache(),o8(window),null}}setInteractionInProgress(t,r=pf.SIGNIN){const a=`${dl}.${Qi.INTERACTION_STATUS_KEY}`;if(t){if(this.getInteractionInProgress())throw Tr(_6);this.setTemporaryCache(a,JSON.stringify({clientId:this.clientId,type:r}),!1)}else!t&&this.getInteractionInProgress()?.clientId===this.clientId&&this.removeTemporaryItem(a)}async hydrateCache(t,r){const a=wy(t.account?.homeAccountId,t.account?.environment,t.idToken,this.clientId,t.tenantId);let n;r.claims&&(n=await this.cryptoImpl.hashString(r.claims));const e=Sy(t.account?.homeAccountId,t.account.environment,t.accessToken,this.clientId,t.tenantId,t.scopes.join(" "),t.expiresOn?qx(t.expiresOn):0,t.extExpiresOn?qx(t.extExpiresOn):0,Dl,void 0,t.tokenType,void 0,r.sshKid,r.claims,n),p={idToken:a,accessToken:e};return this.saveCacheRecord(p,t.correlationId,Fh(_h(t.idToken,Dl)))}async saveCacheRecord(t,r,a,n){try{await super.saveCacheRecord(t,r,a,n)}catch(e){if(e instanceof V1&&this.performanceClient&&r)try{const p=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:p.refreshToken.length,cacheIdCount:p.idToken.length,cacheAtCount:p.accessToken.length},r)}catch{}throw e}}}function p4(i,t,r,a){try{switch(t){case zo.LocalStorage:return new MT(i,r,a);case zo.SessionStorage:return new UT;case zo.MemoryStorage:default:break}}catch(n){r.error(n)}return new Dy}const BT=(i,t,r,a)=>{const n={cacheLocation:zo.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:zo.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new nv(i,n,P2,t,r,a)};function HT(i,t,r,a,n){return i.verbose("getAllAccounts called"),r?t.getAllAccounts(n||{},a):[]}function zT(i,t,r,a){const n=r.getAccountInfoFilteredBy(i,a);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}function $T(i,t,r,a){if(t.trace("getAccountByUsername called"),!i)return t.warning("getAccountByUsername: No username provided"),null;const n=r.getAccountInfoFilteredBy({username:i},a);return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${i}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}function qT(i,t,r,a){if(t.trace("getAccountByHomeId called"),!i)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const n=r.getAccountInfoFilteredBy({homeAccountId:i},a);return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${i}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function GT(i,t,r,a){if(t.trace("getAccountByLocalId called"),!i)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const n=r.getAccountInfoFilteredBy({localAccountId:i},a);return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${i}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function VT(i,t,r){t.setActiveAccount(i,r)}function WT(i,t){return i.getActiveAccount(t)}const KT="msal.broadcast.event";class YT{constructor(t){this.eventCallbacks=new Map,this.logger=t||new vd({}),typeof BroadcastChannel<"u"&&(this.broadcastChannel=new BroadcastChannel(KT)),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(t,r,a){if(typeof window<"u"){const n=a||NT();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[t,r||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(t){this.eventCallbacks.delete(t),this.logger.verbose(`Event callback ${t} removed.`)}emitEvent(t,r,a,n){const e={eventType:t,interactionType:r||null,payload:a||null,error:n||null,timestamp:Date.now()};switch(t){case jr.ACCOUNT_ADDED:case jr.ACCOUNT_REMOVED:case jr.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel?.postMessage(e);break;default:this.invokeCallbacks(e);break}}invokeCallbacks(t){this.eventCallbacks.forEach(([r,a],n)=>{(a.length===0||a.includes(t.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${t.eventType}`),r.apply(null,[t]))})}invokeCrossTabCallbacks(t){const r=t.data;this.invokeCallbacks(r)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}class p8{constructor(t,r,a,n,e,p,m,y,w){this.config=t,this.browserStorage=r,this.browserCrypto=a,this.networkClient=this.config.system.networkClient,this.eventHandler=e,this.navigationClient=p,this.platformAuthProvider=y,this.correlationId=w||Yu(),this.logger=n.clone(ic.MSAL_SKU,_0,this.correlationId),this.performanceClient=m}async clearCacheOnLogout(t,r){if(r)try{this.browserStorage.removeAccount(r,t),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(t),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(t){this.logger.verbose("getRedirectUri called");const r=t||this.config.auth.redirectUri;return Da.getAbsoluteUrl(r,md())}initializeServerTelemetryManager(t,r){this.logger.verbose("initializeServerTelemetryManager called");const a={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:t,forceRefresh:r||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Pm(a,this.browserStorage)}async getDiscoveredAuthority(t){const{account:r}=t,a=t.requestExtraQueryParameters&&t.requestExtraQueryParameters.hasOwnProperty("instance_aware")?t.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Ye.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},e=t.requestAuthority||this.config.auth.authority,p=a?.length?a==="true":this.config.auth.instanceAware,m=r&&p?this.config.auth.authority.replace(Da.getDomainFromUrl(e),r.environment):e,y=hl.generateAuthority(m,t.requestAzureCloudOptions||this.config.auth.azureCloudOptions),w=await It(m6,Ye.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(y,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(r&&!w.isAlias(r.environment))throw ms(qw);return w}}async function Ub(i,t,r,a){r.addQueueMeasurement(Ye.InitializeBaseRequest,i.correlationId);const n=i.authority||t.auth.authority,e=[...i&&i.scopes||[]],p={...i,correlationId:i.correlationId,authority:n,scopes:e};if(!p.authenticationScheme)p.authenticationScheme=rs.BEARER,a.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(p.authenticationScheme===rs.SSH){if(!i.sshJwk)throw ms(gy);if(!i.sshKid)throw ms(Hw)}a.verbose(`Authentication Scheme set to "${p.authenticationScheme}" as configured in Auth request`)}return t.cache.claimsBasedCachingEnabled&&i.claims&&!Uc.isEmptyObj(i.claims)&&(p.requestedClaimsHash=await i8(i.claims)),p}async function JT(i,t,r,a,n){a.addQueueMeasurement(Ye.InitializeSilentRequest,i.correlationId);const e=await It(Ub,Ye.InitializeBaseRequest,n,a,i.correlationId)(i,r,a,n);return{...i,...e,account:t,forceRefresh:i.forceRefresh||!1}}function m8(i,t){let r;const a=i.httpMethod;if(t===oc.EAR){if(r=a||x0.POST,r!==x0.POST)throw ms(Gw)}else r=a||x0.GET;if(i.authorizePostBodyParameters&&r!==x0.POST)throw ms(Vw);return r}class up extends p8{initializeLogoutRequest(t){this.logger.verbose("initializeLogoutRequest called",t?.correlationId);const r={correlationId:this.correlationId||Yu(),...t};if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){const a=this.getLogoutHintFromIdTokenClaims(t.account);a&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),r.logoutHint=a)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!t||t.postLogoutRedirectUri!==null?t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",r.correlationId),r.postLogoutRedirectUri=Da.getAbsoluteUrl(t.postLogoutRedirectUri,md())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",r.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",r.correlationId),r.postLogoutRedirectUri=Da.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,md())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",r.correlationId),r.postLogoutRedirectUri=Da.getAbsoluteUrl(md(),md())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",r.correlationId),r}getLogoutHintFromIdTokenClaims(t){const r=t.idTokenClaims;if(r){if(r.login_hint)return r.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(t){this.performanceClient.addQueueMeasurement(Ye.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const r=await It(this.getClientConfiguration.bind(this),Ye.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(t);return new b6(r,this.performanceClient)}async getClientConfiguration(t){const{serverTelemetryManager:r,requestAuthority:a,requestAzureCloudOptions:n,requestExtraQueryParameters:e,account:p}=t;this.performanceClient.addQueueMeasurement(Ye.StandardInteractionClientGetClientConfiguration,this.correlationId);const m=t.authority||await It(this.getDiscoveredAuthority.bind(this),Ye.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:a,requestAzureCloudOptions:n,requestExtraQueryParameters:e,account:p}),y=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:m,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:y.loggerCallback,piiLoggingEnabled:y.piiLoggingEnabled,logLevel:y.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:r,libraryInfo:{sku:ic.MSAL_SKU,version:_0,cpu:Pt.EMPTY_STRING,os:Pt.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(t,r){this.performanceClient.addQueueMeasurement(Ye.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const a=this.getRedirectUri(t.redirectUri),n={interactionType:r},e=lp.setRequestState(this.browserCrypto,t&&t.state||Pt.EMPTY_STRING,n),m={...await It(Ub,Ye.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...t,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:a,state:e,nonce:t.nonce||Yu(),responseMode:this.config.auth.OIDCOptions.serverResponseType},y={...m,httpMethod:m8(m,this.config.auth.protocolMode)};if(t.loginHint||t.sid)return y;const w=t.account||this.browserStorage.getActiveAccount(this.correlationId);return w&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${w.homeAccountId}`,this.correlationId),y.account=w),y}}function QT(i,t){if(!t)return null;try{return lp.parseRequestState(i,t).libraryState.meta}catch{throw Qt(np)}}function _m(i,t,r){const a=U2(i);if(!a)throw Yw(i)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${i}`),Tr(T6)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),Tr(N6));return a}function XT(i,t,r){if(!i.state)throw Tr(Nb);const a=QT(t,i.state);if(!a)throw Tr(E6);if(a.interactionType!==r)throw Tr(k6)}class g8{constructor(t,r,a,n,e){this.authModule=t,this.browserStorage=r,this.authCodeRequest=a,this.logger=n,this.performanceClient=e}async handleCodeResponse(t,r){this.performanceClient.addQueueMeasurement(Ye.HandleCodeResponse,r.correlationId);let a;try{a=$N(t,r.state)}catch(n){throw n instanceof O0&&n.subError===Mm?Tr(Mm):n}return It(this.handleCodeResponseFromServer.bind(this),Ye.HandleCodeResponseFromServer,this.logger,this.performanceClient,r.correlationId)(a,r)}async handleCodeResponseFromServer(t,r,a=!0){if(this.performanceClient.addQueueMeasurement(Ye.HandleCodeResponseFromServer,r.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=t.code,t.cloud_instance_host_name&&await It(this.authModule.updateAuthority.bind(this.authModule),Ye.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,r.correlationId)(t.cloud_instance_host_name,r.correlationId),a&&(t.nonce=r.nonce||void 0),t.state=r.state,t.client_info)this.authCodeRequest.clientInfo=t.client_info;else{const e=this.createCcsCredentials(r);e&&(this.authCodeRequest.ccsCredential=e)}return await It(this.authModule.acquireToken.bind(this.authModule),Ye.AuthClientAcquireToken,this.logger,this.performanceClient,r.correlationId)(this.authCodeRequest,t)}createCcsCredentials(t){return t.account?{credential:t.account.homeAccountId,type:Vu.HOME_ACCOUNT_ID}:t.loginHint?{credential:t.loginHint,type:Vu.UPN}:null}}const ZT="ContentError",eE="PageException",y8="user_switch";const tE="USER_INTERACTION_REQUIRED",rE="USER_CANCEL",nE="NO_NETWORK",aE="DISABLED",sE="ACCOUNT_UNAVAILABLE",iE="UX_NOT_ALLOWED";const oE=-2147186943,lE={[y8]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class kh extends gs{constructor(t,r,a){super(t,r),Object.setPrototypeOf(this,kh.prototype),this.name="NativeAuthError",this.ext=a}}function U1(i){if(i.ext&&i.ext.status&&i.ext.status===aE||i.ext&&i.ext.error&&i.ext.error===oE)return!0;switch(i.errorCode){case ZT:case eE:return!0;default:return!1}}function Q2(i,t,r){if(r&&r.status)switch(r.status){case sE:return W2(g6);case tE:return new Ku(i,t);case rE:return Tr(Mm);case nE:return Tr(K2);case iE:return W2(vb)}return new kh(i,lE[i]||t,r)}class v8 extends up{async acquireToken(t){this.performanceClient.addQueueMeasurement(Ye.SilentCacheClientAcquireToken,t.correlationId);const r=this.initializeServerTelemetryManager(Ka.acquireTokenSilent_silentFlow),a=await It(this.getClientConfiguration.bind(this),Ye.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,account:t.account}),n=new BN(a,this.performanceClient);this.logger.verbose("Silent auth client created");try{const p=(await It(n.acquireCachedToken.bind(n),Ye.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,t.correlationId)(t))[0];return this.performanceClient.addFields({fromCache:!0},t.correlationId),p}catch(e){throw e instanceof qm&&e.errorCode===Tb&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(t){this.logger.verbose("logoutRedirect called");const r=this.initializeLogoutRequest(t);return this.clearCacheOnLogout(r.correlationId,r?.account)}}class x2 extends p8{constructor(t,r,a,n,e,p,m,y,w,A,I,R){super(t,r,a,n,e,p,y,w,R),this.apiId=m,this.accountId=A,this.platformAuthProvider=w,this.nativeStorageManager=I,this.silentCacheClient=new v8(t,this.nativeStorageManager,a,n,e,p,y,w,R);const k=this.platformAuthProvider.getExtensionName();this.skus=Pm.makeExtraSkuString({libraryName:ic.MSAL_SKU,libraryVersion:_0,extensionName:k,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(t){t.extraParameters={...t.extraParameters,[rN]:this.skus}}async acquireToken(t,r){this.performanceClient.addQueueMeasurement(Ye.NativeInteractionClientAcquireToken,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const a=this.performanceClient.startMeasurement(Ye.NativeInteractionClientAcquireToken,this.correlationId),n=lc(),e=this.initializeServerTelemetryManager(this.apiId);try{const p=await this.initializeNativeRequest(t);try{const y=await this.acquireTokensFromCache(this.accountId,p);return a.end({success:!0,isNativeBroker:!1,fromCache:!0}),y}catch(y){if(r===_l.AccessToken)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),a.end({success:!1,brokerErrorCode:"cache_request_failed"}),y;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const m=await this.platformAuthProvider.sendMessage(p);return await this.handleNativeResponse(m,p,n).then(y=>(a.end({success:!0,isNativeBroker:!0,requestId:y.requestId}),e.clearNativeBrokerErrorCode(),y)).catch(y=>{throw a.end({success:!1,errorCode:y.errorCode,subErrorCode:y.subError}),y})}catch(p){throw p instanceof kh&&e.setNativeBrokerErrorCode(p.errorCode),a.end({success:!1}),p}}createSilentCacheRequest(t,r){return{authority:t.authority,correlationId:this.correlationId,scopes:ro.fromString(t.scope).asArray(),account:r,forceRefresh:!1}}async acquireTokensFromCache(t,r){if(!t)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Qt(W5);const a=this.browserStorage.getBaseAccountInfo({nativeAccountId:t},this.correlationId);if(!a)throw Qt(W5);try{const n=this.createSilentCacheRequest(r,a),e=await this.silentCacheClient.acquireToken(n),p={...a,idTokenClaims:e?.idTokenClaims,idToken:e?.idToken};return{...e,account:p}}catch(n){throw n}}async acquireTokenRedirect(t,r){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...a}=t;delete a.onRedirectNavigate;const n=await this.initializeNativeRequest(a);try{await this.platformAuthProvider.sendMessage(n)}catch(m){if(m instanceof kh&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(m.errorCode),U1(m)))throw m}this.browserStorage.setTemporaryCache(Qi.NATIVE_REQUEST,JSON.stringify(n),!0);const e={apiId:Ka.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri);r.end({success:!0}),await this.navigationClient.navigateExternal(p,e)}async handleRedirectPromise(t,r){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const a=this.browserStorage.getCachedNativeRequest();if(!a)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),t&&r&&t?.addFields({errorCode:"no_cached_request"},r),null;const{prompt:n,...e}=a;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Qi.NATIVE_REQUEST));const p=lc();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const m=await this.platformAuthProvider.sendMessage(e),y=await this.handleNativeResponse(m,e,p);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),t&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),y}catch(m){throw m}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(t,r,a){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=_h(t.id_token,Dl),e=this.createHomeAccountIdentifier(t,n),p=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:r.accountId},this.correlationId)?.homeAccountId;if(r.extraParameters?.child_client_id&&t.account.id!==r.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(e!==p&&t.account.id!==r.accountId)throw Q2(y8);const m=await this.getDiscoveredAuthority({requestAuthority:r.authority}),y=bb(this.browserStorage,m,e,Dl,this.correlationId,n,t.client_info,void 0,n.tid,void 0,t.account.id,this.logger);t.expires_in=Number(t.expires_in);const w=await this.generateAuthenticationResult(t,r,n,y,m.canonicalAuthority,a);return await this.cacheAccount(y,this.correlationId,Fh(n)),await this.cacheNativeTokens(t,r,e,n,t.access_token,w.tenantId,a),w}createHomeAccountIdentifier(t,r){return Fi.generateHomeAccountId(t.client_info||Pt.EMPTY_STRING,qu.Default,this.logger,this.browserCrypto,r)}generateScopes(t,r){return r?ro.fromString(r):ro.fromString(t)}async generatePopAccessToken(t,r){if(r.tokenType===rs.POP&&r.signPopToken){if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),t.shr;const a=new ap(this.browserCrypto),n={resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,shrNonce:r.shrNonce};if(!r.keyId)throw Qt(Wv);return a.signPopToken(t.access_token,r.keyId,n)}else return t.access_token}async generateAuthenticationResult(t,r,a,n,e,p){const m=this.addTelemetryFromNativeResponse(t.properties.MATS),y=this.generateScopes(r.scope,t.scope),w=t.account.properties||{},A=w.UID||a.oid||a.sub||Pt.EMPTY_STRING,I=w.TenantId||a.tid||Pt.EMPTY_STRING,R=tb(Fi.getAccountInfo(n),void 0,a,t.id_token);R.nativeAccountId!==t.account.id&&(R.nativeAccountId=t.account.id);const k=await this.generatePopAccessToken(t,r),M=r.tokenType===rs.POP?rs.POP:rs.BEARER;return{authority:e,uniqueId:A,tenantId:I,scopes:y.asArray(),account:R,idToken:t.id_token,idTokenClaims:a,accessToken:k,fromCache:m?this.isResponseFromCache(m):!1,expiresOn:W1(p+t.expires_in),tokenType:M,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0}}async cacheAccount(t,r,a){await this.browserStorage.setAccount(t,this.correlationId,a),this.browserStorage.removeAccountContext(Fi.getAccountInfo(t),r)}cacheNativeTokens(t,r,a,n,e,p,m){const y=wy(a,r.authority,t.id_token||"",r.clientId,n.tid||""),w=r.tokenType===rs.POP?Pt.SHR_NONCE_VALIDITY:(typeof t.expires_in=="string"?parseInt(t.expires_in,10):t.expires_in)||0,A=m+w,I=this.generateScopes(t.scope,r.scope),R=Sy(a,r.authority,e,r.clientId,n.tid||p,I.printScopes(),A,0,Dl,void 0,r.tokenType,void 0,r.keyId),k={idToken:y,accessToken:R};return this.nativeStorageManager.saveCacheRecord(k,this.correlationId,Fh(n),r.storeInCache)}getExpiresInValue(t,r){return t===rs.POP?Pt.SHR_NONCE_VALIDITY:(typeof r=="string"?parseInt(r,10):r)||0}addTelemetryFromNativeResponse(t){const r=this.getMATSFromResponse(t);return r?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:r.broker_version,matsAccountJoinOnStart:r.account_join_on_start,matsAccountJoinOnEnd:r.account_join_on_end,matsDeviceJoin:r.device_join,matsPromptBehavior:r.prompt_behavior,matsApiErrorCode:r.api_error_code,matsUiVisible:r.ui_visible,matsSilentCode:r.silent_code,matsSilentBiSubCode:r.silent_bi_sub_code,matsSilentMessage:r.silent_message,matsSilentStatus:r.silent_status,matsHttpStatus:r.http_status,matsHttpEventCount:r.http_event_count},this.correlationId),r):null}getMATSFromResponse(t){if(t)try{return JSON.parse(t)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(t){return typeof t.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached}async initializeNativeRequest(t){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const r=await this.getCanonicalAuthority(t),{scopes:a,...n}=t,e=new ro(a||[]);e.appendScopes(op);const p={...n,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:e.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:this.getPrompt(t.prompt),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...t.extraQueryParameters,...t.tokenQueryParameters},extendedExpiryToken:!1,keyId:t.popKid};if(p.signPopToken&&t.popKid)throw Tr(J6);if(this.handleExtraBrokerParams(p),p.extraParameters=p.extraParameters||{},p.extraParameters.telemetry=iu.MATS_TELEMETRY,t.authenticationScheme===rs.POP){const m={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},y=new ap(this.browserCrypto);let w;if(p.keyId)w=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:p.keyId})),p.signPopToken=!1;else{const A=await It(y.generateCnf.bind(y),Ye.PopTokenGenerateCnf,this.logger,this.performanceClient,this.correlationId)(m,this.logger);w=A.reqCnfString,p.keyId=A.kid,p.signPopToken=!0}p.reqCnf=w}return this.addRequestSKUs(p),p}async getCanonicalAuthority(t){const r=t.authority||this.config.auth.authority;t.account&&await this.getDiscoveredAuthority({requestAuthority:r,requestAzureCloudOptions:t.azureCloudOptions,account:t.account});const a=new Da(r);return a.validateAsUri(),a}getPrompt(t){switch(this.apiId){case Ka.ssoSilent:case Ka.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Ho.NONE}if(!t){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(t){case Ho.NONE:case Ho.CONSENT:case Ho.LOGIN:case Ho.SELECT_ACCOUNT:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${t} is not compatible with native flow`),Tr(K6)}}handleExtraBrokerParams(t){const r=t.extraParameters&&t.extraParameters.hasOwnProperty(z2)&&t.extraParameters.hasOwnProperty($2)&&t.extraParameters.hasOwnProperty(E0);if(!t.embeddedClientId&&!r)return;let a="";const n=t.redirectUri;t.embeddedClientId?(t.redirectUri=this.config.auth.redirectUri,a=t.embeddedClientId):t.extraParameters&&(t.redirectUri=t.extraParameters[$2],a=t.extraParameters[E0]),t.extraParameters={child_client_id:a,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:a,embeddedRedirectUri:n},this.correlationId)}}async function Bb(i,t,r,a,n){const e=zN({...i.auth,authority:t},r,a,n);if(hb(e,{sku:ic.MSAL_SKU,version:_0,os:"",cpu:""}),i.auth.protocolMode!==oc.OIDC&&db(e,i.telemetry.application),r.platformBroker&&(iN(e),n.addFields({isPlatformAuthorizeRequest:!0},r.correlationId),r.authenticationScheme===rs.POP)){const p=new bd(a,n),m=new ap(p);let y;r.popKid?y=p.encodeKid(r.popKid):y=(await It(m.generateCnf.bind(m),Ye.PopTokenGenerateCnf,a,n,r.correlationId)(r,a)).reqCnfString,mb(e,y)}return vy(e,r.correlationId,n),e}async function Hb(i,t,r,a,n){if(!r.codeChallenge)throw ms(Xv);const e=await It(Bb,Ye.GetStandardParams,a,n,r.correlationId)(i,t,r,a,n);return sb(e,Bv.CODE),fb(e,r.codeChallenge,Pt.S256_CODE_CHALLENGE_METHOD),wf(e,r.extraQueryParameters||{}),xb(t,e,i.auth.encodeExtraQueryParams,r.extraQueryParameters)}async function zb(i,t,r,a,n,e){if(!a.earJwk)throw Tr(Cb);const p=await Bb(t,r,a,n,e);sb(p,Bv.IDTOKEN_TOKEN_REFRESHTOKEN),yN(p,a.earJwk),fb(p,a.codeChallenge,Pt.S256_CODE_CHALLENGE_METHOD);const m=new Map;wf(m,a.extraQueryParameters||{});const y=xb(r,m,t.auth.encodeExtraQueryParams,a.extraQueryParameters);return b8(i,y,p)}async function $b(i,t,r,a,n,e){const p=await Bb(t,r,a,n,e);sb(p,Bv.CODE),fb(p,a.codeChallenge,a.codeChallengeMethod||Pt.S256_CODE_CHALLENGE_METHOD),vN(p,a.authorizePostBodyParameters||{});const m=new Map;wf(m,a.extraQueryParameters||{});const y=xb(r,m,t.auth.encodeExtraQueryParams,a.extraQueryParameters);return b8(i,y,p)}function b8(i,t,r){const a=i.createElement("form");return a.method="post",a.action=t,r.forEach((n,e)=>{const p=i.createElement("input");p.hidden=!0,p.name=e,p.value=n,a.appendChild(p)}),i.body.appendChild(a),a}async function x8(i,t,r,a,n,e,p,m,y,w){if(m.verbose("Account id found, calling WAM for token"),!w)throw Tr(kb);const A=new bd(m,y),I=new x2(a,n,A,m,p,a.system.navigationClient,r,y,w,t,e,i.correlationId),{userRequestState:R}=lp.parseRequestState(A,i.state);return It(I.acquireToken.bind(I),Ye.NativeInteractionClientAcquireToken,m,y,i.correlationId)({...i,state:R,prompt:void 0})}async function J1(i,t,r,a,n,e,p,m,y,w,A,I){if(Eh.removeThrottle(p,n.auth.clientId,i),t.accountId)return It(x8,Ye.HandleResponsePlatformBroker,w,A,i.correlationId)(i,t.accountId,a,n,p,m,y,w,A,I);const R={...i,code:t.code||"",codeVerifier:r},k=new g8(e,p,R,w,A);return await It(k.handleCodeResponse.bind(k),Ye.HandleCodeResponse,w,A,i.correlationId)(t,i)}async function qb(i,t,r,a,n,e,p,m,y,w,A){if(Eh.removeThrottle(e,a.auth.clientId,i),x6(t,i.state),!t.ear_jwe)throw Tr(C6);if(!i.earJwk)throw Tr(Cb);const I=JSON.parse(await It(yT,Ye.DecryptEarResponse,y,w,i.correlationId)(i.earJwk,t.ear_jwe));if(I.accountId)return It(x8,Ye.HandleResponsePlatformBroker,y,w,i.correlationId)(i,I.accountId,r,a,e,p,m,y,w,A);const R=new k0(a.auth.clientId,e,new bd(y,w),y,null,null,w);R.validateTokenResponse(I);const k={code:"",state:i.state,nonce:i.nonce,client_info:I.client_info,cloud_graph_host_name:I.cloud_graph_host_name,cloud_instance_host_name:I.cloud_instance_host_name,cloud_instance_name:I.cloud_instance_name,msgraph_host:I.msgraph_host};return await It(R.handleServerTokenResponse.bind(R),Ye.HandleServerTokenResponse,y,w,i.correlationId)(I,n,lc(),i,k,void 0,void 0,void 0,void 0)}const cE=32;async function D0(i,t,r){i.addQueueMeasurement(Ye.GeneratePkceCodes,r);const a=Bc(uE,Ye.GenerateCodeVerifier,t,i,r)(i,t,r),n=await It(hE,Ye.GenerateCodeChallengeFromVerifier,t,i,r)(a,i,t,r);return{verifier:a,challenge:n}}function uE(i,t,r){try{const a=new Uint8Array(cE);return Bc(dT,Ye.GetRandomValues,t,i,r)(a),Af(a)}catch{throw Tr(Ab)}}async function hE(i,t,r,a){t.addQueueMeasurement(Ye.GenerateCodeChallengeFromVerifier,a);try{const n=await It(n8,Ye.Sha256Digest,r,t,a)(i,t,a);return Af(new Uint8Array(n))}catch{throw Tr(Ab)}}class X2{constructor(t,r,a,n){this.logger=t,this.handshakeTimeoutMs=r,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=a,this.handshakeEvent=a.startMeasurement(Ye.NativeMessageHandlerHandshake),this.platformAuthType=iu.PLATFORM_EXTENSION_PROVIDER}async sendMessage(t){this.logger.trace(this.platformAuthType+" - sendMessage called.");const r={method:bm.GetToken,request:t},a={channel:iu.CHANNEL_ID,extensionId:this.extensionId,responseId:Yu(),body:r};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(a)}`),this.messageChannel.port1.postMessage(a);const n=await new Promise((p,m)=>{this.resolvers.set(a.responseId,{resolve:p,reject:m})});return this.validatePlatformBrokerResponse(n)}static async createProvider(t,r,a){t.trace("PlatformAuthExtensionHandler - createProvider called.");try{const n=new X2(t,r,a,iu.PREFERRED_EXTENSION_ID);return await n.sendHandshakeRequest(),n}catch{const e=new X2(t,r,a);return await e.sendHandshakeRequest(),e}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const t={channel:iu.CHANNEL_ID,extensionId:this.extensionId,responseId:Yu(),body:{method:bm.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=r=>{this.onChannelMessage(r)},window.postMessage(t,window.origin,[this.messageChannel.port2]),new Promise((r,a)=>{this.handshakeResolvers.set(t.responseId,{resolve:r,reject:a}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),a(Tr(V6)),this.handshakeResolvers.delete(t.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(t){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),t.source!==window)return;const r=t.data;if(!(!r.channel||r.channel!==iu.CHANNEL_ID)&&!(r.extensionId&&r.extensionId!==this.extensionId)&&r.body.method===bm.HandshakeRequest){const a=this.handshakeResolvers.get(r.responseId);if(!a){this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${r.responseId}`);return}this.logger.verbose(r.extensionId?`Extension with id: ${r.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),a.reject(Tr(W6))}}onChannelMessage(t){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const r=t.data,a=this.resolvers.get(r.responseId),n=this.handshakeResolvers.get(r.responseId);try{const e=r.body.method;if(e===bm.Response){if(!a)return;const p=r.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(p)}`),p.status!=="Success")a.reject(Q2(p.code,p.description,p.ext));else if(p.result)p.result.code&&p.result.description?a.reject(Q2(p.result.code,p.result.description,p.result.ext)):a.resolve(p.result);else throw q5(L2,"Event does not contain result.");this.resolvers.delete(r.responseId)}else if(e===bm.HandshakeResponse){if(!n){this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${r.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=r.extensionId,this.extensionVersion=r.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(r.responseId)}}catch(e){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${e}`),this.logger.errorPii(`Unable to parse ${t}`),a?a.reject(e):n&&n.reject(e)}}validatePlatformBrokerResponse(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw q5(L2,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return this.getExtensionId()===iu.PREFERRED_EXTENSION_ID?"chrome":this.getExtensionId()?.length?"unknown":void 0}}class Gb{constructor(t,r,a){this.logger=t,this.performanceClient=r,this.correlationId=a,this.platformAuthType=iu.PLATFORM_DOM_PROVIDER}static async createProvider(t,r,a){if(t.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication&&(await window.navigator.platformAuthentication.getSupportedContracts(iu.MICROSOFT_ENTRA_BROKERID))?.includes(iu.PLATFORM_DOM_APIS))return t.trace("Platform auth api available in DOM"),new Gb(t,r,a)}getExtensionId(){return iu.MICROSOFT_ENTRA_BROKERID}getExtensionVersion(){return""}getExtensionName(){return iu.DOM_API_NAME}async sendMessage(t){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const r=this.initializePlatformDOMRequest(t),a=await window.navigator.platformAuthentication.executeGetToken(r);return this.validatePlatformBrokerResponse(a)}catch(r){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),r}}initializePlatformDOMRequest(t){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:r,clientId:a,authority:n,scope:e,redirectUri:p,correlationId:m,state:y,storeInCache:w,embeddedClientId:A,extraParameters:I,...R}=t,k=this.getDOMExtraParams(R);return{accountId:r,brokerId:this.getExtensionId(),authority:n,clientId:a,correlationId:m||this.correlationId,extraParameters:{...I,...k},isSecurityTokenService:!1,redirectUri:p,scope:e,state:y,storeInCache:w,embeddedClientId:A}}validatePlatformBrokerResponse(t){if(t.hasOwnProperty("isSuccess")){if(t.hasOwnProperty("accessToken")&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("clientInfo")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scopes")&&t.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(t);if(t.hasOwnProperty("error")){const r=t;if(r.isSuccess===!1&&r.error&&r.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),Q2(r.error.code,r.error.description,{error:parseInt(r.error.errorCode),protocol_error:r.error.protocolError,status:r.error.status,properties:r.error.properties})}}throw q5(L2,"Response missing expected properties.")}convertToPlatformBrokerResponse(t){return this.logger.trace(this.platformAuthType+" - convertToNativeResponse called"),{access_token:t.accessToken,id_token:t.idToken,client_info:t.clientInfo,account:t.account,expires_in:t.expiresIn,scope:t.scopes,state:t.state||"",properties:t.properties||{},extendedLifetimeToken:t.extendedLifetimeToken??!1,shr:t.proofOfPossessionPayload}}getDOMExtraParams(t){return{...Object.entries(t).reduce((n,[e,p])=>(n[e]=String(p),n),{})}}}async function dE(i,t,r,a,n){i.trace("getPlatformAuthProvider called",r),i.trace("Has client allowed platform auth via DOM API: "+n);let e;try{n&&(e=await Gb.createProvider(i,t,r)),e||(i.trace("Platform auth via DOM API not available, checking for extension"),e=await X2.createProvider(i,a||h8,t))}catch(p){i.trace("Platform auth not available",p)}return e}function Bm(i,t,r,a){if(t.trace("isPlatformAuthAllowed called"),!i.system.allowPlatformBroker&&i.system.allowPlatformBrokerWithDOM)throw ms(Ww);if(!i.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(a)switch(a){case rs.BEARER:case rs.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}class fE extends up{constructor(t,r,a,n,e,p,m,y,w,A){super(t,r,a,n,e,p,m,w,A),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=y,this.eventHandler=e}acquireToken(t,r){let a;try{if(a={popupName:this.generatePopupName(t.scopes||op,t.authority||this.config.auth.authority),popupWindowAttributes:t.popupWindowAttributes||{},popupWindowParent:t.popupWindowParent??window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,a,r);{const e={...t,httpMethod:m8(t,this.config.auth.protocolMode)};return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),a.popup=this.openSizedPopup("about:blank",a),this.acquireTokenPopupAsync(e,a,r)}}catch(n){return Promise.reject(n)}}logout(t){try{this.logger.verbose("logoutPopup called");const r=this.initializeLogoutRequest(t),a={popupName:this.generateLogoutPopupName(r),popupWindowAttributes:t?.popupWindowAttributes||{},popupWindowParent:t?.popupWindowParent??window},n=t&&t.authority,e=t&&t.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,a,n,e)):(this.logger.verbose("asyncPopup set to false, opening popup"),a.popup=this.openSizedPopup("about:blank",a),this.logoutPopupAsync(r,a,n,e))}catch(r){return Promise.reject(r)}}async acquireTokenPopupAsync(t,r,a){this.logger.verbose("acquireTokenPopupAsync called");const n=await It(this.initializeAuthorizationRequest.bind(this),Ye.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,pn.Popup);r.popup&&u8(n.authority);const e=Bm(this.config,this.logger,this.platformAuthProvider,t.authenticationScheme);return n.platformBroker=e,this.config.auth.protocolMode===oc.EAR?this.executeEarFlow(n,r,a):this.executeCodeFlow(n,r,a)}async executeCodeFlow(t,r,a){const n=t.correlationId,e=this.initializeServerTelemetryManager(Ka.acquireTokenPopup),p=a||await It(D0,Ye.GeneratePkceCodes,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),m={...t,codeChallenge:p.challenge};try{const y=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,n)({serverTelemetryManager:e,requestAuthority:m.authority,requestAzureCloudOptions:m.azureCloudOptions,requestExtraQueryParameters:m.extraQueryParameters,account:m.account});if(m.httpMethod===x0.POST)return await this.executeCodeFlowWithPost(m,r,y,p.verifier);{const w=await It(Hb,Ye.GetAuthCodeUrl,this.logger,this.performanceClient,n)(this.config,y.authority,m,this.logger,this.performanceClient),A=this.initiateAuthRequest(w,r);this.eventHandler.emitEvent(jr.POPUP_OPENED,pn.Popup,{popupWindow:A},null);const I=await this.monitorPopupForHash(A,r.popupWindowParent),R=Bc(_m,Ye.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(I,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await It(J1,Ye.HandleResponseCode,this.logger,this.performanceClient,n)(t,R,p.verifier,Ka.acquireTokenPopup,this.config,y,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(y){throw r.popup?.close(),y instanceof gs&&(y.setCorrelationId(this.correlationId),e.cacheFailedRequest(y)),y}}async executeEarFlow(t,r,a){const n=t.correlationId,e=await It(this.getDiscoveredAuthority.bind(this),Ye.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,n)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),p=await It(Rb,Ye.GenerateEarKey,this.logger,this.performanceClient,n)(),m=a||await It(D0,Ye.GeneratePkceCodes,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),y={...t,earJwk:p,codeChallenge:m.challenge},w=r.popup||this.openPopup("about:blank",r);(await zb(w.document,this.config,e,y,this.logger,this.performanceClient)).submit();const I=await It(this.monitorPopupForHash.bind(this),Ye.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(w,r.popupWindowParent),R=Bc(_m,Ye.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(I,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(!R.ear_jwe&&R.code){const k=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,n)({serverTelemetryManager:this.initializeServerTelemetryManager(Ka.acquireTokenPopup),requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account,authority:e});return It(J1,Ye.HandleResponseCode,this.logger,this.performanceClient,n)(y,R,m.verifier,Ka.acquireTokenPopup,this.config,k,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}else return It(qb,Ye.HandleResponseEar,this.logger,this.performanceClient,n)(y,R,Ka.acquireTokenPopup,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(t,r,a,n){const e=t.correlationId,p=await It(this.getDiscoveredAuthority.bind(this),Ye.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,e)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),m=r.popup||this.openPopup("about:blank",r);(await $b(m.document,this.config,p,t,this.logger,this.performanceClient)).submit();const w=await It(this.monitorPopupForHash.bind(this),Ye.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,e)(m,r.popupWindowParent),A=Bc(_m,Ye.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(w,this.config.auth.OIDCOptions.serverResponseType,this.logger);return It(J1,Ye.HandleResponseCode,this.logger,this.performanceClient,e)(t,A,n,Ka.acquireTokenPopup,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(t,r,a,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(jr.LOGOUT_START,pn.Popup,t);const e=this.initializeServerTelemetryManager(Ka.logoutPopup);try{await this.clearCacheOnLogout(this.correlationId,t.account);const p=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e,requestAuthority:a,account:t.account||void 0});try{p.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId&&t.postLogoutRedirectUri&&p.authority.protocolMode===oc.OIDC){if(this.eventHandler.emitEvent(jr.LOGOUT_SUCCESS,pn.Popup,t),n){const w={apiId:Ka.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},A=Da.getAbsoluteUrl(n,md());await this.navigationClient.navigateInternal(A,w)}r.popup?.close();return}}const m=p.getLogoutUri(t);this.eventHandler.emitEvent(jr.LOGOUT_SUCCESS,pn.Popup,t);const y=this.openPopup(m,r);if(this.eventHandler.emitEvent(jr.POPUP_OPENED,pn.Popup,{popupWindow:y},null),await this.monitorPopupForHash(y,r.popupWindowParent).catch(()=>{}),n){const w={apiId:Ka.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},A=Da.getAbsoluteUrl(n,md());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${A}`),await this.navigationClient.navigateInternal(A,w)}else this.logger.verbose("No main window navigation requested")}catch(p){throw r.popup?.close(),p instanceof gs&&(p.setCorrelationId(this.correlationId),e.cacheFailedRequest(p)),this.eventHandler.emitEvent(jr.LOGOUT_FAILURE,pn.Popup,null,p),this.eventHandler.emitEvent(jr.LOGOUT_END,pn.Popup),p}this.eventHandler.emitEvent(jr.LOGOUT_END,pn.Popup)}initiateAuthRequest(t,r){if(t)return this.logger.infoPii(`Navigate to: ${t}`),this.openPopup(t,r);throw this.logger.error("Navigate url is empty"),Tr(Ey)}monitorPopupForHash(t,r){return new Promise((a,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const e=setInterval(()=>{if(t.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(e),n(Tr(Mm));return}let p="";try{p=t.location.href}catch{}if(!p||p==="about:blank")return;clearInterval(e);let m="";const y=this.config.auth.OIDCOptions.serverResponseType;t&&(y===my.QUERY?m=t.location.search:m=t.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),a(m)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(t,r)})}openPopup(t,r){try{let a;if(r.popup?(a=r.popup,this.logger.verbosePii(`Navigating popup window to: ${t}`),a.location.assign(t)):typeof r.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${t}`),a=this.openSizedPopup(t,r)),!a)throw Tr(D6);return a.focus&&a.focus(),this.currentWindow=a,r.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),a}catch(a){throw this.logger.error("error opening popup "+a.message),Tr(I6)}}openSizedPopup(t,{popupName:r,popupWindowAttributes:a,popupWindowParent:n}){const e=n.screenLeft?n.screenLeft:n.screenX,p=n.screenTop?n.screenTop:n.screenY,m=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,y=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let w=a.popupSize?.width,A=a.popupSize?.height,I=a.popupPosition?.top,R=a.popupPosition?.left;return(!w||w<0||w>m)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),w=ic.POPUP_WIDTH),(!A||A<0||A>y)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),A=ic.POPUP_HEIGHT),(!I||I<0||I>y)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),I=Math.max(0,y/2-ic.POPUP_HEIGHT/2+p)),(!R||R<0||R>m)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),R=Math.max(0,m/2-ic.POPUP_WIDTH/2+e)),n.open(t,r,`width=${w}, height=${A}, top=${I}, left=${R}, scrollbars=yes`)}unloadWindow(t){this.currentWindow&&this.currentWindow.close(),t.preventDefault()}cleanPopup(t,r){t.close(),r.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(t,r){return`${ic.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t.join("-")}.${r}.${this.correlationId}`}generateLogoutPopupName(t){const r=t.account&&t.account.homeAccountId;return`${ic.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${r}.${this.correlationId}`}}function pE(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const i=window.performance.getEntriesByType("navigation");return(i.length?i[0]:void 0)?.type}class mE extends up{constructor(t,r,a,n,e,p,m,y,w,A){super(t,r,a,n,e,p,m,w,A),this.nativeStorage=y}async acquireToken(t){const r=await It(this.initializeAuthorizationRequest.bind(this),Ye.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,pn.Redirect);r.platformBroker=Bm(this.config,this.logger,this.platformAuthProvider,t.authenticationScheme);const a=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent(jr.RESTORE_FROM_BFCACHE,pn.Redirect))},n=this.getRedirectStartPage(t.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${n}`),this.browserStorage.setTemporaryCache(Qi.ORIGIN_URI,n,!0),window.addEventListener("pageshow",a);try{this.config.auth.protocolMode===oc.EAR?await this.executeEarFlow(r):await this.executeCodeFlow(r,t.onRedirectNavigate)}catch(e){throw e instanceof gs&&e.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",a),e}}async executeCodeFlow(t,r){const a=t.correlationId,n=this.initializeServerTelemetryManager(Ka.acquireTokenRedirect),e=await It(D0,Ye.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),p={...t,codeChallenge:e.challenge};this.browserStorage.cacheAuthorizeRequest(p,e.verifier);try{if(p.httpMethod===x0.POST)return await this.executeCodeFlowWithPost(p);{const m=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:p.authority,requestAzureCloudOptions:p.azureCloudOptions,requestExtraQueryParameters:p.extraQueryParameters,account:p.account}),y=await It(Hb,Ye.GetAuthCodeUrl,this.logger,this.performanceClient,t.correlationId)(this.config,m.authority,p,this.logger,this.performanceClient);return await this.initiateAuthRequest(y,r)}}catch(m){throw m instanceof gs&&(m.setCorrelationId(this.correlationId),n.cacheFailedRequest(m)),m}}async executeEarFlow(t){const r=t.correlationId,a=await It(this.getDiscoveredAuthority.bind(this),Ye.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),n=await It(Rb,Ye.GenerateEarKey,this.logger,this.performanceClient,r)(),e=await It(D0,Ye.GeneratePkceCodes,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),p={...t,earJwk:n,codeChallenge:e.challenge};return this.browserStorage.cacheAuthorizeRequest(p,e.verifier),(await zb(document,this.config,a,p,this.logger,this.performanceClient)).submit(),new Promise((y,w)=>{setTimeout(()=>{w(Tr(Y2,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(t){const r=t.correlationId,a=await It(this.getDiscoveredAuthority.bind(this),Ye.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return this.browserStorage.cacheAuthorizeRequest(t),(await $b(document,this.config,a,t,this.logger,this.performanceClient)).submit(),new Promise((e,p)=>{setTimeout(()=>{p(Tr(Y2,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(t="",r,a,n){const e=this.initializeServerTelemetryManager(Ka.handleRedirectPromise);try{const[p,m]=this.getRedirectResponse(t||"");if(!p)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),pE()!=="back_forward"?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const y=this.browserStorage.getTemporaryCache(Qi.ORIGIN_URI,!0)||Pt.EMPTY_STRING,w=Mx(y),A=Mx(window.location.href);if(w===A&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),y.indexOf("#")>-1&&bT(y),await this.handleResponse(p,r,a,e);if(this.config.auth.navigateToLoginRequestUrl){if(!Lb()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Qi.URL_HASH,m,!0);const I={apiId:Ka.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let R=!0;if(!y||y==="null"){const k=wT();this.browserStorage.setTemporaryCache(Qi.ORIGIN_URI,k,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),R=await this.navigationClient.navigateInternal(k,I)}else this.logger.verbose(`Navigating to loginRequestUrl: ${y}`),R=await this.navigationClient.navigateInternal(y,I);if(!R)return await this.handleResponse(p,r,a,e)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(p,r,a,e);return null}catch(p){throw p instanceof gs&&(p.setCorrelationId(this.correlationId),e.cacheFailedRequest(p)),p}}getRedirectResponse(t){this.logger.verbose("getRedirectResponseHash called");let r=t;r||(this.config.auth.OIDCOptions.serverResponseType===my.QUERY?r=window.location.search:r=window.location.hash);let a=U2(r);if(a){try{XT(a,this.browserCrypto,pn.Redirect)}catch(e){return e instanceof gs&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return o8(window),this.logger.verbose("Hash contains known properties, returning response hash"),[a,r]}const n=this.browserStorage.getTemporaryCache(Qi.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Qi.URL_HASH)),n&&(a=U2(n),a)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[a,n]):[null,""]}async handleResponse(t,r,a,n){if(!t.state)throw Tr(Nb);if(t.ear_jwe){const m=await It(this.getDiscoveredAuthority.bind(this),Ye.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r.correlationId)({requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account});return It(qb,Ye.HandleResponseEar,this.logger,this.performanceClient,r.correlationId)(r,t,Ka.acquireTokenRedirect,this.config,m,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const p=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:r.authority});return It(J1,Ye.HandleResponseCode,this.logger,this.performanceClient,r.correlationId)(r,t,a,Ka.acquireTokenRedirect,this.config,p,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(t,r){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),t){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${t}`);const a={apiId:Ka.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},n=r||this.config.auth.onRedirectNavigate;if(typeof n=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n(t)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await this.navigationClient.navigateExternal(t,a);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await this.navigationClient.navigateExternal(t,a);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Tr(Ey)}async logout(t){this.logger.verbose("logoutRedirect called");const r=this.initializeLogoutRequest(t),a=this.initializeServerTelemetryManager(Ka.logout);try{this.eventHandler.emitEvent(jr.LOGOUT_START,pn.Redirect,t),await this.clearCacheOnLogout(this.correlationId,r.account);const n={apiId:Ka.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},e=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:t&&t.authority,requestExtraQueryParameters:t?.extraQueryParameters,account:t&&t.account||void 0});if(e.authority.protocolMode===oc.OIDC)try{e.authority.endSessionEndpoint}catch{if(r.account?.homeAccountId){this.eventHandler.emitEvent(jr.LOGOUT_SUCCESS,pn.Redirect,r);return}}const p=e.getLogoutUri(r);if(this.eventHandler.emitEvent(jr.LOGOUT_SUCCESS,pn.Redirect,r),t&&typeof t.onRedirectNavigate=="function")if(t.onRedirectNavigate(p)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,pf.SIGNOUT),await this.navigationClient.navigateExternal(p,n);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,pf.SIGNOUT),await this.navigationClient.navigateExternal(p,n);return}}catch(n){throw n instanceof gs&&(n.setCorrelationId(this.correlationId),a.cacheFailedRequest(n)),this.eventHandler.emitEvent(jr.LOGOUT_FAILURE,pn.Redirect,null,n),this.eventHandler.emitEvent(jr.LOGOUT_END,pn.Redirect),n}this.eventHandler.emitEvent(jr.LOGOUT_END,pn.Redirect)}getRedirectStartPage(t){const r=t||window.location.href;return Da.getAbsoluteUrl(r,md())}}async function gE(i,t,r,a,n){if(t.addQueueMeasurement(Ye.SilentHandlerInitiateAuthRequest,a),!i)throw r.info("Navigate url is empty"),Tr(Ey);return n?It(bE,Ye.SilentHandlerLoadFrame,r,t,a)(i,n,t,a):Bc(xE,Ye.SilentHandlerLoadFrameSync,r,t,a)(i)}async function yE(i,t,r,a,n){const e=Fy();if(!e.contentDocument)throw"No document associated with iframe!";return(await $b(e.contentDocument,i,t,r,a,n)).submit(),e}async function vE(i,t,r,a,n){const e=Fy();if(!e.contentDocument)throw"No document associated with iframe!";return(await zb(e.contentDocument,i,t,r,a,n)).submit(),e}async function m4(i,t,r,a,n,e,p){return a.addQueueMeasurement(Ye.SilentHandlerMonitorIframeForHash,e),new Promise((m,y)=>{t<tv&&n.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (${tv}ms). This may result in timeouts.`);const w=window.setTimeout(()=>{window.clearInterval(A),y(Tr(F6))},t),A=window.setInterval(()=>{let I="";const R=i.contentWindow;try{I=R?R.location.href:""}catch{}if(!I||I==="about:blank")return;let k="";R&&(p===my.QUERY?k=R.location.search:k=R.location.hash),window.clearTimeout(w),window.clearInterval(A),m(k)},r)}).finally(()=>{Bc(wE,Ye.RemoveHiddenIframe,n,a,e)(i)})}function bE(i,t,r,a){return r.addQueueMeasurement(Ye.SilentHandlerLoadFrame,a),new Promise((n,e)=>{const p=Fy();window.setTimeout(()=>{if(!p){e("Unable to load iframe");return}p.src=i,n(p)},t)})}function xE(i){const t=Fy();return t.src=i,t}function Fy(){const i=document.createElement("iframe");return i.className="msalSilentIframe",i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height="0",i.style.border="0",i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),i.setAttribute("allow","local-network-access *"),document.body.appendChild(i),i}function wE(i){document.body===i.parentNode&&document.body.removeChild(i)}class SE extends up{constructor(t,r,a,n,e,p,m,y,w,A,I){super(t,r,a,n,e,p,y,A,I),this.apiId=m,this.nativeStorage=w}async acquireToken(t){this.performanceClient.addQueueMeasurement(Ye.SilentIframeClientAcquireToken,t.correlationId),!t.loginHint&&!t.sid&&(!t.account||!t.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const r={...t};r.prompt?r.prompt!==Ho.NONE&&r.prompt!==Ho.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${r.prompt} with ${Ho.NONE}`),r.prompt=Ho.NONE):r.prompt=Ho.NONE;const a=await It(this.initializeAuthorizationRequest.bind(this),Ye.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(r,pn.Silent);return a.platformBroker=Bm(this.config,this.logger,this.platformAuthProvider,a.authenticationScheme),u8(a.authority),this.config.auth.protocolMode===oc.EAR?this.executeEarFlow(a):this.executeCodeFlow(a)}async executeCodeFlow(t){let r;const a=this.initializeServerTelemetryManager(this.apiId);try{return r=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,t.correlationId)({serverTelemetryManager:a,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),await It(this.silentTokenHelper.bind(this),Ye.SilentIframeClientTokenHelper,this.logger,this.performanceClient,t.correlationId)(r,t)}catch(n){if(n instanceof gs&&(n.setCorrelationId(this.correlationId),a.cacheFailedRequest(n)),!r||!(n instanceof gs)||n.errorCode!==ic.INVALID_GRANT_ERROR)throw n;return this.performanceClient.addFields({retryError:n.errorCode},this.correlationId),await It(this.silentTokenHelper.bind(this),Ye.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(r,t)}}async executeEarFlow(t){const r=t.correlationId,a=await It(this.getDiscoveredAuthority.bind(this),Ye.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),n=await It(Rb,Ye.GenerateEarKey,this.logger,this.performanceClient,r)(),e=await It(D0,Ye.GeneratePkceCodes,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),p={...t,earJwk:n,codeChallenge:e.challenge},m=await It(vE,Ye.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(this.config,a,p,this.logger,this.performanceClient),y=this.config.auth.OIDCOptions.serverResponseType,w=await It(m4,Ye.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(m,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,y),A=Bc(_m,Ye.DeserializeResponse,this.logger,this.performanceClient,r)(w,y,this.logger);if(!A.ear_jwe&&A.code){const I=await It(this.createAuthCodeClient.bind(this),Ye.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,r)({serverTelemetryManager:this.initializeServerTelemetryManager(this.apiId),requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account,authority:a});return It(J1,Ye.HandleResponseCode,this.logger,this.performanceClient,r)(p,A,e.verifier,this.apiId,this.config,I,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}else return It(qb,Ye.HandleResponseEar,this.logger,this.performanceClient,r)(p,A,this.apiId,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(Tr(ky))}async silentTokenHelper(t,r){const a=r.correlationId;this.performanceClient.addQueueMeasurement(Ye.SilentIframeClientTokenHelper,a);const n=await It(D0,Ye.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),e={...r,codeChallenge:n.challenge};let p;if(r.httpMethod===x0.POST)p=await It(yE,Ye.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(this.config,t.authority,e,this.logger,this.performanceClient);else{const A=await It(Hb,Ye.GetAuthCodeUrl,this.logger,this.performanceClient,a)(this.config,t.authority,e,this.logger,this.performanceClient);p=await It(gE,Ye.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(A,this.performanceClient,this.logger,a,this.config.system.navigateFrameWait)}const m=this.config.auth.OIDCOptions.serverResponseType,y=await It(m4,Ye.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,a)(p,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,a,m),w=Bc(_m,Ye.DeserializeResponse,this.logger,this.performanceClient,a)(y,m,this.logger);return It(J1,Ye.HandleResponseCode,this.logger,this.performanceClient,a)(r,w,n.verifier,this.apiId,this.config,t,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}class AE extends up{async acquireToken(t){this.performanceClient.addQueueMeasurement(Ye.SilentRefreshClientAcquireToken,t.correlationId);const r=await It(Ub,Ye.InitializeBaseRequest,this.logger,this.performanceClient,t.correlationId)(t,this.config,this.performanceClient,this.logger),a={...t,...r};t.redirectUri&&(a.redirectUri=this.getRedirectUri(t.redirectUri));const n=this.initializeServerTelemetryManager(Ka.acquireTokenSilent_silentFlow),e=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:a.authority,azureCloudOptions:a.azureCloudOptions,account:a.account});return It(e.acquireTokenByRefreshToken.bind(e),Ye.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,t.correlationId)(a).catch(p=>{throw p.setCorrelationId(this.correlationId),n.cacheFailedRequest(p),p})}logout(){return Promise.reject(Tr(ky))}async createRefreshTokenClient(t){const r=await It(this.getClientConfiguration.bind(this),Ye.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t.serverTelemetryManager,requestAuthority:t.authorityUrl,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return new UN(r,this.performanceClient)}}class CE{constructor(t,r,a,n){this.isBrowserEnvironment=typeof window<"u",this.config=t,this.storage=r,this.logger=a,this.cryptoObj=n}async loadExternalTokens(t,r,a){if(!this.isBrowserEnvironment)throw Tr(_y);const n=t.correlationId||Yu(),e=r.id_token?_h(r.id_token,Dl):void 0,p=Fh(e||{}),m={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},y=t.authority?new hl(hl.generateAuthority(t.authority,t.azureCloudOptions),this.config.system.networkClient,this.storage,m,this.logger,t.correlationId||Yu()):void 0,w=await this.loadAccount(t,a.clientInfo||r.client_info||"",n,e,y),A=await this.loadIdToken(r,w.homeAccountId,w.environment,w.realm,n,p),I=await this.loadAccessToken(t,r,w.homeAccountId,w.environment,w.realm,a,n,p),R=await this.loadRefreshToken(r,w.homeAccountId,w.environment,n,p);return this.generateAuthenticationResult(t,{account:w,idToken:A,accessToken:I,refreshToken:R},e,y)}async loadAccount(t,r,a,n,e){if(this.logger.verbose("TokenCache - loading account"),t.account){const w=Fi.createFromAccountInfo(t.account);return await this.storage.setAccount(w,a,Fh(n||{})),w}else if(!e||!r&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Tr(H6);const p=Fi.generateHomeAccountId(r,e.authorityType,this.logger,this.cryptoObj,n),m=n?.tid,y=bb(this.storage,e,p,Dl,a,n,r,e.hostnameAndPort,m,void 0,void 0,this.logger);return await this.storage.setAccount(y,a,Fh(n||{})),y}async loadIdToken(t,r,a,n,e,p){if(!t.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const m=wy(r,a,t.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(m,e,p),m}async loadAccessToken(t,r,a,n,e,p,m,y){if(r.access_token)if(r.expires_in){if(!r.scope&&(!t.scopes||!t.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const w=r.scope?ro.fromString(r.scope):new ro(t.scopes),A=p.expiresOn||r.expires_in+lc(),I=p.extendedExpiresOn||(r.ext_expires_in||r.expires_in)+lc(),R=Sy(a,n,r.access_token,this.config.auth.clientId,e,w.printScopes(),A,I,Dl);return await this.storage.setAccessTokenCredential(R,m,y),R}async loadRefreshToken(t,r,a,n,e){if(!t.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const p=f6(r,a,t.refresh_token,this.config.auth.clientId,t.foci,void 0,t.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(p,n,e),p}generateAuthenticationResult(t,r,a,n){let e="",p=[],m=null,y;r?.accessToken&&(e=r.accessToken.secret,p=ro.fromString(r.accessToken.target).asArray(),m=W1(r.accessToken.expiresOn),y=W1(r.accessToken.extendedExpiresOn));const w=r.account;return{authority:n?n.canonicalAuthority:"",uniqueId:r.account.localAccountId,tenantId:r.account.realm,scopes:p,account:Fi.getAccountInfo(w),idToken:r.idToken?.secret||"",idTokenClaims:a||{},accessToken:e,fromCache:!0,expiresOn:m,correlationId:t.correlationId||"",requestId:"",extExpiresOn:y,familyId:r.refreshToken?.familyId||"",tokenType:r?.accessToken?.tokenType||"",state:t.state||"",cloudGraphHostName:w.cloudGraphHostName||"",msGraphHost:w.msGraphHost||"",fromNativeBroker:!1}}}class NE extends b6{constructor(t){super(t),this.includeRedirectUri=!1}}class TE extends up{constructor(t,r,a,n,e,p,m,y,w,A){super(t,r,a,n,e,p,y,w,A),this.apiId=m}async acquireToken(t){if(!t.code)throw Tr(z6);const r=await It(this.initializeAuthorizationRequest.bind(this),Ye.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(t,pn.Silent),a=this.initializeServerTelemetryManager(this.apiId);try{const n={...r,code:t.code},e=await It(this.getClientConfiguration.bind(this),Ye.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,t.correlationId)({serverTelemetryManager:a,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),p=new NE(e);this.logger.verbose("Auth code client created");const m=new g8(p,this.browserStorage,n,this.logger,this.performanceClient);return await It(m.handleCodeResponseFromServer.bind(m),Ye.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},r,!1)}catch(n){throw n instanceof gs&&(n.setCorrelationId(this.correlationId),a.cacheFailedRequest(n)),n}}logout(){return Promise.reject(Tr(ky))}}function EE(i,t,r){const a=window.msal?.clientIds||[],n=a.length,e=a.filter(p=>p===i).length;e>1&&r.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:n,sameClientIdInstanceCount:e})}function t2(i,t,r){try{Pb(i)}catch(a){throw t.end({success:!1},a,r),a}}class Ry{constructor(t){this.operatingContext=t,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=t.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new bd(this.logger,this.performanceClient):P2,this.eventHandler=new YT(this.logger),this.browserStorage=this.isBrowserEnvironment?new nv(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,IN(this.config.auth)):BT(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const r={cacheLocation:zo.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:zo.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new nv(this.config.auth.clientId,r,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new CE(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(t,r){const a=new Ry(t);return await a.initialize(r),a}trackPageVisibility(t){t&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},t))}async initialize(t,r){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(jr.INITIALIZE_END);return}const a=t?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowPlatformBroker,e=this.performanceClient.startMeasurement(Ye.InitializeClientApplication,a);if(this.eventHandler.emitEvent(jr.INITIALIZE_START),!r)try{this.logMultipleInstances(e)}catch{}if(await It(this.browserStorage.initialize.bind(this.browserStorage),Ye.InitializeCache,this.logger,this.performanceClient,a)(a),n)try{this.platformAuthProvider=await dE(this.logger,this.performanceClient,a,this.config.system.nativeBrokerHandshakeTimeout,this.config.system.allowPlatformBrokerWithDOM)}catch(p){this.logger.verbose(p)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),Bc(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Ye.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,a)(a)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(a),this.initialized=!0,this.eventHandler.emitEvent(jr.INITIALIZE_END),e.end({allowPlatformBroker:n,success:!0})}async handleRedirectPromise(t){if(this.logger.verbose("handleRedirectPromise called"),c8(this.initialized),this.isBrowserEnvironment){const r=t||"";let a=this.redirectResponse.get(r);return typeof a>"u"?(a=this.handleRedirectPromiseInternal(t),this.redirectResponse.set(r,a),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),a}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(t){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if(this.browserStorage.getInteractionInProgress()?.type===pf.SIGNOUT)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const a=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),e=n&&this.platformAuthProvider&&!t;let p;this.eventHandler.emitEvent(jr.HANDLE_REDIRECT_START,pn.Redirect);let m;try{if(e&&this.platformAuthProvider){p=this.performanceClient.startMeasurement(Ye.AcquireTokenRedirect,n?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),p.add({isPlatformBrokerRequest:!0});const y=new x2(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ka.handleRedirectPromise,this.performanceClient,this.platformAuthProvider,n.accountId,this.nativeInternalStorage,n.correlationId);m=It(y.handleRedirectPromise.bind(y),Ye.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,p.event.correlationId)(this.performanceClient,p.event.correlationId)}else{const[y,w]=this.browserStorage.getCachedRequest(),A=y.correlationId;p=this.performanceClient.startMeasurement(Ye.AcquireTokenRedirect,A),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const I=this.createRedirectClient(A);m=It(I.handleRedirectPromise.bind(I),Ye.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,p.event.correlationId)(t,y,w,p)}}catch(y){throw this.browserStorage.resetRequestCache(),y}return m.then(y=>(y?(this.browserStorage.resetRequestCache(),a.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(jr.LOGIN_SUCCESS,pn.Redirect,y),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_SUCCESS,pn.Redirect,y),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),p.end({success:!0},void 0,y.account)):p.event.errorCode?p.end({success:!1},void 0):p.discard(),this.eventHandler.emitEvent(jr.HANDLE_REDIRECT_END,pn.Redirect),y)).catch(y=>{this.browserStorage.resetRequestCache();const w=y;throw a.length>0?this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_FAILURE,pn.Redirect,null,w):this.eventHandler.emitEvent(jr.LOGIN_FAILURE,pn.Redirect,null,w),this.eventHandler.emitEvent(jr.HANDLE_REDIRECT_END,pn.Redirect),p.end({success:!1},w),y})}async acquireTokenRedirect(t){const r=this.getRequestCorrelationId(t);this.logger.verbose("acquireTokenRedirect called",r);const a=this.performanceClient.startMeasurement(Ye.AcquireTokenPreRedirect,r);a.add({scenarioId:t.scenarioId});const n=t.onRedirectNavigate;if(n)t.onRedirectNavigate=p=>{const m=typeof n=="function"?n(p):void 0;return a.add({navigateCallbackResult:m!==!1}),a.event=a.end({success:!0},void 0,t.account)||a.event,m};else{const p=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=m=>{const y=typeof p=="function"?p(m):void 0;return a.add({navigateCallbackResult:y!==!1}),a.event=a.end({success:!0},void 0,t.account)||a.event,y}}const e=this.getAllAccounts().length>0;try{s4(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,pf.SIGNIN),e?this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_START,pn.Redirect,t):this.eventHandler.emitEvent(jr.LOGIN_START,pn.Redirect,t);let p;return this.platformAuthProvider&&this.canUsePlatformBroker(t)?p=new x2(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ka.acquireTokenRedirect,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(t),this.nativeInternalStorage,r).acquireTokenRedirect(t,a).catch(y=>{if(a.add({brokerErrorName:y.name,brokerErrorCode:y.errorCode}),y instanceof kh&&U1(y))return this.platformAuthProvider=void 0,this.createRedirectClient(r).acquireToken(t);if(y instanceof Ku)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(r).acquireToken(t);throw y}):p=this.createRedirectClient(r).acquireToken(t),await p}catch(p){throw this.browserStorage.resetRequestCache(),a.event.status===2?this.performanceClient.startMeasurement(Ye.AcquireTokenRedirect,r).end({success:!1},p,t.account):a.end({success:!1},p,t.account),e?this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_FAILURE,pn.Redirect,null,p):this.eventHandler.emitEvent(jr.LOGIN_FAILURE,pn.Redirect,null,p),p}}acquireTokenPopup(t){const r=this.getRequestCorrelationId(t),a=this.performanceClient.startMeasurement(Ye.AcquireTokenPopup,r);a.add({scenarioId:t.scenarioId});try{this.logger.verbose("acquireTokenPopup called",r),t2(this.initialized,a,t.account),this.browserStorage.setInteractionInProgress(!0,pf.SIGNIN)}catch(m){return Promise.reject(m)}const n=this.getAllAccounts();n.length>0?this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_START,pn.Popup,t):this.eventHandler.emitEvent(jr.LOGIN_START,pn.Popup,t);let e;const p=this.getPreGeneratedPkceCodes(r);return this.canUsePlatformBroker(t)?(a.add({isPlatformBrokerRequest:!0}),e=this.acquireTokenNative({...t,correlationId:r},Ka.acquireTokenPopup).then(m=>(a.end({success:!0},void 0,m.account),m)).catch(m=>{if(a.add({brokerErrorName:m.name,brokerErrorCode:m.errorCode}),m instanceof kh&&U1(m))return this.platformAuthProvider=void 0,this.createPopupClient(r).acquireToken(t,p);if(m instanceof Ku)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(r).acquireToken(t,p);throw m})):e=this.createPopupClient(r).acquireToken(t,p),e.then(m=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(jr.LOGIN_SUCCESS,pn.Popup,m):this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_SUCCESS,pn.Popup,m),a.end({success:!0,accessTokenSize:m.accessToken.length,idTokenSize:m.idToken.length},void 0,m.account),m)).catch(m=>(n.length>0?this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_FAILURE,pn.Popup,null,m):this.eventHandler.emitEvent(jr.LOGIN_FAILURE,pn.Popup,null,m),a.end({success:!1},m,t.account),Promise.reject(m))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(r)})}trackPageVisibilityWithMeasurement(){const t=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;t&&(this.logger.info("Perf: Visibility change detected in ",t.event.name),t.increment({visibilityChangeCount:1}))}async ssoSilent(t){const r=this.getRequestCorrelationId(t),a={...t,prompt:t.prompt,correlationId:r};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Ye.SsoSilent,r),this.ssoSilentMeasurement?.add({scenarioId:t.scenarioId}),t2(this.initialized,this.ssoSilentMeasurement,t.account),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(jr.SSO_SILENT_START,pn.Silent,a);let n;return this.canUsePlatformBroker(a)?(this.ssoSilentMeasurement?.add({isPlatformBrokerRequest:!0}),n=this.acquireTokenNative(a,Ka.ssoSilent).catch(e=>{if(this.ssoSilentMeasurement?.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof kh&&U1(e))return this.platformAuthProvider=void 0,this.createSilentIframeClient(a.correlationId).acquireToken(a);throw e})):n=this.createSilentIframeClient(a.correlationId).acquireToken(a),n.then(e=>(this.eventHandler.emitEvent(jr.SSO_SILENT_SUCCESS,pn.Silent,e),this.ssoSilentMeasurement?.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(e=>{throw this.eventHandler.emitEvent(jr.SSO_SILENT_FAILURE,pn.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e,t.account),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(t){const r=this.getRequestCorrelationId(t);this.logger.trace("acquireTokenByCode called",r);const a=this.performanceClient.startMeasurement(Ye.AcquireTokenByCode,r);t2(this.initialized,a),this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_BY_CODE_START,pn.Silent,t),a.add({scenarioId:t.scenarioId});try{if(t.code&&t.nativeAccountId)throw Tr(q6);if(t.code){const n=t.code;let e=this.hybridAuthCodeResponses.get(n);return e?(this.logger.verbose("Existing acquireTokenByCode request found",r),a.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",r),e=this.acquireTokenByCodeAsync({...t,correlationId:r}).then(p=>(this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_BY_CODE_SUCCESS,pn.Silent,p),this.hybridAuthCodeResponses.delete(n),a.end({success:!0,accessTokenSize:p.accessToken.length,idTokenSize:p.idToken.length},void 0,p.account),p)).catch(p=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_BY_CODE_FAILURE,pn.Silent,null,p),a.end({success:!1},p),p}),this.hybridAuthCodeResponses.set(n,e)),await e}else if(t.nativeAccountId)if(this.canUsePlatformBroker(t,t.nativeAccountId)){a.add({isPlatformBrokerRequest:!0});const n=await this.acquireTokenNative({...t,correlationId:r},Ka.acquireTokenByCode,t.nativeAccountId).catch(e=>{throw e instanceof kh&&U1(e)&&(this.platformAuthProvider=void 0),a.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e});return a.end({success:!0},void 0,n.account),n}else throw Tr(G6);else throw Tr($6)}catch(n){throw this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_BY_CODE_FAILURE,pn.Silent,null,n),a.end({success:!1},n),n}}async acquireTokenByCodeAsync(t){return this.logger.trace("acquireTokenByCodeAsync called",t.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Ye.AcquireTokenByCodeAsync,t.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(t.correlationId).acquireToken(t).then(n=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:n.fromCache}),n)).catch(n=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},n),n}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(t,r){switch(this.performanceClient.addQueueMeasurement(Ye.AcquireTokenFromCache,t.correlationId),r){case _l.Default:case _l.AccessToken:case _l.AccessTokenAndRefreshToken:const a=this.createSilentCacheClient(t.correlationId);return It(a.acquireToken.bind(a),Ye.SilentCacheClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t);default:throw Qt(xf)}}async acquireTokenByRefreshToken(t,r){switch(this.performanceClient.addQueueMeasurement(Ye.AcquireTokenByRefreshToken,t.correlationId),r){case _l.Default:case _l.AccessTokenAndRefreshToken:case _l.RefreshToken:case _l.RefreshTokenAndNetwork:const a=this.createSilentRefreshClient(t.correlationId);return It(a.acquireToken.bind(a),Ye.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t);default:throw Qt(xf)}}async acquireTokenBySilentIframe(t){this.performanceClient.addQueueMeasurement(Ye.AcquireTokenBySilentIframe,t.correlationId);const r=this.createSilentIframeClient(t.correlationId);return It(r.acquireToken.bind(r),Ye.SilentIframeClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t)}async logout(t){const r=this.getRequestCorrelationId(t);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",r),this.logoutRedirect({correlationId:r,...t})}async logoutRedirect(t){const r=this.getRequestCorrelationId(t);return s4(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,pf.SIGNOUT),this.createRedirectClient(r).logout(t)}logoutPopup(t){try{const r=this.getRequestCorrelationId(t);return Pb(this.initialized),this.browserStorage.setInteractionInProgress(!0,pf.SIGNOUT),this.createPopupClient(r).logout(t).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(r){return Promise.reject(r)}}async clearCache(t){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const r=this.getRequestCorrelationId(t);return this.createSilentCacheClient(r).logout(t)}getAllAccounts(t){const r=this.getRequestCorrelationId();return HT(this.logger,this.browserStorage,this.isBrowserEnvironment,r,t)}getAccount(t){const r=this.getRequestCorrelationId();return zT(t,this.logger,this.browserStorage,r)}getAccountByUsername(t){const r=this.getRequestCorrelationId();return $T(t,this.logger,this.browserStorage,r)}getAccountByHomeId(t){const r=this.getRequestCorrelationId();return qT(t,this.logger,this.browserStorage,r)}getAccountByLocalId(t){const r=this.getRequestCorrelationId();return GT(t,this.logger,this.browserStorage,r)}setActiveAccount(t){const r=this.getRequestCorrelationId();VT(t,this.browserStorage,r)}getActiveAccount(){const t=this.getRequestCorrelationId();return WT(this.browserStorage,t)}async hydrateCache(t,r){this.logger.verbose("hydrateCache called");const a=Fi.createFromAccountInfo(t.account,t.cloudGraphHostName,t.msGraphHost);return await this.browserStorage.setAccount(a,t.correlationId,Fh(t.idTokenClaims)),t.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(t,r)):this.browserStorage.hydrateCache(t,r)}async acquireTokenNative(t,r,a,n){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw Tr(kb);return new x2(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,r,this.performanceClient,this.platformAuthProvider,a||this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId).acquireToken(t,n)}canUsePlatformBroker(t,r){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!Bm(this.config,this.logger,this.platformAuthProvider,t.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(t.prompt)switch(t.prompt){case Ho.NONE:case Ho.CONSENT:case Ho.LOGIN:case Ho.SELECT_ACCOUNT:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${t.prompt} is not compatible with platform broker flow, returning false`),!1}return!r&&!this.getNativeAccountId(t)?(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(t){const r=t.account||this.getAccount({loginHint:t.loginHint,sid:t.sid})||this.getActiveAccount();return r&&r.nativeAccountId||""}createPopupClient(t){return new fE(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,t)}createRedirectClient(t){return new mE(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,t)}createSilentIframeClient(t){return new SE(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ka.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,t)}createSilentCacheClient(t){return new v8(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,t)}createSilentRefreshClient(t){return new AE(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,t)}createSilentAuthCodeClient(t){return new TE(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ka.acquireTokenByCode,this.performanceClient,this.platformAuthProvider,t)}addEventCallback(t,r){return this.eventHandler.addEventCallback(t,r)}removeEventCallback(t){this.eventHandler.removeEventCallback(t)}addPerformanceCallback(t){return l8(),this.performanceClient.addPerformanceCallback(t)}removePerformanceCallback(t){return this.performanceClient.removePerformanceCallback(t)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==zo.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==zo.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(t){this.logger=t}initializeWrapperLibrary(t,r){this.browserStorage.setWrapperMetadata(t,r)}setNavigationClient(t){this.navigationClient=t}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(t){return t?.correlationId?t.correlationId:this.isBrowserEnvironment?Yu():Pt.EMPTY_STRING}async loginRedirect(t){const r=this.getRequestCorrelationId(t);return this.logger.verbose("loginRedirect called",r),this.acquireTokenRedirect({correlationId:r,...t||e4})}loginPopup(t){const r=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",r),this.acquireTokenPopup({correlationId:r,...t||e4})}async acquireTokenSilent(t){const r=this.getRequestCorrelationId(t),a=this.performanceClient.startMeasurement(Ye.AcquireTokenSilent,r);a.add({cacheLookupPolicy:t.cacheLookupPolicy,scenarioId:t.scenarioId}),t2(this.initialized,a,t.account),this.logger.verbose("acquireTokenSilent called",r);const n=t.account||this.getActiveAccount();if(!n)throw Tr(L6);return this.acquireTokenSilentDeduped(t,n,r).then(e=>(a.end({success:!0,fromCache:e.fromCache,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),{...e,state:t.state,correlationId:r})).catch(e=>{throw e instanceof gs&&e.setCorrelationId(r),a.end({success:!1},e,n),e})}async acquireTokenSilentDeduped(t,r,a){const n=Cy(this.config.auth.clientId,{...t,authority:t.authority||this.config.auth.authority},r.homeAccountId),e=JSON.stringify(n),p=this.activeSilentTokenRequests.get(e);if(typeof p>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",a),this.performanceClient.addFields({deduped:!1},a);const m=It(this.acquireTokenSilentAsync.bind(this),Ye.AcquireTokenSilentAsync,this.logger,this.performanceClient,a)({...t,correlationId:a},r);return this.activeSilentTokenRequests.set(e,m),m.finally(()=>{this.activeSilentTokenRequests.delete(e)})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",a),this.performanceClient.addFields({deduped:!0},a),p}async acquireTokenSilentAsync(t,r){const a=()=>this.trackPageVisibility(t.correlationId);this.performanceClient.addQueueMeasurement(Ye.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_START,pn.Silent,t),t.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},t.correlationId),document.addEventListener("visibilitychange",a);const n=await It(JT,Ye.InitializeSilentRequest,this.logger,this.performanceClient,t.correlationId)(t,r,this.config,this.performanceClient,this.logger),e=t.cacheLookupPolicy||_l.Default;return this.acquireTokenSilentNoIframe(n,e).catch(async m=>{if(kE(m,e))if(this.activeIframeRequest)if(e!==_l.Skip){const[w,A]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${A}`,n.correlationId);const I=this.performanceClient.startMeasurement(Ye.AwaitConcurrentIframe,n.correlationId);I.add({awaitIframeCorrelationId:A});const R=await w;if(I.end({success:R}),R)return this.logger.verbose(`Parallel iframe request with correlationId: ${A} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,e);throw this.logger.info(`Iframe request with correlationId: ${A} failed. Interaction is required.`),m}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),It(this.acquireTokenBySilentIframe.bind(this),Ye.AcquireTokenBySilentIframe,this.logger,this.performanceClient,n.correlationId)(n);else{let w;return this.activeIframeRequest=[new Promise(A=>{w=A}),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),It(this.acquireTokenBySilentIframe.bind(this),Ye.AcquireTokenBySilentIframe,this.logger,this.performanceClient,n.correlationId)(n).then(A=>(w(!0),A)).catch(A=>{throw w(!1),A}).finally(()=>{this.activeIframeRequest=void 0})}else throw m}).then(m=>(this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_SUCCESS,pn.Silent,m),this.performanceClient.addFields({fromCache:m.fromCache},t.correlationId),m)).catch(m=>{throw this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_FAILURE,pn.Silent,null,m),m}).finally(()=>{document.removeEventListener("visibilitychange",a)})}async acquireTokenSilentNoIframe(t,r){return Bm(this.config,this.logger,this.platformAuthProvider,t.authenticationScheme)&&t.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},t.correlationId),this.acquireTokenNative(t,Ka.acquireTokenSilent_silentFlow,t.account.nativeAccountId,r).catch(async a=>{throw this.performanceClient.addFields({brokerErrorName:a.name,brokerErrorCode:a.errorCode},t.correlationId),a instanceof kh&&U1(a)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,Qt(xf)):a})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),r===_l.AccessToken&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),It(this.acquireTokenFromCache.bind(this),Ye.AcquireTokenFromCache,this.logger,this.performanceClient,t.correlationId)(t,r).catch(a=>{if(r===_l.AccessToken)throw a;return this.eventHandler.emitEvent(jr.ACQUIRE_TOKEN_NETWORK_START,pn.Silent,t),It(this.acquireTokenByRefreshToken.bind(this),Ye.AcquireTokenByRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,r)}))}async preGeneratePkceCodes(t){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await It(D0,Ye.GeneratePkceCodes,this.logger,this.performanceClient,t)(this.performanceClient,this.logger,t),Promise.resolve()}getPreGeneratedPkceCodes(t){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const r=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${r?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!r},t),r}logMultipleInstances(t){const r=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(r),EE(r,t,this.logger)}}function kE(i,t){const r=!(i instanceof Ku&&i.subError!==Ty),a=i.errorCode===ic.INVALID_GRANT_ERROR||i.errorCode===xf,n=r&&a||i.errorCode===V2||i.errorCode===yb,e=sT.includes(t);return n&&e}async function _E(i,t){const r=new I0(i);return await r.initialize(),Ry.createController(r,t)}class Vb{static async createPublicClientApplication(t){const r=await _E(t);return new Vb(t,r)}constructor(t,r){this.isBroker=!1,this.controller=r||new Ry(new I0(t))}async initialize(t){return this.controller.initialize(t,this.isBroker)}async acquireTokenPopup(t){return this.controller.acquireTokenPopup(t)}acquireTokenRedirect(t){return this.controller.acquireTokenRedirect(t)}acquireTokenSilent(t){return this.controller.acquireTokenSilent(t)}acquireTokenByCode(t){return this.controller.acquireTokenByCode(t)}addEventCallback(t,r){return this.controller.addEventCallback(t,r)}removeEventCallback(t){return this.controller.removeEventCallback(t)}addPerformanceCallback(t){return this.controller.addPerformanceCallback(t)}removePerformanceCallback(t){return this.controller.removePerformanceCallback(t)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(t){return this.controller.getAccount(t)}getAccountByHomeId(t){return this.controller.getAccountByHomeId(t)}getAccountByLocalId(t){return this.controller.getAccountByLocalId(t)}getAccountByUsername(t){return this.controller.getAccountByUsername(t)}getAllAccounts(t){return this.controller.getAllAccounts(t)}handleRedirectPromise(t){return this.controller.handleRedirectPromise(t)}loginPopup(t){return this.controller.loginPopup(t)}loginRedirect(t){return this.controller.loginRedirect(t)}logout(t){return this.controller.logout(t)}logoutRedirect(t){return this.controller.logoutRedirect(t)}logoutPopup(t){return this.controller.logoutPopup(t)}ssoSilent(t){return this.controller.ssoSilent(t)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(t){this.controller.setLogger(t)}setActiveAccount(t){this.controller.setActiveAccount(t)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(t,r){return this.controller.initializeWrapperLibrary(t,r)}setNavigationClient(t){this.controller.setNavigationClient(t)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(t,r){return this.controller.hydrateCache(t,r)}clearCache(t){return this.controller.clearCache(t)}}const IE={initialize:()=>Promise.reject(Ji(to)),acquireTokenPopup:()=>Promise.reject(Ji(to)),acquireTokenRedirect:()=>Promise.reject(Ji(to)),acquireTokenSilent:()=>Promise.reject(Ji(to)),acquireTokenByCode:()=>Promise.reject(Ji(to)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(Ji(to)),loginPopup:()=>Promise.reject(Ji(to)),loginRedirect:()=>Promise.reject(Ji(to)),logout:()=>Promise.reject(Ji(to)),logoutRedirect:()=>Promise.reject(Ji(to)),logoutPopup:()=>Promise.reject(Ji(to)),ssoSilent:()=>Promise.reject(Ji(to)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw Ji(to)},getLogger:()=>{throw Ji(to)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw Ji(to)},hydrateCache:()=>Promise.reject(Ji(to)),clearCache:()=>Promise.reject(Ji(to))};class DE{static getInteractionStatusFromEvent(t,r){switch(t.eventType){case jr.LOGIN_START:return si.Login;case jr.SSO_SILENT_START:return si.SsoSilent;case jr.ACQUIRE_TOKEN_START:if(t.interactionType===pn.Redirect||t.interactionType===pn.Popup)return si.AcquireToken;break;case jr.HANDLE_REDIRECT_START:return si.HandleRedirect;case jr.LOGOUT_START:return si.Logout;case jr.SSO_SILENT_SUCCESS:case jr.SSO_SILENT_FAILURE:if(r&&r!==si.SsoSilent)break;return si.None;case jr.LOGOUT_END:if(r&&r!==si.Logout)break;return si.None;case jr.HANDLE_REDIRECT_END:if(r&&r!==si.HandleRedirect)break;return si.None;case jr.LOGIN_SUCCESS:case jr.LOGIN_FAILURE:case jr.ACQUIRE_TOKEN_SUCCESS:case jr.ACQUIRE_TOKEN_FAILURE:case jr.RESTORE_FROM_BFCACHE:if(t.interactionType===pn.Redirect||t.interactionType===pn.Popup){if(r&&r!==si.Login&&r!==si.AcquireToken)break;return si.None}break}return null}}const FE="modulepreload",RE=function(i){return"/hrms-portal/"+i},g4={},h5=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){let y=function(w){return Promise.all(w.map(A=>Promise.resolve(A).then(I=>({status:"fulfilled",value:I}),I=>({status:"rejected",reason:I}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),m=p?.nonce||p?.getAttribute("nonce");n=y(r.map(w=>{if(w=RE(w),w in g4)return;g4[w]=!0;const A=w.endsWith(".css"),I=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${I}`))return;const R=document.createElement("link");if(R.rel=A?"stylesheet":FE,A||(R.as="script"),R.crossOrigin="",R.href=w,m&&R.setAttribute("nonce",m),document.head.appendChild(R),A)return new Promise((k,M)=>{R.addEventListener("load",k),R.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${w}`)))})}))}function e(p){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=p,window.dispatchEvent(m),!m.defaultPrevented)throw p}return n.then(p=>{for(const m of p||[])m.status==="rejected"&&e(m.reason);return t().catch(e)})};const jE={instance:IE,inProgress:si.None,accounts:[],logger:new vd({})},Wb=le.createContext(jE);Wb.Consumer;function w8(i,t){return typeof i=="function"?i(t):i}function y4(i,t){if(i.length!==t.length)return!1;const r=[...t];return i.every(a=>{const n=r.shift();return!a||!n?!1:a.homeAccountId===n.homeAccountId&&a.localAccountId===n.localAccountId&&a.username===n.username})}function OE(i,t){return i.length>0&&(t.homeAccountId||t.localAccountId||t.username)&&i.filter(a=>!(t.username&&t.username.toLowerCase()!==a.username.toLowerCase()||t.homeAccountId&&t.homeAccountId.toLowerCase()!==a.homeAccountId.toLowerCase()||t.localAccountId&&t.localAccountId.toLowerCase()!==a.localAccountId.toLowerCase()))[0]||null}const LE="@azure/msal-react",v4="3.0.23";const Z2={UNBLOCK_INPROGRESS:"UNBLOCK_INPROGRESS",EVENT:"EVENT"},PE=(i,t)=>{const{type:r,payload:a}=t;let n=i.inProgress;switch(r){case Z2.UNBLOCK_INPROGRESS:i.inProgress===si.Startup&&(n=si.None,a.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case Z2.EVENT:const p=a.message,m=DE.getInteractionStatusFromEvent(p,i.inProgress);m&&(a.logger.info(`MsalProvider - ${p.eventType} results in setting inProgress from ${i.inProgress} to ${m}`),n=m);break;default:throw new Error(`Unknown action type: ${r}`)}if(n===si.Startup)return i;const e=a.instance.getAllAccounts();return n!==i.inProgress&&!y4(e,i.accounts)?{...i,inProgress:n,accounts:e}:n!==i.inProgress?{...i,inProgress:n}:y4(e,i.accounts)?i:{...i,accounts:e}};function ME({instance:i,children:t}){le.useEffect(()=>{i.initializeWrapperLibrary(rT.React,v4)},[i]);const r=le.useMemo(()=>i.getLogger().clone(LE,v4),[i]),[a,n]=le.useReducer(PE,void 0,()=>({inProgress:si.Startup,accounts:[]}));le.useEffect(()=>{const p=i.addEventCallback(m=>{n({payload:{instance:i,logger:r,message:m},type:Z2.EVENT})});return r.verbose(`MsalProvider - Registered event callback with id: ${p}`),i.initialize().then(()=>{i.handleRedirectPromise().catch(()=>{}).finally(()=>{n({payload:{instance:i,logger:r},type:Z2.UNBLOCK_INPROGRESS})})}).catch(()=>{}),()=>{p&&(r.verbose(`MsalProvider - Removing event callback ${p}`),i.removeEventCallback(p))}},[i,r]);const e={instance:i,inProgress:a.inProgress,accounts:a.accounts,logger:r};return vo.createElement(Wb.Provider,{value:e},t)}const Cd=()=>le.useContext(Wb);function UE(i,t){return t&&(t.username||t.homeAccountId||t.localAccountId)?!!OE(i,t):i.length>0}function S8(i){const{accounts:t,inProgress:r}=Cd();return le.useMemo(()=>r===si.Startup?!1:UE(t,i),[t,r,i])}function BE({username:i,homeAccountId:t,localAccountId:r,children:a}){const n=Cd(),e=le.useMemo(()=>({username:i,homeAccountId:t,localAccountId:r}),[i,t,r]);return S8(e)&&n.inProgress!==si.Startup?vo.createElement(vo.Fragment,null,w8(a,n)):null}function HE({username:i,homeAccountId:t,localAccountId:r,children:a}){const n=Cd(),e=le.useMemo(()=>({username:i,homeAccountId:t,localAccountId:r}),[i,t,r]);return!S8(e)&&n.inProgress!==si.Startup&&n.inProgress!==si.HandleRedirect?vo.createElement(vo.Fragment,null,w8(a,n)):null}const zE={auth:{clientId:"d149cfd3-5619-4d82-a73e-3e6a9c14c549",authority:"https://login.microsoftonline.com/83bbc9ba-745e-4322-91f7-871d643a214e",redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}};function Wu(...i){return i.filter(t=>!Gm(t)).map(t=>t.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}function av(){let i=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=(i+Math.random()*16)%16|0;return i=Math.floor(i/16),(t==="x"?r:r&3|8).toString(16)})}function Q1(i){return typeof i=="function"}function F0(i){return Array.isArray(i)}function Kb(i){return/^https?:\/\/|^\/\//i.test(i)}function Gm(i){return typeof i>"u"||i===null||i.length<1}function sp(i){return typeof i<"u"&&i!==null}function $E(i){return JSON.stringify(i)}function sc(i,t){return Object.hasOwnProperty.call(i,t)}function A8(){return function(i,...t){const r=[...i];for(let a=0;a<r.length;a++)Reflect.apply(r[a],this,t)}}function qE(){return function(i,...t){return[...i].reduce((a,n)=>Reflect.apply(n,this,a),t)}}function r2(){return async function(i,...t){return[...i].reduce((a,n)=>a.then(e=>Reflect.apply(n,this,e)),Promise.resolve(t))}}function GE(){return async function(i,...t){if(!F0(i)||i.length<1)return;const r=i[0];return Reflect.apply(r,this,t)}}function C8(){return function(i,...t){const r=[...i];for(let a=0;a<r.length;a++)Reflect.apply(r[a],this,t);return this}}const VE=Symbol.for("ObserverLifecycleFlags"),N8=i=>(t=>!((t[VE]||0)&i));class WE{constructor(t,r={}){this.moments=t,this.observers=r,this._onProxy=null,this._emitProxy=null,this._inheritingObservers=!0}using(...t){for(let r=0;r<t.length;r++)t[r](this);return this}get on(){return this._onProxy===null&&(this._onProxy=new Proxy(this,{get:(t,r)=>Object.assign(a=>(t.cloneObserversOnChange(),d5(t.observers,r,a,1),t),{toArray:()=>Reflect.has(t.observers,r)?[...Reflect.get(t.observers,r)]:[],replace:a=>(t.cloneObserversOnChange(),d5(t.observers,r,a,3),t),prepend:a=>(t.cloneObserversOnChange(),d5(t.observers,r,a,2),t),clear:()=>Reflect.has(t.observers,r)?(t.cloneObserversOnChange(),t.observers[r].length=0,!0):!1})})),this._onProxy}log(t,r=0){this.emit.log(t,r)}error(t){sp(t)&&this.emit.error(t)}get emit(){return this._emitProxy===null&&(this._emitProxy=new Proxy(this,{get:(t,r)=>(...a)=>{const n=Reflect.has(t.observers,r)?Reflect.get(t.observers,r):[];if((!F0(n)||n.length<1)&&r==="error")throw Error(`Unhandled Exception: ${a[0]}`);try{const e=Reflect.has(t.moments,r)?Reflect.get(t.moments,r):r==="init"||r==="dispose"?C8():A8();return Reflect.apply(e,t,[n,...a])}catch(e){if(r!=="error")this.error(e);else throw e}finally{n&&n.length>0&&Reflect.set(t.observers,r,n.filter(N8(2)))}}})),this._emitProxy}start(t){this.emit.init();const r=this.execute(t);return r.finally(()=>{try{this.emit.dispose()}catch(a){const n=Object.assign(Error("Error in dispose."),{innerException:a});this.error(n)}}).catch(()=>{}),r}cloneObserversOnChange(){this._inheritingObservers&&(this._inheritingObservers=!1,this.observers=T8(this.observers))}}function d5(i,t,r,a){if(!Q1(r))throw Error("Observers must be functions.");if(!Reflect.has(i,t))i[t]=[r];else switch(a){case 1:i[t].push(r);break;case 2:i[t].unshift(r);break;case 3:i[t].length=0,i[t].push(r);break}return i[t]}function T8(i){return Reflect.ownKeys(i).reduce((t,r)=>(t[r]=[...i[r].filter(N8(1))],t),{})}function ey(i,t="append",r){return a=>Reflect.apply(KE,a,[i,t,r])}function KE(i,t,r){if(!sp(i)||!sp(i.observers))return this;Q1(r)||(r=()=>!0);const a=T8(i.observers),n=Object.keys(a).filter(r);for(let e=0;e<n.length;e++){const p=n[e],m=this.on[p];t==="replace"&&m.clear(),a[p].forEach(w=>m(w))}return this}function L0(i,t,r,a){var n=arguments.length,e=n<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,r):a,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(i,t,r,a);else for(var m=i.length-1;m>=0;m--)(p=i[m])&&(e=(n<3?p(e):n>3?p(t,r,e):p(t,r))||e);return n>3&&e&&Object.defineProperty(t,r,e),e}const YE={construct:C8(),pre:r2(),auth:r2(),send:GE(),parse:r2(),post:r2(),data:A8()};let sv=class extends WE{constructor(t,r){super(YE),this.InternalResolve=Symbol.for("Queryable_Resolve"),this.InternalReject=Symbol.for("Queryable_Reject"),this.InternalPromise=Symbol.for("Queryable_Promise"),this._query=new URLSearchParams,this.moments[this.InternalPromise]=qE();let a;if(typeof t=="string")this._url=Wu(t,r);else if(F0(t)){if(t.length!==2)throw Error("When using the tuple param exactly two arguments are expected.");if(typeof t[1]!="string")throw Error("Expected second tuple param to be a string.");a=t[0],this._url=Wu(t[1],r)}else a=t,this._url=Wu(a._url,r);typeof a<"u"&&(this.observers=a.observers,this._inheritingObservers=!0)}concat(t){return this._url+=t,this}toRequestUrl(){let t=this.toUrl();const r=this.query.toString();return Gm(r)||(t+=`${t.indexOf("?")>-1?"&":"?"}${r}`),t}get query(){return this._query}toUrl(){return this._url}execute(t){if(Reflect.ownKeys(this.observers).length<1)throw Error("No observers registered for this request. (https://pnp.github.io/pnpjs/queryable/queryable#no-observers-registered-for-this-request)");return setTimeout(async()=>{const r=av();let a;const n=(e,p)=>{this.log(`[${r}] ${e}`,p)};try{n("Beginning request",0);const e={...t,headers:{...t.headers,"X-PnPjs-RequestId":r}};let[p,m,y]=await this.emit.pre(this.toRequestUrl(),e,void 0);if(n(`Url: ${p}`,1),typeof y<"u"){n("Result returned from pre, Emitting data"),this.emit.data(y),n("Emitted data");return}n("Emitting auth"),[a,m]=await this.emit.auth(new URL(p),m),n("Emitted auth"),m={...m,...t,headers:{...m.headers,...t.headers}},n("Emitting send");let w=await this.emit.send(a,m);n("Emitted send"),n("Emitting parse"),[a,w,y]=await this.emit.parse(a,w,y),n("Emitted parse"),n("Emitting post"),[a,y]=await this.emit.post(a,y),n("Emitted post"),n("Emitting data"),this.emit.data(y),n("Emitted data")}catch(e){n(`Emitting error: "${e.message||e}"`,3),this.error(e),n("Emitted error",3)}finally{n("Finished request",0)}},0),this.emit[this.InternalPromise](new Promise((r,a)=>{this.on[this.InternalResolve].replace(r),this.on[this.InternalReject].replace(a)}))[0]}};sv=L0([ZE()],sv);function E8(i,t={headers:{}}){return{method:i,...t,headers:{...t.headers}}}function JE(i){return this.start(E8("GET",i))}function QE(i){return this.start(E8("POST",i))}function k8(i,t,r){return Reflect.apply(t,i,[r])}function XE(i){return(t,r)=>{const a=new i(t,r);return a.emit.construct(t,r),a}}function ZE(i){return t=>new Proxy(t,{construct(r,a,n){const e=Object.assign(function(p){return Q1(i)||(i=function(m){return k8(this,JE,m)}),Reflect.apply(i,e,[p])},Reflect.construct(r,a,n));return Reflect.setPrototypeOf(e,n.prototype),e}})}function e7(){return jy(i=>i.text())}async function t7(i,t,r){if(!t.ok)throw await Yb.init(t);return[i,t,r]}function r7(i){let t=i;return sc(i,"d")?sc(i.d,"results")?t=i.d.results:t=i.d:sc(i,"value")&&(t=i.value),t}function jy(i){return t=>(t.on.parse.replace(t7),t.on.parse(async(r,a,n)=>(a.ok&&typeof n>"u"&&(n=await i(a)),[r,a,n])),t)}class Yb extends Error{constructor(t,r,a=r.status,n=r.statusText){super(t),this.response=r,this.status=a,this.statusText=n,this.isHttpRequestError=!0}static async init(t){const r=await t.clone().text();return new Yb(`Error making HttpClient request in queryable [${t.status}] ${t.statusText} ::> ${r}`,t)}}function Ef(i,t,r,a){Reflect.defineProperty(i.prototype,t,{configurable:!0,enumerable:!0,get:function(){return r(this,a||t)}})}function Xi(i,t){return Object.assign({body:$E(i)},t)}function Jb(i,t){return Object.assign({},t,{headers:{...i}})}const Hc=i=>XE(i);class Oy extends sv{constructor(t,r){if(typeof t=="string"){let a="",n="";if(Kb(t)||t.lastIndexOf("/")<0)n=t,a=Wu(t,r);else if(t.lastIndexOf("/")>t.lastIndexOf("(")){const e=t.lastIndexOf("/");n=t.slice(0,e),r=Wu(t.slice(e),r),a=Wu(n,r)}else{const e=t.lastIndexOf("(");n=t.slice(0,e),a=Wu(t,r)}super(a),this.parentUrl=n}else{super(t,r);const a=F0(t)?t[0]:t;this.parentUrl=F0(t)?t[1]:a.toUrl()}}toRequestUrl(){const t=new URLSearchParams(this.query);let r=this.toUrl().replace(/'!(@.+?)::((?:[^']|'')+)'/ig,(n,e,p)=>(this.log(`Rewriting aliased parameter from match ${n} to label: ${e} value: ${p}`,0),t.set(e,`'${p}'`),e));const a=t.toString();return Gm(a)||(r+=`${r.indexOf("?")>-1?"&":"?"}${a}`),r}select(...t){return t.length>0&&this.query.set("$select",t.join(",")),this}expand(...t){return t.length>0&&this.query.set("$expand",t.join(",")),this}getParent(t,r,a=this.parentUrl){return t([this,a],r)}}const A0=Hc(Oy);class hp extends Oy{filter(t){return typeof t=="object"?(this.query.set("$filter",t.toString()),this):typeof t=="function"?(this.query.set("$filter",t(iv.Where()).toString()),this):(this.query.set("$filter",t.toString()),this)}orderBy(t,r=!0){const a="$orderby",n=this.query.has(a)?this.query.get(a).split(","):[];return n.push(`${t} ${r?"asc":"desc"}`),this.query.set(a,n.join(",")),this}skip(t){return this.query.set("$skip",t.toString()),this}top(t){return this.query.set("$top",t.toString()),this}}const C0=Hc(hp);class dp extends Oy{}const w2=Hc(dp);function _8(){return function(){return I8(this)}}function Qb(){return function(i="*"){return n7(this,{},i)}}const ba=(i,t)=>k8(i,QE,t),Xb=(i,t)=>(t=t||{},t.headers={...t.headers,"X-HTTP-Method":"MERGE"},ba(i,t)),I8=(i,t)=>(t=t||{},t.headers={...t.headers||{},"X-HTTP-Method":"DELETE"},ba(i,t)),n7=(i,t,r="*")=>(t=t||{},t.headers={...t.headers||{},"IF-Match":r},I8(i,t));var no;(function(i){i.Equals="eq",i.NotEquals="ne",i.GreaterThan="gt",i.GreaterThanOrEqualTo="ge",i.LessThan="lt",i.LessThanOrEqualTo="le",i.StartsWith="startswith",i.SubstringOf="substringof"})(no||(no={}));var fl;(function(i){i.And="and",i.AndWithSpace=" and ",i.Or="or",i.OrWithSpace=" or "})(fl||(fl={}));class iv{static Where(){return new i7([])}}class Ly{constructor(t){this.query=[],this.query=t}}class Im extends Ly{constructor(t){super(t)}text(t){return new S2([...this.query,t])}choice(t){return new S2([...this.query,t])}multiChoice(t){return new S2([...this.query,t])}number(t){return new ov([...this.query,t])}date(t){return new c7([...this.query,t])}boolean(t){return new l7([...this.query,t])}lookup(t){return new o7([...this.query],t)}lookupId(t){const r=t.endsWith("Id")?t:`${t}Id`;return new ov([...this.query,r])}}class a7 extends Im{or(...t){return new vi([...this.query,`(${t.map(r=>r.toString()).join(fl.OrWithSpace)})`])}}class s7 extends Im{and(...t){return new vi([...this.query,`(${t.map(r=>r.toString()).join(fl.AndWithSpace)})`])}}class i7 extends Im{or(...t){return t==null||t.length===0?new Im([...this.query,fl.Or]):new vi([...this.query,`(${t.map(r=>r.toString()).join(fl.OrWithSpace)})`])}and(...t){return t==null||t.length===0?new Im([...this.query,fl.And]):new vi([...this.query,`(${t.map(r=>r.toString()).join(fl.AndWithSpace)})`])}}class o7 extends Ly{constructor(t,r){super(t),this.LookupField=r}Id(t){return new vi([...this.query,`${this.LookupField}/Id`,no.Equals,t.toString()])}text(t){return new S2([...this.query,`${this.LookupField}/${t}`])}number(t){return new ov([...this.query,`${this.LookupField}/${t}`])}}class D8 extends Ly{constructor(t){super(t),this.LastIndex=t.length-1,this.InternalName=t[this.LastIndex]}toODataValue(t){return`'${t}'`}isNull(){return new vi([...this.query,no.Equals,"null"])}isNotNull(){return new vi([...this.query,no.NotEquals,"null"])}}class F8 extends D8{equals(t){return new vi([...this.query,no.Equals,this.toODataValue(t)])}notEquals(t){return new vi([...this.query,no.NotEquals,this.toODataValue(t)])}in(...t){return iv.Where().or(...t.map(r=>this.equals(r)))}notIn(...t){return iv.Where().and(...t.map(r=>this.notEquals(r)))}}class S2 extends F8{startsWith(t){const r=`${no.StartsWith}(${this.InternalName}, ${this.toODataValue(t)})`;return this.query[this.LastIndex]=r,new vi([...this.query])}contains(t){const r=`${no.SubstringOf}(${this.toODataValue(t)}, ${this.InternalName})`;return this.query[this.LastIndex]=r,new vi([...this.query])}}class l7 extends D8{toODataValue(t){return`${t==null?"null":t?1:0}`}isTrue(){return new vi([...this.query,no.Equals,this.toODataValue(!0)])}isFalse(){return new vi([...this.query,no.Equals,this.toODataValue(!1)])}isFalseOrNull(){const t=`(${[this.InternalName,no.Equals,this.toODataValue(null),fl.Or,this.InternalName,no.Equals,this.toODataValue(!1)].join(" ")})`;return this.query[this.LastIndex]=t,new vi([...this.query])}}class R8 extends F8{greaterThan(t){return new vi([...this.query,no.GreaterThan,this.toODataValue(t)])}greaterThanOrEquals(t){return new vi([...this.query,no.GreaterThanOrEqualTo,this.toODataValue(t)])}lessThan(t){return new vi([...this.query,no.LessThan,this.toODataValue(t)])}lessThanOrEquals(t){return new vi([...this.query,no.LessThanOrEqualTo,this.toODataValue(t)])}}class ov extends R8{toODataValue(t){return`${t}`}}class c7 extends R8{toODataValue(t){return`'${t.toISOString()}'`}isBetween(t,r){const a=`(${[this.InternalName,no.GreaterThan,this.toODataValue(t),fl.And,this.InternalName,no.LessThan,this.toODataValue(r)].join(" ")})`;return this.query[this.LastIndex]=a,new vi([...this.query])}isToday(){const t=new Date;t.setHours(0,0,0,0);const r=new Date;return r.setHours(23,59,59,999),this.isBetween(t,r)}}class vi extends Ly{and(...t){return t==null||t.length===0?new a7([...this.query,fl.And]):new vi([...this.query,fl.And,`(${t.map(r=>r.toString()).join(fl.AndWithSpace)})`])}or(...t){return t==null||t.length===0?new s7([...this.query,fl.Or]):new vi([...this.query,fl.Or,`(${t.map(r=>r.toString()).join(fl.OrWithSpace)})`])}toString(){return this.query.join(" ")}}function fp(i){return function(t){return class extends t{constructor(...r){super(r[0],r.length>1&&r[1]!==void 0?r[1]:i)}}}}class Zb{constructor(t=""){this._root=A0(t)}using(...t){return this._root.using(...t),this}create(t,r){return t(this._root,r)}}function j8(i=""){return typeof i=="object"&&!Reflect.has(i,"length")&&(i=i._root),new Zb(i)}var b4;(function(i){i[i.None=0]="None",i[i.User=1]="User",i[i.DistributionList=2]="DistributionList",i[i.SecurityGroup=4]="SecurityGroup",i[i.SharePointGroup=8]="SharePointGroup",i[i.All=15]="All"})(b4||(b4={}));var x4;(function(i){i[i.None=0]="None",i[i.UserInfoList=1]="UserInfoList",i[i.Windows=2]="Windows",i[i.MembershipProvider=4]="MembershipProvider",i[i.RoleProvider=8]="RoleProvider",i[i.All=15]="All"})(x4||(x4={}));var w4;(function(i){i[i.Invalid=-1]="Invalid",i[i.DefaultView=0]="DefaultView",i[i.NormalView=1]="NormalView",i[i.DialogView=2]="DialogView",i[i.View=3]="View",i[i.DisplayForm=4]="DisplayForm",i[i.DisplayFormDialog=5]="DisplayFormDialog",i[i.EditForm=6]="EditForm",i[i.EditFormDialog=7]="EditFormDialog",i[i.NewForm=8]="NewForm",i[i.NewFormDialog=9]="NewFormDialog",i[i.SolutionForm=10]="SolutionForm",i[i.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"})(w4||(w4={}));function ex(i){if(Gm(i))return"";let t=i.indexOf("_api/");return t<0&&(t=i.indexOf("_vti_bin/")),t>-1?i.substring(0,t):i}function lv(i){const t=[],r=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(sc(i,r[0])&&i[r[0]]==="SP.Web")sc(i,r[4])?t.push(i[r[4]]):sc(i,r[2])&&t.push(i.__metadata.uri);else if(sc(i,r[3])&&sc(i,r[1])){const a=Kb(i[r[1]])?i[r[1]].split("_api")[1]:i[r[1]];t.push(ex(i[r[3]]),"_api",a)}else sc(i,r[1])?t.push("_api",i[r[1]]):sc(i,r[2])&&t.push(i.__metadata.uri);return t.length<1?"":Wu(...t)}function S4(i){return{DecodedUrl:i}}function y0(i){return Gm(i)?"":/!(@.*?)::(.*?)/ig.test(i)?i.replace(/!(@.*?)::(.*)$/ig,(t,r,a)=>`!${r}::${a.replace(/'/ig,"''")}`):encodeURIComponent(i.replace(/'/ig,"''"))}let cv=class extends hp{async add(t,r,a="",n="STS",e=1033,p=!0){const m=Xi({parameters:{Description:a,Language:e,Title:t,Url:r,UseSamePermissionsAsParentSite:p,WebTemplate:n}});return ba(O8(this,"add"),m)}};cv=L0([fp("webs")],cv);const O8=Hc(cv);function f5(i,t){let r="_api/web";const a=/(_api[/|\\](site\/rootweb|site|web))/i.exec(i);return a?.length>0&&(i=ex(i),r=a[1]),t?.indexOf("_api")<0&&(i=Wu(i,r)),i}let ou=class extends dp{constructor(t,r){typeof t=="string"?t=f5(t,r):F0(t)?t=[t[0],f5(t[1],r)]:t=[t,f5(t.toUrl(),r)],super(t,r),this.delete=_8()}get webs(){return O8(this)}get allProperties(){return w2(this,"allproperties")}get webinfos(){return C0(this,"webinfos")}async getParentWeb(){const{Url:t,ParentWeb:r}=await this.select("Url","ParentWeb/ServerRelativeUrl").expand("ParentWeb")();return r?.ServerRelativeUrl?zu([this,Wu(new URL(t).origin,r.ServerRelativeUrl)]):null}async update(t){return Xb(this,Xi(t))}applyTheme(t,r,a,n){const e=Xi({backgroundImageUrl:a,colorPaletteUrl:t,fontSchemeUrl:r,shareGenerated:n});return ba(zu(this,"applytheme"),e)}applyWebTemplate(t){return ba(zu(this,`applywebtemplate(webTemplate='${y0(t)}')`))}getChanges(t){return ba(zu(this,"getchanges"),Xi({query:t}))}mapToIcon(t,r=0,a=""){return zu(this,`maptoicon(filename='${y0(t)}',progid='${y0(a)}',size=${r})`)()}getStorageEntity(t){return zu(this,`getStorageEntity('${y0(t)}')`)()}setStorageEntity(t,r,a="",n=""){return ba(zu(this,"setStorageEntity"),Xi({comments:n,description:a,key:t,value:r}))}removeStorageEntity(t){return ba(zu(this,`removeStorageEntity('${y0(t)}')`))}getSubwebsFilteredForCurrentUser(t=-1,r=-1){return C0(this,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${t},nConfigurationFilter=${r})`)}availableWebTemplates(t=1033,r=!0){return C0(this,`getavailablewebtemplates(lcid=${t},doincludecrosslanguage=${r})`)}};ou=L0([fp("_api/web")],ou);const zu=Hc(ou);Zb.prototype.batched=function(i){const t=j8(this),[r,a]=L8(t._root,i);return t.using(r),[t,a]};ou.prototype.batched=function(i){const t=zu(this),[r,a]=L8(t,i);return t.using(r),[t,a]};const R1=Symbol.for("batch_registration"),p0=Symbol.for("batch_request");function u7(){return jy(async i=>{const t=await i.text();return h7(t)})}class A4 extends Oy{constructor(t,r=t.toUrl().replace(/_api[\\|/].*$/i,"")){super(r,"_api/$batch"),this.requestBaseUrl=r,this.using(ey(t,"replace"),u7()),this.on.dispose(()=>{t.using(ey(this,"replace",a=>/(auth|send|pre|init)/i.test(a)))})}}function L8(i,t){const r=[],a=[],n=[],e=new A4(i),p=av(),m=new A4(i),{headersCopyPattern:y,maxRequests:w}={headersCopyPattern:/Accept|Content-Type|IF-Match/i,maxRequests:20,...t};return[R=>(R.on.init(function(){if(Q1(this[R1]))throw Error("This instance is already part of a batch. Please review the docs at https://pnp.github.io/pnpjs/concepts/batching#reuse.");return r.push(new Promise(k=>{this[R1]=k})),this}),R.on.pre(async function(k,M,V){return sc(M.headers,"X-PnP-BatchNever")?(typeof this[p0]=="function"&&(this[p0](),delete this[p0]),this.using(ey(m,"replace",q=>/(init|pre)/i.test(q))),[k,M,V]):(this.on.auth.clear(),this.on.send.replace(async function(q,U){const te=new Promise(W=>{n.push([this,q.toString(),U,W])});return this.log(`[batch:${p}] (${new Date().getTime()}) Adding request ${U.method} ${q.toString()} to batch.`,0),a.push(new Promise(W=>{this[p0]=W})),this[R1](),te}),this.on.dispose(function(){Q1(this[R1])&&(this[R1](),delete this[R1]),Q1(this[p0])&&(this[p0](),delete this[p0],this.using(ey(m,"replace",q=>/(auth|pre|send|init|dispose)/i.test(q))))}),[k,M,V])}),R),async()=>{if(await Promise.all(r),n.length<1)return Promise.all(a).then(()=>{});const R=n.slice();for(;R.length>0;){const k=R.splice(0,w),M=[];let V="";for(let U=0;U<k.length;U++){const[,te,W]=k[U];W.method==="GET"?(V.length>0&&(M.push(`--changeset_${V}--

`),V=""),M.push(`--batch_${p}
`)):(V.length<1&&(V=av(),M.push(`--batch_${p}
`),M.push(`Content-Type: multipart/mixed; boundary="changeset_${V}"

`)),M.push(`--changeset_${V}
`)),M.push(`Content-Type: application/http
`),M.push(`Content-Transfer-Encoding: binary

`);const re=new Headers(W.headers),xe=Kb(te)?te:Wu(e.requestBaseUrl,te);if(W.method!=="GET"){let ve=W.method;re.has("X-HTTP-Method")&&(ve=re.get("X-HTTP-Method"),re.delete("X-HTTP-Method")),M.push(`${ve} ${xe} HTTP/1.1
`)}else M.push(`${W.method} ${xe} HTTP/1.1
`);re.has("Accept")||re.append("Accept","application/json"),re.has("Content-Type")||re.append("Content-Type","application/json;charset=utf-8"),re.forEach((ve,De)=>{y.test(De)&&M.push(`${De}: ${ve}
`)}),M.push(`
`),W.body&&M.push(`${W.body}

`)}V.length>0&&(M.push(`--changeset_${V}--

`),V=""),M.push(`--batch_${p}--
`);const q=await ba(e,{body:M.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${p}`}});if(q.length!==k.length)throw Error("Could not properly parse responses to match requests in batch.");for(let U=0;U<q.length;U++)k[U][3](q[U])}await Promise.all(a).then(()=>{})}]}function h7(i){const t=[],r="--batchresponse_",a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),n=i.split(`
`);let e="batch",p,m,y={};const w=[];for(let A=0;A<n.length;++A){let I=n[A];switch(e){case"batch":if(I.substring(0,r.length)===r)e="batchHeaders";else if(I.trim()!=="")throw Error(`Invalid response, line ${A}`);break;case"batchHeaders":I.trim()===""&&(e="status");break;case"status":{const R=a.exec(I);if(R.length!==3)throw Error(`Invalid status, line ${A}`);p=parseInt(R[1],10),m=R[2],e="statusHeaders";break}case"statusHeaders":if(I.trim()==="")e="body";else{const R=I.split(":");R?.length===2&&(y[R[0].trim()]=R[1].trim())}break;case"body":for(w.length=0;I.substring(0,r.length)!==r;)w.push(I),I=n[++A];A--,t.push(new Response(p===204?null:w.join(""),{status:p,statusText:m,headers:y})),e="batch",y={};break}}if(e!=="status")throw Error("Unexpected end of input");return t}Reflect.defineProperty(Zb.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.create(zu)}});let uv=class extends hp{getById(t){return go(this).concat(`('${t}')`)}getByTitle(t){return go(this,`getByTitle('${y0(t)}')`)}async add(t,r="",a=100,n=!1,e={}){const p={AllowContentTypes:n,BaseTemplate:a,ContentTypesEnabled:n,Description:r,Title:t,...e};return ba(this,Xi(p))}async ensure(t,r="",a=100,n=!1,e={}){const p={Title:t,Description:r,ContentTypesEnabled:n,...e},m=this.getByTitle(p.Title);try{return await m.select("Title")(),{created:!1,data:await m.update(p),list:this.getByTitle(p.Title)}}catch{return{created:!0,data:await this.add(t,r,a,n,p),list:this.getByTitle(p.Title)}}}async ensureSiteAssetsLibrary(){const t=await ba(hv(this,"ensuresiteassetslibrary"));return go([this,lv(t)])}async ensureSitePagesLibrary(){const t=await ba(hv(this,"ensuresitepageslibrary"));return go([this,lv(t)])}};uv=L0([fp("lists")],uv);const hv=Hc(uv);class tx extends dp{constructor(){super(...arguments),this.delete=Qb()}get effectiveBasePermissions(){return A0(this,"EffectiveBasePermissions")}get eventReceivers(){return C0(this,"EventReceivers")}get relatedFields(){return A0(this,"getRelatedFields")}get informationRightsManagementSettings(){return A0(this,"InformationRightsManagementSettings")}async update(t,r="*"){return await Xb(this,Xi(t,Jb({"IF-Match":r})))}getChanges(t){return ba(go(this,"getchanges"),Xi({query:t}))}getItemsByCAMLQuery(t,...r){return ba(go(this,"getitems").expand(...r),Xi({query:t}))}getListItemChangesSinceToken(t){return ba(go(this,"getlistitemchangessincetoken").using(e7()),Xi({query:t}))}async recycle(){return ba(go(this,"recycle"))}async renderListData(t){const r=go(this,"renderlistdata(@viewXml)");r.query.set("@viewXml",`'${t}'`);const a=await ba(r);return JSON.parse(a)}renderListDataAsStream(t,r=null,a=new Map){sc(t,"RenderOptions")&&F0(t.RenderOptions)&&(t.RenderOptions=t.RenderOptions.reduce((p,m)=>p+m));const n=go(this,"RenderListDataAsStream");a&&a.size>0&&a.forEach((p,m)=>n.query.set(m,p));const e=sp(r)?{parameters:t,overrideParameters:r}:{parameters:t};return ba(n,Xi(e))}async renderListFormData(t,r,a){const n=await ba(go(this,`renderlistformdata(itemid=${t}, formid='${r}', mode='${a}')`));return JSON.parse(n)}async reserveListItemId(){return ba(go(this,"reservelistitemid"))}async addValidateUpdateItemUsingPath(t,r,a=!1,n,e){const p={FolderPath:S4(r)};return sp(e)&&(e.leafName&&(p.LeafName=S4(e.leafName)),e.objectType&&(p.UnderlyingObjectType=e.objectType)),ba(go(this,"AddValidateUpdateItemUsingPath()"),Xi({bNewDocumentUpdate:a,checkInComment:n,formValues:t,listItemCreateInfo:p}))}async getParentInfos(){const t=await this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:t.Id,RootFolderServerRelativePath:t.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:t.RootFolder.ServerRelativeUrl,RootFolderUniqueId:t.RootFolder.UniqueId},ParentWeb:{Id:t.ParentWeb.Id,ServerRelativePath:t.ParentWeb.ServerRelativePath,ServerRelativeUrl:t.ParentWeb.ServerRelativeUrl,Url:t.ParentWeb.Url}}}}const go=Hc(tx);var C4;(function(i){i[i.None=0]="None",i[i.ContextInfo=1]="ContextInfo",i[i.ListData=2]="ListData",i[i.ListSchema=4]="ListSchema",i[i.MenuView=8]="MenuView",i[i.ListContentType=16]="ListContentType",i[i.FileSystemItemId=32]="FileSystemItemId",i[i.ClientFormSchema=64]="ClientFormSchema",i[i.QuickLaunch=128]="QuickLaunch",i[i.Spotlight=256]="Spotlight",i[i.Visualization=512]="Visualization",i[i.ViewMetadata=1024]="ViewMetadata",i[i.DisableAutoHyperlink=2048]="DisableAutoHyperlink",i[i.EnableMediaTAUrls=4096]="EnableMediaTAUrls",i[i.ParentInfo=8192]="ParentInfo",i[i.PageContextInfo=16384]="PageContextInfo",i[i.ClientSideComponentManifest=32768]="ClientSideComponentManifest",i[i.ListAvailableContentTypes=65536]="ListAvailableContentTypes",i[i.FolderContentTypeOrder=131072]="FolderContentTypeOrder",i[i.GridInitInfo=262144]="GridInitInfo",i[i.SiteUrlAsMediaTASPItemHost=524288]="SiteUrlAsMediaTASPItemHost",i[i.AddToOneDrive=1048576]="AddToOneDrive",i[i.SPFXCustomActions=2097152]="SPFXCustomActions",i[i.CustomActions=4194304]="CustomActions"})(C4||(C4={}));var N4;(function(i){i[i.Display=1]="Display",i[i.Edit=2]="Edit",i[i.New=3]="New"})(N4||(N4={}));Ef(ou,"lists",hv);Ef(ou,"siteUserInfoList",go);Ef(ou,"defaultDocumentLibrary",go);Ef(ou,"customListTemplates",C0,"getcustomlisttemplates");ou.prototype.getList=function(i){return go(this,`getList('${y0(i)}')`)};ou.prototype.getCatalog=async function(i){const t=await zu(this,`getcatalog(${i})`).select("Id")();return go([this,lv(t)])};let dv=class extends hp{getById(t){return v0(this).concat(`(${t})`)}getItemByStringId(t){return v0([this,this.parentUrl],`getItemByStringId('${t}')`)}skip(t,r=!1){return r?this.query.set("$skiptoken",`Paged=TRUE&PagedPrev=TRUE&p_ID=${t}`):this.query.set("$skiptoken",`Paged=TRUE&p_ID=${t}`),this}[Symbol.asyncIterator](){const t=C0(this).using(jy(async a=>{const n=await a.json(),e=sc(n,"d")&&sc(n.d,"__next")?n.d.__next:n["odata.nextLink"];return{hasNext:typeof e=="string"&&e.length>0,nextLink:e,value:r7(n)}})),r=["$top","$select","$expand","$filter","$orderby","$skiptoken"];for(let a=0;a<r.length;a++){const n=this.query.get(r[a]);sp(n)&&t.query.set(r[a],n)}return{_next:t,async next(){if(this._next===null)return{done:!0,value:void 0};const a=await this._next();return a.hasNext?(this._next=C0([this._next,a.nextLink]),{done:!1,value:a.value}):(this._next=null,{done:!1,value:a.value})}}}async add(t={}){return ba(this,Xi(t))}};dv=L0([fp("items")],dv);const d7=Hc(dv);class f7 extends dp{constructor(){super(...arguments),this.delete=Qb()}get effectiveBasePermissions(){return A0(this,"EffectiveBasePermissions")}get effectiveBasePermissionsForUI(){return A0(this,"EffectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return w2(this,"FieldValuesAsHTML")}get fieldValuesAsText(){return w2(this,"FieldValuesAsText")}get fieldValuesForEdit(){return w2(this,"FieldValuesForEdit")}get versions(){return p7(this)}get list(){return this.getParent(go,"",this.parentUrl.substring(0,this.parentUrl.lastIndexOf("/")))}async update(t,r="*"){const a=Xi(t,Jb({"IF-Match":r,"X-HTTP-Method":"MERGE"}));return ba(v0(this).using(y7()),a)}recycle(){return ba(v0(this,"recycle"))}async deleteWithParams(t){return ba(v0(this,"DeleteWithParameters"),Xi({parameters:t}))}async getWopiFrameUrl(t=0){const r=v0(this,"getWOPIFrameUrl(@action)");return r.query.set("@action",t),ba(r)}validateUpdateListItem(t,r=!1){return ba(v0(this,"validateupdatelistitem"),Xi({formValues:t,bNewDocumentUpdate:r}))}async getParentInfos(){const t=await this.select("Id","ParentList/Id","ParentList/Title","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:t.Id},ParentList:{Id:t.ParentList.Id,Title:t.ParentList.Title,RootFolderServerRelativePath:t.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:t.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:t.ParentList.RootFolder.UniqueId},ParentWeb:{Id:t.ParentList.ParentWeb.Id,ServerRelativePath:t.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:t.ParentList.ParentWeb.ServerRelativeUrl,Url:t.ParentList.ParentWeb.Url}}}async setImageField(t,r,a){const n=await this.getParentInfos(),e=ex(this.toUrl()),p=A0([this,e],"/_api/web/UploadImage");p.concat("(listTitle=@a1,imageName=@a2,listId=@a3,itemId=@a4)"),p.query.set("@a1",`'${n.ParentList.Title}'`),p.query.set("@a2",`'${r}'`),p.query.set("@a3",`'${n.ParentList.Id}'`),p.query.set("@a4",n.Item.Id);const m=await ba(p,{body:a}),y={type:"thumbnail",fileName:m.Name,nativeFile:{},fieldName:t,serverUrl:n.ParentWeb.Url.replace(n.ParentWeb.ServerRelativeUrl,""),serverRelativeUrl:m.ServerRelativeUrl,id:m.UniqueId};return this.validateUpdateListItem([{FieldName:t,FieldValue:JSON.stringify(y)}])}}const v0=Hc(f7);let fv=class extends hp{getById(t){return g7(this).concat(`(${t})`)}};fv=L0([fp("versions")],fv);const p7=Hc(fv);class m7 extends dp{constructor(){super(...arguments),this.delete=Qb()}}const g7=Hc(m7);function y7(){return jy(async i=>({etag:i.headers.get("etag")}))}Ef(tx,"items",d7);var ty;(function(i){i[i.Verbose=0]="Verbose",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i[i.Off=99]="Off"})(ty||(ty={}));const v7=[];ty.Warning;function b7(i){return t=>(t.on.log(function(r,a){i<=a&&v7.map(n=>n.log({level:a,message:r}))}),t)}let n2;const x7=(i,t)=>r=>(r.on.auth.replace(async function(a,n){console.log("PnP: Intercepting request for",a.toString());const e=i.getAllAccounts();if(e.length>0){const p={scopes:t,account:e[0]};try{console.log("PnP: Attempting to acquire token silently...");const m=await i.acquireTokenSilent(p);console.log("PnP: Token acquired successfully.");const y=m.accessToken;n.headers||(n.headers={}),n.headers.Authorization=`Bearer ${y}`,n.headers.Accept="application/json;odata=verbose"}catch(m){console.error("PnP: Token acquisition failed via Behavior",m)}}else console.warn("PnP: No active accounts found for token acquisition.");return console.log("PnP: Proceeding with request."),[a,n]}),r),ry=i=>n2||(i&&(Nm=i,n2=j8("https://jmtechtalent.sharepoint.com/sites/EmployeesDOB").using(b7(ty.Warning)).using(x7(i,["https://jmtechtalent.sharepoint.com/.default"]))),n2);let Nm;const nn=async()=>{if(!Nm)throw new Error("MSAL Instance not initialized");const i=Nm.getActiveAccount(),t=Nm.getAllAccounts(),r=i||t[0];if(!r)throw new Error("No active account! Please sign in.");const a={scopes:["https://jmtechtalent.sharepoint.com/.default"],account:r};try{return(await Nm.acquireTokenSilent(a)).accessToken}catch(n){throw console.warn("Silent token failed",n),new Error("InteractionRequired: "+n.message)}};var T4="popstate";function w7(i={}){function t(a,n){let{pathname:e,search:p,hash:m}=a.location;return pv("",{pathname:e,search:p,hash:m},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:Hm(n)}return A7(t,r,null,i)}function Xs(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function lu(i,t){if(!i){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function S7(){return Math.random().toString(36).substring(2,10)}function E4(i,t){return{usr:i.state,key:i.key,idx:t}}function pv(i,t,r=null,a){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof t=="string"?pp(t):t,state:r,key:t&&t.key||a||S7()}}function Hm({pathname:i="/",search:t="",hash:r=""}){return t&&t!=="?"&&(i+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(i+=r.charAt(0)==="#"?r:"#"+r),i}function pp(i){let t={};if(i){let r=i.indexOf("#");r>=0&&(t.hash=i.substring(r),i=i.substring(0,r));let a=i.indexOf("?");a>=0&&(t.search=i.substring(a),i=i.substring(0,a)),i&&(t.pathname=i)}return t}function A7(i,t,r,a={}){let{window:n=document.defaultView,v5Compat:e=!1}=a,p=n.history,m="POP",y=null,w=A();w==null&&(w=0,p.replaceState({...p.state,idx:w},""));function A(){return(p.state||{idx:null}).idx}function I(){m="POP";let q=A(),U=q==null?null:q-w;w=q,y&&y({action:m,location:V.location,delta:U})}function R(q,U){m="PUSH";let te=pv(V.location,q,U);w=A()+1;let W=E4(te,w),re=V.createHref(te);try{p.pushState(W,"",re)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;n.location.assign(re)}e&&y&&y({action:m,location:V.location,delta:1})}function k(q,U){m="REPLACE";let te=pv(V.location,q,U);w=A();let W=E4(te,w),re=V.createHref(te);p.replaceState(W,"",re),e&&y&&y({action:m,location:V.location,delta:0})}function M(q){return C7(q)}let V={get action(){return m},get location(){return i(n,p)},listen(q){if(y)throw new Error("A history only accepts one active listener");return n.addEventListener(T4,I),y=q,()=>{n.removeEventListener(T4,I),y=null}},createHref(q){return t(n,q)},createURL:M,encodeLocation(q){let U=M(q);return{pathname:U.pathname,search:U.search,hash:U.hash}},push:R,replace:k,go(q){return p.go(q)}};return V}function C7(i,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Xs(r,"No window.location.(origin|href) available to create URL");let a=typeof i=="string"?i:Hm(i);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=r+a),new URL(a,r)}function P8(i,t,r="/"){return N7(i,t,r,!1)}function N7(i,t,r,a){let n=typeof t=="string"?pp(t):t,e=xd(n.pathname||"/",r);if(e==null)return null;let p=M8(i);T7(p);let m=null;for(let y=0;m==null&&y<p.length;++y){let w=P7(e);m=O7(p[y],w,a)}return m}function M8(i,t=[],r=[],a="",n=!1){let e=(p,m,y=n,w)=>{let A={relativePath:w===void 0?p.path||"":w,caseSensitive:p.caseSensitive===!0,childrenIndex:m,route:p};if(A.relativePath.startsWith("/")){if(!A.relativePath.startsWith(a)&&y)return;Xs(A.relativePath.startsWith(a),`Absolute route path "${A.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),A.relativePath=A.relativePath.slice(a.length)}let I=yd([a,A.relativePath]),R=r.concat(A);p.children&&p.children.length>0&&(Xs(p.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${I}".`),M8(p.children,t,R,I,y)),!(p.path==null&&!p.index)&&t.push({path:I,score:R7(I,p.index),routesMeta:R})};return i.forEach((p,m)=>{if(p.path===""||!p.path?.includes("?"))e(p,m);else for(let y of U8(p.path))e(p,m,!0,y)}),t}function U8(i){let t=i.split("/");if(t.length===0)return[];let[r,...a]=t,n=r.endsWith("?"),e=r.replace(/\?$/,"");if(a.length===0)return n?[e,""]:[e];let p=U8(a.join("/")),m=[];return m.push(...p.map(y=>y===""?e:[e,y].join("/"))),n&&m.push(...p),m.map(y=>i.startsWith("/")&&y===""?"/":y)}function T7(i){i.sort((t,r)=>t.score!==r.score?r.score-t.score:j7(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var E7=/^:[\w-]+$/,k7=3,_7=2,I7=1,D7=10,F7=-2,k4=i=>i==="*";function R7(i,t){let r=i.split("/"),a=r.length;return r.some(k4)&&(a+=F7),t&&(a+=_7),r.filter(n=>!k4(n)).reduce((n,e)=>n+(E7.test(e)?k7:e===""?I7:D7),a)}function j7(i,t){return i.length===t.length&&i.slice(0,-1).every((a,n)=>a===t[n])?i[i.length-1]-t[t.length-1]:0}function O7(i,t,r=!1){let{routesMeta:a}=i,n={},e="/",p=[];for(let m=0;m<a.length;++m){let y=a[m],w=m===a.length-1,A=e==="/"?t:t.slice(e.length)||"/",I=ny({path:y.relativePath,caseSensitive:y.caseSensitive,end:w},A),R=y.route;if(!I&&w&&r&&!a[a.length-1].route.index&&(I=ny({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},A)),!I)return null;Object.assign(n,I.params),p.push({params:n,pathname:yd([e,I.pathname]),pathnameBase:H7(yd([e,I.pathnameBase])),route:R}),I.pathnameBase!=="/"&&(e=yd([e,I.pathnameBase]))}return p}function ny(i,t){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[r,a]=L7(i.path,i.caseSensitive,i.end),n=t.match(r);if(!n)return null;let e=n[0],p=e.replace(/(.)\/+$/,"$1"),m=n.slice(1);return{params:a.reduce((w,{paramName:A,isOptional:I},R)=>{if(A==="*"){let M=m[R]||"";p=e.slice(0,e.length-M.length).replace(/(.)\/+$/,"$1")}const k=m[R];return I&&!k?w[A]=void 0:w[A]=(k||"").replace(/%2F/g,"/"),w},{}),pathname:e,pathnameBase:p,pattern:i}}function L7(i,t=!1,r=!0){lu(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let a=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,m,y)=>(a.push({paramName:m,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(a.push({paramName:"*"}),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}function P7(i){try{return i.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return lu(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),i}}function xd(i,t){if(t==="/")return i;if(!i.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=i.charAt(r);return a&&a!=="/"?null:i.slice(r)||"/"}var B8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,M7=i=>B8.test(i);function U7(i,t="/"){let{pathname:r,search:a="",hash:n=""}=typeof i=="string"?pp(i):i,e;if(r)if(M7(r))e=r;else{if(r.includes("//")){let p=r;r=r.replace(/\/\/+/g,"/"),lu(!1,`Pathnames cannot have embedded double slashes - normalizing ${p} -> ${r}`)}r.startsWith("/")?e=_4(r.substring(1),"/"):e=_4(r,t)}else e=t;return{pathname:e,search:z7(a),hash:$7(n)}}function _4(i,t){let r=t.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function p5(i,t,r,a){return`Cannot include a '${i}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function B7(i){return i.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function rx(i){let t=B7(i);return t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase)}function nx(i,t,r,a=!1){let n;typeof i=="string"?n=pp(i):(n={...i},Xs(!n.pathname||!n.pathname.includes("?"),p5("?","pathname","search",n)),Xs(!n.pathname||!n.pathname.includes("#"),p5("#","pathname","hash",n)),Xs(!n.search||!n.search.includes("#"),p5("#","search","hash",n)));let e=i===""||n.pathname==="",p=e?"/":n.pathname,m;if(p==null)m=r;else{let I=t.length-1;if(!a&&p.startsWith("..")){let R=p.split("/");for(;R[0]==="..";)R.shift(),I-=1;n.pathname=R.join("/")}m=I>=0?t[I]:"/"}let y=U7(n,m),w=p&&p!=="/"&&p.endsWith("/"),A=(e||p===".")&&r.endsWith("/");return!y.pathname.endsWith("/")&&(w||A)&&(y.pathname+="/"),y}var yd=i=>i.join("/").replace(/\/\/+/g,"/"),H7=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),z7=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,$7=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,q7=class{constructor(i,t,r,a=!1){this.status=i,this.statusText=t||"",this.internal=a,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function G7(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}function V7(i){return i.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var H8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function z8(i,t){let r=i;if(typeof r!="string"||!B8.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let a=r,n=!1;if(H8)try{let e=new URL(window.location.href),p=r.startsWith("//")?new URL(e.protocol+r):new URL(r),m=xd(p.pathname,t);p.origin===e.origin&&m!=null?r=m+p.search+p.hash:n=!0}catch{lu(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:n,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $8=["POST","PUT","PATCH","DELETE"];new Set($8);var W7=["GET",...$8];new Set(W7);var mp=le.createContext(null);mp.displayName="DataRouter";var Py=le.createContext(null);Py.displayName="DataRouterState";var K7=le.createContext(!1),q8=le.createContext({isTransitioning:!1});q8.displayName="ViewTransition";var Y7=le.createContext(new Map);Y7.displayName="Fetchers";var J7=le.createContext(null);J7.displayName="Await";var zc=le.createContext(null);zc.displayName="Navigation";var Vm=le.createContext(null);Vm.displayName="Location";var Rh=le.createContext({outlet:null,matches:[],isDataRoute:!1});Rh.displayName="Route";var ax=le.createContext(null);ax.displayName="RouteError";var G8="REACT_ROUTER_ERROR",Q7="REDIRECT",X7="ROUTE_ERROR_RESPONSE";function Z7(i){if(i.startsWith(`${G8}:${Q7}:{`))try{let t=JSON.parse(i.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function ek(i){if(i.startsWith(`${G8}:${X7}:{`))try{let t=JSON.parse(i.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new q7(t.status,t.statusText,t.data)}catch{}}function tk(i,{relative:t}={}){Xs(gp(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=le.useContext(zc),{hash:n,pathname:e,search:p}=Wm(i,{relative:t}),m=e;return r!=="/"&&(m=e==="/"?r:yd([r,e])),a.createHref({pathname:m,search:p,hash:n})}function gp(){return le.useContext(Vm)!=null}function Nd(){return Xs(gp(),"useLocation() may be used only in the context of a <Router> component."),le.useContext(Vm).location}var V8="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function W8(i){le.useContext(zc).static||le.useLayoutEffect(i)}function kf(){let{isDataRoute:i}=le.useContext(Rh);return i?pk():rk()}function rk(){Xs(gp(),"useNavigate() may be used only in the context of a <Router> component.");let i=le.useContext(mp),{basename:t,navigator:r}=le.useContext(zc),{matches:a}=le.useContext(Rh),{pathname:n}=Nd(),e=JSON.stringify(rx(a)),p=le.useRef(!1);return W8(()=>{p.current=!0}),le.useCallback((y,w={})=>{if(lu(p.current,V8),!p.current)return;if(typeof y=="number"){r.go(y);return}let A=nx(y,JSON.parse(e),n,w.relative==="path");i==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:yd([t,A.pathname])),(w.replace?r.replace:r.push)(A,w.state,w)},[t,r,e,n,i])}le.createContext(null);function Wm(i,{relative:t}={}){let{matches:r}=le.useContext(Rh),{pathname:a}=Nd(),n=JSON.stringify(rx(r));return le.useMemo(()=>nx(i,JSON.parse(n),a,t==="path"),[i,n,a,t])}function nk(i,t){return K8(i,t)}function K8(i,t,r,a,n){Xs(gp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:e}=le.useContext(zc),{matches:p}=le.useContext(Rh),m=p[p.length-1],y=m?m.params:{},w=m?m.pathname:"/",A=m?m.pathnameBase:"/",I=m&&m.route;{let te=I&&I.path||"";J8(w,!I||te.endsWith("*")||te.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${w}" (under <Route path="${te}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${te}"> to <Route path="${te==="/"?"*":`${te}/*`}">.`)}let R=Nd(),k;if(t){let te=typeof t=="string"?pp(t):t;Xs(A==="/"||te.pathname?.startsWith(A),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${te.pathname}" was given in the \`location\` prop.`),k=te}else k=R;let M=k.pathname||"/",V=M;if(A!=="/"){let te=A.replace(/^\//,"").split("/");V="/"+M.replace(/^\//,"").split("/").slice(te.length).join("/")}let q=P8(i,{pathname:V});lu(I||q!=null,`No routes matched location "${k.pathname}${k.search}${k.hash}" `),lu(q==null||q[q.length-1].route.element!==void 0||q[q.length-1].route.Component!==void 0||q[q.length-1].route.lazy!==void 0,`Matched leaf route at location "${k.pathname}${k.search}${k.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let U=lk(q&&q.map(te=>Object.assign({},te,{params:Object.assign({},y,te.params),pathname:yd([A,e.encodeLocation?e.encodeLocation(te.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:te.pathname]),pathnameBase:te.pathnameBase==="/"?A:yd([A,e.encodeLocation?e.encodeLocation(te.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:te.pathnameBase])})),p,r,a,n);return t&&U?le.createElement(Vm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...k},navigationType:"POP"}},U):U}function ak(){let i=fk(),t=G7(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),r=i instanceof Error?i.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},e={padding:"2px 4px",backgroundColor:a},p=null;return console.error("Error handled by React Router default ErrorBoundary:",i),p=le.createElement(le.Fragment,null,le.createElement("p",null," Hey developer "),le.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",le.createElement("code",{style:e},"ErrorBoundary")," or"," ",le.createElement("code",{style:e},"errorElement")," prop on your route.")),le.createElement(le.Fragment,null,le.createElement("h2",null,"Unexpected Application Error!"),le.createElement("h3",{style:{fontStyle:"italic"}},t),r?le.createElement("pre",{style:n},r):null,p)}var sk=le.createElement(ak,null),Y8=class extends le.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,t){return t.location!==i.location||t.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:t.error,location:t.location,revalidation:i.revalidation||t.revalidation}}componentDidCatch(i,t){this.props.onError?this.props.onError(i,t):console.error("React Router caught the following error during render",i)}render(){let i=this.state.error;if(this.context&&typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){const r=ek(i.digest);r&&(i=r)}let t=i!==void 0?le.createElement(Rh.Provider,{value:this.props.routeContext},le.createElement(ax.Provider,{value:i,children:this.props.component})):this.props.children;return this.context?le.createElement(ik,{error:i},t):t}};Y8.contextType=K7;var m5=new WeakMap;function ik({children:i,error:t}){let{basename:r}=le.useContext(zc);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let a=Z7(t.digest);if(a){let n=m5.get(t);if(n)throw n;let e=z8(a.location,r);if(H8&&!m5.get(t))if(e.isExternal||a.reloadDocument)window.location.href=e.absoluteURL||e.to;else{const p=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(e.to,{replace:a.replace}));throw m5.set(t,p),p}return le.createElement("meta",{httpEquiv:"refresh",content:`0;url=${e.absoluteURL||e.to}`})}}return i}function ok({routeContext:i,match:t,children:r}){let a=le.useContext(mp);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),le.createElement(Rh.Provider,{value:i},r)}function lk(i,t=[],r=null,a=null,n=null){if(i==null){if(!r)return null;if(r.errors)i=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)i=r.matches;else return null}let e=i,p=r?.errors;if(p!=null){let A=e.findIndex(I=>I.route.id&&p?.[I.route.id]!==void 0);Xs(A>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(p).join(",")}`),e=e.slice(0,Math.min(e.length,A+1))}let m=!1,y=-1;if(r)for(let A=0;A<e.length;A++){let I=e[A];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(y=A),I.route.id){let{loaderData:R,errors:k}=r,M=I.route.loader&&!R.hasOwnProperty(I.route.id)&&(!k||k[I.route.id]===void 0);if(I.route.lazy||M){m=!0,y>=0?e=e.slice(0,y+1):e=[e[0]];break}}}let w=r&&a?(A,I)=>{a(A,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:V7(r.matches),errorInfo:I})}:void 0;return e.reduceRight((A,I,R)=>{let k,M=!1,V=null,q=null;r&&(k=p&&I.route.id?p[I.route.id]:void 0,V=I.route.errorElement||sk,m&&(y<0&&R===0?(J8("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),M=!0,q=null):y===R&&(M=!0,q=I.route.hydrateFallbackElement||null)));let U=t.concat(e.slice(0,R+1)),te=()=>{let W;return k?W=V:M?W=q:I.route.Component?W=le.createElement(I.route.Component,null):I.route.element?W=I.route.element:W=A,le.createElement(ok,{match:I,routeContext:{outlet:A,matches:U,isDataRoute:r!=null},children:W})};return r&&(I.route.ErrorBoundary||I.route.errorElement||R===0)?le.createElement(Y8,{location:r.location,revalidation:r.revalidation,component:V,error:k,children:te(),routeContext:{outlet:null,matches:U,isDataRoute:!0},onError:w}):te()},null)}function sx(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ck(i){let t=le.useContext(mp);return Xs(t,sx(i)),t}function uk(i){let t=le.useContext(Py);return Xs(t,sx(i)),t}function hk(i){let t=le.useContext(Rh);return Xs(t,sx(i)),t}function ix(i){let t=hk(i),r=t.matches[t.matches.length-1];return Xs(r.route.id,`${i} can only be used on routes that contain a unique "id"`),r.route.id}function dk(){return ix("useRouteId")}function fk(){let i=le.useContext(ax),t=uk("useRouteError"),r=ix("useRouteError");return i!==void 0?i:t.errors?.[r]}function pk(){let{router:i}=ck("useNavigate"),t=ix("useNavigate"),r=le.useRef(!1);return W8(()=>{r.current=!0}),le.useCallback(async(n,e={})=>{lu(r.current,V8),r.current&&(typeof n=="number"?await i.navigate(n):await i.navigate(n,{fromRouteId:t,...e}))},[i,t])}var I4={};function J8(i,t,r){!t&&!I4[i]&&(I4[i]=!0,lu(!1,r))}le.memo(mk);function mk({routes:i,future:t,state:r,onError:a}){return K8(i,void 0,r,a,t)}function g5({to:i,replace:t,state:r,relative:a}){Xs(gp(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=le.useContext(zc);lu(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:e}=le.useContext(Rh),{pathname:p}=Nd(),m=kf(),y=nx(i,rx(e),p,a==="path"),w=JSON.stringify(y);return le.useEffect(()=>{m(JSON.parse(w),{replace:t,state:r,relative:a})},[m,w,a,t,r]),null}function Ta(i){Xs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function gk({basename:i="/",children:t=null,location:r,navigationType:a="POP",navigator:n,static:e=!1,unstable_useTransitions:p}){Xs(!gp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=i.replace(/^\/*/,"/"),y=le.useMemo(()=>({basename:m,navigator:n,static:e,unstable_useTransitions:p,future:{}}),[m,n,e,p]);typeof r=="string"&&(r=pp(r));let{pathname:w="/",search:A="",hash:I="",state:R=null,key:k="default"}=r,M=le.useMemo(()=>{let V=xd(w,m);return V==null?null:{location:{pathname:V,search:A,hash:I,state:R,key:k},navigationType:a}},[m,w,A,I,R,k,a]);return lu(M!=null,`<Router basename="${m}"> is not able to match the URL "${w}${A}${I}" because it does not start with the basename, so the <Router> won't render anything.`),M==null?null:le.createElement(zc.Provider,{value:y},le.createElement(Vm.Provider,{children:t,value:M}))}function yk({children:i,location:t}){return nk(mv(i),t)}function mv(i,t=[]){let r=[];return le.Children.forEach(i,(a,n)=>{if(!le.isValidElement(a))return;let e=[...t,n];if(a.type===le.Fragment){r.push.apply(r,mv(a.props.children,e));return}Xs(a.type===Ta,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xs(!a.props.index||!a.props.children,"An index route cannot have child routes.");let p={id:a.props.id||e.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(p.children=mv(a.props.children,e)),r.push(p)}),r}var A2="get",C2="application/x-www-form-urlencoded";function My(i){return typeof HTMLElement<"u"&&i instanceof HTMLElement}function vk(i){return My(i)&&i.tagName.toLowerCase()==="button"}function bk(i){return My(i)&&i.tagName.toLowerCase()==="form"}function xk(i){return My(i)&&i.tagName.toLowerCase()==="input"}function wk(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function Sk(i,t){return i.button===0&&(!t||t==="_self")&&!wk(i)}var a2=null;function Ak(){if(a2===null)try{new FormData(document.createElement("form"),0),a2=!1}catch{a2=!0}return a2}var Ck=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function y5(i){return i!=null&&!Ck.has(i)?(lu(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${C2}"`),null):i}function Nk(i,t){let r,a,n,e,p;if(bk(i)){let m=i.getAttribute("action");a=m?xd(m,t):null,r=i.getAttribute("method")||A2,n=y5(i.getAttribute("enctype"))||C2,e=new FormData(i)}else if(vk(i)||xk(i)&&(i.type==="submit"||i.type==="image")){let m=i.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=i.getAttribute("formaction")||m.getAttribute("action");if(a=y?xd(y,t):null,r=i.getAttribute("formmethod")||m.getAttribute("method")||A2,n=y5(i.getAttribute("formenctype"))||y5(m.getAttribute("enctype"))||C2,e=new FormData(m,i),!Ak()){let{name:w,type:A,value:I}=i;if(A==="image"){let R=w?`${w}.`:"";e.append(`${R}x`,"0"),e.append(`${R}y`,"0")}else w&&e.append(w,I)}}else{if(My(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=A2,a=null,n=C2,p=i}return e&&n==="text/plain"&&(p=e,e=void 0),{action:a,method:r.toLowerCase(),encType:n,formData:e,body:p}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ox(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function Tk(i,t,r){let a=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return a.pathname==="/"?a.pathname=`_root.${r}`:t&&xd(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${r}`,a}async function Ek(i,t){if(i.id in t)return t[i.id];try{let r=await import(i.module);return t[i.id]=r,r}catch(r){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function kk(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function _k(i,t,r){let a=await Promise.all(i.map(async n=>{let e=t.routes[n.route.id];if(e){let p=await Ek(e,r);return p.links?p.links():[]}return[]}));return Rk(a.flat(1).filter(kk).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function D4(i,t,r,a,n,e){let p=(y,w)=>r[w]?y.route.id!==r[w].route.id:!0,m=(y,w)=>r[w].pathname!==y.pathname||r[w].route.path?.endsWith("*")&&r[w].params["*"]!==y.params["*"];return e==="assets"?t.filter((y,w)=>p(y,w)||m(y,w)):e==="data"?t.filter((y,w)=>{let A=a.routes[y.route.id];if(!A||!A.hasLoader)return!1;if(p(y,w)||m(y,w))return!0;if(y.route.shouldRevalidate){let I=y.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof I=="boolean")return I}return!0}):[]}function Ik(i,t,{includeHydrateFallback:r}={}){return Dk(i.map(a=>{let n=t.routes[a.route.id];if(!n)return[];let e=[n.module];return n.clientActionModule&&(e=e.concat(n.clientActionModule)),n.clientLoaderModule&&(e=e.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(e=e.concat(n.hydrateFallbackModule)),n.imports&&(e=e.concat(n.imports)),e}).flat(1))}function Dk(i){return[...new Set(i)]}function Fk(i){let t={},r=Object.keys(i).sort();for(let a of r)t[a]=i[a];return t}function Rk(i,t){let r=new Set;return new Set(t),i.reduce((a,n)=>{let e=JSON.stringify(Fk(n));return r.has(e)||(r.add(e),a.push({key:e,link:n})),a},[])}function Q8(){let i=le.useContext(mp);return ox(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function jk(){let i=le.useContext(Py);return ox(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var lx=le.createContext(void 0);lx.displayName="FrameworkContext";function X8(){let i=le.useContext(lx);return ox(i,"You must render this element inside a <HydratedRouter> element"),i}function Ok(i,t){let r=le.useContext(lx),[a,n]=le.useState(!1),[e,p]=le.useState(!1),{onFocus:m,onBlur:y,onMouseEnter:w,onMouseLeave:A,onTouchStart:I}=t,R=le.useRef(null);le.useEffect(()=>{if(i==="render"&&p(!0),i==="viewport"){let V=U=>{U.forEach(te=>{p(te.isIntersecting)})},q=new IntersectionObserver(V,{threshold:.5});return R.current&&q.observe(R.current),()=>{q.disconnect()}}},[i]),le.useEffect(()=>{if(a){let V=setTimeout(()=>{p(!0)},100);return()=>{clearTimeout(V)}}},[a]);let k=()=>{n(!0)},M=()=>{n(!1),p(!1)};return r?i!=="intent"?[e,R,{}]:[e,R,{onFocus:xm(m,k),onBlur:xm(y,M),onMouseEnter:xm(w,k),onMouseLeave:xm(A,M),onTouchStart:xm(I,k)}]:[!1,R,{}]}function xm(i,t){return r=>{i&&i(r),r.defaultPrevented||t(r)}}function Lk({page:i,...t}){let{router:r}=Q8(),a=le.useMemo(()=>P8(r.routes,i,r.basename),[r.routes,i,r.basename]);return a?le.createElement(Mk,{page:i,matches:a,...t}):null}function Pk(i){let{manifest:t,routeModules:r}=X8(),[a,n]=le.useState([]);return le.useEffect(()=>{let e=!1;return _k(i,t,r).then(p=>{e||n(p)}),()=>{e=!0}},[i,t,r]),a}function Mk({page:i,matches:t,...r}){let a=Nd(),{manifest:n,routeModules:e}=X8(),{basename:p}=Q8(),{loaderData:m,matches:y}=jk(),w=le.useMemo(()=>D4(i,t,y,n,a,"data"),[i,t,y,n,a]),A=le.useMemo(()=>D4(i,t,y,n,a,"assets"),[i,t,y,n,a]),I=le.useMemo(()=>{if(i===a.pathname+a.search+a.hash)return[];let M=new Set,V=!1;if(t.forEach(U=>{let te=n.routes[U.route.id];!te||!te.hasLoader||(!w.some(W=>W.route.id===U.route.id)&&U.route.id in m&&e[U.route.id]?.shouldRevalidate||te.hasClientLoader?V=!0:M.add(U.route.id))}),M.size===0)return[];let q=Tk(i,p,"data");return V&&M.size>0&&q.searchParams.set("_routes",t.filter(U=>M.has(U.route.id)).map(U=>U.route.id).join(",")),[q.pathname+q.search]},[p,m,a,n,w,t,i,e]),R=le.useMemo(()=>Ik(A,n),[A,n]),k=Pk(A);return le.createElement(le.Fragment,null,I.map(M=>le.createElement("link",{key:M,rel:"prefetch",as:"fetch",href:M,...r})),R.map(M=>le.createElement("link",{key:M,rel:"modulepreload",href:M,...r})),k.map(({key:M,link:V})=>le.createElement("link",{key:M,nonce:r.nonce,...V})))}function Uk(...i){return t=>{i.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Bk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Bk&&(window.__reactRouterVersion="7.11.0")}catch{}function Hk({basename:i,children:t,unstable_useTransitions:r,window:a}){let n=le.useRef();n.current==null&&(n.current=w7({window:a,v5Compat:!0}));let e=n.current,[p,m]=le.useState({action:e.action,location:e.location}),y=le.useCallback(w=>{r===!1?m(w):le.startTransition(()=>m(w))},[r]);return le.useLayoutEffect(()=>e.listen(y),[e,y]),le.createElement(gk,{basename:i,children:t,location:p.location,navigationType:p.action,navigator:e,unstable_useTransitions:r})}var Z8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eS=le.forwardRef(function({onClick:t,discover:r="render",prefetch:a="none",relative:n,reloadDocument:e,replace:p,state:m,target:y,to:w,preventScrollReset:A,viewTransition:I,unstable_defaultShouldRevalidate:R,...k},M){let{basename:V,unstable_useTransitions:q}=le.useContext(zc),U=typeof w=="string"&&Z8.test(w),te=z8(w,V);w=te.to;let W=tk(w,{relative:n}),[re,xe,ve]=Ok(a,k),De=qk(w,{replace:p,state:m,target:y,preventScrollReset:A,relative:n,viewTransition:I,unstable_defaultShouldRevalidate:R,unstable_useTransitions:q});function ke(Oe){t&&t(Oe),Oe.defaultPrevented||De(Oe)}let de=le.createElement("a",{...k,...ve,href:te.absoluteURL||W,onClick:te.isExternal||e?t:ke,ref:Uk(M,xe),target:y,"data-discover":!U&&r==="render"?"true":void 0});return re&&!U?le.createElement(le.Fragment,null,de,le.createElement(Lk,{page:W})):de});eS.displayName="Link";var tS=le.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:a="",end:n=!1,style:e,to:p,viewTransition:m,children:y,...w},A){let I=Wm(p,{relative:w.relative}),R=Nd(),k=le.useContext(Py),{navigator:M,basename:V}=le.useContext(zc),q=k!=null&&Yk(I)&&m===!0,U=M.encodeLocation?M.encodeLocation(I).pathname:I.pathname,te=R.pathname,W=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;r||(te=te.toLowerCase(),W=W?W.toLowerCase():null,U=U.toLowerCase()),W&&V&&(W=xd(W,V)||W);const re=U!=="/"&&U.endsWith("/")?U.length-1:U.length;let xe=te===U||!n&&te.startsWith(U)&&te.charAt(re)==="/",ve=W!=null&&(W===U||!n&&W.startsWith(U)&&W.charAt(U.length)==="/"),De={isActive:xe,isPending:ve,isTransitioning:q},ke=xe?t:void 0,de;typeof a=="function"?de=a(De):de=[a,xe?"active":null,ve?"pending":null,q?"transitioning":null].filter(Boolean).join(" ");let Oe=typeof e=="function"?e(De):e;return le.createElement(eS,{...w,"aria-current":ke,className:de,ref:A,style:Oe,to:p,viewTransition:m},typeof y=="function"?y(De):y)});tS.displayName="NavLink";var zk=le.forwardRef(({discover:i="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:n,state:e,method:p=A2,action:m,onSubmit:y,relative:w,preventScrollReset:A,viewTransition:I,unstable_defaultShouldRevalidate:R,...k},M)=>{let{unstable_useTransitions:V}=le.useContext(zc),q=Wk(),U=Kk(m,{relative:w}),te=p.toLowerCase()==="get"?"get":"post",W=typeof m=="string"&&Z8.test(m),re=xe=>{if(y&&y(xe),xe.defaultPrevented)return;xe.preventDefault();let ve=xe.nativeEvent.submitter,De=ve?.getAttribute("formmethod")||p,ke=()=>q(ve||xe.currentTarget,{fetcherKey:t,method:De,navigate:r,replace:n,state:e,relative:w,preventScrollReset:A,viewTransition:I,unstable_defaultShouldRevalidate:R});V&&r!==!1?le.startTransition(()=>ke()):ke()};return le.createElement("form",{ref:M,method:te,action:U,onSubmit:a?y:re,...k,"data-discover":!W&&i==="render"?"true":void 0})});zk.displayName="Form";function $k(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rS(i){let t=le.useContext(mp);return Xs(t,$k(i)),t}function qk(i,{target:t,replace:r,state:a,preventScrollReset:n,relative:e,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:y}={}){let w=kf(),A=Nd(),I=Wm(i,{relative:e});return le.useCallback(R=>{if(Sk(R,t)){R.preventDefault();let k=r!==void 0?r:Hm(A)===Hm(I),M=()=>w(i,{replace:k,state:a,preventScrollReset:n,relative:e,viewTransition:p,unstable_defaultShouldRevalidate:m});y?le.startTransition(()=>M()):M()}},[A,w,I,r,a,t,i,n,e,p,m,y])}var Gk=0,Vk=()=>`__${String(++Gk)}__`;function Wk(){let{router:i}=rS("useSubmit"),{basename:t}=le.useContext(zc),r=dk(),a=i.fetch,n=i.navigate;return le.useCallback(async(e,p={})=>{let{action:m,method:y,encType:w,formData:A,body:I}=Nk(e,t);if(p.navigate===!1){let R=p.fetcherKey||Vk();await a(R,r,p.action||m,{unstable_defaultShouldRevalidate:p.unstable_defaultShouldRevalidate,preventScrollReset:p.preventScrollReset,formData:A,body:I,formMethod:p.method||y,formEncType:p.encType||w,flushSync:p.flushSync})}else await n(p.action||m,{unstable_defaultShouldRevalidate:p.unstable_defaultShouldRevalidate,preventScrollReset:p.preventScrollReset,formData:A,body:I,formMethod:p.method||y,formEncType:p.encType||w,replace:p.replace,state:p.state,fromRouteId:r,flushSync:p.flushSync,viewTransition:p.viewTransition})},[a,n,t,r])}function Kk(i,{relative:t}={}){let{basename:r}=le.useContext(zc),a=le.useContext(Rh);Xs(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),e={...Wm(i||".",{relative:t})},p=Nd();if(i==null){e.search=p.search;let m=new URLSearchParams(e.search),y=m.getAll("index");if(y.some(A=>A==="")){m.delete("index"),y.filter(I=>I).forEach(I=>m.append("index",I));let A=m.toString();e.search=A?`?${A}`:""}}return(!i||i===".")&&n.route.index&&(e.search=e.search?e.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(e.pathname=e.pathname==="/"?r:yd([r,e.pathname])),Hm(e)}function Yk(i,{relative:t}={}){let r=le.useContext(q8);Xs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=rS("useViewTransitionState"),n=Wm(i,{relative:t});if(!r.isTransitioning)return!1;let e=xd(r.currentLocation.pathname,a)||r.currentLocation.pathname,p=xd(r.nextLocation.pathname,a)||r.nextLocation.pathname;return ny(n.pathname,p)!=null||ny(n.pathname,e)!=null}let Jk={data:""},Qk=i=>{if(typeof window=="object"){let t=(i?i.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(i||document.head).appendChild(t),t.firstChild}return i||Jk},Xk=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Zk=/\/\*[^]*?\*\/|  +/g,F4=/\n+/g,mf=(i,t)=>{let r="",a="",n="";for(let e in i){let p=i[e];e[0]=="@"?e[1]=="i"?r=e+" "+p+";":a+=e[1]=="f"?mf(p,e):e+"{"+mf(p,e[1]=="k"?"":t)+"}":typeof p=="object"?a+=mf(p,t?t.replace(/([^,])+/g,m=>e.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,y=>/&/.test(y)?y.replace(/&/g,m):m?m+" "+y:y)):e):p!=null&&(e=/^--/.test(e)?e:e.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=mf.p?mf.p(e,p):e+":"+p+";")}return r+(t&&n?t+"{"+n+"}":n)+a},ud={},nS=i=>{if(typeof i=="object"){let t="";for(let r in i)t+=r+nS(i[r]);return t}return i},e_=(i,t,r,a,n)=>{let e=nS(i),p=ud[e]||(ud[e]=(y=>{let w=0,A=11;for(;w<y.length;)A=101*A+y.charCodeAt(w++)>>>0;return"go"+A})(e));if(!ud[p]){let y=e!==i?i:(w=>{let A,I,R=[{}];for(;A=Xk.exec(w.replace(Zk,""));)A[4]?R.shift():A[3]?(I=A[3].replace(F4," ").trim(),R.unshift(R[0][I]=R[0][I]||{})):R[0][A[1]]=A[2].replace(F4," ").trim();return R[0]})(i);ud[p]=mf(n?{["@keyframes "+p]:y}:y,r?"":"."+p)}let m=r&&ud.g?ud.g:null;return r&&(ud.g=ud[p]),((y,w,A,I)=>{I?w.data=w.data.replace(I,y):w.data.indexOf(y)===-1&&(w.data=A?y+w.data:w.data+y)})(ud[p],t,a,m),p},t_=(i,t,r)=>i.reduce((a,n,e)=>{let p=t[e];if(p&&p.call){let m=p(r),y=m&&m.props&&m.props.className||/^go/.test(m)&&m;p=y?"."+y:m&&typeof m=="object"?m.props?"":mf(m,""):m===!1?"":m}return a+n+(p??"")},"");function Uy(i){let t=this||{},r=i.call?i(t.p):i;return e_(r.unshift?r.raw?t_(r,[].slice.call(arguments,1),t.p):r.reduce((a,n)=>Object.assign(a,n&&n.call?n(t.p):n),{}):r,Qk(t.target),t.g,t.o,t.k)}let aS,gv,yv;Uy.bind({g:1});let wd=Uy.bind({k:1});function r_(i,t,r,a){mf.p=t,aS=i,gv=r,yv=a}function _f(i,t){let r=this||{};return function(){let a=arguments;function n(e,p){let m=Object.assign({},e),y=m.className||n.className;r.p=Object.assign({theme:gv&&gv()},m),r.o=/ *go\d+/.test(y),m.className=Uy.apply(r,a)+(y?" "+y:"");let w=i;return i[0]&&(w=m.as||i,delete m.as),yv&&w[0]&&yv(m),aS(w,m)}return n}}var n_=i=>typeof i=="function",ay=(i,t)=>n_(i)?i(t):i,a_=(()=>{let i=0;return()=>(++i).toString()})(),sS=(()=>{let i;return()=>{if(i===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");i=!t||t.matches}return i}})(),s_=20,cx="default",iS=(i,t)=>{let{toastLimit:r}=i.settings;switch(t.type){case 0:return{...i,toasts:[t.toast,...i.toasts].slice(0,r)};case 1:return{...i,toasts:i.toasts.map(p=>p.id===t.toast.id?{...p,...t.toast}:p)};case 2:let{toast:a}=t;return iS(i,{type:i.toasts.find(p=>p.id===a.id)?1:0,toast:a});case 3:let{toastId:n}=t;return{...i,toasts:i.toasts.map(p=>p.id===n||n===void 0?{...p,dismissed:!0,visible:!1}:p)};case 4:return t.toastId===void 0?{...i,toasts:[]}:{...i,toasts:i.toasts.filter(p=>p.id!==t.toastId)};case 5:return{...i,pausedAt:t.time};case 6:let e=t.time-(i.pausedAt||0);return{...i,pausedAt:void 0,toasts:i.toasts.map(p=>({...p,pauseDuration:p.pauseDuration+e}))}}},N2=[],oS={toasts:[],pausedAt:void 0,settings:{toastLimit:s_}},Ih={},lS=(i,t=cx)=>{Ih[t]=iS(Ih[t]||oS,i),N2.forEach(([r,a])=>{r===t&&a(Ih[t])})},cS=i=>Object.keys(Ih).forEach(t=>lS(i,t)),i_=i=>Object.keys(Ih).find(t=>Ih[t].toasts.some(r=>r.id===i)),By=(i=cx)=>t=>{lS(t,i)},o_={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},l_=(i={},t=cx)=>{let[r,a]=le.useState(Ih[t]||oS),n=le.useRef(Ih[t]);le.useEffect(()=>(n.current!==Ih[t]&&a(Ih[t]),N2.push([t,a]),()=>{let p=N2.findIndex(([m])=>m===t);p>-1&&N2.splice(p,1)}),[t]);let e=r.toasts.map(p=>{var m,y,w;return{...i,...i[p.type],...p,removeDelay:p.removeDelay||((m=i[p.type])==null?void 0:m.removeDelay)||i?.removeDelay,duration:p.duration||((y=i[p.type])==null?void 0:y.duration)||i?.duration||o_[p.type],style:{...i.style,...(w=i[p.type])==null?void 0:w.style,...p.style}}});return{...r,toasts:e}},c_=(i,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:i,pauseDuration:0,...r,id:r?.id||a_()}),Km=i=>(t,r)=>{let a=c_(t,i,r);return By(a.toasterId||i_(a.id))({type:2,toast:a}),a.id},ps=(i,t)=>Km("blank")(i,t);ps.error=Km("error");ps.success=Km("success");ps.loading=Km("loading");ps.custom=Km("custom");ps.dismiss=(i,t)=>{let r={type:3,toastId:i};t?By(t)(r):cS(r)};ps.dismissAll=i=>ps.dismiss(void 0,i);ps.remove=(i,t)=>{let r={type:4,toastId:i};t?By(t)(r):cS(r)};ps.removeAll=i=>ps.remove(void 0,i);ps.promise=(i,t,r)=>{let a=ps.loading(t.loading,{...r,...r?.loading});return typeof i=="function"&&(i=i()),i.then(n=>{let e=t.success?ay(t.success,n):void 0;return e?ps.success(e,{id:a,...r,...r?.success}):ps.dismiss(a),n}).catch(n=>{let e=t.error?ay(t.error,n):void 0;e?ps.error(e,{id:a,...r,...r?.error}):ps.dismiss(a)}),i};var u_=1e3,h_=(i,t="default")=>{let{toasts:r,pausedAt:a}=l_(i,t),n=le.useRef(new Map).current,e=le.useCallback((I,R=u_)=>{if(n.has(I))return;let k=setTimeout(()=>{n.delete(I),p({type:4,toastId:I})},R);n.set(I,k)},[]);le.useEffect(()=>{if(a)return;let I=Date.now(),R=r.map(k=>{if(k.duration===1/0)return;let M=(k.duration||0)+k.pauseDuration-(I-k.createdAt);if(M<0){k.visible&&ps.dismiss(k.id);return}return setTimeout(()=>ps.dismiss(k.id,t),M)});return()=>{R.forEach(k=>k&&clearTimeout(k))}},[r,a,t]);let p=le.useCallback(By(t),[t]),m=le.useCallback(()=>{p({type:5,time:Date.now()})},[p]),y=le.useCallback((I,R)=>{p({type:1,toast:{id:I,height:R}})},[p]),w=le.useCallback(()=>{a&&p({type:6,time:Date.now()})},[a,p]),A=le.useCallback((I,R)=>{let{reverseOrder:k=!1,gutter:M=8,defaultPosition:V}=R||{},q=r.filter(W=>(W.position||V)===(I.position||V)&&W.height),U=q.findIndex(W=>W.id===I.id),te=q.filter((W,re)=>re<U&&W.visible).length;return q.filter(W=>W.visible).slice(...k?[te+1]:[0,te]).reduce((W,re)=>W+(re.height||0)+M,0)},[r]);return le.useEffect(()=>{r.forEach(I=>{if(I.dismissed)e(I.id,I.removeDelay);else{let R=n.get(I.id);R&&(clearTimeout(R),n.delete(I.id))}})},[r,e]),{toasts:r,handlers:{updateHeight:y,startPause:m,endPause:w,calculateOffset:A}}},d_=wd`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,f_=wd`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,p_=wd`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,m_=_f("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${d_} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${f_} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${i=>i.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${p_} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,g_=wd`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,y_=_f("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${i=>i.secondary||"#e0e0e0"};
  border-right-color: ${i=>i.primary||"#616161"};
  animation: ${g_} 1s linear infinite;
`,v_=wd`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,b_=wd`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,x_=_f("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${v_} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${b_} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${i=>i.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,w_=_f("div")`
  position: absolute;
`,S_=_f("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,A_=wd`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,C_=_f("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${A_} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,N_=({toast:i})=>{let{icon:t,type:r,iconTheme:a}=i;return t!==void 0?typeof t=="string"?le.createElement(C_,null,t):t:r==="blank"?null:le.createElement(S_,null,le.createElement(y_,{...a}),r!=="loading"&&le.createElement(w_,null,r==="error"?le.createElement(m_,{...a}):le.createElement(x_,{...a})))},T_=i=>`
0% {transform: translate3d(0,${i*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,E_=i=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${i*-150}%,-1px) scale(.6); opacity:0;}
`,k_="0%{opacity:0;} 100%{opacity:1;}",__="0%{opacity:1;} 100%{opacity:0;}",I_=_f("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,D_=_f("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,F_=(i,t)=>{let r=i.includes("top")?1:-1,[a,n]=sS()?[k_,__]:[T_(r),E_(r)];return{animation:t?`${wd(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${wd(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},R_=le.memo(({toast:i,position:t,style:r,children:a})=>{let n=i.height?F_(i.position||t||"top-center",i.visible):{opacity:0},e=le.createElement(N_,{toast:i}),p=le.createElement(D_,{...i.ariaProps},ay(i.message,i));return le.createElement(I_,{className:i.className,style:{...n,...r,...i.style}},typeof a=="function"?a({icon:e,message:p}):le.createElement(le.Fragment,null,e,p))});r_(le.createElement);var j_=({id:i,className:t,style:r,onHeightUpdate:a,children:n})=>{let e=le.useCallback(p=>{if(p){let m=()=>{let y=p.getBoundingClientRect().height;a(i,y)};m(),new MutationObserver(m).observe(p,{subtree:!0,childList:!0,characterData:!0})}},[i,a]);return le.createElement("div",{ref:e,className:t,style:r},n)},O_=(i,t)=>{let r=i.includes("top"),a=r?{top:0}:{bottom:0},n=i.includes("center")?{justifyContent:"center"}:i.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:sS()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...a,...n}},L_=Uy`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,s2=16,P_=({reverseOrder:i,position:t="top-center",toastOptions:r,gutter:a,children:n,toasterId:e,containerStyle:p,containerClassName:m})=>{let{toasts:y,handlers:w}=h_(r,e);return le.createElement("div",{"data-rht-toaster":e||"",style:{position:"fixed",zIndex:9999,top:s2,left:s2,right:s2,bottom:s2,pointerEvents:"none",...p},className:m,onMouseEnter:w.startPause,onMouseLeave:w.endPause},y.map(A=>{let I=A.position||t,R=w.calculateOffset(A,{reverseOrder:i,gutter:a,defaultPosition:t}),k=O_(I,R);return le.createElement(j_,{id:A.id,key:A.id,onHeightUpdate:w.updateHeight,className:A.visible?L_:"",style:k},A.type==="custom"?ay(A.message,A):n?n(A):le.createElement(R_,{toast:A,position:I}))}))},$u=ps;function M_(i){return{__metadata:{type:i}}}let vv=class extends hp{async createFieldAsXml(t){return typeof t=="string"&&(t={SchemaXml:t}),ba(w0(this,"createfieldasxml"),Xi({parameters:t}))}getById(t){return S0(this).concat(`('${t}')`)}getByTitle(t){return S0(this,`getByTitle('${t}')`)}getByInternalNameOrTitle(t){return S0(this,`getByInternalNameOrTitle('${t}')`)}async add(t,r,a){return ba(w0(this,null),Xi(Object.assign(M_(H_(r)),{Title:t,FieldTypeKind:r,...a}),Jb({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"})))}async addField(t,r,a){return ba(w0(this,"AddField"),Xi({parameters:{Title:t,FieldTypeKind:r,...a}}))}addText(t,r){return this.add(t,2,{MaxLength:255,...r})}addCalculated(t,r){return this.add(t,17,{OutputType:ai.Text,...r})}addDateTime(t,r){return this.add(t,4,{DateTimeCalendarType:wv.Gregorian,DisplayFormat:bv.DateOnly,FriendlyDisplayFormat:xv.Unspecified,...r})}addNumber(t,r){return this.add(t,9,r)}addCurrency(t,r){return this.add(t,10,{CurrencyLocaleId:1033,...r})}addMultilineText(t,r){return this.add(t,3,{AllowHyperlink:!0,AppendOnly:!1,NumberOfLines:6,RestrictedMode:!1,RichText:!0,...r})}addUrl(t,r){return this.add(t,11,{DisplayFormat:Sv.Hyperlink,...r})}addUser(t,r){return this.add(t,20,{SelectionMode:Av.PeopleAndGroups,...r})}async addLookup(t,r){return this.addField(t,7,r)}addChoice(t,r){const a={...r,Choices:{results:r.Choices}};return this.add(t,6,a)}addMultiChoice(t,r){const a={...r,Choices:{results:r.Choices}};return this.add(t,15,a)}addBoolean(t,r){return this.add(t,8,r)}async addDependentLookupField(t,r,a){const n=`adddependentlookupfield(displayName='${t}', primarylookupfieldid='${r}', showfield='${a}')`;return ba(w0(this,n))}addLocation(t,r){return this.add(t,33,r)}addImageField(t,r){return this.add(t,34,r)}};vv=L0([fp("fields")],vv);const w0=Hc(vv);class U_ extends dp{constructor(){super(...arguments),this.delete=_8()}async update(t,r){return(typeof r>"u"||r===null)&&(r=(await S0(this).select("FieldTypeKind")())["odata.type"]),Xb(this,Xi(t))}setShowInDisplayForm(t){return ba(S0(this,`setshowindisplayform(${t})`))}setShowInEditForm(t){return ba(S0(this,`setshowineditform(${t})`))}setShowInNewForm(t){return ba(S0(this,`setshowinnewform(${t})`))}}const S0=Hc(U_);var ai;(function(i){i[i.Invalid=0]="Invalid",i[i.Integer=1]="Integer",i[i.Text=2]="Text",i[i.Note=3]="Note",i[i.DateTime=4]="DateTime",i[i.Counter=5]="Counter",i[i.Choice=6]="Choice",i[i.Lookup=7]="Lookup",i[i.Boolean=8]="Boolean",i[i.Number=9]="Number",i[i.Currency=10]="Currency",i[i.URL=11]="URL",i[i.Computed=12]="Computed",i[i.Threading=13]="Threading",i[i.Guid=14]="Guid",i[i.MultiChoice=15]="MultiChoice",i[i.GridChoice=16]="GridChoice",i[i.Calculated=17]="Calculated",i[i.File=18]="File",i[i.Attachments=19]="Attachments",i[i.User=20]="User",i[i.Recurrence=21]="Recurrence",i[i.CrossProjectLink=22]="CrossProjectLink",i[i.ModStat=23]="ModStat",i[i.Error=24]="Error",i[i.ContentTypeId=25]="ContentTypeId",i[i.PageSeparator=26]="PageSeparator",i[i.ThreadIndex=27]="ThreadIndex",i[i.WorkflowStatus=28]="WorkflowStatus",i[i.AllDayEvent=29]="AllDayEvent",i[i.WorkflowEventType=30]="WorkflowEventType",i[i.Location=33]="Location",i[i.Image=34]="Image"})(ai||(ai={}));const B_={[ai.Calculated]:"SP.FieldCalculated",[ai.Choice]:"SP.FieldChoice",[ai.Computed]:"SP.FieldComputed",[ai.Currency]:"SP.FieldCurrency",[ai.DateTime]:"SP.FieldDateTime",[ai.GridChoice]:"SP.FieldRatingScale",[ai.Guid]:"SP.FieldGuid",[ai.Image]:"SP.FieldMultiLineText",[ai.Integer]:"SP.FieldNumber",[ai.Location]:"SP.FieldLocation",[ai.Lookup]:"SP.FieldLookup",[ai.ModStat]:"SP.FieldChoice",[ai.MultiChoice]:"SP.FieldMultiChoice",[ai.Note]:"SP.FieldMultiLineText",[ai.Number]:"SP.FieldNumber",[ai.Text]:"SP.FieldText",[ai.URL]:"SP.FieldUrl",[ai.User]:"SP.FieldUser",[ai.WorkflowStatus]:"SP.FieldChoice",[ai.WorkflowEventType]:"SP.FieldNumber"};function H_(i){var t;return(t=B_[i])!==null&&t!==void 0?t:"SP.Field"}var bv;(function(i){i[i.DateOnly=0]="DateOnly",i[i.DateTime=1]="DateTime"})(bv||(bv={}));var xv;(function(i){i[i.Unspecified=0]="Unspecified",i[i.Disabled=1]="Disabled",i[i.Relative=2]="Relative"})(xv||(xv={}));var R4;(function(i){i[i.DefaultValue=0]="DefaultValue",i[i.AddToDefaultContentType=1]="AddToDefaultContentType",i[i.AddToNoContentType=2]="AddToNoContentType",i[i.AddToAllContentTypes=4]="AddToAllContentTypes",i[i.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",i[i.AddFieldToDefaultView=16]="AddFieldToDefaultView",i[i.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"})(R4||(R4={}));var wv;(function(i){i[i.Gregorian=1]="Gregorian",i[i.Japan=3]="Japan",i[i.Taiwan=4]="Taiwan",i[i.Korea=5]="Korea",i[i.Hijri=6]="Hijri",i[i.Thai=7]="Thai",i[i.Hebrew=8]="Hebrew",i[i.GregorianMEFrench=9]="GregorianMEFrench",i[i.GregorianArabic=10]="GregorianArabic",i[i.GregorianXLITEnglish=11]="GregorianXLITEnglish",i[i.GregorianXLITFrench=12]="GregorianXLITFrench",i[i.KoreaJapanLunar=14]="KoreaJapanLunar",i[i.ChineseLunar=15]="ChineseLunar",i[i.SakaEra=16]="SakaEra",i[i.UmAlQura=23]="UmAlQura"})(wv||(wv={}));var Sv;(function(i){i[i.Hyperlink=0]="Hyperlink",i[i.Image=1]="Image"})(Sv||(Sv={}));var Av;(function(i){i[i.PeopleAndGroups=1]="PeopleAndGroups",i[i.PeopleOnly=0]="PeopleOnly"})(Av||(Av={}));var j4;(function(i){i[i.Dropdown=0]="Dropdown",i[i.RadioButtons=1]="RadioButtons"})(j4||(j4={}));Ef(ou,"fields",w0);Ef(ou,"availablefields",w0);Ef(tx,"fields",w0);class cr{static EMPLOYEES_LIST="Employees";static SHIFTS_LIST="Shifts";static ATTENDANCE_LIST="Attendance";static DOB_ANNIVERSARY_LIST="Employee DOB and Work Anniversary";static NOTIFICATIONS_LIST="Notifications";static getSP(){return ry()}static getAttendanceListName(t){return`${this.ATTENDANCE_LIST} ${t}`}static async getAllEmployees(){console.log("SP Service: Fetching Employees (Comprehensive)...");const t=await nn(),r="Id,Title,Role,Department,Email,ShiftId,Place,PermissionLevel",a=`${r},AccountStatus`,n=async e=>{const p=await fetch(`${this.getEmployeesDOBBaseUrl()}/_api/web/lists/getByTitle('${this.EMPLOYEES_LIST}')/items?$select=${e}`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});if(!p.ok){const m=await p.text();throw new Error(`SharePoint Error: ${p.status} - ${m}`)}return p.json()};try{try{return(await n(a)).d.results.map(m=>({id:m.Id.toString(),name:m.Title,role:m.Role||m.field_6||"Staff",department:m.Department||m.field_5||"General",email:m.Email||m.field_11||"",shiftId:m.ShiftId||"",place:m.Place||m.field_1||"",avatarUrl:m.AvatarUrl,permissionLevel:(m.PermissionLevel==="User"?"Employee":m.PermissionLevel)||"Employee",accountStatus:m.AccountStatus||"Active",location:m.field_1||"",employeeId:m.field_2||"",dateOfJoining:m.field_3||"",dateOfBirth:m.field_4||"",designation:m.field_6||"",reportingManager:m.field_7||"",contactNumber:m.field_8||"",emergencyContact:m.field_9||"",professionalEmail:m.field_11||"",personalEmail:m.field_12||""}))}catch(e){return console.warn("SP Service: Failed to fetch with AccountStatus, retrying without...",e),(await n(r)).d.results.map(y=>({id:y.Id.toString(),name:y.Title,role:y.Role||y.field_6||"Staff",department:y.Department||y.field_5||"General",email:y.Email||y.field_11||"",shiftId:y.ShiftId||"",place:y.Place||y.field_1||"",avatarUrl:y.AvatarUrl,permissionLevel:(y.PermissionLevel==="User"?"Employee":y.PermissionLevel)||"Employee",accountStatus:"Active",location:y.field_1||"",employeeId:y.field_2||"",dateOfJoining:y.field_3||"",dateOfBirth:y.field_4||"",designation:y.field_6||"",reportingManager:y.field_7||"",contactNumber:y.field_8||"",emergencyContact:y.field_9||"",professionalEmail:y.field_11||"",personalEmail:y.field_12||""}))}}catch(e){throw console.error("SP Service: Failed to fetch employees (Fallback failed)",e),e}}static async getEmployeeByEmail(t){try{const r=await nn(),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.EMPLOYEES_LIST}')/items?$select=Id,Title,Role,Department,Email,ShiftId,PermissionLevel,Place&$filter=Email eq '${encodeURIComponent(t)}'`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!n.ok)return console.warn("SP Service: Identity fetch failed",n.status),null;const p=(await n.json()).d.results;if(!p||p.length===0)return null;const m=p[0];let y=m.Place||"",w="",A="Active";try{const R=await fetch(`${this.getEmployeesDOBBaseUrl()}/_api/web/lists/getByTitle('${this.EMPLOYEES_LIST}')/items(${m.Id})?$select=Place,AvatarUrl,AccountStatus`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(R.ok){const M=(await R.json()).d;y=M.Place||"",w=M.AvatarUrl||"",M.AccountStatus&&(A=M.AccountStatus)}if(!y)try{const V=await fetch(`https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('EmployeeDB')/items?$select=field_1&$filter=field_11 eq '${encodeURIComponent(t)}'`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(V.ok){const q=await V.json();q.d.results&&q.d.results.length>0&&(y=q.d.results[0].field_1||"",console.log("SP Service: Found location in EmployeeDB:",y))}}catch(k){console.warn("SP Service: Failed to fallback fetch from EmployeeDB",k)}}catch(R){console.warn("SP Service: Detail fetch failed",R)}let I=m.PermissionLevel||"User";return typeof I=="string"&&(I=I.split("-")[0].trim()),{id:m.Id.toString(),name:m.Title,role:m.Role||"Staff",department:m.Department||"General",email:m.Email||"",shiftId:m.ShiftId||"",place:y,avatarUrl:w,permissionLevel:I==="User"?"Employee":I,accountStatus:A}}catch(r){return console.error("SP Service: getEmployeeByEmail critical failure",r),null}}static async getEmployeeProfileByEmail(t){console.log("SP Service: Fetching complete employee profile for",t);try{const r=await nn(),p=await fetch(`https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('EmployeeDB')/items?$select=Id,Title,field_1,field_2,field_3,field_4,field_5,field_6,field_7,field_8,field_9,field_10,field_11,field_12,field_13,field_14&$filter=field_11 eq '${encodeURIComponent(t)}'`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!p.ok)return console.warn("SP Service: Failed to fetch employee profile from EmployeeDB",p.status),null;const y=(await p.json()).d.results;if(!y||y.length===0)return console.warn("SP Service: No employee found in EmployeeDB with email",t),null;const w=y[0];return{id:w.Id.toString(),name:w.Title||"",location:w.field_1||"",employeeId:w.field_2||"",dateOfJoining:w.field_3||"",dateOfBirth:w.field_4||"",department:w.field_5||"",designation:w.field_6||"",reportingManager:w.field_7||"",contactNumber:w.field_8||"",emergencyContact:w.field_9||"",deskNumber:w.field_10||"",professionalEmail:w.field_11||"",personalEmail:w.field_12||"",currentAddress:w.field_13||"",permanentAddress:w.field_14||"",email:w.field_11||"",role:w.field_6||"Staff",shiftId:"",permissionLevel:"Employee"}}catch(r){return console.error("SP Service: Failed to fetch employee profile from EmployeeDB",r),null}}static async getAllEmployeesDB(){console.log("SP Service: Fetching all employees from EmployeeDB...");try{const t=await nn(),e=await fetch("https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('EmployeeDB')/items?$select=Id,Title,field_1,field_2,field_3,field_4,field_5,field_6,field_7,field_8,field_9,field_10,field_11,field_12,field_13,field_14&$top=5000",{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});if(!e.ok){const y=await e.text();throw new Error(`Failed to fetch EmployeeDB list: ${e.status} - ${y}`)}return((await e.json()).d.results||[]).map(y=>({id:y.Id.toString(),name:y.Title||"",location:y.field_1||"",employeeId:y.field_2||"",dateOfJoining:y.field_3?y.field_3:"",dateOfBirth:y.field_4?y.field_4:"",department:y.field_5||"",designation:y.field_6||"",reportingManager:y.field_7||"",contactNumber:y.field_8||"",emergencyContact:y.field_9||"",deskNumber:y.field_10||"",professionalEmail:y.field_11||"",personalEmail:y.field_12||"",currentAddress:y.field_13||"",permanentAddress:y.field_14||""}))}catch(t){throw console.error("SP Service: Failed to fetch all employees from EmployeeDB",t),t}}static async addEmployeeDBRecord(t){try{const r=await nn(),a=await this.getFormDigest(r),n="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",e="EmployeeDB",p={__metadata:{type:"SP.Data.EmployeeDBListItem"},Title:t.name,field_1:t.location,field_2:t.employeeId,field_3:t.dateOfJoining,field_4:t.dateOfBirth,field_5:t.department,field_6:t.designation,field_7:t.reportingManager,field_8:t.contactNumber,field_9:t.emergencyContact,field_10:t.deskNumber,field_11:t.professionalEmail,field_12:t.personalEmail,field_13:t.currentAddress,field_14:t.permanentAddress},m=await fetch(`${n}/_api/web/lists/getByTitle('${e}')/items`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify(p)});if(!m.ok){const y=await m.text();throw new Error(`Failed to add employee record: ${m.status} - ${y}`)}}catch(r){throw console.error("SP Service: Failed to add employee DB record",r),r}}static async updateEmployeeDBRecord(t,r){try{const a=await nn(),n=await this.getFormDigest(a),e="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",p="EmployeeDB",m={__metadata:{type:"SP.Data.EmployeeDBListItem"}};r.name!==void 0&&(m.Title=r.name),r.location!==void 0&&(m.field_1=r.location),r.employeeId!==void 0&&(m.field_2=r.employeeId),r.dateOfJoining!==void 0&&(m.field_3=r.dateOfJoining),r.dateOfBirth!==void 0&&(m.field_4=r.dateOfBirth),r.department!==void 0&&(m.field_5=r.department),r.designation!==void 0&&(m.field_6=r.designation),r.reportingManager!==void 0&&(m.field_7=r.reportingManager),r.contactNumber!==void 0&&(m.field_8=r.contactNumber),r.emergencyContact!==void 0&&(m.field_9=r.emergencyContact),r.deskNumber!==void 0&&(m.field_10=r.deskNumber),r.professionalEmail!==void 0&&(m.field_11=r.professionalEmail),r.personalEmail!==void 0&&(m.field_12=r.personalEmail),r.currentAddress!==void 0&&(m.field_13=r.currentAddress),r.permanentAddress!==void 0&&(m.field_14=r.permanentAddress);const y=await fetch(`${e}/_api/web/lists/getByTitle('${p}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"X-RequestDigest":n,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(m)});if(!y.ok){const w=await y.text();throw new Error(`Failed to update employee record: ${y.status} - ${w}`)}}catch(a){throw console.error("SP Service: Failed to update employee DB record",a),a}}static async deleteEmployeeDBRecord(t){try{const r=await nn(),a=await this.getFormDigest(r),p=await fetch(`https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('EmployeeDB')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"IF-MATCH":"*","X-HTTP-Method":"DELETE",Accept:"application/json;odata=verbose"}});if(!p.ok){const m=await p.text();throw new Error(`Failed to delete employee record: ${p.status} - ${m}`)}}catch(r){throw console.error("SP Service: Failed to delete employee DB record",r),r}}static async getAllUpcomingLeaves(){try{const t=await nn(),n=await fetch("https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('Upcoming Leaves')/items",{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});return n.ok?((await n.json()).d.results||[]).map(p=>({id:p.Id?.toString()||"",employeeName:p.Title||"",date:p.field_1||p.Date||p.Dates||p.Date_x0020_Range||p.UpcomingDate||""})):[]}catch(t){return console.warn("SP Service: Failed to fetch upcoming leaves",t),[]}}static async addUpcomingLeave(t){try{const r=await nn(),a=await this.getFormDigest(r),n="Upcoming Leaves",e="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",p={__metadata:{type:`SP.Data.${n.replace(/\s/g,"_x0020_")}ListItem`},Title:t.employeeName,Date:t.date},m=await fetch(`${e}/_api/web/lists/getByTitle('${n}')/items`,{method:"POST",headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a},body:JSON.stringify(p)});if(!m.ok){const y=await m.text();throw new Error(`Failed to add upcoming leave: ${m.status} - ${y}`)}}catch(r){throw console.error("SP Service: Failed to add upcoming leave",r),r}}static async updateUpcomingLeave(t,r){try{const a=await nn(),n=await this.getFormDigest(a),e="Upcoming Leaves",p="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",m={__metadata:{type:`SP.Data.${e.replace(/\s/g,"_x0020_")}ListItem`}};if(r.employeeName!==void 0&&(m.Title=r.employeeName),r.date!==void 0&&(m.Date=r.date),!(await fetch(`${p}/_api/web/lists/getByTitle('${e}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${a}`,Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":n,"X-HTTP-Method":"MERGE","If-Match":"*"},body:JSON.stringify(m)})).ok)throw new Error("Failed without status")}catch(a){throw console.error("SP Service: Failed to update upcoming leave",a),a}}static async deleteUpcomingLeave(t){try{const r=await nn(),a=await this.getFormDigest(r),p=await fetch(`https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('Upcoming Leaves')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"IF-MATCH":"*","X-HTTP-Method":"DELETE",Accept:"application/json;odata=verbose"}});if(!p.ok){const m=await p.text();throw new Error(`Failed to delete upcoming leave: ${p.status} - ${m}`)}}catch(r){throw console.error("SP Service: Failed to delete upcoming leave",r),r}}static async addEmployee(t){try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch("https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('"+this.EMPLOYEES_LIST+"')/items",{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify({__metadata:{type:"SP.Data.EmployeesListItem"},Title:t.name,Role:t.role,Department:t.department,Email:t.email,ShiftId:t.shiftId||"",Place:t.place||"",PermissionLevel:t.permissionLevel||"Employee"})});if(!n.ok){const m=await n.text();throw new Error(`Add Employee Failed: ${n.status} - ${m}`)}const p=(await n.json()).d;return{id:p.Id.toString(),name:p.Title,role:p.Role,department:p.Department,email:p.Email,shiftId:p.ShiftId,place:p.Place||"",avatarUrl:"",permissionLevel:p.PermissionLevel}}catch(r){throw console.error("SP Service: Failed to add employee",r),r}}static async ensureAccountStatusField(t){try{if((await fetch(`${this.getEmployeesDOBBaseUrl()}/_api/web/lists/getByTitle('${this.EMPLOYEES_LIST}')/fields/getByInternalNameOrTitle('AccountStatus')`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}})).ok)return;console.warn("SP Service: AccountStatus field missing. Creating...");const a=await this.getFormDigest(t);await fetch(`${this.getEmployeesDOBBaseUrl()} / _api / web / lists / getByTitle('${this.EMPLOYEES_LIST}') / fields`,{method:"POST",headers:{Authorization:`Bearer ${t} `,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify({__metadata:{type:"SP.Field"},Title:"AccountStatus",FieldTypeKind:2,Required:!1,EnforceUniqueValues:!1,StaticName:"AccountStatus"})}),console.log("SP Service: AccountStatus field created.")}catch(r){console.error("SP Service: Failed to ensure AccountStatus field",r)}}static async disableEmployee(t){try{const r=await nn();await this.ensureAccountStatusField(r);const a=await this.getFormDigest(r),n=await fetch(`${this.getEmployeesDOBBaseUrl()} /_api/web / lists / getByTitle('${this.EMPLOYEES_LIST}') / items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r} `,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify({__metadata:{type:"SP.Data.EmployeesListItem"},AccountStatus:"Disabled"})});if(!n.ok){const e=await n.text();throw new Error(`Disable Employee Failed: ${n.status} - ${e} `)}}catch(r){throw console.error("SP Service: Failed to disable employee",r),r}}static async enableEmployee(t){try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch(`${this.getEmployeesDOBBaseUrl()} /_api/web / lists / getByTitle('${this.EMPLOYEES_LIST}') / items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r} `,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify({__metadata:{type:"SP.Data.EmployeesListItem"},AccountStatus:"Active"})});if(!n.ok){const e=await n.text();throw new Error(`Enable Employee Failed: ${n.status} - ${e} `)}}catch(r){throw console.error("SP Service: Failed to enable employee",r),r}}static async updateEmployee(t,r){try{const a=await nn(),n=await this.getFormDigest(a),e={__metadata:{type:"SP.Data.EmployeesListItem"}};r.name&&(e.Title=r.name),r.role&&(e.Role=r.role),r.department&&(e.Department=r.department),r.email&&(e.Email=r.email),r.shiftId&&(e.ShiftId=r.shiftId),r.place&&(e.Place=r.place),r.permissionLevel&&(e.PermissionLevel=r.permissionLevel);const p=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.EMPLOYEES_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"X-RequestDigest":n,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(e)});if(!p.ok){const m=await p.text();throw new Error(`Update Employee Failed: ${p.status} - ${m}`)}}catch(a){throw console.error("SP Service: Failed to update employee",a),a}}static async deleteEmployee(t){try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.EMPLOYEES_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"IF-MATCH":"*","X-HTTP-Method":"DELETE"}});if(!n.ok){const e=await n.text();throw new Error(`Delete Employee Failed: ${n.status} - ${e}`)}}catch(r){throw console.error("SP Service: Failed to delete employee",r),r}}static async getAllShifts(){console.log("SP Service: Fetching Shifts (Raw Fetch)...");try{const t=await nn(),r=await fetch("https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('"+this.SHIFTS_LIST+"')/items",{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});if(!r.ok){if(r.status===404)return console.warn("Shifts list not found."),[];const e=await r.text();throw new Error(`SharePoint Error: ${r.status} - ${e}`)}const n=(await r.json()).d.results;return console.log(`SP Service: Found ${n.length} shifts`),n.map(e=>({id:e.Id.toString(),name:e.Title,startTime:e.StartTime,endTime:e.EndTime,timeZone:e.TimeZone}))}catch(t){throw console.error("SP Service: Failed to fetch shifts.",t),t}}static async checkOut(t,r,a,n,e){try{const p=await nn(),m=await this.getFormDigest(p),y=new Date,w=this.formatTimeAMPM(y);if((r==="00:00"||r==="12:00 AM")&&(w==="00:00"||w==="12:00 AM")){const Oe={__metadata:{type:"SP.Data.AttendanceListItem"},CheckOutTime:w,WorkingHours:"00:00"},z=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${p}`,"X-RequestDigest":m,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(Oe)});if(!z.ok){const Be=await z.text();throw new Error(`Manual Check-Out Failed: ${z.status} - ${Be}`)}const Ce=(await(await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{headers:{Authorization:`Bearer ${p}`,Accept:"application/json;odata=verbose"}})).json()).d;return{id:Ce.Id.toString(),employeeId:Ce.EmployeeId,date:Ce.Date,checkInTime:Ce.CheckInTime,checkOutTime:Ce.CheckOutTime,status:Ce.Status,shiftId:Ce.ShiftId,workingHours:Ce.WorkingHours}}const A=this.parseDateTime(a,r),I=y,R=Math.max(0,I.getTime()-A.getTime()),k=Math.floor(R/36e5),M=Math.floor(R%36e5/6e4),V=`${k.toString().padStart(2,"0")}:${M.toString().padStart(2,"0")}`;let q="Present",U=R;if(n&&e){const Oe=this.parseDateTime(a,n);let z=this.parseDateTime(a,e);z<Oe&&(z=new Date(z),z.setDate(z.getDate()+1));const K=A>Oe?A:Oe,Ae=I<z?I:z;U=Math.max(0,Ae.getTime()-K.getTime())}const te=U/(1e3*60*60);te<4?q="Absent":te<6.5&&(q="Half Day");const W=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')?$select=ListItemEntityTypeFullName`,{headers:{Authorization:`Bearer ${p}`,Accept:"application/json;odata=verbose"}});let re="SP.Data.AttendanceListItem";W.ok&&(re=(await W.json()).d.ListItemEntityTypeFullName);const xe={__metadata:{type:re},CheckOutTime:w,Status:q,WorkingHours:V},ve=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${p}`,"X-RequestDigest":m,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(xe)});if(!ve.ok){const Oe=await ve.text();throw Oe.includes("WorkingHours")?new Error("Field 'WorkingHours' not found in SharePoint list."):new Error(`Check-Out Update Failed: ${ve.status} - ${Oe.substring(0,100)}`)}const De=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{headers:{Authorization:`Bearer ${p}`,Accept:"application/json;odata=verbose"}});if(!De.ok){const Oe=await De.text();throw new Error(`SharePoint Error fetching updated record: ${De.status} - ${Oe}`)}const de=(await De.json()).d;return{id:de.Id.toString(),employeeId:de.EmployeeId,date:de.Date,checkInTime:de.CheckInTime,checkOutTime:de.CheckOutTime,status:de.Status,shiftId:de.ShiftId,workingHours:de.WorkingHours}}catch(p){throw console.error("SP Service: Check-Out Error",p),p}}static async getTodayAttendance(t){try{const r=await nn(),a=new Date,n=a.getDate().toString().padStart(2,"0"),e=(a.getMonth()+1).toString().padStart(2,"0"),p=a.getFullYear(),m=`${n}/${e}/${p}`,y=`EmployeeId eq '${t}'`,w=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items?$filter=${encodeURIComponent(y)}&$orderby=Created desc&$top=10`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!w.ok)return console.warn("SP Service: Failed to fetch attendance",w.status),null;const I=(await w.json()).d.results;if(!I||I.length===0)return null;const R=I.find(k=>k.Date===m);return R?{id:R.Id.toString(),employeeId:R.EmployeeId,date:R.Date,checkInTime:R.CheckInTime,checkOutTime:R.CheckOutTime,status:R.Status||"Present",shiftId:R.ShiftId}:null}catch(r){return console.error("SP Service: Attendance fetch error",r),null}}static async getAllAttendanceForDate(t){try{const r=await nn(),a=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items?$orderby=Created desc&$top=500`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!a.ok)return console.warn("SP Service: Failed to fetch all attendance",a.status),[];const e=(await a.json()).d.results;return!e||e.length===0?[]:e.filter(p=>p.Date===t).map(p=>({id:p.Id.toString(),employeeId:p.EmployeeId,name:p.Title,date:p.Date,checkInTime:p.CheckInTime,checkOutTime:p.CheckOutTime,status:p.Status||"Present",shiftId:p.ShiftId||"",workingHours:p.WorkingHours}))}catch(r){return console.error("SP Service: Failed to fetch daily attendance",r),[]}}static async getAttendanceHistory(t,r,a){console.log(`SP Service: Fetching attendance history for user ${t} from ${r} to ${a}`);try{const n=await nn(),e=`EmployeeId eq '${t}'`,p="Id,EmployeeId,Title,Date,CheckInTime,CheckOutTime,Status,ShiftId,WorkingHours,Place,Regularized";let m=[],y=`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items?$select=${p}&$filter=${encodeURIComponent(e)}&$orderby=Created desc&$top=5000`;for(;y;){const M=await fetch(y,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json;odata=verbose"}});if(!M.ok){console.warn("SP Service: Failed to fetch attendance history batch",M.status);break}const V=await M.json(),q=V.d.results;q&&q.length>0&&(m=m.concat(q)),y=V.d.__next||null}if(m.length===0)return[];const w=m;if(!w||w.length===0)return[];const A=M=>{if(M.includes("-"))return M;const[V,q,U]=M.split("/");return`${U}-${q.padStart(2,"0")}-${V.padStart(2,"0")}`},I=A(r),R=A(a);return w.filter(M=>{if(!M.Date)return!1;const[V,q,U]=M.Date.split("/"),te=`${U}-${q.padStart(2,"0")}-${V.padStart(2,"0")}`;return te>=I&&te<=R}).map(M=>({id:M.Id.toString(),employeeId:M.EmployeeId,name:M.Title,date:M.Date,checkInTime:M.CheckInTime,checkOutTime:M.CheckOutTime,status:M.Status||"Present",shiftId:M.ShiftId||"",workingHours:M.WorkingHours,place:M.Place,regularized:M.Regularized||null}))}catch(n){return console.error("SP Service: Failed to fetch attendance history",n),[]}}static async getEmployeeAttendanceForYear(t,r,a){console.log(`SP Service: Fetching attendance for ${r} (${t}) for year ${a}`);try{const n=await nn(),e=`(EmployeeId eq '${t}' or Title eq '${r.replace(/'/g,"''")}')`,p="Id,EmployeeId,Title,Date,CheckInTime,CheckOutTime,Status,ShiftId,WorkingHours,Place,Regularized",m=this.getAttendanceListName(a);let y=[],w=`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${m}')/items?$select=${p}&$filter=${encodeURIComponent(e)}&$orderby=Created desc&$top=5000`;for(;w;){const A=await fetch(w,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json;odata=verbose"}});if(!A.ok)break;const I=await A.json(),R=I.d.results;R&&R.length>0&&(y=y.concat(R)),w=I.d.__next||null}return y.filter(A=>(A.Date||"").endsWith(`/${a}`)).map(A=>({id:A.Id.toString(),employeeId:A.EmployeeId||"",name:A.Title||"",date:A.Date||"",checkInTime:A.CheckInTime||"-",checkOutTime:A.CheckOutTime||"-",workingHours:A.WorkingHours||"-",status:A.Status||"IN",shiftId:A.ShiftId||"",place:A.Place||"",regularized:A.Regularized||null}))}catch(n){return console.error("SP Service: Failed to fetch year attendance",n),[]}}static async getAllAttendanceInRange(t,r){console.log(`SP Service: Fetching ALL attendance from ${t} to ${r}`);try{const a=await nn(),n="Id,EmployeeId,Title,Date,CheckInTime,CheckOutTime,Status,ShiftId,WorkingHours,Place,Regularized,StaffMail";let e=[],p=`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items?$select=${n}&$orderby=Created desc&$top=5000`;for(;p;){console.log(`SP Service: Fetching batch... (${e.length} loaded so far)`);const m=await fetch(p,{headers:{Authorization:`Bearer ${a}`,Accept:"application/json;odata=verbose"}});if(!m.ok){console.warn("SP Service: Failed to fetch batch",m.status);break}const y=await m.json(),w=y.d.results;w&&w.length>0&&(e=e.concat(w)),p=y.d.__next||null}return e.length===0?[]:e.filter(m=>{if(!m.Date)return!1;const[y,w,A]=m.Date.split("/"),I=`${A}-${w}-${y}`;return I>=t&&I<=r}).map(m=>({id:m.Id.toString(),employeeId:m.EmployeeId,name:m.Title,date:m.Date,checkInTime:m.CheckInTime,checkOutTime:m.CheckOutTime,status:m.Status||"Present",shiftId:m.ShiftId,workingHours:m.WorkingHours,place:m.Place,email:m.StaffMail,regularized:m.Regularized||null}))}catch(a){return console.error("SP Service: Failed to fetch global attendance",a),[]}}static async sendWish(t,r,a,n){console.log(`SP Service: Sending ${n} wish to ${t} from ${r}`);try{const e=await nn(),p=await this.getFormDigest(e),m=await fetch(`${this.getEmployeesDOBBaseUrl()}/_api/web/lists/getByTitle('${this.NOTIFICATIONS_LIST}')/items`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"X-RequestDigest":p,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify({__metadata:{type:"SP.Data.NotificationsListItem"},Title:n==="Birthday"?"Birthday Wish":"Work Anniversary Wish",RecipientEmail:t,SenderName:r,Status:"Unread",Notifications:a})});if(!m.ok){const y=await m.text();throw new Error(`Send Wish Failed: ${m.status} - ${y}`)}}catch(e){throw console.error("SP Service: Failed to send wish",e),e}}static async getNotifications(t){try{const r=await nn(),a=await fetch(`${this.getEmployeesDOBBaseUrl()}/_api/web/lists/getByTitle('${this.NOTIFICATIONS_LIST}')/items?$filter=RecipientEmail eq '${encodeURIComponent(t)}' and Status eq 'Unread'&$orderby=Created desc`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});return a.ok?(await a.json()).d.results.map(p=>({id:p.Id.toString(),title:p.Title,message:p.Notifications,recipientEmail:p.RecipientEmail,senderName:p.SenderName,status:p.Status,category:"Wish",timestamp:p.Created})):[]}catch(r){return console.error("SP Service: Failed to fetch notifications",r),[]}}static async markNotificationAsRead(t){try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch(`${this.getEmployeesDOBBaseUrl()}/_api/web/lists/getByTitle('${this.NOTIFICATIONS_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify({__metadata:{type:"SP.Data.NotificationsListItem"},Status:"Read"})});if(!n.ok){const e=await n.text();throw new Error(`Mark Notification as Read Failed: ${n.status} - ${e}`)}}catch(r){throw console.error("SP Service: Failed to mark notification as read",r),r}}static getEmployeesDOBBaseUrl(){return"https://jmtechtalent.sharepoint.com/sites/EmployeesDOB"}static async requestRegularization(t){console.log(`SP Service: Requesting regularization for record ${t}`);try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!n.ok)throw new Error("Failed to fetch attendance record");const p=(await n.json()).d,y=(await this.getAllShifts()).find(De=>De.id===p.ShiftId);if(!y)throw new Error("Shift information not found");let w=y.endTime;if(w.includes(":")&&!w.includes("AM")&&!w.includes("PM")){const[De,ke]=w.split(":").map(Number),de=De>=12?"PM":"AM";w=`${De%12||12}:${ke.toString().padStart(2,"0")} ${de}`}const A=p.Date,I=this.parseDateTime(A,p.CheckInTime||""),R=this.parseDateTime(A,w),k=Math.max(0,R.getTime()-I.getTime()),M=Math.floor(k/36e5),V=Math.floor(k%36e5/6e4),q=`${M.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`,U=k/(1e3*60*60);let te="Present";U<4?te="Absent":U<8&&(te="Half Day");const W=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')?$select=ListItemEntityTypeFullName`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});let re="SP.Data.AttendanceListItem";W.ok&&(re=(await W.json()).d.ListItemEntityTypeFullName);const xe={__metadata:{type:re},CheckOutTime:w,WorkingHours:q,Status:te,Regularized:"YES"},ve=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(xe)});if(!ve.ok){const De=await ve.text();throw new Error(`Regularization failed: ${ve.status} - ${De}`)}console.log("SP Service: Regularization request successful")}catch(r){throw console.error("SP Service: Regularization error",r),r}}static async getRegularizationCount(t,r,a){console.log(`SP Service: Counting regularizations for user ${t} in ${r}/${a}`);try{const n=await nn(),e=`EmployeeId eq '${t}'`,p=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items?$filter=${encodeURIComponent(e)}&$top=500`,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json;odata=verbose"}});if(!p.ok)return console.warn("SP Service: Failed to fetch attendance for regularization count"),0;const y=(await p.json()).d.results;return!y||y.length===0?0:y.filter(A=>{if(!A.Date||!A.Regularized)return!1;const[,I,R]=A.Date.split("/"),k=parseInt(I,10),M=parseInt(R,10),V=A.Regularized&&(A.Regularized==="YES"||A.Regularized.startsWith("Yes"));return k===r&&M===a&&V}).length}catch(n){return console.error("SP Service: Failed to count regularizations",n),0}}static async getFormDigest(t,r="https://jmtechtalent.sharepoint.com/sites/EmployeesDOB"){const a=await fetch(`${r}/_api/contextinfo`,{method:"POST",headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});if(!a.ok)throw new Error("Failed to get Form Digest");return(await a.json()).d.GetContextWebInformation.FormDigestValue}static async addShift(t){try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch("https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('"+this.SHIFTS_LIST+"')/items",{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify({__metadata:{type:"SP.Data.ShiftsListItem"},Title:t.name,StartTime:t.startTime,EndTime:t.endTime,TimeZone:t.timeZone})});if(!n.ok){const m=await n.text();throw new Error(`Add Shift Failed: ${n.status} - ${m}`)}const p=(await n.json()).d;return{id:p.Id.toString(),name:p.Title,startTime:p.StartTime,endTime:p.EndTime,timeZone:p.TimeZone}}catch(r){throw console.error("SP Service: Failed to add shift",r),r}}static async deleteShift(t){try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.SHIFTS_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"IF-MATCH":"*","X-HTTP-Method":"DELETE"}});if(!n.ok){const e=await n.text();throw new Error(`Delete Shift Failed: ${n.status} - ${e}`)}}catch(r){throw console.error("SP Service: Failed to delete shift",r),r}}static formatTimeAMPM(t){let r=t.getHours();const a=t.getMinutes(),n=r>=12?"PM":"AM";r=r%12,r=r||12;const e=r.toString().padStart(2,"0"),p=a.toString().padStart(2,"0");return`${e}:${p} ${n}`}static parseDateTime(t,r){if(!r||r==="-"||r==="00:00"||r.includes("--")){const k=t.includes("/")?t.split("/"):t.split("-"),M=parseInt(k.length===3&&t.includes("/")?k[0]:k[2]||"0",10),V=parseInt(k.length===3&&t.includes("/")?k[1]:k[1]||"1",10)-1,q=parseInt(k.length===3&&t.includes("/")?k[2]:k[0]||"2025",10);return new Date(q,V,M,0,0,0)}const a=t.includes("/")?t.split("/"):t.split("-");let n,e,p;t.includes("/")?(n=parseInt(a[0],10),e=parseInt(a[1],10)-1,p=parseInt(a[2],10)):(p=parseInt(a[0],10),e=parseInt(a[1],10)-1,n=parseInt(a[2],10));const y=r.replace(/\u202F/g," ").trim().match(/(\d+):(\d+)(?::(\d+))?\s*(AM|PM)?/i);if(!y)return new Date(p,e,n,0,0,0);let w=parseInt(y[1],10);const A=parseInt(y[2],10),I=y[4]?.toUpperCase();I&&(w===12&&I==="AM"?w=0:w<12&&I==="PM"&&(w+=12));const R=new Date(p,e,n);return R.setHours(w,A,0,0),R}static calculateDuration(t,r,a){try{const n=this.parseDateTime(t,r);let e=this.parseDateTime(t,a);n>e&&(e=new Date(e),e.setDate(e.getDate()+1));const p=Math.max(0,e.getTime()-n.getTime()),m=Math.floor(p/36e5),y=Math.floor(p%36e5/6e4);return`${m.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`}catch(n){return console.error("Duration calculation failed",n),"00:00"}}static async checkIn(t,r,a,n,e){try{const p=await this.getTodayAttendance(t);if(p)return console.log("SP Service: Record already exists for today. Returning existing.",p),p;const m=await nn(),y=await this.getFormDigest(m),w=new Date,A=w.getDate().toString().padStart(2,"0"),I=(w.getMonth()+1).toString().padStart(2,"0"),R=w.getFullYear(),k=`${A}/${I}/${R}`,M=this.formatTimeAMPM(w),V=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items`,{method:"POST",headers:{Authorization:`Bearer ${m}`,"X-RequestDigest":y,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify({__metadata:{type:"SP.Data.AttendanceListItem"},Title:a,EmployeeId:t,Date:k,CheckInTime:M,Status:"IN",ShiftId:r,Place:n||"",StaffMail:e||""})});if(!V.ok){const te=await V.text();throw new Error(`CheckIn Failed: ${V.status} - ${te}`)}const U=(await V.json()).d;return{id:U.Id.toString(),employeeId:U.EmployeeId,date:U.Date,checkInTime:U.CheckInTime,status:U.Status,shiftId:U.ShiftId,place:U.Place||""}}catch(p){throw console.error("SP Service: CheckIn error",p),p}}static async checkPermissionLevelColumn(){try{return(await ry().web.lists.getByTitle(this.EMPLOYEES_LIST).fields.select("InternalName").filter("InternalName eq 'PermissionLevel'")()).length>0}catch(t){return console.error("SP Service: Failed to check PermissionLevel field",t),!1}}static async getLeaveRequests(t){console.log("SP Service: Fetching Leave Requests for",t);try{const r=await nn(),e=await fetch("https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('Leave Request')/items?$select=*,Author/Title,Author/EMail,Manager/Title,ApprovalComments&$expand=Author,Manager&$orderby=Created desc&$top=100",{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!e.ok){const w=await e.text();if(console.error(`Leave Fetch Error: ${e.status}`,w),e.status===404)return[];throw new Error(`SharePoint Leave Error: ${e.status} - ${w}`)}return(await e.json()).d.results.filter(w=>(w.Author?.EMail||"").toLowerCase()===t.toLowerCase()).map(w=>({id:w.Id.toString(),employeeName:w.Author?.Title||"Unknown",leaveType:w.LeaveType||w.Title||"General",submittedOn:w.Created,fromDate:w.EventDate||w.From||w.StartDate||w.Created,toDate:w.EndDate||w.To||w.EventDate||w.Created,leaveDuration:w.LeaveDuration||w.Duration||"N/A",status:w.Status||"Pending",manager:w.Manager?.Title||"System (Auto)",reason:w.Detail||w.Details||w.Comments||w.Description||"",approvalComments:w.ApprovalComments||w.ApproverComments||w.AdminComments||"",created:w.Created}))}catch(r){throw console.error("SP Service: Failed to fetch leave requests",r),r}}static async submitLeaveRequest(t){try{const r=await nn(),a=await this.getFormDigest(r),n="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",e="Leave Request",p={__metadata:{type:"SP.Data.Leave_x0020_RequestListItem"},Title:t.employeeName,From:t.fromDate,To:t.toDate,LeaveType:t.leaveType,Leave:t.leaveCategory||"Full Day Leave",Detail:t.comments,Status:"Pending"},m=await fetch(`${n}/_api/web/lists/getByTitle('${e}')/items`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify(p)});if(!m.ok){const y=await m.text();throw new Error(`Submit Leave Failed: ${m.status} - ${y}`)}}catch(r){throw console.error("SP Service: Failed to submit leave",r),r}}static async getHolidays(t){console.log(`SP Service: Fetching holidays from ${t}`);try{const r=await nn(),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('${t}')/items`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});return n.ok?((await n.json()).d.results||[]).map(m=>{const y=m.EventDate||m.Date||m.HolidayDate||m.StartDate||"",w=m.Title||m.Name||m.EmployeeName||"Holiday",A=m.Location||m.Place||"";return{id:(m.Id||m.ID||"").toString(),title:w,date:y,location:A}}):(console.warn(`SP Service: Failed to fetch holidays from ${t}`,n.status),[])}catch(r){return console.error(`SP Service: Failed to fetch holidays from ${t}`,r),[]}}static async getUSAHolidays(){return this.getHolidays("USA Holiday List")}static async getCanadaHolidays(){return this.getHolidays("Holiday List")}static async getAPACHolidays(){return this.getHolidays("APAC Holiday List")}static async getUpcomingLeaves(){return this.getHolidays("Upcoming Leaves")}static async getEmployeeAssets(t){console.log(`SP Service: Fetching assets for employee email ${t}`);try{const r=await nn(),e=await fetch("https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('Asset')/items",{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!e.ok){if(e.status===404)return console.warn("Asset list not found"),[];throw new Error(`SharePoint Asset Error: ${e.status}`)}const m=(await e.json()).d.results;console.log("SP Service: All assets fetched:",m.length),m.length>0&&(console.log("SP Service: Sample asset item:",m[0]),console.log("SP Service: Sample asset keys:",Object.keys(m[0])));const y=m.filter(w=>{const A=w.StaffMail||w.Staff_x0020_Mail||w.EmployeeEmail||w.Employee_x0020_Email||w.Email||w.MailID||w.Mail_x0020_ID||w.OfficialEmail||w.Official_x0020_Email;if(!A)return!1;const I=A.toString().trim().toLowerCase(),R=t.toString().trim().toLowerCase();return console.log(`SP Service: Comparing asset email "${I}" with search "${R}"`),I===R});return console.log(`SP Service: Found ${y.length} assets for employee ${t}`),y.length>0&&console.log("SP Service: Matched assets:",y),y.map(w=>({id:w.Id.toString(),employeeName:w.Title||w.EmployeeName||w.Employee_x0020_Name||"",employeeId:w.EmployeeId||w.EmployeeID||w.Employee_x0020_ID||w.EmpId||"",assetType:w.AssetType||w.Type||w.Asset_x0020_Type||w.Category||"N/A",manufacturer:w.Manufacturer||w.Brand||w.Make||"",model:w.Model||w.ModelNumber||"",serialNumber:w.SerialNumber||w.Serial||w.SerialNo||w.SN||"",purchaseDate:w.PurchaseDate||w.DatePurchased||w.Purchase_x0020_Date||"",status:w.Status||w.AssetStatus||"Active",assignedDate:w.AssignedDate||w.DateAssigned||w.Assigned_x0020_Date||"",processor:w.Processor||w.CPU||w.Processer||"",ram:w.RAM||w.Memory||w.Ram||"",hdd:w.HDD||w.Storage||w.Hard_x0020_Disk||w.Hdd||""}))}catch(r){return console.error("SP Service: Failed to fetch employee assets",r),[]}}static async getListFieldMappings(t,r,a){try{const n=await nn(),e=await fetch(`${t}/_api/web/lists/getByTitle('${r}')/fields?$select=InternalName,Title`,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json;odata=verbose"}});if(!e.ok)return{};const m=(await e.json()).d.results||[],y={};for(const[w,A]of Object.entries(a)){const I=m.find(R=>A.test(R.Title)||A.test(R.InternalName));y[w]=I?I.InternalName:w}return y}catch(n){return console.error("Discovery error",n),{}}}static async getAllLeaveBalances(){console.log("SP Service: Fetching all leave balances with discovery");try{const t=await nn(),r="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",a="EmpLeaveBalance",n=await this.getListFieldMappings(r,a,{clKey:/^CL$|^Casual/i,elKey:/^EL$|^Earned/i,balKey:/Balance/i,lopKey:/LOP|Loss/i,empKey:/Emp|Name|Title/i}),{clKey:e,elKey:p,balKey:m,lopKey:y,empKey:w}=n,A=await fetch(`${r}/_api/web/lists/getByTitle('${a}')/items`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});if(!A.ok){if(A.status===404)return[];throw new Error(`SharePoint Leave Balance Error: ${A.status}`)}return(await A.json()).d.results.map(k=>{const M=V=>{const q=k[V];if(q==null)return 0;const U=parseFloat(q.toString());return isNaN(U)?0:U};return{id:k.Id.toString(),empName:k[w]||k.Title||"N/A",cl:M(e),el:M(p),balance:M(m),lop:M(y)}})}catch(t){return console.error("SP Service: Failed to fetch leave balances",t),[]}}static async updateLeaveBalance(t,r){console.log(`SP Service: Updating leave balance for ID ${t}`);try{const a=await nn(),n=await this.getFormDigest(a),e="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",p="EmpLeaveBalance",m=await this.getListFieldMappings(e,p,{clKey:/^CL$|^Casual/i,elKey:/^EL$|^Earned/i,balKey:/Balance/i,lopKey:/LOP|Loss/i}),{clKey:y,elKey:w,balKey:A,lopKey:I}=m,R={__metadata:{type:"SP.Data.EmpLeaveBalanceListItem"}};r.cl!==void 0&&(R[y]=r.cl.toString()),r.el!==void 0&&(R[w]=r.el.toString()),r.balance!==void 0&&(R[A]=r.balance.toString()),r.lop!==void 0&&(R[I]=r.lop.toString());const k=await fetch(`${e}/_api/web/lists/getByTitle('${p}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"X-RequestDigest":n,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(R)});if(!k.ok){const M=await k.text();throw new Error(`Update Leave Balance Failed: ${k.status} - ${M}`)}}catch(a){throw console.error("SP Service: Failed to update leave balance",a),a}}static async deleteLeaveBalance(t){console.log(`SP Service: Deleting leave balance record ${t}`);try{const r=await nn(),a=await this.getFormDigest(r),p=await fetch(`https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All/_api/web/lists/getByTitle('EmpLeaveBalance')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"IF-MATCH":"*","X-HTTP-Method":"DELETE"}});if(!p.ok){const m=await p.text();throw new Error(`Delete Leave Balance Failed: ${p.status} - ${m}`)}}catch(r){throw console.error("SP Service: Failed to delete leave balance",r),r}}static async getEmployeeLeaveBalance(t){console.log(`SP Service: Fetching leave balance for "${t}"`);try{const r=await this.getAllLeaveBalances();if(!r||r.length===0)return null;const a=t.toLowerCase().replace(/\s+/g," ").trim(),n=a.split(" ").filter(m=>m.length>1),e=r.find(m=>m.empName.toLowerCase().replace(/\s+/g," ").trim()===a);if(e)return console.log(`SP Service: Found exact match for ${t}`),e;const p=r.find(m=>{const y=m.empName.toLowerCase().replace(/\s+/g," ").trim();return y.includes(a)||a.includes(y)});if(p)return console.log(`SP Service: Found partial match for ${t}: ${p.empName}`),p;if(n.length>0){const m=r.find(y=>{const w=y.empName.toLowerCase();return n.every(A=>w.includes(A))});if(m)return console.log(`SP Service: Found word-based match for ${t}: ${m.empName}`),m}return console.warn(`SP Service: No leave balance record found for "${t}"`),null}catch(r){return console.error("SP Service: Failed to get employee leave balance",r),null}}static async getAllLeaveRequests(t,r){console.log(`SP Service: Fetching leave requests from ${t||"beginning"} to ${r||"end"}`);try{const a="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",n="Leave Request",e=await this.getListFieldMappings(a,n,{employeeName:/^(?!.*Editor)(?!.*Author)(?!.*Link)(?!.*Type)Title$|^Action$|^Emp/i,submittedOn:/^Created$|^Applied/i,fromDate:/^EventDate$|^(?!.*_)(?!.*Table)(?!.*Menu)(From|Start|Begin).*Date$|^From$/i,toDate:/^EndDate$|^(?!.*_)(?!.*Table)(?!.*Menu)(To|End).*Date$|^To$/i,leaveDuration:/^Leave.*Duration$|^Duration$|^Days$/i,leaveType:/^Leave.*Type$|^Type$/i,reason:/^Reason|^Remarks|^Details/i,status:/^Status$|^State$/i,manager:/^Manager$|^Approver$/i});console.log("SP Service: Leave Request Field Mappings discovered:",e);const p=await nn(),m=[{name:"UserConfirmed",fields:["From","To","Leave","LeaveType","Detail","Status","Manager/Title","Manager/EMail","ApprovalComments"]},{name:"Refined_1",fields:["From","To","LeaveType","Status","Manager/Title","Manager/EMail","Reason"]},{name:"Refined_2",fields:["From","To","Type","Status","Manager/Title","Manager/EMail","Reason"]},{name:"Refined_3",fields:["From","To","LeaveCategory","Status","Manager/Title","Manager/EMail","Description"]},{name:"Standard",fields:["From","To","Leave_x0020_Type","Status","Manager/Title","Manager/EMail","Detail","Leave"]},{name:"Legacy",fields:["StartDate","EndDate","LeaveType","Status","Manager/Title","Manager/EMail","Reason"]},{name:"Strict",fields:["From","To","Leave_x0020_Type","Status","Manager/Title","Manager/EMail","Detail"]},{name:"Simple",fields:["FromDate","ToDate","Type","Status","Manager/EMail"]},{name:"Minimal",fields:["From","To"]}],y="Id,ID,Created,Title,Author/Title,AuthorId",w="Author,Manager";for(const k of m)try{console.log(`SP Service: Trying strategy '${k.name}'...`);const M=k.fields.join(","),V=`${a}/_api/web/lists/getbytitle('${n}')/items?$select=${y},${M}&$expand=${w}&$top=5000`,q=await fetch(V,{headers:{Accept:"application/json; odata=verbose",Authorization:`Bearer ${p}`}});if(q.ok){console.log(`SP Service: Strategy '${k.name}' SUCCEEDED!`);const U=await q.json();return this.mapLeaveRequestsV2(U.d.results)}else console.warn(`SP Service: Strategy '${k.name}' failed: ${q.status}`)}catch(M){console.warn(`SP Service: Strategy '${k.name}' threw error`,M)}console.error("SP Service: All explicit strategies failed. Falling back to Safe Mode.");const A=`${a}/_api/web/lists/getbytitle('${n}')/items?$select=${y}&$expand=${w}&$top=5000`,R=await(await fetch(A,{headers:{Accept:"application/json; odata=verbose",Authorization:`Bearer ${p}`}})).json();return this.mapLeaveRequestsV2(R.d.results)}catch(a){throw console.error("SP Service: Critical Failure in getAllLeaveRequests",a),a}}static async getAllPermissionRequests(){const t="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",r="Permission";try{const a=await nn(),n=[{name:"Corrected",fields:["Date","Hours","Detail","Status","Manager/Title","Manager/EMail"]},{name:"WithManager",fields:["Date","Hours","Detail","Status","Manager/Title","Manager/EMail"]},{name:"Minimal",fields:["Date","Hours"]}],e="Id,ID,Created,Title,Author/Title,AuthorId",p="Author,Manager";for(const A of n)try{console.log(`SP Service (Permission): Trying strategy '${A.name}'...`);const I=A.fields.join(","),R=`${t}/_api/web/lists/getbytitle('${r}')/items?$select=${e},${I}&$expand=${p}&$top=5000`,k=await fetch(R,{headers:{Accept:"application/json; odata=verbose",Authorization:`Bearer ${a}`}});if(k.ok){console.log(`SP Service (Permission): Strategy '${A.name}' SUCCEEDED!`);const M=await k.json();return this.mapPermissionRequests(M.d.results)}else console.warn(`SP Service (Permission): Strategy '${A.name}' failed: ${k.status}`)}catch(I){console.warn(`SP Service (Permission): Strategy '${A.name}' threw error`,I)}console.error("SP Service (Permission): All strategies failed. Falling back to Safe Mode.");const m=`${t}/_api/web/lists/getbytitle('${r}')/items?$select=${e}&$expand=${p}&$top=5000`,w=await(await fetch(m,{headers:{Accept:"application/json; odata=verbose",Authorization:`Bearer ${a}`}})).json();return this.mapPermissionRequests(w.d.results)}catch(a){throw console.error("SP Service (Permission): Critical Failure",a),a}}static mapPermissionRequests(t){return t.map((r,a)=>{const n=y=>y?String(y).replace(/hrs?/i,"").trim():"N/A",e=r.Title||r.Author?.Title||"N/A",p=r.Manager?.EMail||r.Manager?.Title||r.ApproverComments||"N/A",m=y=>{if(!y)return"N/A";try{return new Date(y).toISOString().split("T")[0]}catch{return String(y)}};return{id:(r.ID||r.Id||a).toString(),employeeName:e,permissionType:"Permission",submittedOn:m(r.Created),date:m(r.Date),hours:n(r.Hours),reason:r.Detail||r.Reason||"N/A",status:r.Status||"N/A",manager:p,approvalComments:r.ApproverComments||"",created:r.Created}})}static async getRawDebugItem(){const t="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",r="Leave Request";let a="";try{const n=await nn();a=`${t}/_api/web/lists/getbytitle('${r}')/items?$top=1`;const e=await fetch(a,{headers:{Accept:"application/json; odata=verbose",Authorization:`Bearer ${n}`}});if(!e.ok){const m=await e.text();return{status:e.status,statusText:e.statusText,url:a,errorDetails:m}}return(await e.json()).d.results[0]||{message:"Success but No Items Found in List"}}catch(n){console.error("Debug Fetch Failed",n);const e=n;return{conversionError:"JS Exception",message:e.message,stack:e.stack,urlAttempted:a}}}static async getRawDebugItemMulti(){const t="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",r=["Leave Request","LeaveRequest","LeaveRequests","Leave Requests","Leaves"],a=[];try{const n=await nn();for(const e of r){const p=`${t}/_api/web/lists/getbytitle('${e}')/items?$top=1`;a.push(`Trying list: '${e}'...`);try{const m=await fetch(p,{headers:{Accept:"application/json; odata=verbose",Authorization:`Bearer ${n}`}});if(m.ok){const y=await m.json();return{success:!0,usedListName:e,logs:a,data:y.d.results[0]||"List found, but empty."}}else a.push(`Failed '${e}': ${m.status} ${m.statusText}`)}catch(m){a.push(`Error '${e}': ${m}`)}}return{success:!1,message:"All list name variations failed.",logs:a}}catch(n){return{conversionError:"JS Exception",message:n.message,logs:a}}}static mapLeaveRequestsV2(t){return t.map(a=>{const n=I=>{if(!I||I==="N/A")return"N/A";if(I.includes("T")){const k=new Date(I);if(!isNaN(k.getTime())){const M=k.getDate().toString().padStart(2,"0"),V=(k.getMonth()+1).toString().padStart(2,"0"),q=k.getFullYear();return`${M}/${V}/${q}`}}if(I.includes("-")){const k=I.split("T")[0].split("-");if(k.length===3)return`${k[2]}/${k[1]}/${k[0]}`}const R=I.split("/");return R.length===3&&R[2].length===4,I},e=I=>{for(const R of I){const k=a[R];if(k&&k!=="N/A"&&typeof k=="string")return k}return"N/A"},p=()=>{const I=a.Manager||a.manager;return I&&I.EMail?I.EMail:I&&I.Title?I.Title:typeof I=="string"?I:"N/A"};let m=a.Title||a.Author?.Title||(a.AuthorId?`Employee #${a.AuthorId}`:"N/A");const y=n(e(["From","StartDate","EventDate","Start"])),w=n(e(["To","EndDate","End"]));if((y==="N/A"||e(["LeaveType","Type"])==="N/A"||e(["Status","status","State"])==="N/A")&&a.FieldValuesAsText){const I=["__metadata","ID","Title","Created","Author","Modified","Editor","ItemChildCount","FolderChildCount","ComplianceAssetId","OData__UIVersionString","AppAuthor","OData__ColorTag"],R=Object.keys(a.FieldValuesAsText).filter(M=>!I.includes(M)&&!M.startsWith("OData__")).sort(),k=Object.keys(a).filter(M=>!I.includes(M)&&!M.startsWith("OData_")&&typeof a[M]!="object"&&a[M]!==null).sort();m+=` [MISSING FIELDS. Keys found: ${R.concat(k).join(", ")}]`}return{id:(a.Id||a.ID||0).toString(),employeeName:m,submittedOn:a.Created||"N/A",fromDate:y,toDate:w,leaveDuration:e(["Leave","LeaveDuration","Duration"]),leaveType:e(["LeaveType","Type"]),reason:e(["Detail","Reason"]),status:e(["status","Status","State"]),manager:p()}})}static async runDiagnostics(){console.log("SP Service: Running Diagnostics...");const t=[],r=a=>t.push(a);try{const a=await nn(),n="https://jmtechtalent.sharepoint.com/sites/EmployeesDOB";r(`Target Site: ${n}`);const e="Notifications";r(`
Checking for List: '${e}'...`);const p=await fetch(`${n} /_api/web / lists / getByTitle('${e}')`,{headers:{Authorization:`Bearer ${a} `,Accept:"application/json;odata=verbose"}});if(p.ok){r(" NOTIFICATIONS LIST FOUND!");const w=await fetch(`${n} /_api/web / lists / getByTitle('${e}') / fields ? $select = Title, InternalName, Hidden & $filter=Hidden eq false`,{headers:{Authorization:`Bearer ${a} `,Accept:"application/json;odata=verbose"}});if(w.ok){const A=await w.json();r("--- NOTIFICATIONS FIELDS ---"),A.d.results.forEach(I=>r(`[${I.Title}]-> ${I.InternalName} `))}}else r(` Notifications list NOT FOUND.Status: ${p.status} `);const m="Employees";r(`
Checking for List: '${m}'...`);const y=await fetch(`${n} /_api/web / lists / getByTitle('${m}')`,{headers:{Authorization:`Bearer ${a} `,Accept:"application/json;odata=verbose"}});if(y.ok){r(" EMPLOYEES LIST FOUND!");const w=await fetch(`${n} /_api/web / lists / getByTitle('${m}') / items ? $top = 1`,{headers:{Authorization:`Bearer ${a} `,Accept:"application/json;odata=verbose"}});if(w.ok){const A=await w.json();if(A.d.results.length>0){const I=A.d.results[0];r(`
--- REAL EMPLOYEE FIELD NAMES ---`),Object.keys(I).forEach(R=>{!R.startsWith("odata_")&&!R.startsWith("__")&&r(`${R}: ${JSON.stringify(I[R]).substring(0,30)} `)})}else r(" Employees list is empty. Cannot verify fields.")}}else r(` Employees list NOT FOUND.Status: ${y.status} `)}catch(a){const n=a instanceof Error?a.message:String(a);r(`CRITICAL ERROR: ${n} `)}return{logs:t}}static async getPermissionRequests(t){console.log(`SP Service: Fetching permission requests for ${t}`);try{const r=await nn(),a="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",n="Permission",e=await this.getEmployeeByEmail(t);if(!e)return console.warn("SP Service: Employee not found for email",t),[];const p=`Title eq '${e.name.replace(/'/g,"''")}'`,m=await fetch(`${a}/_api/web/lists/getByTitle('${n}')/items?$select=*,Manager/Title&$expand=Manager&$filter=${p}&$orderby=Created desc&$top=500`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!m.ok)return console.warn("SP Service: Failed to fetch permission requests",m.status),[];const w=(await m.json()).d.results;return!w||w.length===0?[]:w.map(A=>({id:A.Id.toString(),employeeName:A.Title||"",permissionType:"Permission",date:A.Date||"",timeFrom:"",timeTo:"",hours:A.Hours||"",status:A.Status||"Pending",manager:A.Manager?A.Manager.Title:"",reason:A.Detail||"",approvalComments:A.ApproverComments||"",created:A.Created}))}catch(r){return console.error("SP Service: Failed to fetch permission requests",r),[]}}static async createPermissionRequest(t){console.log("SP Service: Creating permission request");try{const r=await nn(),a=await this.getFormDigest(r),n="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",e="Permission",p=await fetch(`${n}/_api/web/lists/getByTitle('${e}')?$select=ListItemEntityTypeFullName`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});let m="SP.Data.PermissionListItem";p.ok&&(m=(await p.json()).d.ListItemEntityTypeFullName);const y={__metadata:{type:m},Title:t.employeeName,Date:t.date,Hours:t.hours,Detail:t.reason,Status:"Pending Manager Approval"},w=await fetch(`${n}/_api/web/lists/getByTitle('${e}')/items`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify(y)});if(!w.ok){const A=await w.text();throw new Error(`Submit Permission Failed: ${w.status} - ${A}`)}}catch(r){throw console.error("SP Service: Failed to create permission request",r),r}}static async createAttendanceRecord(t){try{const r=await nn(),a=`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items`;let n="09:00";const e=t.checkInTime||"09:00",p=t.checkOutTime||"18:00";(e==="00:00"&&p==="00:00"||e==="12:00 AM"&&p==="12:00 AM")&&(n="00:00");const m={__metadata:{type:"SP.Data.AttendanceListItem"},Title:t.name,StaffMail:t.email,EmployeeId:t.employeeId,Date:t.date.split("-").reverse().join("/"),Place:t.place,ShiftId:t.shiftId,Status:t.status||"Absent",WorkingHours:n,CheckInTime:e,CheckOutTime:p},y=await fetch(a,{method:"POST",headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},body:JSON.stringify(m)});if(!y.ok){const w=await y.text();throw new Error(`Failed to create attendance record: ${y.status} - ${w}`)}}catch(r){throw console.error("SP Service: Failed to create attendance record",r),r}}static async deleteAttendanceRecord(t){try{const r=await nn(),a=await this.getFormDigest(r),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":a,"IF-MATCH":"*","X-HTTP-Method":"DELETE"}});if(!n.ok){const e=await n.text();throw new Error(`Delete Attendance Failed: ${n.status} - ${e}`)}}catch(r){throw console.error("SP Service: Failed to delete attendance record",r),r}}static async updateAttendanceRecord(t,r){try{const a=await nn(),n=await this.getFormDigest(a),e=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')?$select=ListItemEntityTypeFullName`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/json;odata=verbose"}});let p="SP.Data.AttendanceListItem";e.ok&&(p=(await e.json()).d.ListItemEntityTypeFullName),(r.CheckInTime==="00:00"||r.CheckInTime==="12:00 AM")&&(r.CheckOutTime==="00:00"||r.CheckOutTime==="12:00 AM")&&(r.WorkingHours="00:00");const m={__metadata:{type:p},...r},y=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.ATTENDANCE_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"X-RequestDigest":n,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(m)});if(!y.ok){const w=await y.text();throw new Error(`Update Attendance Failed: ${y.status} - ${w}`)}}catch(a){throw console.error("SP Service: Failed to update attendance record",a),a}}static async getUpcomingEvents(){console.log("SP Service: Fetching Birthdays and Anniversaries");try{const t=await nn(),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.DOB_ANNIVERSARY_LIST}')/items?$select=Id,Title,Raghunatahn,WorkAnniversary,MailID,Personalid&$top=5000`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});if(!n.ok)return console.warn("SP Service: Failed to fetch events",n.status),[];const p=(await n.json()).d.results,m=[],w=new Date().getMonth();return p.forEach(A=>{const I=A.Title,R=A.Raghunatahn,k=A.WorkAnniversary,M=A.MailID;if(R){const V=new Date(R);!isNaN(V.getTime())&&V.getMonth()===w&&m.push({id:`${A.Id}-dob`,employeeName:I,type:"Birthday",date:V,mailId:M})}if(k){const V=new Date(k);!isNaN(V.getTime())&&V.getMonth()===w&&m.push({id:`${A.Id}-anniv`,employeeName:I,type:"Anniversary",date:V,mailId:M})}}),m.sort((A,I)=>A.date.getDate()-I.date.getDate())}catch(t){return console.error("SP Service: Failed to fetch upcoming events",t),[]}}static async getAllEmployeeEventRecords(){try{const t=await nn(),n=await fetch(`https://jmtechtalent.sharepoint.com/sites/EmployeesDOB/_api/web/lists/getByTitle('${this.DOB_ANNIVERSARY_LIST}')/items?$select=Id,Title,Raghunatahn,WorkAnniversary,MailID,Personalid&$top=5000`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json;odata=verbose"}});if(!n.ok)throw new Error(`Failed to fetch event records: ${n.status}`);return(await n.json()).d.results.map(m=>({id:m.Id.toString(),name:m.Title,dob:m.Raghunatahn||"",workAnniversary:m.WorkAnniversary||"",email:m.MailID||"",personalId:m.Personalid||""}))}catch(t){throw console.error("SP Service: Failed to fetch all event records",t),t}}static async addEmployeeEventRecord(t){try{const r=await nn(),a="https://jmtechtalent.sharepoint.com/sites/EmployeesDOB",n=await this.getFormDigest(r,a),e=await fetch(`${a}/_api/web/lists/getByTitle('${this.DOB_ANNIVERSARY_LIST}')/items`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":n,Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},body:JSON.stringify({__metadata:{type:`SP.Data.${this.DOB_ANNIVERSARY_LIST.replace(/\s/g,"_x0020_")}ListItem`},Title:t.name,Raghunatahn:t.dob,WorkAnniversary:t.workAnniversary,MailID:t.email,Personalid:t.personalId})});if(!e.ok){const p=await e.text();throw new Error(`Failed to add event record: ${e.status} - ${p}`)}}catch(r){throw console.error("SP Service: Failed to add event record",r),r}}static async updateEmployeeEventRecord(t,r){try{const a=await nn(),n=await this.getFormDigest(a,"https://jmtechtalent.sharepoint.com/sites/EmployeesDOB"),e="https://jmtechtalent.sharepoint.com/sites/EmployeesDOB",p={__metadata:{type:`SP.Data.${this.DOB_ANNIVERSARY_LIST.replace(/\s/g,"_x0020_")}ListItem`}};r.name&&(p.Title=r.name),r.dob!==void 0&&(p.Raghunatahn=r.dob),r.workAnniversary!==void 0&&(p.WorkAnniversary=r.workAnniversary),r.email&&(p.MailID=r.email),r.personalId&&(p.Personalid=r.personalId),console.log(`SP Service: Updating record ${t}...`,p);const m=await fetch(`${e}/_api/web/lists/getByTitle('${this.DOB_ANNIVERSARY_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"X-RequestDigest":n,Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-HTTP-Method":"MERGE","IF-MATCH":"*"},body:JSON.stringify(p)});if(!m.ok){const y=await m.text();throw new Error(`Failed to update event record: ${m.status} - ${y}`)}}catch(a){throw console.error("SP Service: Failed to update event record",a),a}}static async deleteEmployeeEventRecord(t){try{const r=await nn(),a="https://jmtechtalent.sharepoint.com/sites/EmployeesDOB",n=await this.getFormDigest(r,a);console.log(`SP Service: Deleting record ${t} from ${this.DOB_ANNIVERSARY_LIST} (V2)...`);const e=await fetch(`${a}/_api/web/lists/getByTitle('${this.DOB_ANNIVERSARY_LIST}')/items(${t})`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-RequestDigest":n,Accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE","IF-MATCH":"*"}});if(!e.ok){const p=await e.text();throw new Error(`Failed to delete record: ${e.status} - ${p}`)}console.log("SP Service: Delete successful")}catch(r){throw console.error("SP Service: Failed to delete event record",r),r}}static async submitCheckInRegularization(t){try{const r=await nn();if(!r)throw new Error("No access token available");const a="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",n="/sites/JMGroupINC-All/Lists/IntimeRegularize",e=await fetch(`${a}/_api/web/getList('${n}')?$select=ListItemEntityTypeFullName`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!e.ok){const A=await e.text();throw new Error(`SharePoint List Error: ${e.status} - ${A}`)}const y={__metadata:{type:(await e.json()).d.ListItemEntityTypeFullName},Title:t.employeeName,EmployeeName:t.employeeName,MailID:t.mailID,Date:t.date,Status:"Pending Manager Approval"},w=await fetch(`${a}/_api/web/getList('${n}')/items`,{method:"POST",headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},body:JSON.stringify(y)});if(!w.ok){const A=await w.text();throw new Error(`SharePoint Error: ${w.status} - ${A}`)}}catch(r){throw console.error("Error submitting regularization request:",r),r}}static async getRegularizationHistory(t){try{const r=await nn();if(!r)throw new Error("No access token available");const a="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",n="/sites/JMGroupINC-All/Lists/IntimeRegularize",e=new Date,m=new Date(e.getFullYear(),e.getMonth(),1).toISOString(),y=`MailID eq '${encodeURIComponent(t)}' and Created ge datetime'${m}'`,w=`${a}/_api/web/getList('${n}')/items?$filter=${y}&$orderby=Created desc`,A=await fetch(w,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json;odata=verbose"}});if(!A.ok){const R=await A.text();throw new Error(`SharePoint Error: ${A.status} - ${R}`)}return(await A.json()).d.results}catch(r){throw console.error("Error fetching regularization history:",r),r}}static async getPendingRegularizations(t,r=!1){try{const a=await nn(),n="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All",e="/sites/JMGroupINC-All/Lists/IntimeRegularize";let p="(Status eq 'Pending Manager Approval' or Status eq 'Pending')";const m=new Date,w=new Date(m.getFullYear(),m.getMonth(),1).toISOString();if(p+=` and Created ge datetime'${w}'`,r)console.log("SP Service: Admin mode - Fetching all pending regularizations for the current month.");else if(t)p+=` and Manager/EMail eq '${encodeURIComponent(t)}'`;else return console.warn("SP Service: No manager email provided for non-admin filtering. Returning empty."),[];const A=`${n}/_api/web/getList('${e}')/items?$select=*,Manager/Title,Manager/EMail&$expand=Manager&$filter=${p}&$orderby=Created desc`;console.log(`SP Service: Fetching Regularizations. isAdmin=${r}, filter=${p}`);const I=await fetch(A,{headers:{Authorization:`Bearer ${a}`,Accept:"application/json;odata=verbose"}});return I.ok?(await I.json()).d.results||[]:[]}catch(a){return console.error("Error fetching pending regularizations:",a),[]}}static async updateApprovalStatus(t,r,a,n){console.log(`SP Service: Updating ${t} #${r} to ${a}`);try{const e=await nn(),p=await this.getFormDigest(e),m="https://jmtechtalent.sharepoint.com/sites/JMGroupINC-All";let y="";const w=["Status","status","ApprovalStatus"],A=["ApproverComments","ApprovalComments","Comments","AdminComments"];t==="Regularization"?y=`${m}/_api/web/getList('/sites/JMGroupINC-All/Lists/IntimeRegularize')`:t==="Leave"?y=`${m}/_api/web/lists/getByTitle('Leave Request')`:t==="Permission"&&(y=`${m}/_api/web/lists/getByTitle('Permission')`);const I=await fetch(`${y}?$select=ListItemEntityTypeFullName`,{headers:{Authorization:`Bearer ${e}`,Accept:"application/json;odata=verbose"}});if(!I.ok){const xe=await I.text();throw new Error(`Failed to fetch list metadata: ${I.status} - ${xe}`)}const k=(await I.json()).d.ListItemEntityTypeFullName,M=await fetch(`${y}/items(${r})?$select=*`,{headers:{Authorization:`Bearer ${e}`,Accept:"application/json;odata=verbose"}});if(!M.ok){const xe=await M.text();throw new Error(`Failed to fetch item data: ${M.status} - ${xe}`)}const V=await M.json(),q=Object.keys(V.d),U=w.find(xe=>q.includes(xe))||"Status",te=A.find(xe=>q.includes(xe))||(t==="Leave"?"ApprovalComments":"ApproverComments");console.log(`SP Service: Fields found for ${t}: Status -> ${U}, Comments -> ${te}`);const W={__metadata:{type:k},[U]:a,[te]:n},re=await fetch(`${y}/items(${r})`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"X-RequestDigest":p,"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:JSON.stringify(W)});if(!re.ok){const xe=await re.text();throw console.error(`SP Service: Update failed for ${t} #${r}. Payload:`,W,"Error:",xe),new Error(`Failed to update status: ${re.status} - ${xe}`)}console.log(`SP Service: ${t} #${r} updated successfully`)}catch(e){throw console.error(`Error updating ${t} status:`,e),e}}}const uS=le.createContext(void 0),z_=({children:i})=>{const{instance:t,accounts:r}=Cd(),[a,n]=le.useState(null),[e,p]=le.useState(null),[m,y]=le.useState(!0),[w,A]=le.useState(!1);return le.useEffect(()=>{const I=async()=>{if(t&&r.length>0){ry(t);const k=r[0].username;try{const M=await cr.getEmployeeByEmail(k);M?(console.log("UserContext: Fetched Employee",M),console.log("UserContext: Permission Level",M.permissionLevel),n(M),p(M.permissionLevel||"Employee")):(console.warn("User not found in Employee list"),A(!0))}catch(M){console.error(M)}finally{y(!1)}}};r.length>0?I():y(!1)},[t,r]),h.jsx(uS.Provider,{value:{employee:a,permissionLevel:e,loading:m,isAccessDenied:w},children:i})},du=()=>{const i=le.useContext(uS);if(i===void 0)throw new Error("useUser must be used within a UserProvider");return i};var hS={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},O4=vo.createContext&&vo.createContext(hS),$_=["attr","size","title"];function q_(i,t){if(i==null)return{};var r=G_(i,t),a,n;if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(i);for(n=0;n<e.length;n++)a=e[n],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(i,a)&&(r[a]=i[a])}return r}function G_(i,t){if(i==null)return{};var r={};for(var a in i)if(Object.prototype.hasOwnProperty.call(i,a)){if(t.indexOf(a)>=0)continue;r[a]=i[a]}return r}function sy(){return sy=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])}return i},sy.apply(this,arguments)}function L4(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),r.push.apply(r,a)}return r}function iy(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L4(Object(r),!0).forEach(function(a){V_(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):L4(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function V_(i,t,r){return t=W_(t),t in i?Object.defineProperty(i,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[t]=r,i}function W_(i){var t=K_(i,"string");return typeof t=="symbol"?t:t+""}function K_(i,t){if(typeof i!="object"||!i)return i;var r=i[Symbol.toPrimitive];if(r!==void 0){var a=r.call(i,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function dS(i){return i&&i.map((t,r)=>vo.createElement(t.tag,iy({key:r},t.attr),dS(t.child)))}function Mr(i){return t=>vo.createElement(Y_,sy({attr:iy({},i.attr)},t),dS(i.child))}function Y_(i){var t=r=>{var{attr:a,size:n,title:e}=i,p=q_(i,$_),m=n||r.size||"1em",y;return r.className&&(y=r.className),i.className&&(y=(y?y+" ":"")+i.className),vo.createElement("svg",sy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,p,{className:y,style:iy(iy({color:i.color||r.color},r.style),i.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),e&&vo.createElement("title",null,e),i.children)};return O4!==void 0?vo.createElement(O4.Consumer,null,r=>t(r)):t(hS)}function fS(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(i)}function J_(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M97.12 362.63c-8.69-8.69-4.16-6.24-25.12-11.85-9.51-2.55-17.87-7.45-25.43-13.32L1.2 448.7c-4.39 10.77 3.81 22.47 15.43 22.03l52.69-2.01L105.56 507c8 8.44 22.04 5.81 26.43-4.96l52.05-127.62c-10.84 6.04-22.87 9.58-35.31 9.58-19.5 0-37.82-7.59-51.61-21.37zM382.8 448.7l-45.37-111.24c-7.56 5.88-15.92 10.77-25.43 13.32-21.07 5.64-16.45 3.18-25.12 11.85-13.79 13.78-32.12 21.37-51.62 21.37-12.44 0-24.47-3.55-35.31-9.58L252 502.04c4.39 10.77 18.44 13.4 26.43 4.96l36.25-38.28 52.69 2.01c11.62.44 19.82-11.27 15.43-22.03zM263 340c15.28-15.55 17.03-14.21 38.79-20.14 13.89-3.79 24.75-14.84 28.47-28.98 7.48-28.4 5.54-24.97 25.95-45.75 10.17-10.35 14.14-25.44 10.42-39.58-7.47-28.38-7.48-24.42 0-52.83 3.72-14.14-.25-29.23-10.42-39.58-20.41-20.78-18.47-17.36-25.95-45.75-3.72-14.14-14.58-25.19-28.47-28.98-27.88-7.61-24.52-5.62-44.95-26.41-10.17-10.35-25-14.4-38.89-10.61-27.87 7.6-23.98 7.61-51.9 0-13.89-3.79-28.72.25-38.89 10.61-20.41 20.78-17.05 18.8-44.94 26.41-13.89 3.79-24.75 14.84-28.47 28.98-7.47 28.39-5.54 24.97-25.95 45.75-10.17 10.35-14.15 25.44-10.42 39.58 7.47 28.36 7.48 24.4 0 52.82-3.72 14.14.25 29.23 10.42 39.59 20.41 20.78 18.47 17.35 25.95 45.75 3.72 14.14 14.58 25.19 28.47 28.98C104.6 325.96 106.27 325 121 340c13.23 13.47 33.84 15.88 49.74 5.82a39.676 39.676 0 0 1 42.53 0c15.89 10.06 36.5 7.65 49.73-5.82zM97.66 175.96c0-53.03 42.24-96.02 94.34-96.02s94.34 42.99 94.34 96.02-42.24 96.02-94.34 96.02-94.34-42.99-94.34-96.02z"},child:[]}]})(i)}function Q_(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M256 336h-.02c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0C-2.06 328.75.02 320.33.02 336H0c0 44.18 57.31 80 128 80s128-35.82 128-80zM128 176l72 144H56l72-144zm511.98 160c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0-87.12 174.26-85.04 165.84-85.04 181.51H384c0 44.18 57.31 80 128 80s128-35.82 128-80h-.02zM440 320l72-144 72 144H440zm88 128H352V153.25c23.51-10.29 41.16-31.48 46.39-57.25H528c8.84 0 16-7.16 16-16V48c0-8.84-7.16-16-16-16H383.64C369.04 12.68 346.09 0 320 0s-49.04 12.68-63.64 32H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h129.61c5.23 25.76 22.87 46.96 46.39 57.25V448H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h416c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(i)}function P4(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z"},child:[]}]})(i)}function X_(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(i)}function Z_(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M176 256c44.11 0 80-35.89 80-80s-35.89-80-80-80-80 35.89-80 80 35.89 80 80 80zm352-128H304c-8.84 0-16 7.16-16 16v144H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v352c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16v-48h512v48c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V240c0-61.86-50.14-112-112-112z"},child:[]}]})(i)}function M4(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(i)}function e9(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 384c-28.02 0-31.26-32-74.5-32-43.43 0-46.825 32-74.75 32-27.695 0-31.454-32-74.75-32-42.842 0-47.218 32-74.5 32-28.148 0-31.202-32-74.75-32-43.547 0-46.653 32-74.75 32v-80c0-26.5 21.5-48 48-48h16V112h64v144h64V112h64v144h64V112h64v144h16c26.5 0 48 21.5 48 48v80zm0 128H0v-96c43.356 0 46.767-32 74.75-32 27.951 0 31.253 32 74.75 32 42.843 0 47.217-32 74.5-32 28.148 0 31.201 32 74.75 32 43.357 0 46.767-32 74.75-32 27.488 0 31.252 32 74.5 32v96zM96 96c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40z"},child:[]}]})(i)}function t9(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(i)}function r9(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 0H48C22.4 0 0 22.4 0 48v416c0 25.6 22.4 48 48 48h352c25.6 0 48-22.4 48-48V48c0-25.6-22.4-48-48-48zM128 435.2c0 6.4-6.4 12.8-12.8 12.8H76.8c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm0-128c0 6.4-6.4 12.8-12.8 12.8H76.8c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm128 128c0 6.4-6.4 12.8-12.8 12.8h-38.4c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm0-128c0 6.4-6.4 12.8-12.8 12.8h-38.4c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm128 128c0 6.4-6.4 12.8-12.8 12.8h-38.4c-6.4 0-12.8-6.4-12.8-12.8V268.8c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v166.4zm0-256c0 6.4-6.4 12.8-12.8 12.8H76.8c-6.4 0-12.8-6.4-12.8-12.8V76.8C64 70.4 70.4 64 76.8 64h294.4c6.4 0 12.8 6.4 12.8 12.8v102.4z"},child:[]}]})(i)}function cu(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(i)}function ux(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 160H12c-6.627 0-12-5.373-12-12v-36c0-26.51 21.49-48 48-48h48V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h128V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h48c26.51 0 48 21.49 48 48v36c0 6.627-5.373 12-12 12zM12 192h424c6.627 0 12 5.373 12 12v260c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V204c0-6.627 5.373-12 12-12zm333.296 95.947l-28.169-28.398c-4.667-4.705-12.265-4.736-16.97-.068L194.12 364.665l-45.98-46.352c-4.667-4.705-12.266-4.736-16.971-.068l-28.397 28.17c-4.705 4.667-4.736 12.265-.068 16.97l82.601 83.269c4.667 4.705 12.265 4.736 16.97.068l142.953-141.805c4.705-4.667 4.736-12.265.068-16.97z"},child:[]}]})(i)}function n9(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm64-192c0-8.8 7.2-16 16-16h96c8.8 0 16 7.2 16 16v96c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16v-96zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(i)}function a9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(i)}function Pc(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(i)}function Cv(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(i)}function pS(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(i)}function Cf(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(i)}function U4(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M192 384h192c53 0 96-43 96-96h32c70.6 0 128-57.4 128-128S582.6 32 512 32H120c-13.3 0-24 10.7-24 24v232c0 53 43 96 96 96zM512 96c35.3 0 64 28.7 64 64s-28.7 64-64 64h-32V96h32zm47.7 384H48.3c-47.6 0-61-64-36-64h583.3c25 0 11.8 64-35.9 64z"},child:[]}]})(i)}function hx(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(i)}function s9(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"},child:[]}]})(i)}function dx(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(i)}function Nf(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(i)}function i9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(i)}function N0(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(i)}function o9(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(i)}function Ym(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(i)}function l9(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z"},child:[]}]})(i)}function mS(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM64 72c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8V72zm0 80v-16c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8zm144 263.88V440c0 4.42-3.58 8-8 8h-16c-4.42 0-8-3.58-8-8v-24.29c-11.29-.58-22.27-4.52-31.37-11.35-3.9-2.93-4.1-8.77-.57-12.14l11.75-11.21c2.77-2.64 6.89-2.76 10.13-.73 3.87 2.42 8.26 3.72 12.82 3.72h28.11c6.5 0 11.8-5.92 11.8-13.19 0-5.95-3.61-11.19-8.77-12.73l-45-13.5c-18.59-5.58-31.58-23.42-31.58-43.39 0-24.52 19.05-44.44 42.67-45.07V232c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v24.29c11.29.58 22.27 4.51 31.37 11.35 3.9 2.93 4.1 8.77.57 12.14l-11.75 11.21c-2.77 2.64-6.89 2.76-10.13.73-3.87-2.43-8.26-3.72-12.82-3.72h-28.11c-6.5 0-11.8 5.92-11.8 13.19 0 5.95 3.61 11.19 8.77 12.73l45 13.5c18.59 5.58 31.58 23.42 31.58 43.39 0 24.53-19.05 44.44-42.67 45.07z"},child:[]}]})(i)}function c9(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(i)}function u9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(i)}function h9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256.12 245.96c-13.25 0-24 10.74-24 24 1.14 72.25-8.14 141.9-27.7 211.55-2.73 9.72 2.15 30.49 23.12 30.49 10.48 0 20.11-6.92 23.09-17.52 13.53-47.91 31.04-125.41 29.48-224.52.01-13.25-10.73-24-23.99-24zm-.86-81.73C194 164.16 151.25 211.3 152.1 265.32c.75 47.94-3.75 95.91-13.37 142.55-2.69 12.98 5.67 25.69 18.64 28.36 13.05 2.67 25.67-5.66 28.36-18.64 10.34-50.09 15.17-101.58 14.37-153.02-.41-25.95 19.92-52.49 54.45-52.34 31.31.47 57.15 25.34 57.62 55.47.77 48.05-2.81 96.33-10.61 143.55-2.17 13.06 6.69 25.42 19.76 27.58 19.97 3.33 26.81-15.1 27.58-19.77 8.28-50.03 12.06-101.21 11.27-152.11-.88-55.8-47.94-101.88-104.91-102.72zm-110.69-19.78c-10.3-8.34-25.37-6.8-33.76 3.48-25.62 31.5-39.39 71.28-38.75 112 .59 37.58-2.47 75.27-9.11 112.05-2.34 13.05 6.31 25.53 19.36 27.89 20.11 3.5 27.07-14.81 27.89-19.36 7.19-39.84 10.5-80.66 9.86-121.33-.47-29.88 9.2-57.88 28-80.97 8.35-10.28 6.79-25.39-3.49-33.76zm109.47-62.33c-15.41-.41-30.87 1.44-45.78 4.97-12.89 3.06-20.87 15.98-17.83 28.89 3.06 12.89 16 20.83 28.89 17.83 11.05-2.61 22.47-3.77 34-3.69 75.43 1.13 137.73 61.5 138.88 134.58.59 37.88-1.28 76.11-5.58 113.63-1.5 13.17 7.95 25.08 21.11 26.58 16.72 1.95 25.51-11.88 26.58-21.11a929.06 929.06 0 0 0 5.89-119.85c-1.56-98.75-85.07-180.33-186.16-181.83zm252.07 121.45c-2.86-12.92-15.51-21.2-28.61-18.27-12.94 2.86-21.12 15.66-18.26 28.61 4.71 21.41 4.91 37.41 4.7 61.6-.11 13.27 10.55 24.09 23.8 24.2h.2c13.17 0 23.89-10.61 24-23.8.18-22.18.4-44.11-5.83-72.34zm-40.12-90.72C417.29 43.46 337.6 1.29 252.81.02 183.02-.82 118.47 24.91 70.46 72.94 24.09 119.37-.9 181.04.14 246.65l-.12 21.47c-.39 13.25 10.03 24.31 23.28 24.69.23.02.48.02.72.02 12.92 0 23.59-10.3 23.97-23.3l.16-23.64c-.83-52.5 19.16-101.86 56.28-139 38.76-38.8 91.34-59.67 147.68-58.86 69.45 1.03 134.73 35.56 174.62 92.39 7.61 10.86 22.56 13.45 33.42 5.86 10.84-7.62 13.46-22.59 5.84-33.43z"},child:[]}]})(i)}function d9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"},child:[]}]})(i)}function f9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.52 32 0 146.496 0 288v48a32 32 0 0 0 17.689 28.622l14.383 7.191C34.083 431.903 83.421 480 144 480h24c13.255 0 24-10.745 24-24V280c0-13.255-10.745-24-24-24h-24c-31.342 0-59.671 12.879-80 33.627V288c0-105.869 86.131-192 192-192s192 86.131 192 192v1.627C427.671 268.879 399.342 256 368 256h-24c-13.255 0-24 10.745-24 24v176c0 13.255 10.745 24 24 24h24c60.579 0 109.917-48.098 111.928-108.187l14.382-7.191A32 32 0 0 0 512 336v-48c0-141.479-114.496-256-256-256z"},child:[]}]})(i)}function $1(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(i)}function p9(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(i)}function m9(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M544 96H416V32c0-17.7-14.3-32-32-32H192c-17.7 0-32 14.3-32 32v64H32c-17.7 0-32 14.3-32 32v368c0 8.8 7.2 16 16 16h544c8.8 0 16-7.2 16-16V128c0-17.7-14.3-32-32-32zM160 436c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-128c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm160 128c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-128c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm16-170c0 3.3-2.7 6-6 6h-26v26c0 3.3-2.7 6-6 6h-20c-3.3 0-6-2.7-6-6v-26h-26c-3.3 0-6-2.7-6-6v-20c0-3.3 2.7-6 6-6h26V86c0-3.3 2.7-6 6-6h20c3.3 0 6 2.7 6 6v26h26c3.3 0 6 2.7 6 6v20zm144 298c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-128c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40z"},child:[]}]})(i)}function g9(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h480c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM128 180v-40c0-6.627-5.373-12-12-12H76c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm-336 96v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm-336 96v-40c0-6.627-5.373-12-12-12H76c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm288 0v-40c0-6.627-5.373-12-12-12H172c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h232c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12z"},child:[]}]})(i)}function B4(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 416H381.54c-.74 19.81-14.71 32-32.74 32H288c-18.69 0-33.02-17.47-32.77-32H16c-8.8 0-16 7.2-16 16v16c0 35.2 28.8 64 64 64h512c35.2 0 64-28.8 64-64v-16c0-8.8-7.2-16-16-16zM576 48c0-26.4-21.6-48-48-48H112C85.6 0 64 21.6 64 48v336h512V48zm-64 272H128V64h384v256z"},child:[]}]})(i)}function y9(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(i)}function v9(i){return Mr({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M272 0H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h224c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM160 480c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(i)}function b9(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M0 352a160 160 0 0 0 160 160h64a160 160 0 0 0 160-160V224H0zM176 0h-16A160 160 0 0 0 0 160v32h176zm48 0h-16v192h176v-32A160 160 0 0 0 224 0z"},child:[]}]})(i)}function x9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(i)}function w9(i){return Mr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M97.333 506.966c-129.874-129.874-129.681-340.252 0-469.933 5.698-5.698 14.527-6.632 21.263-2.422l64.817 40.513a17.187 17.187 0 0 1 6.849 20.958l-32.408 81.021a17.188 17.188 0 0 1-17.669 10.719l-55.81-5.58c-21.051 58.261-20.612 122.471 0 179.515l55.811-5.581a17.188 17.188 0 0 1 17.669 10.719l32.408 81.022a17.188 17.188 0 0 1-6.849 20.958l-64.817 40.513a17.19 17.19 0 0 1-21.264-2.422zM247.126 95.473c11.832 20.047 11.832 45.008 0 65.055-3.95 6.693-13.108 7.959-18.718 2.581l-5.975-5.726c-3.911-3.748-4.793-9.622-2.261-14.41a32.063 32.063 0 0 0 0-29.945c-2.533-4.788-1.65-10.662 2.261-14.41l5.975-5.726c5.61-5.378 14.768-4.112 18.718 2.581zm91.787-91.187c60.14 71.604 60.092 175.882 0 247.428-4.474 5.327-12.53 5.746-17.552.933l-5.798-5.557c-4.56-4.371-4.977-11.529-.93-16.379 49.687-59.538 49.646-145.933 0-205.422-4.047-4.85-3.631-12.008.93-16.379l5.798-5.557c5.022-4.813 13.078-4.394 17.552.933zm-45.972 44.941c36.05 46.322 36.108 111.149 0 157.546-4.39 5.641-12.697 6.251-17.856 1.304l-5.818-5.579c-4.4-4.219-4.998-11.095-1.285-15.931 26.536-34.564 26.534-82.572 0-117.134-3.713-4.836-3.115-11.711 1.285-15.931l5.818-5.579c5.159-4.947 13.466-4.337 17.856 1.304z"},child:[]}]})(i)}function S9(i){return Mr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M480 192H365.71L260.61 8.06A16.014 16.014 0 0 0 246.71 0h-65.5c-10.63 0-18.3 10.17-15.38 20.39L214.86 192H112l-43.2-57.6c-3.02-4.03-7.77-6.4-12.8-6.4H16.01C5.6 128-2.04 137.78.49 147.88L32 256 .49 364.12C-2.04 374.22 5.6 384 16.01 384H56c5.04 0 9.78-2.37 12.8-6.4L112 320h102.86l-49.03 171.6c-2.92 10.22 4.75 20.4 15.38 20.4h65.5c5.74 0 11.04-3.08 13.89-8.06L365.71 320H480c35.35 0 96-28.65 96-64s-60.65-64-96-64z"},child:[]}]})(i)}function ip(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(i)}function A9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"},child:[]}]})(i)}function yp(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(i)}function $o(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(i)}function oy(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(i)}function C9(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M367.9 329.76c-4.62 5.3-9.78 10.1-15.9 13.65v22.94c66.52 9.34 112 28.05 112 49.65 0 30.93-93.12 56-208 56S48 446.93 48 416c0-21.6 45.48-40.3 112-49.65v-22.94c-6.12-3.55-11.28-8.35-15.9-13.65C58.87 345.34 0 378.05 0 416c0 53.02 114.62 96 256 96s256-42.98 256-96c0-37.95-58.87-70.66-144.1-86.24zM256 128c35.35 0 64-28.65 64-64S291.35 0 256 0s-64 28.65-64 64 28.65 64 64 64zm-64 192v96c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-96c17.67 0 32-14.33 32-32v-96c0-26.51-21.49-48-48-48h-11.8c-11.07 5.03-23.26 8-36.2 8s-25.13-2.97-36.2-8H208c-26.51 0-48 21.49-48 48v96c0 17.67 14.33 32 32 32z"},child:[]}]})(i)}function uu(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"},child:[]}]})(i)}function Jm(i){return Mr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},child:[]}]})(i)}function Ju(i){return Mr({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(i)}function Sd(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(i)}function fx(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M115.38 136.9l102.11 37.18c35.19-81.54 86.21-144.29 139-173.7-95.88-4.89-188.78 36.96-248.53 111.8-6.69 8.4-2.66 21.05 7.42 24.72zm132.25 48.16l238.48 86.83c35.76-121.38 18.7-231.66-42.63-253.98-7.4-2.7-15.13-4-23.09-4-58.02.01-128.27 69.17-172.76 171.15zM521.48 60.5c6.22 16.3 10.83 34.6 13.2 55.19 5.74 49.89-1.42 108.23-18.95 166.98l102.62 37.36c10.09 3.67 21.31-3.43 21.57-14.17 2.32-95.69-41.91-187.44-118.44-245.36zM560 447.98H321.06L386 269.5l-60.14-21.9-72.9 200.37H16c-8.84 0-16 7.16-16 16.01v32.01C0 504.83 7.16 512 16 512h544c8.84 0 16-7.17 16-16.01v-32.01c0-8.84-7.16-16-16-16z"},child:[]}]})(i)}function px(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4zm323-128.4l-27.8-28.1c-4.6-4.7-12.1-4.7-16.8-.1l-104.8 104-45.5-45.8c-4.6-4.7-12.1-4.7-16.8-.1l-28.1 27.9c-4.7 4.6-4.7 12.1-.1 16.8l81.7 82.3c4.6 4.7 12.1 4.7 16.8.1l141.3-140.2c4.6-4.7 4.7-12.2.1-16.8z"},child:[]}]})(i)}function Hy(i){return Mr({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"},child:[]}]})(i)}function N9(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M496 224c-79.6 0-144 64.4-144 144s64.4 144 144 144 144-64.4 144-144-64.4-144-144-144zm64 150.3c0 5.3-4.4 9.7-9.7 9.7h-60.6c-5.3 0-9.7-4.4-9.7-9.7v-76.6c0-5.3 4.4-9.7 9.7-9.7h12.6c5.3 0 9.7 4.4 9.7 9.7V352h38.3c5.3 0 9.7 4.4 9.7 9.7v12.6zM320 368c0-27.8 6.7-54.1 18.2-77.5-8-1.5-16.2-2.5-24.6-2.5h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h347.1c-45.3-31.9-75.1-84.5-75.1-144zm-96-112c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128z"},child:[]}]})(i)}function T9(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z"},child:[]}]})(i)}function E9(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.8 458.1L362.3 248.3C412.1 230.7 448 183.8 448 128 448 57.3 390.7 0 320 0c-67.1 0-121.5 51.8-126.9 117.4L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4l588.4 454.7c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.4-6.8 4.1-16.9-2.9-22.3zM96 422.4V464c0 26.5 21.5 48 48 48h350.2L207.4 290.3C144.2 301.3 96 356 96 422.4z"},child:[]}]})(i)}function k9(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm95.8 32.6L272 480l-32-136 32-56h-96l32 56-32 136-47.8-191.4C56.9 292 0 350.3 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-72.1-56.9-130.4-128.2-133.8z"},child:[]}]})(i)}function gS(i){return Mr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(i)}function _9(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M610.5 341.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 368.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm224 32c1.9 0 3.7-.5 5.6-.6 8.3-21.7 20.5-42.1 36.3-59.2 7.4-8 17.9-12.6 28.9-12.6 6.9 0 13.7 1.8 19.6 5.3l7.9 4.6c.8-.5 1.6-.9 2.4-1.4 7-14.6 11.2-30.8 11.2-48 0-61.9-50.1-112-112-112S208 82.1 208 144c0 61.9 50.1 112 112 112zm105.2 194.5c-2.3-1.2-4.6-2.6-6.8-3.9-8.2 4.8-15.3 9.8-27.5 9.8-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-10.7-34.5 24.9-49.7 25.8-50.3-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-3.8-2.2-7-5-9.8-8.1-3.3.2-6.5.6-9.8.6-24.6 0-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h255.4c-3.7-6-6.2-12.8-6.2-20.3v-9.2zM173.1 274.6C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(i)}function ly(i){return Mr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(i)}const I9={Admin:["Dashboard","Attendance","MonthlyAttendance","EmployeeProfile","Leave","Permission","Holiday","MyTeam","Reports","Employees","Payroll","Settings","Approvals"],HR:["Dashboard","Attendance","MonthlyAttendance","EmployeeProfile","Leave","Permission","Holiday","Reports","Employees"],Accounts:["Dashboard","Attendance","MonthlyAttendance","EmployeeProfile","Leave","Permission","Holiday","Reports","Payroll"],Manager:["Dashboard","Attendance","MonthlyAttendance","EmployeeProfile","Leave","Permission","Holiday","MyTeam","Approvals"],Employee:["Dashboard","Attendance","MonthlyAttendance","EmployeeProfile","Leave","Permission","Holiday"]},B1=(i,t,r,a)=>{if(!i)return!1;if(t==="Approvals"){const n=a?.toLowerCase()||"",e=r?.toLowerCase()||"";if(n.includes("lead hr")||n.includes("account manager")||n.includes("operation manager")||n.includes("ceo")||e==="ceo")return!0}return i==="Manager"&&r==="CEO"&&t==="Reports"?!0:I9[i]?.includes(t)||!1},D9=({permissionLevel:i,department:t,designation:r,isMobileOnly:a})=>{const e=[{icon:p9,label:"Dashboard",path:"/dashboard"},{icon:N9,label:"Attendance",path:"/attendance"},{icon:k9,label:"Employee Profile",path:"/employee-profile"},{icon:Pc,label:"Approval",path:"/approvals"},{icon:ux,label:"Leave Management",path:"/leave"},{icon:px,label:"Permission Management",path:"/permission"},{icon:pS,label:"Monthly Attendance",path:"/monthly-attendance"},{icon:T9,label:"My Team",path:"/my-team"},{icon:a9,label:"Reports",path:"/reports"},{icon:mS,label:"Payroll",path:"/payroll"},{icon:fx,label:"Holiday Calendar",path:"/holiday"},{icon:ly,label:"Employees",path:"/employees"},{icon:hx,label:"Settings",path:"/settings",roles:["Admin"]}].filter(p=>{if(a)return p.label==="Leave Management";const y={Dashboard:"Dashboard",Attendance:"Attendance","Employee Profile":"EmployeeProfile","Leave Management":"Leave","Permission Management":"Permission",Approval:"Approvals","Monthly Attendance":"MonthlyAttendance","My Team":"MyTeam",Reports:"Reports",Payroll:"Payroll","Holiday Calendar":"Holiday",Employees:"Employees",Settings:"Settings"}[p.label];return B1(i,y,t,r)});return h.jsxs("aside",{className:"w-64 bg-blue-50 h-full border-r border-blue-100 flex flex-col shadow-[4px_0_24px_rgba(0,0,0,0.02)]",children:[h.jsxs("div",{className:"h-16 flex items-center px-6 border-b border-blue-100 bg-blue-50",children:[h.jsx("img",{src:"/logo.png",alt:"Company Logo",className:"h-10 w-auto mr-3 object-contain"}),h.jsxs("div",{children:[h.jsx("h1",{className:"font-bold text-gray-900 text-lg leading-tight",children:"HRMS Portal"}),h.jsx("p",{className:"text-[10px] uppercase tracking-wider text-gray-500 font-semibold",children:"JM Group Inc."})]})]}),h.jsx("nav",{className:"flex-1 py-6 px-3 space-y-1 overflow-y-auto",children:e.map((p,m)=>h.jsx(tS,{to:p.path,className:({isActive:y})=>`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-md transition-all duration-200 group
                        ${y?"bg-brand-50 text-brand-900 border-l-4 border-brand-900 shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-gray-900 border-l-4 border-transparent"}`,children:({isActive:y})=>h.jsxs(h.Fragment,{children:[h.jsx(p.icon,{className:`text-lg transition-colors 
                            ${y?"text-brand-900":"text-gray-400 group-hover:text-gray-600"}`}),p.label]})},m))})]})},F9=()=>{const{employee:i,permissionLevel:t}=du(),[r,a]=vo.useState([]),[n,e]=vo.useState(!1);vo.useEffect(()=>{if(!i?.email)return;const m=async()=>{try{const w=await cr.getNotifications(i.email);a(w)}catch(w){console.error("Failed to fetch notifications",w)}};m();const y=setInterval(m,3e4);return()=>clearInterval(y)},[i?.email]);const p=async m=>{try{await cr.markNotificationAsRead(m),a(y=>y.filter(w=>w.id!==m))}catch(y){console.error("Failed to mark notification as read",y)}};return h.jsxs("header",{className:"bg-blue-50 text-gray-900 shadow-sm border-b border-blue-100 h-16 flex items-center justify-between px-6 relative z-50",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{className:"md:hidden text-gray-600 hover:text-gray-900",children:h.jsx(X_,{size:20})}),h.jsx("span",{className:"md:hidden font-semibold text-lg tracking-wide text-gray-900",children:"HRMS Portal"})]}),h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsxs("div",{className:"relative",children:[h.jsxs("button",{onClick:()=>e(!n),className:"p-2 text-gray-400 hover:text-indigo-600 transition relative",children:[h.jsx(M4,{size:20}),r.length>0&&h.jsx("span",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center animate-bounce",children:r.length})]}),n&&h.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden animate-fade-in-up",children:[h.jsxs("div",{className:"p-4 border-b border-gray-50 flex justify-between items-center bg-gray-50/50",children:[h.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:"Notifications"}),h.jsxs("span",{className:"text-[10px] bg-indigo-100 text-indigo-600 px-2 py-0.5 rounded-full font-bold",children:[r.length," New"]})]}),h.jsx("div",{className:"max-h-96 overflow-y-auto custom-scrollbar",children:r.length===0?h.jsxs("div",{className:"p-8 text-center",children:[h.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:h.jsx(M4,{className:"text-gray-300",size:20})}),h.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"No new notifications"})]}):h.jsx("div",{className:"divide-y divide-gray-50",children:r.map(m=>h.jsxs("div",{className:"p-4 hover:bg-indigo-50/30 transition group relative",children:[h.jsxs("div",{className:"flex gap-3",children:[h.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs flex-shrink-0",children:m.senderName?m.senderName.charAt(0):"?"}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("p",{className:"text-xs text-gray-800 leading-relaxed pr-6",children:[h.jsx("span",{className:"font-bold",children:m.senderName})," ",m.message||m.title]}),h.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:new Date(m.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),h.jsx("button",{onClick:()=>p(m.id),className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 text-gray-300 hover:text-green-500 opacity-0 group-hover:opacity-100 transition",title:"Mark as read",children:h.jsx(Cv,{size:12})})]},m.id))})}),r.length>0&&h.jsx("div",{className:"p-3 bg-gray-50 border-t border-gray-100 text-center",children:h.jsx("button",{onClick:()=>e(!1),className:"text-[10px] font-bold text-indigo-600 hover:text-indigo-700 uppercase tracking-wider",children:"Close"})})]})]}),h.jsxs("div",{className:"flex items-center gap-3 pl-4",children:[h.jsxs("div",{className:"text-right hidden sm:block",children:[h.jsx("div",{className:"text-sm font-medium text-gray-900 leading-none",children:i?.name||"Guest"}),h.jsx("div",{className:"text-[10px] text-gray-500 font-bold opacity-60 mt-1 uppercase tracking-tighter",children:t||"Employee"})]}),h.jsx(Hy,{size:32,className:"text-gray-400 cursor-pointer hover:text-indigo-600 transition"})]})]})]})},R9=({children:i,permissionLevel:t,department:r,designation:a,isMobileOnly:n=!1})=>{const e=Nd(),p=e.pathname==="/monthly-attendance",m=e.pathname.includes("/reports/employee-leave-calendar");return h.jsxs("div",{className:"flex bg-gray-50 h-screen overflow-hidden font-sans text-gray-900",children:[h.jsx("div",{className:"flex-none hidden md:block z-20",children:h.jsx(D9,{permissionLevel:t,department:r,designation:a,isMobileOnly:n})}),h.jsxs("div",{className:"flex-1 flex flex-col min-w-0 h-full",children:[h.jsx(F9,{}),h.jsx("main",{className:`flex-1 w-full max-w-[1800px] mx-auto ${m?"overflow-hidden p-0 flex flex-col":p?"overflow-y-auto custom-scrollbar p-0":"overflow-y-auto custom-scrollbar p-6 md:p-8"}`,children:i}),h.jsx("footer",{className:"flex-none py-1 text-center text-[9px] text-gray-400 border-t border-gray-100 bg-white",children:" 2025 JM Group Inc. | HRMS Portal v4.73"})]})]})};function j9(){const[i,t]=le.useState(!0),[r,a]=le.useState([]),[n,e]=le.useState([]),[p,m]=le.useState([]),[y,w]=le.useState([]),[A,I]=le.useState({}),{permissionLevel:R,employee:k}=du(),M=r.map(ve=>{const De=n.find(ke=>ke.id===ve.employeeId||ke.name===ve.name);return{...ve,name:ve.name||(De?De.name:"Unknown"),place:ve.place||(De?De.place:"N/A"),status:ve.status||"Present"}}),V=M.filter(ve=>R==="Admin"||R==="HR"?!0:k?.place?ve.place?.toLowerCase()?.trim()===k.place.toLowerCase().trim():!1),q=n.map(ve=>{const De=r.find(ke=>ke.employeeId===ve.id||ke.name===ve.name);return{id:ve.id,name:ve.name,place:ve.place,status:De?De.status:"Absent"}}).filter(ve=>R==="Admin"||R==="HR"?!0:k?.place?ve.place?.toLowerCase()?.trim()===k.place.toLowerCase().trim():!1),te={totalEmployees:n.filter(ve=>R==="Admin"||R==="HR"?!0:k?.place?ve.place?.toLowerCase()?.trim()===k.place.toLowerCase().trim():!1).length,checkedIn:M.filter(ve=>R==="Admin"||R==="HR"?!0:k?.place?ve.place?.toLowerCase()?.trim()===k.place.toLowerCase().trim():!1).length,onLeave:M.filter(ve=>R==="Admin"||R==="HR"?!0:k?.place?ve.status?.includes("Leave")&&ve.place?.toLowerCase()?.trim()===k.place.toLowerCase().trim():!1).length,absent:q.filter(ve=>!r.some(ke=>ke.employeeId===ve.id||ke.name===ve.name)).length},W=q.filter(ve=>r.some(ke=>ke.employeeId===ve.id||ke.name===ve.name)?!1:ve.status==="Absent"||ve.status?.includes("Leave"));le.useEffect(()=>{const ve=async()=>{try{const ke=await cr.getAllEmployees();e(ke);const de=new Date,Oe=de.getDate().toString().padStart(2,"0"),z=(de.getMonth()+1).toString().padStart(2,"0"),K=de.getFullYear(),Ae=`${Oe}/${z}/${K}`,Ce=await cr.getAllAttendanceForDate(Ae);a(Ce);const Be=await cr.getUpcomingLeaves(),Ee=await cr.getUpcomingEvents();w(Ee);const Pe=Be.map(Le=>{const X=Le.date;let H=null,ae=null;if(X){let Z=X,se=X;if(typeof X=="string"&&X.includes("-")){const ce=X.split("-");ce.length>0&&(Z=ce[0].trim(),se=ce[1]?ce[1].trim():Z)}const ye=ce=>{const ze=new Date(ce);return isNaN(ze.getTime())?null:(ze.getFullYear()===2001&&ze.setFullYear(new Date().getFullYear()),ze)};H=ye(Z),ae=ye(se),H&&ae&&ae.getMonth()<H.getMonth()&&ae.setFullYear(H.getFullYear()+1)}return{...Le,displayDate:X,rawDate:H,endDate:ae||H}}),Ue=new Date;Ue.setHours(0,0,0,0);const _e=Pe.filter(Le=>Le.endDate?Le.endDate>=Ue:!0).sort((Le,X)=>!Le.rawDate&&!X.rawDate?0:Le.rawDate?X.rawDate?Le.rawDate.getTime()-X.rawDate.getTime():-1:1).slice(0,5);m(_e)}catch(ke){console.error("Failed to fetch dashboard stats",ke)}finally{t(!1)}};ve();const De=setInterval(ve,6e4);return()=>clearInterval(De)},[]);const re=async ve=>{if(!(!k||!ve.mailId)){I(De=>({...De,[ve.id]:!0}));try{const De=ve.type==="Birthday"?`${k.name} is wishing you a very Happy Birthday! `:`${k.name} is wishing you a Happy Work Anniversary! `;await cr.sendWish(ve.mailId,k.name,De,ve.type),ps.success(`Wish sent to ${ve.employeeName}!`)}catch(De){console.error("Failed to send wish:",De),ps.error("Failed to send wish. Please try again.")}finally{I(De=>({...De,[ve.id]:!1}))}}},xe=ve=>ve.displayDate?ve.displayDate:ve.rawDate?ve.rawDate.toLocaleDateString("en-US",{month:"short",day:"numeric"}):"TBD";return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Dashboard Overview"}),k?.place?h.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-bold uppercase tracking-wider border border-blue-200 shadow-sm",children:k.place}):h.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-bold uppercase tracking-wider border border-red-200 shadow-sm",children:"No Place Detected"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{label:"Total Count",value:i?"-":te.totalEmployees,color:"bg-blue-500"},{label:"Recorded",value:i?"-":te.checkedIn,color:"bg-green-500"},{label:"On Leave",value:i?"-":te.onLeave,color:"bg-yellow-500"},{label:"Absent Records",value:i?"-":te.absent,color:"bg-red-500"}].map((ve,De)=>h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-100 flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:ve.label}),h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ve.value})]}),h.jsx("div",{className:`w-3 h-3 rounded-full ${ve.color}`})]},De))}),(R==="Admin"||R==="HR")&&h.jsx("div",{className:"lg:col-span-3 grid grid-cols-2 md:grid-cols-5 gap-4 mb-2",children:[{name:"Chennai",color:"bg-indigo-50 text-indigo-700 border-indigo-100"},{name:"Hyderabad",color:"bg-purple-50 text-purple-700 border-purple-100"},{name:"Noida",color:"bg-teal-50 text-teal-700 border-teal-100"},{name:"CON",color:"bg-orange-50 text-orange-700 border-orange-100"},{name:"Canada",color:"bg-red-50 text-red-700 border-red-100"}].map(ve=>{const De=n.filter(K=>K.place?.toLowerCase()===ve.name.toLowerCase()).length,ke=M.filter(K=>K.place?.toLowerCase()===ve.name.toLowerCase()),de=ke.filter(K=>K.checkInTime).length,Oe=ke.filter(K=>K.status?.includes("Leave")).length,z=ke.filter(K=>K.status==="Absent").length;return h.jsxs("div",{className:`rounded-lg p-4 border ${ve.color} flex flex-col items-center justify-center min-h-[100px]`,children:[h.jsxs("span",{className:"text-xs font-bold uppercase tracking-wider opacity-80 mb-3",children:[ve.name," (",De,")"]}),h.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full text-center",children:[h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("span",{className:"text-xl font-bold text-green-600 leading-none",children:de}),h.jsx("span",{className:"text-[9px] font-bold mt-1 text-green-700 opacity-60",children:"CI"})]}),h.jsxs("div",{className:"flex flex-col items-center border-x border-current border-opacity-10",children:[h.jsx("span",{className:"text-xl font-bold text-red-600 leading-none",children:z}),h.jsx("span",{className:"text-[9px] font-bold mt-1 text-red-700 opacity-60",children:"A"})]}),h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("span",{className:"text-xl font-bold text-yellow-600 leading-none",children:Oe}),h.jsx("span",{className:"text-[9px] font-bold mt-1 text-yellow-700 opacity-60",children:"L"})]})]})]},ve.name)})}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"lg:col-span-2 bg-white rounded-lg shadow-sm p-6 border border-gray-100 min-h-[400px]",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 text-green-600",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Today's Live Check-Ins"}),h.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-100 text-green-700 rounded-full animate-pulse",children:"Live"}),R!=="Admin"&&R!=="HR"&&k?.place&&h.jsxs("span",{className:"ml-auto text-xs text-gray-400 font-medium border border-gray-200 px-2 py-1 rounded",children:["Location: ",k.place]})]}),V.length===0&&i?h.jsx("div",{className:"h-64 flex flex-col items-center justify-center text-gray-400 border-2 border-dashed border-gray-100 rounded-lg bg-gray-50",children:h.jsx("p",{children:"Loading data..."})}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-gray-200 text-gray-500",children:[h.jsx("th",{className:"pb-3 pl-2",children:"Employee"}),h.jsx("th",{className:"pb-3",children:"In"}),h.jsx("th",{className:"pb-3",children:"Out"}),h.jsx("th",{className:"pb-3",children:"Duration"}),h.jsx("th",{className:"pb-3",children:"Status"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:V.map(ve=>h.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[h.jsx("td",{className:"py-3 pl-2 font-medium text-gray-800",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs ${ve.status==="Absent"?"bg-red-100 text-red-600":"bg-indigo-100 text-indigo-600"}`,children:ve.name?ve.name.charAt(0):"?"}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{children:ve.name||"Unknown"}),(R==="Admin"||R==="HR")&&ve.place&&h.jsx("span",{className:"text-[9px] text-gray-400",children:ve.place})]})]})}),h.jsx("td",{className:`py-3 font-mono text-xs font-semibold ${ve.checkInTime!=="-"?"text-green-600":"text-gray-400"}`,children:ve.checkInTime}),h.jsx("td",{className:`py-3 font-mono text-xs ${ve.checkOutTime!=="-"?"text-red-600":"text-gray-400"}`,children:ve.checkOutTime||"-"}),h.jsx("td",{className:"py-3 text-gray-600 font-mono text-xs",children:ve.workingHours||"-"}),h.jsx("td",{className:"py-3",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${ve.status==="Present"||ve.status==="On Time"?"bg-green-100 text-green-700":ve.status==="Late"?"bg-red-100 text-red-700":ve.status==="Half-Day"||ve.status==="Half Day"||ve.status==="In"||ve.status==="Checked In"?"bg-yellow-100 text-yellow-700":ve.status==="Absent"?"bg-red-50 text-red-500":ve.status==="Holiday"?"bg-blue-100 text-blue-700":ve.status&&ve.status.includes("Leave")?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600"}`,children:ve.status})})]},ve.id||ve.name))})]})})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden",children:[h.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-4",children:h.jsxs("div",{className:"flex items-center gap-2 text-white",children:[h.jsx(cu,{className:"text-white/80"}),h.jsx("h3",{className:"font-bold",children:"Celebrations this Month"})]})}),h.jsx("div",{className:"p-5",children:y.length===0?h.jsx("p",{className:"text-sm text-gray-400 italic text-center py-4",children:"No celebrations this month."}):h.jsx("div",{className:"space-y-4",children:y.map(ve=>h.jsxs("div",{className:"flex items-center gap-4 group",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-transform group-hover:scale-110 ${ve.type==="Birthday"?"bg-pink-100 text-pink-600":"bg-yellow-100 text-yellow-600"}`,children:ve.type==="Birthday"?h.jsx(e9,{}):h.jsx(J_,{})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-sm font-bold text-gray-800 truncate",children:ve.employeeName}),h.jsx("p",{className:"text-xs text-gray-500",children:ve.type==="Birthday"?"Happy Birthday!":"Work Anniversary!"})]}),h.jsx("span",{className:"text-xs font-medium text-gray-500 w-12 text-right shrink-0",children:ve.date.toLocaleDateString("en-US",{month:"short",day:"2-digit"})}),h.jsx("div",{className:"w-24 flex justify-end shrink-0",children:ve.mailId&&ve.mailId!==k?.email&&h.jsx("button",{onClick:()=>re(ve),disabled:A[ve.id],className:`flex items-center gap-1.5 px-3 py-1 rounded-lg transition-all text-xs font-bold ${A[ve.id]?"text-gray-400 cursor-not-allowed":"text-green-600 hover:text-green-700 hover:bg-green-50"}`,title:"Send Wish",children:A[ve.id]?h.jsx("span",{children:"Sending..."}):h.jsxs(h.Fragment,{children:[h.jsx("span",{children:"Send Wish"}),h.jsx(x9,{className:"text-[10px]"})]})})})]},ve.id))})})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-100",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("h3",{className:"font-bold text-gray-800",children:"Today Absentees"}),h.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-100 text-red-600 rounded-full font-bold",children:W.length})]}),W.length===0?h.jsx("p",{className:"text-sm text-gray-400 italic",children:"No absentees recorded."}):h.jsx("div",{className:"space-y-3",children:W.map((ve,De)=>h.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-gray-50 last:border-0 last:pb-0",children:[h.jsx("div",{className:"w-8 h-8 rounded-full bg-red-50 flex items-center justify-center text-red-500 font-bold text-xs",children:ve.name?ve.name.charAt(0):"!"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-800",children:ve.name}),h.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold ${ve.status.includes("Leave")?"bg-purple-100 text-purple-600":"bg-red-100 text-red-600"}`,children:ve.status})]})]},De))})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-100",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("h3",{className:"font-bold text-gray-800",children:"Planned Leaves"}),h.jsx("span",{className:"text-xs px-2 py-0.5 bg-orange-100 text-orange-600 rounded-full font-bold",children:p.length})]}),p.length===0?h.jsx("p",{className:"text-sm text-gray-400 italic",children:"No upcoming leaves."}):h.jsx("div",{className:"space-y-4",children:p.map((ve,De)=>h.jsxs("div",{className:"flex gap-3 pb-3 border-b border-gray-50 last:border-0 last:pb-0",children:[h.jsxs("div",{className:"flex-col items-center justify-center text-center min-w-[3rem] bg-orange-50 rounded p-1",children:[h.jsx("span",{className:"block text-xs font-bold text-orange-600",children:ve.rawDate?ve.rawDate.toLocaleDateString("en-US",{weekday:"short"}):"PLAN"}),h.jsx("span",{className:"block text-[10px] text-orange-400",children:ve.rawDate?ve.rawDate.getDate():"-"})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"text-sm font-medium text-gray-800 line-clamp-1",children:ve.title||"Leave"}),h.jsx("p",{className:"text-xs text-gray-500",children:xe(ve)})]})]},De))})]})]})]})]})}function ns(i){"@babel/helpers - typeof";return ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ns(i)}var Qu=Uint8Array,Mc=Uint16Array,mx=Int32Array,gx=new Qu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yx=new Qu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),H4=new Qu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yS=function(i,t){for(var r=new Mc(31),a=0;a<31;++a)r[a]=t+=1<<i[a-1];for(var n=new mx(r[30]),a=1;a<30;++a)for(var e=r[a];e<r[a+1];++e)n[e]=e-r[a]<<5|a;return{b:r,r:n}},vS=yS(gx,2),O9=vS.b,Nv=vS.r;O9[28]=258,Nv[258]=28;var L9=yS(yx,0),z4=L9.r,Tv=new Mc(32768);for(var Gs=0;Gs<32768;++Gs){var hf=(Gs&43690)>>1|(Gs&21845)<<1;hf=(hf&52428)>>2|(hf&13107)<<2,hf=(hf&61680)>>4|(hf&3855)<<4,Tv[Gs]=((hf&65280)>>8|(hf&255)<<8)>>1}var Dm=(function(i,t,r){for(var a=i.length,n=0,e=new Mc(t);n<a;++n)i[n]&&++e[i[n]-1];var p=new Mc(t);for(n=1;n<t;++n)p[n]=p[n-1]+e[n-1]<<1;var m;if(r){m=new Mc(1<<t);var y=15-t;for(n=0;n<a;++n)if(i[n])for(var w=n<<4|i[n],A=t-i[n],I=p[i[n]-1]++<<A,R=I|(1<<A)-1;I<=R;++I)m[Tv[I]>>y]=w}else for(m=new Mc(a),n=0;n<a;++n)i[n]&&(m[n]=Tv[p[i[n]-1]++]>>15-i[n]);return m}),R0=new Qu(288);for(var Gs=0;Gs<144;++Gs)R0[Gs]=8;for(var Gs=144;Gs<256;++Gs)R0[Gs]=9;for(var Gs=256;Gs<280;++Gs)R0[Gs]=7;for(var Gs=280;Gs<288;++Gs)R0[Gs]=8;var cy=new Qu(32);for(var Gs=0;Gs<32;++Gs)cy[Gs]=5;var P9=Dm(R0,9,0),M9=Dm(cy,5,0),bS=function(i){return(i+7)/8|0},U9=function(i,t,r){return(r==null||r>i.length)&&(r=i.length),new Qu(i.subarray(t,r))},hd=function(i,t,r){r<<=t&7;var a=t/8|0;i[a]|=r,i[a+1]|=r>>8},wm=function(i,t,r){r<<=t&7;var a=t/8|0;i[a]|=r,i[a+1]|=r>>8,i[a+2]|=r>>16},v5=function(i,t){for(var r=[],a=0;a<i.length;++a)i[a]&&r.push({s:a,f:i[a]});var n=r.length,e=r.slice();if(!n)return{t:wS,l:0};if(n==1){var p=new Qu(r[0].s+1);return p[r[0].s]=1,{t:p,l:1}}r.sort(function(xe,ve){return xe.f-ve.f}),r.push({s:-1,f:25001});var m=r[0],y=r[1],w=0,A=1,I=2;for(r[0]={s:-1,f:m.f+y.f,l:m,r:y};A!=n-1;)m=r[r[w].f<r[I].f?w++:I++],y=r[w!=A&&r[w].f<r[I].f?w++:I++],r[A++]={s:-1,f:m.f+y.f,l:m,r:y};for(var R=e[0].s,a=1;a<n;++a)e[a].s>R&&(R=e[a].s);var k=new Mc(R+1),M=Ev(r[A-1],k,0);if(M>t){var a=0,V=0,q=M-t,U=1<<q;for(e.sort(function(ve,De){return k[De.s]-k[ve.s]||ve.f-De.f});a<n;++a){var te=e[a].s;if(k[te]>t)V+=U-(1<<M-k[te]),k[te]=t;else break}for(V>>=q;V>0;){var W=e[a].s;k[W]<t?V-=1<<t-k[W]++-1:++a}for(;a>=0&&V;--a){var re=e[a].s;k[re]==t&&(--k[re],++V)}M=t}return{t:new Qu(k),l:M}},Ev=function(i,t,r){return i.s==-1?Math.max(Ev(i.l,t,r+1),Ev(i.r,t,r+1)):t[i.s]=r},$4=function(i){for(var t=i.length;t&&!i[--t];);for(var r=new Mc(++t),a=0,n=i[0],e=1,p=function(y){r[a++]=y},m=1;m<=t;++m)if(i[m]==n&&m!=t)++e;else{if(!n&&e>2){for(;e>138;e-=138)p(32754);e>2&&(p(e>10?e-11<<5|28690:e-3<<5|12305),e=0)}else if(e>3){for(p(n),--e;e>6;e-=6)p(8304);e>2&&(p(e-3<<5|8208),e=0)}for(;e--;)p(n);e=1,n=i[m]}return{c:r.subarray(0,a),n:t}},Sm=function(i,t){for(var r=0,a=0;a<t.length;++a)r+=i[a]*t[a];return r},xS=function(i,t,r){var a=r.length,n=bS(t+2);i[n]=a&255,i[n+1]=a>>8,i[n+2]=i[n]^255,i[n+3]=i[n+1]^255;for(var e=0;e<a;++e)i[n+e+4]=r[e];return(n+4+a)*8},q4=function(i,t,r,a,n,e,p,m,y,w,A){hd(t,A++,r),++n[256];for(var I=v5(n,15),R=I.t,k=I.l,M=v5(e,15),V=M.t,q=M.l,U=$4(R),te=U.c,W=U.n,re=$4(V),xe=re.c,ve=re.n,De=new Mc(19),ke=0;ke<te.length;++ke)++De[te[ke]&31];for(var ke=0;ke<xe.length;++ke)++De[xe[ke]&31];for(var de=v5(De,7),Oe=de.t,z=de.l,K=19;K>4&&!Oe[H4[K-1]];--K);var Ae=w+5<<3,Ce=Sm(n,R0)+Sm(e,cy)+p,Be=Sm(n,R)+Sm(e,V)+p+14+3*K+Sm(De,Oe)+2*De[16]+3*De[17]+7*De[18];if(y>=0&&Ae<=Ce&&Ae<=Be)return xS(t,A,i.subarray(y,y+w));var Ee,Pe,Ue,_e;if(hd(t,A,1+(Be<Ce)),A+=2,Be<Ce){Ee=Dm(R,k,0),Pe=R,Ue=Dm(V,q,0),_e=V;var Le=Dm(Oe,z,0);hd(t,A,W-257),hd(t,A+5,ve-1),hd(t,A+10,K-4),A+=14;for(var ke=0;ke<K;++ke)hd(t,A+3*ke,Oe[H4[ke]]);A+=3*K;for(var X=[te,xe],H=0;H<2;++H)for(var ae=X[H],ke=0;ke<ae.length;++ke){var Z=ae[ke]&31;hd(t,A,Le[Z]),A+=Oe[Z],Z>15&&(hd(t,A,ae[ke]>>5&127),A+=ae[ke]>>12)}}else Ee=P9,Pe=R0,Ue=M9,_e=cy;for(var ke=0;ke<m;++ke){var se=a[ke];if(se>255){var Z=se>>18&31;wm(t,A,Ee[Z+257]),A+=Pe[Z+257],Z>7&&(hd(t,A,se>>23&31),A+=gx[Z]);var ye=se&31;wm(t,A,Ue[ye]),A+=_e[ye],ye>3&&(wm(t,A,se>>5&8191),A+=yx[ye])}else wm(t,A,Ee[se]),A+=Pe[se]}return wm(t,A,Ee[256]),A+Pe[256]},B9=new mx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),wS=new Qu(0),H9=function(i,t,r,a,n,e){var p=e.z||i.length,m=new Qu(a+p+5*(1+Math.ceil(p/7e3))+n),y=m.subarray(a,m.length-n),w=e.l,A=(e.r||0)&7;if(t){A&&(y[0]=e.r>>3);for(var I=B9[t-1],R=I>>13,k=I&8191,M=(1<<r)-1,V=e.p||new Mc(32768),q=e.h||new Mc(M+1),U=Math.ceil(r/3),te=2*U,W=function(Ft){return(i[Ft]^i[Ft+1]<<U^i[Ft+2]<<te)&M},re=new mx(25e3),xe=new Mc(288),ve=new Mc(32),De=0,ke=0,de=e.i||0,Oe=0,z=e.w||0,K=0;de+2<p;++de){var Ae=W(de),Ce=de&32767,Be=q[Ae];if(V[Ce]=Be,q[Ae]=Ce,z<=de){var Ee=p-de;if((De>7e3||Oe>24576)&&(Ee>423||!w)){A=q4(i,y,0,re,xe,ve,ke,Oe,K,de-K,A),Oe=De=ke=0,K=de;for(var Pe=0;Pe<286;++Pe)xe[Pe]=0;for(var Pe=0;Pe<30;++Pe)ve[Pe]=0}var Ue=2,_e=0,Le=k,X=Ce-Be&32767;if(Ee>2&&Ae==W(de-X))for(var H=Math.min(R,Ee)-1,ae=Math.min(32767,de),Z=Math.min(258,Ee);X<=ae&&--Le&&Ce!=Be;){if(i[de+Ue]==i[de+Ue-X]){for(var se=0;se<Z&&i[de+se]==i[de+se-X];++se);if(se>Ue){if(Ue=se,_e=X,se>H)break;for(var ye=Math.min(X,se-2),ce=0,Pe=0;Pe<ye;++Pe){var ze=de-X+Pe&32767,pe=V[ze],Ve=ze-pe&32767;Ve>ce&&(ce=Ve,Be=ze)}}}Ce=Be,Be=V[Ce],X+=Ce-Be&32767}if(_e){re[Oe++]=268435456|Nv[Ue]<<18|z4[_e];var yt=Nv[Ue]&31,vt=z4[_e]&31;ke+=gx[yt]+yx[vt],++xe[257+yt],++ve[vt],z=de+Ue,++De}else re[Oe++]=i[de],++xe[i[de]]}}for(de=Math.max(de,z);de<p;++de)re[Oe++]=i[de],++xe[i[de]];A=q4(i,y,w,re,xe,ve,ke,Oe,K,de-K,A),w||(e.r=A&7|y[A/8|0]<<3,A-=7,e.h=q,e.p=V,e.i=de,e.w=z)}else{for(var de=e.w||0;de<p+w;de+=65535){var bt=de+65535;bt>=p&&(y[A/8|0]=w,bt=p),A=xS(y,A+1,i.subarray(de,bt))}e.i=p}return U9(m,0,a+bS(A)+n)},SS=function(){var i=1,t=0;return{p:function(r){for(var a=i,n=t,e=r.length|0,p=0;p!=e;){for(var m=Math.min(p+2655,e);p<m;++p)n+=a+=r[p];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}i=a,t=n},d:function(){return i%=65521,t%=65521,(i&255)<<24|(i&65280)<<8|(t&255)<<8|t>>8}}},z9=function(i,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var e=t.dictionary.subarray(-32768),p=new Qu(e.length+i.length);p.set(e),p.set(i,e.length),i=p,n.w=e.length}return H9(i,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+t.mem,r,a,n)},AS=function(i,t,r){for(;r;++t)i[t]=r,r>>>=8},$9=function(i,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(i[0]=120,i[1]=a<<6|(t.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,t.dictionary){var n=SS();n.p(t.dictionary),AS(i,2,n.d())}};function kv(i,t){t||(t={});var r=SS();r.p(i);var a=z9(i,t,t.dictionary?6:2,4);return $9(a,t),AS(a,a.length-4,r.d()),a}var q9=typeof TextDecoder<"u"&&new TextDecoder,G9=0;try{q9.decode(wS,{stream:!0}),G9=1}catch{}function V9(i){if(Array.isArray(i))return i}function W9(i,t){var r=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(r!=null){var a,n,e,p,m=[],y=!0,w=!1;try{if(e=(r=r.call(i)).next,t!==0)for(;!(y=(a=e.call(r)).done)&&(m.push(a.value),m.length!==t);y=!0);}catch(A){w=!0,n=A}finally{try{if(!y&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(w)throw n}}return m}}function G4(i,t){(t==null||t>i.length)&&(t=i.length);for(var r=0,a=Array(t);r<t;r++)a[r]=i[r];return a}function K9(i,t){if(i){if(typeof i=="string")return G4(i,t);var r={}.toString.call(i).slice(8,-1);return r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set"?Array.from(i):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G4(i,t):void 0}}function Y9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V4(i,t){return V9(i)||W9(i,t)||K9(i,t)||Y9()}function W4(i,t="utf8"){return new TextDecoder(t).decode(i)}const J9=new TextEncoder;function Q9(i){return J9.encode(i)}const X9=1024*8,Z9=(()=>{const i=new Uint8Array(4),t=new Uint32Array(i.buffer);return!((t[0]=1)&i[0])})(),b5={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class vx{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(t=X9,r={}){let a=!1;typeof t=="number"?t=new ArrayBuffer(t):(a=!0,this.lastWrittenByte=t.byteLength);const n=r.offset?r.offset>>>0:0,e=t.byteLength-n;let p=n;(ArrayBuffer.isView(t)||t instanceof vx)&&(t.byteLength!==t.buffer.byteLength&&(p=t.byteOffset+n),t=t.buffer),a?this.lastWrittenByte=e:this.lastWrittenByte=0,this.buffer=t,this.length=e,this.byteLength=e,this.byteOffset=p,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,p,e),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const a=(this.offset+t)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const a=b5[r].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,e=this.buffer.slice(n,n+a);if(this.littleEndian===Z9&&r!=="uint8"&&r!=="int8"){const m=new Uint8Array(this.buffer.slice(n,n+a));m.reverse();const y=new b5[r](m.buffer);return this.offset+=a,y.reverse(),y}const p=new b5[r](e);return this.offset+=a,p}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let a=0;a<t;a++)r+=this.readChar();return r}readUtf8(t=1){return W4(this.readBytes(t))}decodeText(t=1,r="utf8"){return W4(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Q9(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function vp(i){let t=i.length;for(;--t>=0;)i[t]=0}const eI=3,tI=258,CS=29,rI=256,nI=rI+1+CS,NS=30,aI=512,sI=new Array((nI+2)*2);vp(sI);const iI=new Array(NS*2);vp(iI);const oI=new Array(aI);vp(oI);const lI=new Array(tI-eI+1);vp(lI);const cI=new Array(CS);vp(cI);const uI=new Array(NS);vp(uI);const hI=(i,t,r,a)=>{let n=i&65535|0,e=i>>>16&65535|0,p=0;for(;r!==0;){p=r>2e3?2e3:r,r-=p;do n=n+t[a++]|0,e=e+n|0;while(--p);n%=65521,e%=65521}return n|e<<16|0};var _v=hI;const dI=()=>{let i,t=[];for(var r=0;r<256;r++){i=r;for(var a=0;a<8;a++)i=i&1?3988292384^i>>>1:i>>>1;t[r]=i}return t},fI=new Uint32Array(dI()),pI=(i,t,r,a)=>{const n=fI,e=a+r;i^=-1;for(let p=a;p<e;p++)i=i>>>8^n[(i^t[p])&255];return i^-1};var Nh=pI,Iv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},TS={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const mI=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var gI=function(i){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)mI(r,a)&&(i[a]=r[a])}}return i},yI=i=>{let t=0;for(let a=0,n=i.length;a<n;a++)t+=i[a].length;const r=new Uint8Array(t);for(let a=0,n=0,e=i.length;a<e;a++){let p=i[a];r.set(p,n),n+=p.length}return r},ES={assign:gI,flattenChunks:yI};let kS=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{kS=!1}const zm=new Uint8Array(256);for(let i=0;i<256;i++)zm[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;zm[254]=zm[254]=1;var vI=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,r,a,n,e,p=i.length,m=0;for(n=0;n<p;n++)r=i.charCodeAt(n),(r&64512)===55296&&n+1<p&&(a=i.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),m+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(m),e=0,n=0;e<m;n++)r=i.charCodeAt(n),(r&64512)===55296&&n+1<p&&(a=i.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?t[e++]=r:r<2048?(t[e++]=192|r>>>6,t[e++]=128|r&63):r<65536?(t[e++]=224|r>>>12,t[e++]=128|r>>>6&63,t[e++]=128|r&63):(t[e++]=240|r>>>18,t[e++]=128|r>>>12&63,t[e++]=128|r>>>6&63,t[e++]=128|r&63);return t};const bI=(i,t)=>{if(t<65534&&i.subarray&&kS)return String.fromCharCode.apply(null,i.length===t?i:i.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(i[a]);return r};var xI=(i,t)=>{const r=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let a,n;const e=new Array(r*2);for(n=0,a=0;a<r;){let p=i[a++];if(p<128){e[n++]=p;continue}let m=zm[p];if(m>4){e[n++]=65533,a+=m-1;continue}for(p&=m===2?31:m===3?15:7;m>1&&a<r;)p=p<<6|i[a++]&63,m--;if(m>1){e[n++]=65533;continue}p<65536?e[n++]=p:(p-=65536,e[n++]=55296|p>>10&1023,e[n++]=56320|p&1023)}return bI(e,n)},wI=(i,t)=>{t=t||i.length,t>i.length&&(t=i.length);let r=t-1;for(;r>=0&&(i[r]&192)===128;)r--;return r<0||r===0?t:r+zm[i[r]]>t?r:t},Dv={string2buf:vI,buf2string:xI,utf8border:wI};function SI(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var AI=SI;const i2=16209,CI=16191;var NI=function(t,r){let a,n,e,p,m,y,w,A,I,R,k,M,V,q,U,te,W,re,xe,ve,De,ke,de,Oe;const z=t.state;a=t.next_in,de=t.input,n=a+(t.avail_in-5),e=t.next_out,Oe=t.output,p=e-(r-t.avail_out),m=e+(t.avail_out-257),y=z.dmax,w=z.wsize,A=z.whave,I=z.wnext,R=z.window,k=z.hold,M=z.bits,V=z.lencode,q=z.distcode,U=(1<<z.lenbits)-1,te=(1<<z.distbits)-1;e:do{M<15&&(k+=de[a++]<<M,M+=8,k+=de[a++]<<M,M+=8),W=V[k&U];t:for(;;){if(re=W>>>24,k>>>=re,M-=re,re=W>>>16&255,re===0)Oe[e++]=W&65535;else if(re&16){xe=W&65535,re&=15,re&&(M<re&&(k+=de[a++]<<M,M+=8),xe+=k&(1<<re)-1,k>>>=re,M-=re),M<15&&(k+=de[a++]<<M,M+=8,k+=de[a++]<<M,M+=8),W=q[k&te];r:for(;;){if(re=W>>>24,k>>>=re,M-=re,re=W>>>16&255,re&16){if(ve=W&65535,re&=15,M<re&&(k+=de[a++]<<M,M+=8,M<re&&(k+=de[a++]<<M,M+=8)),ve+=k&(1<<re)-1,ve>y){t.msg="invalid distance too far back",z.mode=i2;break e}if(k>>>=re,M-=re,re=e-p,ve>re){if(re=ve-re,re>A&&z.sane){t.msg="invalid distance too far back",z.mode=i2;break e}if(De=0,ke=R,I===0){if(De+=w-re,re<xe){xe-=re;do Oe[e++]=R[De++];while(--re);De=e-ve,ke=Oe}}else if(I<re){if(De+=w+I-re,re-=I,re<xe){xe-=re;do Oe[e++]=R[De++];while(--re);if(De=0,I<xe){re=I,xe-=re;do Oe[e++]=R[De++];while(--re);De=e-ve,ke=Oe}}}else if(De+=I-re,re<xe){xe-=re;do Oe[e++]=R[De++];while(--re);De=e-ve,ke=Oe}for(;xe>2;)Oe[e++]=ke[De++],Oe[e++]=ke[De++],Oe[e++]=ke[De++],xe-=3;xe&&(Oe[e++]=ke[De++],xe>1&&(Oe[e++]=ke[De++]))}else{De=e-ve;do Oe[e++]=Oe[De++],Oe[e++]=Oe[De++],Oe[e++]=Oe[De++],xe-=3;while(xe>2);xe&&(Oe[e++]=Oe[De++],xe>1&&(Oe[e++]=Oe[De++]))}}else if((re&64)===0){W=q[(W&65535)+(k&(1<<re)-1)];continue r}else{t.msg="invalid distance code",z.mode=i2;break e}break}}else if((re&64)===0){W=V[(W&65535)+(k&(1<<re)-1)];continue t}else if(re&32){z.mode=CI;break e}else{t.msg="invalid literal/length code",z.mode=i2;break e}break}}while(a<n&&e<m);xe=M>>3,a-=xe,M-=xe<<3,k&=(1<<M)-1,t.next_in=a,t.next_out=e,t.avail_in=a<n?5+(n-a):5-(a-n),t.avail_out=e<m?257+(m-e):257-(e-m),z.hold=k,z.bits=M};const j1=15,K4=852,Y4=592,J4=0,x5=1,Q4=2,TI=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),EI=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),kI=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),_I=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),II=(i,t,r,a,n,e,p,m)=>{const y=m.bits;let w=0,A=0,I=0,R=0,k=0,M=0,V=0,q=0,U=0,te=0,W,re,xe,ve,De,ke=null,de;const Oe=new Uint16Array(j1+1),z=new Uint16Array(j1+1);let K=null,Ae,Ce,Be;for(w=0;w<=j1;w++)Oe[w]=0;for(A=0;A<a;A++)Oe[t[r+A]]++;for(k=y,R=j1;R>=1&&Oe[R]===0;R--);if(k>R&&(k=R),R===0)return n[e++]=1<<24|64<<16|0,n[e++]=1<<24|64<<16|0,m.bits=1,0;for(I=1;I<R&&Oe[I]===0;I++);for(k<I&&(k=I),q=1,w=1;w<=j1;w++)if(q<<=1,q-=Oe[w],q<0)return-1;if(q>0&&(i===J4||R!==1))return-1;for(z[1]=0,w=1;w<j1;w++)z[w+1]=z[w]+Oe[w];for(A=0;A<a;A++)t[r+A]!==0&&(p[z[t[r+A]]++]=A);if(i===J4?(ke=K=p,de=20):i===x5?(ke=TI,K=EI,de=257):(ke=kI,K=_I,de=0),te=0,A=0,w=I,De=e,M=k,V=0,xe=-1,U=1<<k,ve=U-1,i===x5&&U>K4||i===Q4&&U>Y4)return 1;for(;;){Ae=w-V,p[A]+1<de?(Ce=0,Be=p[A]):p[A]>=de?(Ce=K[p[A]-de],Be=ke[p[A]-de]):(Ce=96,Be=0),W=1<<w-V,re=1<<M,I=re;do re-=W,n[De+(te>>V)+re]=Ae<<24|Ce<<16|Be|0;while(re!==0);for(W=1<<w-1;te&W;)W>>=1;if(W!==0?(te&=W-1,te+=W):te=0,A++,--Oe[w]===0){if(w===R)break;w=t[r+p[A]]}if(w>k&&(te&ve)!==xe){for(V===0&&(V=k),De+=I,M=w-V,q=1<<M;M+V<R&&(q-=Oe[M+V],!(q<=0));)M++,q<<=1;if(U+=1<<M,i===x5&&U>K4||i===Q4&&U>Y4)return 1;xe=te&ve,n[xe]=k<<24|M<<16|De-e|0}}return te!==0&&(n[De+te]=w-V<<24|64<<16|0),m.bits=k,0};var Fm=II;const DI=0,_S=1,IS=2,{Z_FINISH:X4,Z_BLOCK:FI,Z_TREES:o2,Z_OK:j0,Z_STREAM_END:RI,Z_NEED_DICT:jI,Z_STREAM_ERROR:hu,Z_DATA_ERROR:DS,Z_MEM_ERROR:FS,Z_BUF_ERROR:OI,Z_DEFLATED:Z4}=TS,zy=16180,e3=16181,t3=16182,r3=16183,n3=16184,a3=16185,s3=16186,i3=16187,o3=16188,l3=16189,uy=16190,dd=16191,w5=16192,c3=16193,S5=16194,u3=16195,h3=16196,d3=16197,f3=16198,l2=16199,c2=16200,p3=16201,m3=16202,g3=16203,y3=16204,v3=16205,A5=16206,b3=16207,x3=16208,Js=16209,RS=16210,jS=16211,LI=852,PI=592,MI=15,UI=MI,w3=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function BI(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const P0=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.mode<zy||t.mode>jS?1:0},OS=i=>{if(P0(i))return hu;const t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=t.wrap&1),t.mode=zy,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(LI),t.distcode=t.distdyn=new Int32Array(PI),t.sane=1,t.back=-1,j0},LS=i=>{if(P0(i))return hu;const t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,OS(i)},PS=(i,t)=>{let r;if(P0(i))return hu;const a=i.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?hu:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,LS(i))},MS=(i,t)=>{if(!i)return hu;const r=new BI;i.state=r,r.strm=i,r.window=null,r.mode=zy;const a=PS(i,t);return a!==j0&&(i.state=null),a},HI=i=>MS(i,UI);let S3=!0,C5,N5;const zI=i=>{if(S3){C5=new Int32Array(512),N5=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(Fm(_S,i.lens,0,288,C5,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;Fm(IS,i.lens,0,32,N5,0,i.work,{bits:5}),S3=!1}i.lencode=C5,i.lenbits=9,i.distcode=N5,i.distbits=5},US=(i,t,r,a)=>{let n;const e=i.state;return e.window===null&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new Uint8Array(e.wsize)),a>=e.wsize?(e.window.set(t.subarray(r-e.wsize,r),0),e.wnext=0,e.whave=e.wsize):(n=e.wsize-e.wnext,n>a&&(n=a),e.window.set(t.subarray(r-a,r-a+n),e.wnext),a-=n,a?(e.window.set(t.subarray(r-a,r),0),e.wnext=a,e.whave=e.wsize):(e.wnext+=n,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=n))),0},$I=(i,t)=>{let r,a,n,e,p,m,y,w,A,I,R,k,M,V,q=0,U,te,W,re,xe,ve,De,ke;const de=new Uint8Array(4);let Oe,z;const K=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(P0(i)||!i.output||!i.input&&i.avail_in!==0)return hu;r=i.state,r.mode===dd&&(r.mode=w5),p=i.next_out,n=i.output,y=i.avail_out,e=i.next_in,a=i.input,m=i.avail_in,w=r.hold,A=r.bits,I=m,R=y,ke=j0;e:for(;;)switch(r.mode){case zy:if(r.wrap===0){r.mode=w5;break}for(;A<16;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(r.wrap&2&&w===35615){r.wbits===0&&(r.wbits=15),r.check=0,de[0]=w&255,de[1]=w>>>8&255,r.check=Nh(r.check,de,2,0),w=0,A=0,r.mode=e3;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((w&255)<<8)+(w>>8))%31){i.msg="incorrect header check",r.mode=Js;break}if((w&15)!==Z4){i.msg="unknown compression method",r.mode=Js;break}if(w>>>=4,A-=4,De=(w&15)+8,r.wbits===0&&(r.wbits=De),De>15||De>r.wbits){i.msg="invalid window size",r.mode=Js;break}r.dmax=1<<r.wbits,r.flags=0,i.adler=r.check=1,r.mode=w&512?l3:dd,w=0,A=0;break;case e3:for(;A<16;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(r.flags=w,(r.flags&255)!==Z4){i.msg="unknown compression method",r.mode=Js;break}if(r.flags&57344){i.msg="unknown header flags set",r.mode=Js;break}r.head&&(r.head.text=w>>8&1),r.flags&512&&r.wrap&4&&(de[0]=w&255,de[1]=w>>>8&255,r.check=Nh(r.check,de,2,0)),w=0,A=0,r.mode=t3;case t3:for(;A<32;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}r.head&&(r.head.time=w),r.flags&512&&r.wrap&4&&(de[0]=w&255,de[1]=w>>>8&255,de[2]=w>>>16&255,de[3]=w>>>24&255,r.check=Nh(r.check,de,4,0)),w=0,A=0,r.mode=r3;case r3:for(;A<16;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}r.head&&(r.head.xflags=w&255,r.head.os=w>>8),r.flags&512&&r.wrap&4&&(de[0]=w&255,de[1]=w>>>8&255,r.check=Nh(r.check,de,2,0)),w=0,A=0,r.mode=n3;case n3:if(r.flags&1024){for(;A<16;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}r.length=w,r.head&&(r.head.extra_len=w),r.flags&512&&r.wrap&4&&(de[0]=w&255,de[1]=w>>>8&255,r.check=Nh(r.check,de,2,0)),w=0,A=0}else r.head&&(r.head.extra=null);r.mode=a3;case a3:if(r.flags&1024&&(k=r.length,k>m&&(k=m),k&&(r.head&&(De=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(e,e+k),De)),r.flags&512&&r.wrap&4&&(r.check=Nh(r.check,a,k,e)),m-=k,e+=k,r.length-=k),r.length))break e;r.length=0,r.mode=s3;case s3:if(r.flags&2048){if(m===0)break e;k=0;do De=a[e+k++],r.head&&De&&r.length<65536&&(r.head.name+=String.fromCharCode(De));while(De&&k<m);if(r.flags&512&&r.wrap&4&&(r.check=Nh(r.check,a,k,e)),m-=k,e+=k,De)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=i3;case i3:if(r.flags&4096){if(m===0)break e;k=0;do De=a[e+k++],r.head&&De&&r.length<65536&&(r.head.comment+=String.fromCharCode(De));while(De&&k<m);if(r.flags&512&&r.wrap&4&&(r.check=Nh(r.check,a,k,e)),m-=k,e+=k,De)break e}else r.head&&(r.head.comment=null);r.mode=o3;case o3:if(r.flags&512){for(;A<16;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(r.wrap&4&&w!==(r.check&65535)){i.msg="header crc mismatch",r.mode=Js;break}w=0,A=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),i.adler=r.check=0,r.mode=dd;break;case l3:for(;A<32;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}i.adler=r.check=w3(w),w=0,A=0,r.mode=uy;case uy:if(r.havedict===0)return i.next_out=p,i.avail_out=y,i.next_in=e,i.avail_in=m,r.hold=w,r.bits=A,jI;i.adler=r.check=1,r.mode=dd;case dd:if(t===FI||t===o2)break e;case w5:if(r.last){w>>>=A&7,A-=A&7,r.mode=A5;break}for(;A<3;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}switch(r.last=w&1,w>>>=1,A-=1,w&3){case 0:r.mode=c3;break;case 1:if(zI(r),r.mode=l2,t===o2){w>>>=2,A-=2;break e}break;case 2:r.mode=h3;break;case 3:i.msg="invalid block type",r.mode=Js}w>>>=2,A-=2;break;case c3:for(w>>>=A&7,A-=A&7;A<32;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if((w&65535)!==(w>>>16^65535)){i.msg="invalid stored block lengths",r.mode=Js;break}if(r.length=w&65535,w=0,A=0,r.mode=S5,t===o2)break e;case S5:r.mode=u3;case u3:if(k=r.length,k){if(k>m&&(k=m),k>y&&(k=y),k===0)break e;n.set(a.subarray(e,e+k),p),m-=k,e+=k,y-=k,p+=k,r.length-=k;break}r.mode=dd;break;case h3:for(;A<14;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(r.nlen=(w&31)+257,w>>>=5,A-=5,r.ndist=(w&31)+1,w>>>=5,A-=5,r.ncode=(w&15)+4,w>>>=4,A-=4,r.nlen>286||r.ndist>30){i.msg="too many length or distance symbols",r.mode=Js;break}r.have=0,r.mode=d3;case d3:for(;r.have<r.ncode;){for(;A<3;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}r.lens[K[r.have++]]=w&7,w>>>=3,A-=3}for(;r.have<19;)r.lens[K[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Oe={bits:r.lenbits},ke=Fm(DI,r.lens,0,19,r.lencode,0,r.work,Oe),r.lenbits=Oe.bits,ke){i.msg="invalid code lengths set",r.mode=Js;break}r.have=0,r.mode=f3;case f3:for(;r.have<r.nlen+r.ndist;){for(;q=r.lencode[w&(1<<r.lenbits)-1],U=q>>>24,te=q>>>16&255,W=q&65535,!(U<=A);){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(W<16)w>>>=U,A-=U,r.lens[r.have++]=W;else{if(W===16){for(z=U+2;A<z;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(w>>>=U,A-=U,r.have===0){i.msg="invalid bit length repeat",r.mode=Js;break}De=r.lens[r.have-1],k=3+(w&3),w>>>=2,A-=2}else if(W===17){for(z=U+3;A<z;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}w>>>=U,A-=U,De=0,k=3+(w&7),w>>>=3,A-=3}else{for(z=U+7;A<z;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}w>>>=U,A-=U,De=0,k=11+(w&127),w>>>=7,A-=7}if(r.have+k>r.nlen+r.ndist){i.msg="invalid bit length repeat",r.mode=Js;break}for(;k--;)r.lens[r.have++]=De}}if(r.mode===Js)break;if(r.lens[256]===0){i.msg="invalid code -- missing end-of-block",r.mode=Js;break}if(r.lenbits=9,Oe={bits:r.lenbits},ke=Fm(_S,r.lens,0,r.nlen,r.lencode,0,r.work,Oe),r.lenbits=Oe.bits,ke){i.msg="invalid literal/lengths set",r.mode=Js;break}if(r.distbits=6,r.distcode=r.distdyn,Oe={bits:r.distbits},ke=Fm(IS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Oe),r.distbits=Oe.bits,ke){i.msg="invalid distances set",r.mode=Js;break}if(r.mode=l2,t===o2)break e;case l2:r.mode=c2;case c2:if(m>=6&&y>=258){i.next_out=p,i.avail_out=y,i.next_in=e,i.avail_in=m,r.hold=w,r.bits=A,NI(i,R),p=i.next_out,n=i.output,y=i.avail_out,e=i.next_in,a=i.input,m=i.avail_in,w=r.hold,A=r.bits,r.mode===dd&&(r.back=-1);break}for(r.back=0;q=r.lencode[w&(1<<r.lenbits)-1],U=q>>>24,te=q>>>16&255,W=q&65535,!(U<=A);){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(te&&(te&240)===0){for(re=U,xe=te,ve=W;q=r.lencode[ve+((w&(1<<re+xe)-1)>>re)],U=q>>>24,te=q>>>16&255,W=q&65535,!(re+U<=A);){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}w>>>=re,A-=re,r.back+=re}if(w>>>=U,A-=U,r.back+=U,r.length=W,te===0){r.mode=v3;break}if(te&32){r.back=-1,r.mode=dd;break}if(te&64){i.msg="invalid literal/length code",r.mode=Js;break}r.extra=te&15,r.mode=p3;case p3:if(r.extra){for(z=r.extra;A<z;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}r.length+=w&(1<<r.extra)-1,w>>>=r.extra,A-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=m3;case m3:for(;q=r.distcode[w&(1<<r.distbits)-1],U=q>>>24,te=q>>>16&255,W=q&65535,!(U<=A);){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if((te&240)===0){for(re=U,xe=te,ve=W;q=r.distcode[ve+((w&(1<<re+xe)-1)>>re)],U=q>>>24,te=q>>>16&255,W=q&65535,!(re+U<=A);){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}w>>>=re,A-=re,r.back+=re}if(w>>>=U,A-=U,r.back+=U,te&64){i.msg="invalid distance code",r.mode=Js;break}r.offset=W,r.extra=te&15,r.mode=g3;case g3:if(r.extra){for(z=r.extra;A<z;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}r.offset+=w&(1<<r.extra)-1,w>>>=r.extra,A-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){i.msg="invalid distance too far back",r.mode=Js;break}r.mode=y3;case y3:if(y===0)break e;if(k=R-y,r.offset>k){if(k=r.offset-k,k>r.whave&&r.sane){i.msg="invalid distance too far back",r.mode=Js;break}k>r.wnext?(k-=r.wnext,M=r.wsize-k):M=r.wnext-k,k>r.length&&(k=r.length),V=r.window}else V=n,M=p-r.offset,k=r.length;k>y&&(k=y),y-=k,r.length-=k;do n[p++]=V[M++];while(--k);r.length===0&&(r.mode=c2);break;case v3:if(y===0)break e;n[p++]=r.length,y--,r.mode=c2;break;case A5:if(r.wrap){for(;A<32;){if(m===0)break e;m--,w|=a[e++]<<A,A+=8}if(R-=y,i.total_out+=R,r.total+=R,r.wrap&4&&R&&(i.adler=r.check=r.flags?Nh(r.check,n,R,p-R):_v(r.check,n,R,p-R)),R=y,r.wrap&4&&(r.flags?w:w3(w))!==r.check){i.msg="incorrect data check",r.mode=Js;break}w=0,A=0}r.mode=b3;case b3:if(r.wrap&&r.flags){for(;A<32;){if(m===0)break e;m--,w+=a[e++]<<A,A+=8}if(r.wrap&4&&w!==(r.total&4294967295)){i.msg="incorrect length check",r.mode=Js;break}w=0,A=0}r.mode=x3;case x3:ke=RI;break e;case Js:ke=DS;break e;case RS:return FS;case jS:default:return hu}return i.next_out=p,i.avail_out=y,i.next_in=e,i.avail_in=m,r.hold=w,r.bits=A,(r.wsize||R!==i.avail_out&&r.mode<Js&&(r.mode<A5||t!==X4))&&US(i,i.output,i.next_out,R-i.avail_out),I-=i.avail_in,R-=i.avail_out,i.total_in+=I,i.total_out+=R,r.total+=R,r.wrap&4&&R&&(i.adler=r.check=r.flags?Nh(r.check,n,R,i.next_out-R):_v(r.check,n,R,i.next_out-R)),i.data_type=r.bits+(r.last?64:0)+(r.mode===dd?128:0)+(r.mode===l2||r.mode===S5?256:0),(I===0&&R===0||t===X4)&&ke===j0&&(ke=OI),ke},qI=i=>{if(P0(i))return hu;let t=i.state;return t.window&&(t.window=null),i.state=null,j0},GI=(i,t)=>{if(P0(i))return hu;const r=i.state;return(r.wrap&2)===0?hu:(r.head=t,t.done=!1,j0)},VI=(i,t)=>{const r=t.length;let a,n,e;return P0(i)||(a=i.state,a.wrap!==0&&a.mode!==uy)?hu:a.mode===uy&&(n=1,n=_v(n,t,r,0),n!==a.check)?DS:(e=US(i,t,r,r),e?(a.mode=RS,FS):(a.havedict=1,j0))};var WI=LS,KI=PS,YI=OS,JI=HI,QI=MS,XI=$I,ZI=qI,eD=GI,tD=VI,rD="pako inflate (from Nodeca project)",pd={inflateReset:WI,inflateReset2:KI,inflateResetKeep:YI,inflateInit:JI,inflateInit2:QI,inflate:XI,inflateEnd:ZI,inflateGetHeader:eD,inflateSetDictionary:tD,inflateInfo:rD};function nD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var aD=nD;const BS=Object.prototype.toString,{Z_NO_FLUSH:sD,Z_FINISH:iD,Z_OK:$m,Z_STREAM_END:T5,Z_NEED_DICT:E5,Z_STREAM_ERROR:oD,Z_DATA_ERROR:A3,Z_MEM_ERROR:lD}=TS;function Qm(i){this.options=ES.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(i&&i.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new AI,this.strm.avail_out=0;let r=pd.inflateInit2(this.strm,t.windowBits);if(r!==$m)throw new Error(Iv[r]);if(this.header=new aD,pd.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Dv.string2buf(t.dictionary):BS.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=pd.inflateSetDictionary(this.strm,t.dictionary),r!==$m)))throw new Error(Iv[r])}Qm.prototype.push=function(i,t){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let e,p,m;if(this.ended)return!1;for(t===~~t?p=t:p=t===!0?iD:sD,BS.call(i)==="[object ArrayBuffer]"?r.input=new Uint8Array(i):r.input=i,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),e=pd.inflate(r,p),e===E5&&n&&(e=pd.inflateSetDictionary(r,n),e===$m?e=pd.inflate(r,p):e===A3&&(e=E5));r.avail_in>0&&e===T5&&r.state.wrap>0&&i[r.next_in]!==0;)pd.inflateReset(r),e=pd.inflate(r,p);switch(e){case oD:case A3:case E5:case lD:return this.onEnd(e),this.ended=!0,!1}if(m=r.avail_out,r.next_out&&(r.avail_out===0||e===T5))if(this.options.to==="string"){let y=Dv.utf8border(r.output,r.next_out),w=r.next_out-y,A=Dv.buf2string(r.output,y);r.next_out=w,r.avail_out=a-w,w&&r.output.set(r.output.subarray(y,y+w),0),this.onData(A)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(e===$m&&m===0)){if(e===T5)return e=pd.inflateEnd(this.strm),this.onEnd(e),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Qm.prototype.onData=function(i){this.chunks.push(i)};Qm.prototype.onEnd=function(i){i===$m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ES.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function cD(i,t){const r=new Qm(t);if(r.push(i),r.err)throw r.msg||Iv[r.err];return r.result}var uD=Qm,hD=cD,dD={Inflate:uD,inflate:hD};const{Inflate:fD,inflate:pD}=dD;var C3=fD,mD=pD;const HS=[];for(let i=0;i<256;i++){let t=i;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;HS[i]=t}const N3=4294967295;function gD(i,t,r){let a=i;for(let n=0;n<r;n++)a=HS[(a^t[n])&255]^a>>>8;return a}function yD(i,t){return(gD(N3,i,t)^N3)>>>0}function T3(i,t,r){const a=i.readUint32(),n=yD(new Uint8Array(i.buffer,i.byteOffset+i.offset-t-4,t),t);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function zS(i,t,r){for(let a=0;a<r;a++)t[a]=i[a]}function $S(i,t,r,a){let n=0;for(;n<a;n++)t[n]=i[n];for(;n<r;n++)t[n]=i[n]+t[n-a]&255}function qS(i,t,r,a){let n=0;if(r.length===0)for(;n<a;n++)t[n]=i[n];else for(;n<a;n++)t[n]=i[n]+r[n]&255}function GS(i,t,r,a,n){let e=0;if(r.length===0){for(;e<n;e++)t[e]=i[e];for(;e<a;e++)t[e]=i[e]+(t[e-n]>>1)&255}else{for(;e<n;e++)t[e]=i[e]+(r[e]>>1)&255;for(;e<a;e++)t[e]=i[e]+(t[e-n]+r[e]>>1)&255}}function VS(i,t,r,a,n){let e=0;if(r.length===0){for(;e<n;e++)t[e]=i[e];for(;e<a;e++)t[e]=i[e]+t[e-n]&255}else{for(;e<n;e++)t[e]=i[e]+r[e]&255;for(;e<a;e++)t[e]=i[e]+vD(t[e-n],r[e],r[e-n])&255}}function vD(i,t,r){const a=i+t-r,n=Math.abs(a-i),e=Math.abs(a-t),p=Math.abs(a-r);return n<=e&&n<=p?i:e<=p?t:r}function bD(i,t,r,a,n,e){switch(i){case 0:zS(t,r,n);break;case 1:$S(t,r,n,e);break;case 2:qS(t,r,a,n);break;case 3:GS(t,r,a,n,e);break;case 4:VS(t,r,a,n,e);break;default:throw new Error(`Unsupported filter: ${i}`)}}const xD=new Uint16Array([255]),wD=new Uint8Array(xD.buffer),SD=wD[0]===255;function AD(i){const{data:t,width:r,height:a,channels:n,depth:e}=i,p=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],m=Math.ceil(e/8)*n,y=new Uint8Array(a*r*m);let w=0;for(let A=0;A<7;A++){const I=p[A],R=Math.ceil((r-I.x)/I.xStep),k=Math.ceil((a-I.y)/I.yStep);if(R<=0||k<=0)continue;const M=R*m,V=new Uint8Array(M);for(let q=0;q<k;q++){const U=t[w++],te=t.subarray(w,w+M);w+=M;const W=new Uint8Array(M);bD(U,te,W,V,M,m),V.set(W);for(let re=0;re<R;re++){const xe=I.x+re*I.xStep,ve=I.y+q*I.yStep;if(!(xe>=r||ve>=a))for(let De=0;De<m;De++)y[(ve*r+xe)*m+De]=W[re*m+De]}}}if(e===16){const A=new Uint16Array(y.buffer);if(SD)for(let I=0;I<A.length;I++)A[I]=CD(A[I]);return A}else return y}function CD(i){return(i&255)<<8|i>>8&255}const ND=new Uint16Array([255]),TD=new Uint8Array(ND.buffer),ED=TD[0]===255,kD=new Uint8Array(0);function E3(i){const{data:t,width:r,height:a,channels:n,depth:e}=i,p=Math.ceil(e/8)*n,m=Math.ceil(e/8*n*r),y=new Uint8Array(a*m);let w=kD,A=0,I,R;for(let k=0;k<a;k++){switch(I=t.subarray(A+1,A+1+m),R=y.subarray(k*m,(k+1)*m),t[A]){case 0:zS(I,R,m);break;case 1:$S(I,R,m,p);break;case 2:qS(I,R,w,m);break;case 3:GS(I,R,w,m,p);break;case 4:VS(I,R,w,m,p);break;default:throw new Error(`Unsupported filter: ${t[A]}`)}w=R,A+=m+1}if(e===16){const k=new Uint16Array(y.buffer);if(ED)for(let M=0;M<k.length;M++)k[M]=_D(k[M]);return k}else return y}function _D(i){return(i&255)<<8|i>>8&255}const T2=Uint8Array.of(137,80,78,71,13,10,26,10);function k3(i){if(!ID(i.readBytes(T2.length)))throw new Error("wrong PNG signature")}function ID(i){if(i.length<T2.length)return!1;for(let t=0;t<T2.length;t++)if(i[t]!==T2[t])return!1;return!0}const DD="tEXt",FD=0,WS=new TextDecoder("latin1");function RD(i){if(OD(i),i.length===0||i.length>79)throw new Error("keyword length must be between 1 and 79")}const jD=/^[\u0000-\u00FF]*$/;function OD(i){if(!jD.test(i))throw new Error("invalid latin1 text")}function LD(i,t,r){const a=KS(t);i[a]=PD(t,r-a.length-1)}function KS(i){for(i.mark();i.readByte()!==FD;);const t=i.offset;i.reset();const r=WS.decode(i.readBytes(t-i.offset-1));return i.skip(1),RD(r),r}function PD(i,t){return WS.decode(i.readBytes(t))}const Oc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},k5={UNKNOWN:-1,DEFLATE:0},_3={UNKNOWN:-1,ADAPTIVE:0},_5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},u2={NONE:0,BACKGROUND:1,PREVIOUS:2},I5={SOURCE:0,OVER:1};class MD extends vx{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,r={}){super(t);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new C3,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=k5.UNKNOWN,this._filterMethod=_3.UNKNOWN,this._interlaceMethod=_5.UNKNOWN,this._colorType=Oc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(k3(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(k3(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case DD:LD(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?T3(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=a+t;break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?T3(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=UD(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case Oc.GREYSCALE:a=1;break;case Oc.TRUECOLOUR:a=3;break;case Oc.INDEXED_COLOUR:a=1;break;case Oc.GREYSCALE_ALPHA:a=2;break;case Oc.TRUECOLOUR_ALPHA:a=4;break;case Oc.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==k5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<r;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case Oc.GREYSCALE:case Oc.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case Oc.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Oc.UNKNOWN:case Oc.GREYSCALE_ALPHA:case Oc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=KS(this),a=this.readUint8();if(a!==k5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const n=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:mD(n)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:t,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(t);if(a){if(a.data=E3({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const n=this._apng.frames.at(t-1);this.disposeFrame(a,n,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,a){switch(t.disposeOp){case u2.NONE:break;case u2.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let e=0;e<this._png.width;e++){const p=(n*t.width+e)*this._png.channels;for(let m=0;m<this._png.channels;m++)a.data[p+m]=0}break;case u2.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const a=1<<this._png.depth,n=(e,p)=>{const m=((e+r.yOffset)*this._png.width+r.xOffset+p)*this._png.channels,y=(e*r.width+p)*this._png.channels;return{index:m,frameIndex:y}};switch(r.blendOp){case I5.SOURCE:for(let e=0;e<r.height;e++)for(let p=0;p<r.width;p++){const{index:m,frameIndex:y}=n(e,p);for(let w=0;w<this._png.channels;w++)t.data[m+w]=r.data[y+w]}break;case I5.OVER:for(let e=0;e<r.height;e++)for(let p=0;p<r.width;p++){const{index:m,frameIndex:y}=n(e,p);for(let w=0;w<this._png.channels;w++){const A=r.data[y+this._png.channels-1]/a,I=w%(this._png.channels-1)===0?1:r.data[y+w],R=Math.floor(A*I+(1-A)*t.data[m+w]);t.data[m+w]+=R}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==_3.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===_5.NO_INTERLACE)this._png.data=E3({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===_5.ADAM7)this._png.data=AD({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:u2.NONE,blendOp:I5.SOURCE,data:t}),this._inflator=new C3,this._writingDataChunks=!1}}function UD(i){if(i!==1&&i!==2&&i!==4&&i!==8&&i!==16)throw new Error(`invalid bit depth: ${i}`);return i}var I3;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.METRE=1]="METRE"})(I3||(I3={}));function BD(i,t){return new MD(i,t).decode()}var kn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function D5(){kn.console&&typeof kn.console.log=="function"&&kn.console.log.apply(kn.console,arguments)}var As={log:D5,warn:function(i){kn.console&&(typeof kn.console.warn=="function"?kn.console.warn.apply(kn.console,arguments):D5.call(null,arguments))},error:function(i){kn.console&&(typeof kn.console.error=="function"?kn.console.error.apply(kn.console,arguments):D5(i))}};function F5(i,t,r){var a=new XMLHttpRequest;a.open("GET",i),a.responseType="blob",a.onload=function(){g0(a.response,t,r)},a.onerror=function(){As.error("could not download file")},a.send()}function D3(i){var t=new XMLHttpRequest;t.open("HEAD",i,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function h2(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(t)}}var g0=kn.saveAs||((typeof window>"u"?"undefined":ns(window))!=="object"||window!==kn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,t,r){var a=kn.URL||kn.webkitURL,n=document.createElement("a");t=t||i.name||"download",n.download=t,n.rel="noopener",typeof i=="string"?(n.href=i,n.origin!==location.origin?D3(n.href)?F5(i,t,r):h2(n,n.target="_blank"):h2(n)):(n.href=a.createObjectURL(i),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){h2(n)},0))}:"msSaveOrOpenBlob"in navigator?function(i,t,r){if(t=t||i.name||"download",typeof i=="string")if(D3(i))F5(i,t,r);else{var a=document.createElement("a");a.href=i,a.target="_blank",setTimeout(function(){h2(a)})}else navigator.msSaveOrOpenBlob((function(n,e){return e===void 0?e={autoBom:!1}:ns(e)!=="object"&&(As.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(i,r),t)}:function(i,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof i=="string")return F5(i,t,r);var n=i.type==="application/octet-stream",e=/constructor/i.test(kn.HTMLElement)||kn.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||n&&e)&&(typeof FileReader>"u"?"undefined":ns(FileReader))==="object"){var m=new FileReader;m.onloadend=function(){var A=m.result;A=p?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=A:location=A,a=null},m.readAsDataURL(i)}else{var y=kn.URL||kn.webkitURL,w=y.createObjectURL(i);a?a.location=w:location.href=w,a=null,setTimeout(function(){y.revokeObjectURL(w)},4e4)}});function YS(i){var t;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(m){return[parseInt(m[1]),parseInt(m[2]),parseInt(m[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(m){return[parseInt(m[1],16),parseInt(m[2],16),parseInt(m[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(m){return[parseInt(m[1]+m[1],16),parseInt(m[2]+m[2],16),parseInt(m[3]+m[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,e=r[a].process,p=n.exec(i);p&&(t=e(p),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var m=this.r.toString(16),y=this.g.toString(16),w=this.b.toString(16);return m.length==1&&(m="0"+m),y.length==1&&(y="0"+y),w.length==1&&(w="0"+w),"#"+m+y+w}}var E2=kn.atob.bind(kn),F3=kn.btoa.bind(kn);function R5(i,t){var r=i[0],a=i[1],n=i[2],e=i[3];r=il(r,a,n,e,t[0],7,-680876936),e=il(e,r,a,n,t[1],12,-389564586),n=il(n,e,r,a,t[2],17,606105819),a=il(a,n,e,r,t[3],22,-1044525330),r=il(r,a,n,e,t[4],7,-176418897),e=il(e,r,a,n,t[5],12,1200080426),n=il(n,e,r,a,t[6],17,-1473231341),a=il(a,n,e,r,t[7],22,-45705983),r=il(r,a,n,e,t[8],7,1770035416),e=il(e,r,a,n,t[9],12,-1958414417),n=il(n,e,r,a,t[10],17,-42063),a=il(a,n,e,r,t[11],22,-1990404162),r=il(r,a,n,e,t[12],7,1804603682),e=il(e,r,a,n,t[13],12,-40341101),n=il(n,e,r,a,t[14],17,-1502002290),r=ol(r,a=il(a,n,e,r,t[15],22,1236535329),n,e,t[1],5,-165796510),e=ol(e,r,a,n,t[6],9,-1069501632),n=ol(n,e,r,a,t[11],14,643717713),a=ol(a,n,e,r,t[0],20,-373897302),r=ol(r,a,n,e,t[5],5,-701558691),e=ol(e,r,a,n,t[10],9,38016083),n=ol(n,e,r,a,t[15],14,-660478335),a=ol(a,n,e,r,t[4],20,-405537848),r=ol(r,a,n,e,t[9],5,568446438),e=ol(e,r,a,n,t[14],9,-1019803690),n=ol(n,e,r,a,t[3],14,-187363961),a=ol(a,n,e,r,t[8],20,1163531501),r=ol(r,a,n,e,t[13],5,-1444681467),e=ol(e,r,a,n,t[2],9,-51403784),n=ol(n,e,r,a,t[7],14,1735328473),r=ll(r,a=ol(a,n,e,r,t[12],20,-1926607734),n,e,t[5],4,-378558),e=ll(e,r,a,n,t[8],11,-2022574463),n=ll(n,e,r,a,t[11],16,1839030562),a=ll(a,n,e,r,t[14],23,-35309556),r=ll(r,a,n,e,t[1],4,-1530992060),e=ll(e,r,a,n,t[4],11,1272893353),n=ll(n,e,r,a,t[7],16,-155497632),a=ll(a,n,e,r,t[10],23,-1094730640),r=ll(r,a,n,e,t[13],4,681279174),e=ll(e,r,a,n,t[0],11,-358537222),n=ll(n,e,r,a,t[3],16,-722521979),a=ll(a,n,e,r,t[6],23,76029189),r=ll(r,a,n,e,t[9],4,-640364487),e=ll(e,r,a,n,t[12],11,-421815835),n=ll(n,e,r,a,t[15],16,530742520),r=cl(r,a=ll(a,n,e,r,t[2],23,-995338651),n,e,t[0],6,-198630844),e=cl(e,r,a,n,t[7],10,1126891415),n=cl(n,e,r,a,t[14],15,-1416354905),a=cl(a,n,e,r,t[5],21,-57434055),r=cl(r,a,n,e,t[12],6,1700485571),e=cl(e,r,a,n,t[3],10,-1894986606),n=cl(n,e,r,a,t[10],15,-1051523),a=cl(a,n,e,r,t[1],21,-2054922799),r=cl(r,a,n,e,t[8],6,1873313359),e=cl(e,r,a,n,t[15],10,-30611744),n=cl(n,e,r,a,t[6],15,-1560198380),a=cl(a,n,e,r,t[13],21,1309151649),r=cl(r,a,n,e,t[4],6,-145523070),e=cl(e,r,a,n,t[11],10,-1120210379),n=cl(n,e,r,a,t[2],15,718787259),a=cl(a,n,e,r,t[9],21,-343485551),i[0]=yf(r,i[0]),i[1]=yf(a,i[1]),i[2]=yf(n,i[2]),i[3]=yf(e,i[3])}function $y(i,t,r,a,n,e){return t=yf(yf(t,i),yf(a,e)),yf(t<<n|t>>>32-n,r)}function il(i,t,r,a,n,e,p){return $y(t&r|~t&a,i,t,n,e,p)}function ol(i,t,r,a,n,e,p){return $y(t&a|r&~a,i,t,n,e,p)}function ll(i,t,r,a,n,e,p){return $y(t^r^a,i,t,n,e,p)}function cl(i,t,r,a,n,e,p){return $y(r^(t|~a),i,t,n,e,p)}function JS(i){var t,r=i.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=i.length;t+=64)R5(a,HD(i.substring(t-64,t)));i=i.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i.length;t++)n[t>>2]|=i.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(R5(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,R5(a,n),a}function HD(i){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=i.charCodeAt(t)+(i.charCodeAt(t+1)<<8)+(i.charCodeAt(t+2)<<16)+(i.charCodeAt(t+3)<<24);return r}var R3="0123456789abcdef".split("");function zD(i){for(var t="",r=0;r<4;r++)t+=R3[i>>8*r+4&15]+R3[i>>8*r&15];return t}function $D(i){return String.fromCharCode(255&i,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function Fv(i){return JS(i).map($D).join("")}var qD=(function(i){for(var t=0;t<i.length;t++)i[t]=zD(i[t]);return i.join("")})(JS("hello"))!="5d41402abc4b2a76b9719d911017c592";function yf(i,t){if(qD){var r=(65535&i)+(65535&t);return(i>>16)+(t>>16)+(r>>16)<<16|65535&r}return i+t&4294967295}function Rv(i,t){var r,a,n,e;if(i!==r){for(var p=(n=i,e=1+(256/i.length|0),new Array(e+1).join(n)),m=[],y=0;y<256;y++)m[y]=y;var w=0;for(y=0;y<256;y++){var A=m[y];w=(w+A+p.charCodeAt(y))%256,m[y]=m[w],m[w]=A}r=i,a=m}else m=a;var I=t.length,R=0,k=0,M="";for(y=0;y<I;y++)k=(k+(A=m[R=(R+1)%256]))%256,m[R]=m[k],m[k]=A,p=m[(m[R]+m[k])%256],M+=String.fromCharCode(t.charCodeAt(y)^p);return M}var j3={print:4,modify:8,copy:16,"annot-forms":32};function H1(i,t,r,a){this.v=1,this.r=2;var n=192;i.forEach(function(m){if(j3.perm!==void 0)throw new Error("Invalid permission: "+m);n+=j3[m]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var e=(t+this.padding).substr(0,32),p=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(e,p),this.P=-(1+(255^n)),this.encryptionKey=Fv(e+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Rv(this.encryptionKey,this.padding)}function z1(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var t="",r=i.length,a=0;a<r;a++){var n=i.charCodeAt(a);t+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):i[a]}return t}function O3(i){if(ns(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var e=Math.random().toString(35);return t[r][e]=[a,!!n],e},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var e in t[r]){var p=t[r][e];try{p[0].apply(i,a)}catch(m){kn.console&&As.error("jsPDF PubSub Error",m.message,m)}p[1]&&n.push(e)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function hy(i){if(!(this instanceof hy))return new hy(i);var t="opacity,stroke-opacity".split(",");for(var r in i)i.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=i[r]);this.id="",this.objectNumber=-1}function QS(i,t){this.gState=i,this.matrix=t,this.id="",this.objectNumber=-1}function b0(i,t,r,a,n){if(!(this instanceof b0))return new b0(i,t,r,a,n);this.type=i==="axial"?2:3,this.coords=t,this.colors=r,QS.call(this,a,n)}function q1(i,t,r,a,n){if(!(this instanceof q1))return new q1(i,t,r,a,n);this.boundingBox=i,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,QS.call(this,a,n)}function en(i){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],e=arguments[3],p=[],m=1,y=16,w="S",A=null;ns(i=i||{})==="object"&&(r=i.orientation,a=i.unit||a,n=i.format||n,e=i.compress||i.compressPdf||e,(A=i.encryption||null)!==null&&(A.userPassword=A.userPassword||"",A.ownerPassword=A.ownerPassword||"",A.userPermissions=A.userPermissions||[]),m=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(t=i.precision),i.floatPrecision!==void 0&&(y=i.floatPrecision),w=i.defaultPathOperation||"S"),p=i.filters||(e===!0?["FlateEncode"]:p),a=a||"mm",r=(""+(r||"P")).toLowerCase();var I=i.putOnlyUsedFonts||!1,R={},k={internal:{},__private__:{}};k.__private__.PubSub=O3;var M="1.3",V=k.__private__.getPdfVersion=function(){return M};k.__private__.setPdfVersion=function(j){M=j};var q={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};k.__private__.getPageFormats=function(){return q};var U=k.__private__.getPageFormat=function(j){return q[j]};n=n||"a4";var te="compat",W="advanced",re=te;function xe(){this.saveGraphicsState(),Te(new Yr(_r,0,0,-_r,0,Pl()*_r).toString()+" cm"),this.setFontSize(this.getFontSize()/_r),w="n",re=W}function ve(){this.restoreGraphicsState(),w="S",re=te}var De=k.__private__.combineFontStyleAndFontWeight=function(j,ie){if(j=="bold"&&ie=="normal"||j=="bold"&&ie==400||j=="normal"&&ie=="italic"||j=="bold"&&ie=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ie&&(j=ie==400||ie==="normal"?j==="italic"?"italic":"normal":ie!=700&&ie!=="bold"||j!=="normal"?(ie==700?"bold":ie)+""+j:"bold"),j};k.advancedAPI=function(j){var ie=re===te;return ie&&xe.call(this),typeof j!="function"||(j(this),ie&&ve.call(this)),this},k.compatAPI=function(j){var ie=re===W;return ie&&ve.call(this),typeof j!="function"||(j(this),ie&&xe.call(this)),this},k.isAdvancedAPI=function(){return re===W};var ke,de=function(j){if(re!==W)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Oe=k.roundToPrecision=k.__private__.roundToPrecision=function(j,ie){var je=t||ie;if(isNaN(j)||isNaN(je))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(je).replace(/0+$/,"")};ke=k.hpf=k.__private__.hpf=typeof y=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Oe(j,y)}:y==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Oe(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Oe(j,16)};var z=k.f2=k.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return Oe(j,2)},K=k.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return Oe(j,3)},Ae=k.scale=k.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return re===te?j*_r:re===W?j:void 0},Ce=function(j){return Ae((function(ie){return re===te?Pl()-ie:re===W?ie:void 0})(j))};k.__private__.setPrecision=k.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(t=parseInt(j,10))};var Be,Ee="00000000000000000000000000000000",Pe=k.__private__.getFileId=function(){return Ee},Ue=k.__private__.setFileId=function(j){return Ee=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():Ee.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),A!==null&&(Bs=new H1(A.userPermissions,A.userPassword,A.ownerPassword,Ee)),Ee};k.setFileId=function(j){return Ue(j),this},k.getFileId=function(){return Pe()};var _e=k.__private__.convertDateToPDFDate=function(j){var ie=j.getTimezoneOffset(),je=ie<0?"+":"-",Ge=Math.floor(Math.abs(ie/60)),tt=Math.abs(ie%60),Et=[je,Z(Ge),"'",Z(tt),"'"].join("");return["D:",j.getFullYear(),Z(j.getMonth()+1),Z(j.getDate()),Z(j.getHours()),Z(j.getMinutes()),Z(j.getSeconds()),Et].join("")},Le=k.__private__.convertPDFDateToDate=function(j){var ie=parseInt(j.substr(2,4),10),je=parseInt(j.substr(6,2),10)-1,Ge=parseInt(j.substr(8,2),10),tt=parseInt(j.substr(10,2),10),Et=parseInt(j.substr(12,2),10),Ut=parseInt(j.substr(14,2),10);return new Date(ie,je,Ge,tt,Et,Ut,0)},X=k.__private__.setCreationDate=function(j){var ie;if(j===void 0&&(j=new Date),j instanceof Date)ie=_e(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ie=j}return Be=ie},H=k.__private__.getCreationDate=function(j){var ie=Be;return j==="jsDate"&&(ie=Le(Be)),ie};k.setCreationDate=function(j){return X(j),this},k.getCreationDate=function(j){return H(j)};var ae,Z=k.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},se=k.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},ye=0,ce=[],ze=[],pe=0,Ve=[],yt=[],vt=!1,bt=ze;k.__private__.setCustomOutputDestination=function(j){vt=!0,bt=j};var Ft=function(j){vt||(bt=j)};k.__private__.resetCustomOutputDestination=function(){vt=!1,bt=ze};var Te=k.__private__.out=function(j){return j=j.toString(),pe+=j.length+1,bt.push(j),bt},Ht=k.__private__.write=function(j){return Te(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},Or=k.__private__.getArrayBuffer=function(j){for(var ie=j.length,je=new ArrayBuffer(ie),Ge=new Uint8Array(je);ie--;)Ge[ie]=j.charCodeAt(ie);return je},Vr=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];k.__private__.getStandardFonts=function(){return Vr};var Mt=i.fontSize||16;k.__private__.setFontSize=k.setFontSize=function(j){return Mt=re===W?j/_r:j,this};var zr,Qe=k.__private__.getFontSize=k.getFontSize=function(){return re===te?Mt:Mt*_r},Rt=i.R2L||!1;k.__private__.setR2L=k.setR2L=function(j){return Rt=j,this},k.__private__.getR2L=k.getR2L=function(){return Rt};var Ct,er=k.__private__.setZoomMode=function(j){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))zr=j;else if(isNaN(j)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');zr=j}else zr=parseInt(j,10)};k.__private__.getZoomMode=function(){return zr};var nr,ur=k.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');Ct=j};k.__private__.getPageMode=function(){return Ct};var Sr=k.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');nr=j};k.__private__.getLayoutMode=function(){return nr},k.__private__.setDisplayMode=k.setDisplayMode=function(j,ie,je){return er(j),Sr(ie),ur(je),this};var kr={title:"",subject:"",author:"",keywords:"",creator:""};k.__private__.getDocumentProperty=function(j){if(Object.keys(kr).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return kr[j]},k.__private__.getDocumentProperties=function(){return kr},k.__private__.setDocumentProperties=k.setProperties=k.setDocumentProperties=function(j){for(var ie in kr)kr.hasOwnProperty(ie)&&j[ie]&&(kr[ie]=j[ie]);return this},k.__private__.setDocumentProperty=function(j,ie){if(Object.keys(kr).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return kr[j]=ie};var ar,_r,Ar,ra,Nn,Qr={},xr={},an=[],Lr={},Jn={},on={},gn={},xa=null,fn=0,Wr=[],Jt=new O3(k),bo=i.hotfixes||[],Vs={},fa={},xo=[],Yr=function j(ie,je,Ge,tt,Et,Ut){if(!(this instanceof j))return new j(ie,je,Ge,tt,Et,Ut);isNaN(ie)&&(ie=1),isNaN(je)&&(je=0),isNaN(Ge)&&(Ge=0),isNaN(tt)&&(tt=1),isNaN(Et)&&(Et=0),isNaN(Ut)&&(Ut=0),this._matrix=[ie,je,Ge,tt,Et,Ut]};Object.defineProperty(Yr.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Yr.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Yr.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Yr.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Yr.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Yr.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Yr.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Yr.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Yr.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Yr.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Yr.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Yr.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Yr.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Yr.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Yr.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Yr.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Yr.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ke).join(j)},Yr.prototype.multiply=function(j){var ie=j.sx*this.sx+j.shy*this.shx,je=j.sx*this.shy+j.shy*this.sy,Ge=j.shx*this.sx+j.sy*this.shx,tt=j.shx*this.shy+j.sy*this.sy,Et=j.tx*this.sx+j.ty*this.shx+this.tx,Ut=j.tx*this.shy+j.ty*this.sy+this.ty;return new Yr(ie,je,Ge,tt,Et,Ut)},Yr.prototype.decompose=function(){var j=this.sx,ie=this.shy,je=this.shx,Ge=this.sy,tt=this.tx,Et=this.ty,Ut=Math.sqrt(j*j+ie*ie),wr=(j/=Ut)*je+(ie/=Ut)*Ge;je-=j*wr,Ge-=ie*wr;var Cr=Math.sqrt(je*je+Ge*Ge);return wr/=Cr,j*(Ge/=Cr)<ie*(je/=Cr)&&(j=-j,ie=-ie,wr=-wr,Ut=-Ut),{scale:new Yr(Ut,0,0,Cr,0,0),translate:new Yr(1,0,0,1,tt,Et),rotate:new Yr(j,ie,-ie,j,0,0),skew:new Yr(1,0,wr,1,0,0)}},Yr.prototype.toString=function(j){return this.join(" ")},Yr.prototype.inversed=function(){var j=this.sx,ie=this.shy,je=this.shx,Ge=this.sy,tt=this.tx,Et=this.ty,Ut=1/(j*Ge-ie*je),wr=Ge*Ut,Cr=-ie*Ut,yn=-je*Ut,$r=j*Ut;return new Yr(wr,Cr,yn,$r,-wr*tt-yn*Et,-Cr*tt-$r*Et)},Yr.prototype.applyToPoint=function(j){var ie=j.x*this.sx+j.y*this.shx+this.tx,je=j.x*this.shy+j.y*this.sy+this.ty;return new Co(ie,je)},Yr.prototype.applyToRectangle=function(j){var ie=this.applyToPoint(j),je=this.applyToPoint(new Co(j.x+j.w,j.y+j.h));return new Fl(ie.x,ie.y,je.x-ie.x,je.y-ie.y)},Yr.prototype.clone=function(){var j=this.sx,ie=this.shy,je=this.shx,Ge=this.sy,tt=this.tx,Et=this.ty;return new Yr(j,ie,je,Ge,tt,Et)},k.Matrix=Yr;var qo=k.matrixMult=function(j,ie){return ie.multiply(j)},wo=new Yr(1,0,0,1,0,0);k.unitMatrix=k.identityMatrix=wo;var pa=function(j,ie){if(!Jn[j]){var je=(ie instanceof b0?"Sh":"P")+(Object.keys(Lr).length+1).toString(10);ie.id=je,Jn[j]=je,Lr[je]=ie,Jt.publish("addPattern",ie)}};k.ShadingPattern=b0,k.TilingPattern=q1,k.addShadingPattern=function(j,ie){return de("addShadingPattern()"),pa(j,ie),this},k.beginTilingPattern=function(j){de("beginTilingPattern()"),Vc(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},k.endTilingPattern=function(j,ie){de("endTilingPattern()"),ie.stream=yt[ae].join(`
`),pa(j,ie),Jt.publish("endTilingPattern",ie),xo.pop().restore()};var Ri,as=k.__private__.newObject=function(){var j=Ps();return Ms(j,!0),j},Ps=k.__private__.newObjectDeferred=function(){return ye++,ce[ye]=function(){return pe},ye},Ms=function(j,ie){return ie=typeof ie=="boolean"&&ie,ce[j]=pe,ie&&Te(j+" 0 obj"),j},pl=k.__private__.newAdditionalObject=function(){var j={objId:Ps(),content:""};return Ve.push(j),j},ji=Ps(),Fa=Ps(),vn=k.__private__.decodeColorString=function(j){var ie=j.split(" ");if(ie.length!==2||ie[1]!=="g"&&ie[1]!=="G")ie.length!==5||ie[4]!=="k"&&ie[4]!=="K"||(ie=[(1-ie[0])*(1-ie[3]),(1-ie[1])*(1-ie[3]),(1-ie[2])*(1-ie[3]),"r"]);else{var je=parseFloat(ie[0]);ie=[je,je,je,"r"]}for(var Ge="#",tt=0;tt<3;tt++)Ge+=("0"+Math.floor(255*parseFloat(ie[tt])).toString(16)).slice(-2);return Ge},Cs=k.__private__.encodeColorString=function(j){var ie;typeof j=="string"&&(j={ch1:j});var je=j.ch1,Ge=j.ch2,tt=j.ch3,Et=j.ch4,Ut=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof je=="string"&&je.charAt(0)!=="#"){var wr=new YS(je);if(wr.ok)je=wr.toHex();else if(!/^\d*\.?\d*$/.test(je))throw new Error('Invalid color "'+je+'" passed to jsPDF.encodeColorString.')}if(typeof je=="string"&&/^#[0-9A-Fa-f]{3}$/.test(je)&&(je="#"+je[1]+je[1]+je[2]+je[2]+je[3]+je[3]),typeof je=="string"&&/^#[0-9A-Fa-f]{6}$/.test(je)){var Cr=parseInt(je.substr(1),16);je=Cr>>16&255,Ge=Cr>>8&255,tt=255&Cr}if(Ge===void 0||Et===void 0&&je===Ge&&Ge===tt)ie=typeof je=="string"?je+" "+Ut[0]:j.precision===2?z(je/255)+" "+Ut[0]:K(je/255)+" "+Ut[0];else if(Et===void 0||ns(Et)==="object"){if(Et&&!isNaN(Et.a)&&Et.a===0)return["1.","1.","1.",Ut[1]].join(" ");ie=typeof je=="string"?[je,Ge,tt,Ut[1]].join(" "):j.precision===2?[z(je/255),z(Ge/255),z(tt/255),Ut[1]].join(" "):[K(je/255),K(Ge/255),K(tt/255),Ut[1]].join(" ")}else ie=typeof je=="string"?[je,Ge,tt,Et,Ut[2]].join(" "):j.precision===2?[z(je),z(Ge),z(tt),z(Et),Ut[2]].join(" "):[K(je),K(Ge),K(tt),K(Et),Ut[2]].join(" ");return ie},jn=k.__private__.getFilters=function(){return p},na=k.__private__.putStream=function(j){var ie=(j=j||{}).data||"",je=j.filters||jn(),Ge=j.alreadyAppliedFilters||[],tt=j.addLength1||!1,Et=ie.length,Ut=j.objectId,wr=function(ei){return ei};if(A!==null&&Ut===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");A!==null&&(wr=Bs.encryptor(Ut,0));var Cr={};je===!0&&(je=["FlateEncode"]);var yn=j.additionalKeyValues||[],$r=(Cr=en.API.processDataByFilters!==void 0?en.API.processDataByFilters(ie,je):{data:ie,reverseChain:[]}).reverseChain+(Array.isArray(Ge)?Ge.join(" "):Ge.toString());if(Cr.data.length!==0&&(yn.push({key:"Length",value:Cr.data.length}),tt===!0&&yn.push({key:"Length1",value:Et})),$r.length!=0)if($r.split("/").length-1==1)yn.push({key:"Filter",value:$r});else{yn.push({key:"Filter",value:"["+$r+"]"});for(var On=0;On<yn.length;On+=1)if(yn[On].key==="DecodeParms"){for(var bs=[],Ja=0;Ja<Cr.reverseChain.split("/").length-1;Ja+=1)bs.push("null");bs.push(yn[On].value),yn[On].value="["+bs.join(" ")+"]"}}Te("<<");for(var Ba=0;Ba<yn.length;Ba++)Te("/"+yn[Ba].key+" "+yn[Ba].value);Te(">>"),Cr.data.length!==0&&(Te("stream"),Te(wr(Cr.data)),Te("endstream"))},bi=k.__private__.putPage=function(j){var ie=j.number,je=j.data,Ge=j.objId,tt=j.contentsObjId;Ms(Ge,!0),Te("<</Type /Page"),Te("/Parent "+j.rootDictionaryObjId+" 0 R"),Te("/Resources "+j.resourceDictionaryObjId+" 0 R"),Te("/MediaBox ["+parseFloat(ke(j.mediaBox.bottomLeftX))+" "+parseFloat(ke(j.mediaBox.bottomLeftY))+" "+ke(j.mediaBox.topRightX)+" "+ke(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&Te("/CropBox ["+ke(j.cropBox.bottomLeftX)+" "+ke(j.cropBox.bottomLeftY)+" "+ke(j.cropBox.topRightX)+" "+ke(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&Te("/BleedBox ["+ke(j.bleedBox.bottomLeftX)+" "+ke(j.bleedBox.bottomLeftY)+" "+ke(j.bleedBox.topRightX)+" "+ke(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&Te("/TrimBox ["+ke(j.trimBox.bottomLeftX)+" "+ke(j.trimBox.bottomLeftY)+" "+ke(j.trimBox.topRightX)+" "+ke(j.trimBox.topRightY)+"]"),j.artBox!==null&&Te("/ArtBox ["+ke(j.artBox.bottomLeftX)+" "+ke(j.artBox.bottomLeftY)+" "+ke(j.artBox.topRightX)+" "+ke(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&Te("/UserUnit "+j.userUnit),Jt.publish("putPage",{objId:Ge,pageContext:Wr[ie],pageNumber:ie,page:je}),Te("/Contents "+tt+" 0 R"),Te(">>"),Te("endobj");var Et=je.join(`
`);return re===W&&(Et+=`
Q`),Ms(tt,!0),na({data:Et,filters:jn(),objectId:tt}),Te("endobj"),Ge},ml=k.__private__.putPages=function(){var j,ie,je=[];for(j=1;j<=fn;j++)Wr[j].objId=Ps(),Wr[j].contentsObjId=Ps();for(j=1;j<=fn;j++)je.push(bi({number:j,data:yt[j],objId:Wr[j].objId,contentsObjId:Wr[j].contentsObjId,mediaBox:Wr[j].mediaBox,cropBox:Wr[j].cropBox,bleedBox:Wr[j].bleedBox,trimBox:Wr[j].trimBox,artBox:Wr[j].artBox,userUnit:Wr[j].userUnit,rootDictionaryObjId:ji,resourceDictionaryObjId:Fa}));Ms(ji,!0),Te("<</Type /Pages");var Ge="/Kids [";for(ie=0;ie<fn;ie++)Ge+=je[ie]+" 0 R ";Te(Ge+"]"),Te("/Count "+fn),Te(">>"),Te("endobj"),Jt.publish("postPutPages")},Oi=function(j){Jt.publish("putFont",{font:j,out:Te,newObject:as,putStream:na}),j.isAlreadyPutted!==!0&&(j.objectNumber=as(),Te("<<"),Te("/Type /Font"),Te("/BaseFont /"+z1(j.postScriptName)),Te("/Subtype /Type1"),typeof j.encoding=="string"&&Te("/Encoding /"+j.encoding),Te("/FirstChar 32"),Te("/LastChar 255"),Te(">>"),Te("endobj"))},uc=function(j){j.objectNumber=as();var ie=[];ie.push({key:"Type",value:"/XObject"}),ie.push({key:"Subtype",value:"/Form"}),ie.push({key:"BBox",value:"["+[ke(j.x),ke(j.y),ke(j.x+j.width),ke(j.y+j.height)].join(" ")+"]"}),ie.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var je=j.pages[1].join(`
`);na({data:je,additionalKeyValues:ie,objectId:j.objectNumber}),Te("endobj")},gl=function(j,ie){ie||(ie=21);var je=as(),Ge=(function(Ut,wr){var Cr,yn=[],$r=1/(wr-1);for(Cr=0;Cr<1;Cr+=$r)yn.push(Cr);if(yn.push(1),Ut[0].offset!=0){var On={offset:0,color:Ut[0].color};Ut.unshift(On)}if(Ut[Ut.length-1].offset!=1){var bs={offset:1,color:Ut[Ut.length-1].color};Ut.push(bs)}for(var Ja="",Ba=0,ei=0;ei<yn.length;ei++){for(Cr=yn[ei];Cr>Ut[Ba+1].offset;)Ba++;var Ws=Ut[Ba].offset,Si=(Cr-Ws)/(Ut[Ba+1].offset-Ws),Ml=Ut[Ba].color,Ra=Ut[Ba+1].color;Ja+=se(Math.round((1-Si)*Ml[0]+Si*Ra[0]).toString(16))+se(Math.round((1-Si)*Ml[1]+Si*Ra[1]).toString(16))+se(Math.round((1-Si)*Ml[2]+Si*Ra[2]).toString(16))}return Ja.trim()})(j.colors,ie),tt=[];tt.push({key:"FunctionType",value:"0"}),tt.push({key:"Domain",value:"[0.0 1.0]"}),tt.push({key:"Size",value:"["+ie+"]"}),tt.push({key:"BitsPerSample",value:"8"}),tt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),tt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),na({data:Ge,additionalKeyValues:tt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:je}),Te("endobj"),j.objectNumber=as(),Te("<< /ShadingType "+j.type),Te("/ColorSpace /DeviceRGB");var Et="/Coords ["+ke(parseFloat(j.coords[0]))+" "+ke(parseFloat(j.coords[1]))+" ";j.type===2?Et+=ke(parseFloat(j.coords[2]))+" "+ke(parseFloat(j.coords[3])):Et+=ke(parseFloat(j.coords[2]))+" "+ke(parseFloat(j.coords[3]))+" "+ke(parseFloat(j.coords[4]))+" "+ke(parseFloat(j.coords[5])),Te(Et+="]"),j.matrix&&Te("/Matrix ["+j.matrix.toString()+"]"),Te("/Function "+je+" 0 R"),Te("/Extend [true true]"),Te(">>"),Te("endobj")},Go=function(j,ie){var je=Ps(),Ge=as();ie.push({resourcesOid:je,objectOid:Ge}),j.objectNumber=Ge;var tt=[];tt.push({key:"Type",value:"/Pattern"}),tt.push({key:"PatternType",value:"1"}),tt.push({key:"PaintType",value:"1"}),tt.push({key:"TilingType",value:"1"}),tt.push({key:"BBox",value:"["+j.boundingBox.map(ke).join(" ")+"]"}),tt.push({key:"XStep",value:ke(j.xStep)}),tt.push({key:"YStep",value:ke(j.yStep)}),tt.push({key:"Resources",value:je+" 0 R"}),j.matrix&&tt.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),na({data:j.stream,additionalKeyValues:tt,objectId:j.objectNumber}),Te("endobj")},$c=function(j){for(var ie in j.objectNumber=as(),Te("<<"),j)switch(ie){case"opacity":Te("/ca "+z(j[ie]));break;case"stroke-opacity":Te("/CA "+z(j[ie]))}Te(">>"),Te("endobj")},Us=function(j){Ms(j.resourcesOid,!0),Te("<<"),Te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ie in Te("/Font <<"),Qr)Qr.hasOwnProperty(ie)&&(I===!1||I===!0&&R.hasOwnProperty(ie))&&Te("/"+ie+" "+Qr[ie].objectNumber+" 0 R");Te(">>")})(),(function(){if(Object.keys(Lr).length>0){for(var ie in Te("/Shading <<"),Lr)Lr.hasOwnProperty(ie)&&Lr[ie]instanceof b0&&Lr[ie].objectNumber>=0&&Te("/"+ie+" "+Lr[ie].objectNumber+" 0 R");Jt.publish("putShadingPatternDict"),Te(">>")}})(),(function(ie){if(Object.keys(Lr).length>0){for(var je in Te("/Pattern <<"),Lr)Lr.hasOwnProperty(je)&&Lr[je]instanceof k.TilingPattern&&Lr[je].objectNumber>=0&&Lr[je].objectNumber<ie&&Te("/"+je+" "+Lr[je].objectNumber+" 0 R");Jt.publish("putTilingPatternDict"),Te(">>")}})(j.objectOid),(function(){if(Object.keys(on).length>0){var ie;for(ie in Te("/ExtGState <<"),on)on.hasOwnProperty(ie)&&on[ie].objectNumber>=0&&Te("/"+ie+" "+on[ie].objectNumber+" 0 R");Jt.publish("putGStateDict"),Te(">>")}})(),(function(){for(var ie in Te("/XObject <<"),Vs)Vs.hasOwnProperty(ie)&&Vs[ie].objectNumber>=0&&Te("/"+ie+" "+Vs[ie].objectNumber+" 0 R");Jt.publish("putXobjectDict"),Te(">>")})(),Te(">>"),Te("endobj")},ys=function(j){xr[j.fontName]=xr[j.fontName]||{},xr[j.fontName][j.fontStyle]=j.id},ss=function(j,ie,je,Ge,tt){var Et={id:"F"+(Object.keys(Qr).length+1).toString(10),postScriptName:j,fontName:ie,fontStyle:je,encoding:Ge,isStandardFont:tt||!1,metadata:{}};return Jt.publish("addFont",{font:Et,instance:this}),Qr[Et.id]=Et,ys(Et),Et.id},Ya=k.__private__.pdfEscape=k.pdfEscape=function(j,ie){return(function(je,Ge){var tt,Et,Ut,wr,Cr,yn,$r,On,bs;if(Ut=(Ge=Ge||{}).sourceEncoding||"Unicode",Cr=Ge.outputEncoding,(Ge.autoencode||Cr)&&Qr[ar].metadata&&Qr[ar].metadata[Ut]&&Qr[ar].metadata[Ut].encoding&&(wr=Qr[ar].metadata[Ut].encoding,!Cr&&Qr[ar].encoding&&(Cr=Qr[ar].encoding),!Cr&&wr.codePages&&(Cr=wr.codePages[0]),typeof Cr=="string"&&(Cr=wr[Cr]),Cr)){for($r=!1,yn=[],tt=0,Et=je.length;tt<Et;tt++)(On=Cr[je.charCodeAt(tt)])?yn.push(String.fromCharCode(On)):yn.push(je[tt]),yn[tt].charCodeAt(0)>>8&&($r=!0);je=yn.join("")}for(tt=je.length;$r===void 0&&tt!==0;)je.charCodeAt(tt-1)>>8&&($r=!0),tt--;if(!$r)return je;for(yn=Ge.noBOM?[]:[254,255],tt=0,Et=je.length;tt<Et;tt++){if((bs=(On=je.charCodeAt(tt))>>8)>>8)throw new Error("Character at position "+tt+" of string '"+je+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");yn.push(bs),yn.push(On-(bs<<8))}return String.fromCharCode.apply(void 0,yn)})(j,ie).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Vo=k.__private__.beginPage=function(j){yt[++fn]=[],Wr[fn]={objId:0,contentsObjId:0,userUnit:Number(m),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},eh(fn),Ft(yt[ae])},mn=function(j,ie){var je,Ge,tt;switch(r=ie||r,typeof j=="string"&&(je=U(j.toLowerCase()),Array.isArray(je)&&(Ge=je[0],tt=je[1])),Array.isArray(j)&&(Ge=j[0]*_r,tt=j[1]*_r),isNaN(Ge)&&(Ge=n[0],tt=n[1]),(Ge>14400||tt>14400)&&(As.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ge=Math.min(14400,Ge),tt=Math.min(14400,tt)),n=[Ge,tt],r.substr(0,1)){case"l":tt>Ge&&(n=[tt,Ge]);break;case"p":Ge>tt&&(n=[tt,Ge])}Vo(n),tn(Xn),Te(wi),Jo!==0&&Te(Jo+" J"),wa!==0&&Te(wa+" j"),Jt.publish("addPage",{pageNumber:fn})},fu=function(j){j>0&&j<=fn&&(yt.splice(j,1),Wr.splice(j,1),fn--,ae>fn&&(ae=fn),this.setPage(ae))},eh=function(j){j>0&&j<=fn&&(ae=j)},hc=k.__private__.getNumberOfPages=k.getNumberOfPages=function(){return yt.length-1},is=function(j,ie,je){var Ge,tt=void 0;return je=je||{},j=j!==void 0?j:Qr[ar].fontName,ie=ie!==void 0?ie:Qr[ar].fontStyle,Ge=j.toLowerCase(),xr[Ge]!==void 0&&xr[Ge][ie]!==void 0?tt=xr[Ge][ie]:xr[j]!==void 0&&xr[j][ie]!==void 0?tt=xr[j][ie]:je.disableWarning===!1&&As.warn("Unable to look up font label for font '"+j+"', '"+ie+"'. Refer to getFontList() for available fonts."),tt||je.noFallback||(tt=xr.times[ie])==null&&(tt=xr.times.normal),tt},So=k.__private__.putInfo=function(){var j=as(),ie=function(Ge){return Ge};for(var je in A!==null&&(ie=Bs.encryptor(j,0)),Te("<<"),Te("/Producer ("+Ya(ie("jsPDF "+en.version))+")"),kr)kr.hasOwnProperty(je)&&kr[je]&&Te("/"+je.substr(0,1).toUpperCase()+je.substr(1)+" ("+Ya(ie(kr[je]))+")");Te("/CreationDate ("+Ya(ie(Be))+")"),Te(">>"),Te("endobj")},os=k.__private__.putCatalog=function(j){var ie=(j=j||{}).rootDictionaryObjId||ji;switch(as(),Te("<<"),Te("/Type /Catalog"),Te("/Pages "+ie+" 0 R"),zr||(zr="fullwidth"),zr){case"fullwidth":Te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Te("/OpenAction [3 0 R /Fit]");break;case"original":Te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var je=""+zr;je.substr(je.length-1)==="%"&&(zr=parseInt(zr)/100),typeof zr=="number"&&Te("/OpenAction [3 0 R /XYZ null null "+z(zr)+"]")}switch(nr||(nr="continuous"),nr){case"continuous":Te("/PageLayout /OneColumn");break;case"single":Te("/PageLayout /SinglePage");break;case"two":case"twoleft":Te("/PageLayout /TwoColumnLeft");break;case"tworight":Te("/PageLayout /TwoColumnRight")}Ct&&Te("/PageMode /"+Ct),Jt.publish("putCatalog"),Te(">>"),Te("endobj")},yl=k.__private__.putTrailer=function(){Te("trailer"),Te("<<"),Te("/Size "+(ye+1)),Te("/Root "+ye+" 0 R"),Te("/Info "+(ye-1)+" 0 R"),A!==null&&Te("/Encrypt "+Bs.oid+" 0 R"),Te("/ID [ <"+Ee+"> <"+Ee+"> ]"),Te(">>")},ma=k.__private__.putHeader=function(){Te("%PDF-"+M),Te("%")},ln=k.__private__.putXRef=function(){var j="0000000000";Te("xref"),Te("0 "+(ye+1)),Te("0000000000 65535 f ");for(var ie=1;ie<=ye;ie++)typeof ce[ie]=="function"?Te((j+ce[ie]()).slice(-10)+" 00000 n "):ce[ie]!==void 0?Te((j+ce[ie]).slice(-10)+" 00000 n "):Te("0000000000 00000 n ")},Zs=k.__private__.buildDocument=function(){var j;ye=0,pe=0,ze=[],ce=[],Ve=[],ji=Ps(),Fa=Ps(),Ft(ze),Jt.publish("buildDocument"),ma(),ml(),(function(){Jt.publish("putAdditionalObjects");for(var je=0;je<Ve.length;je++){var Ge=Ve[je];Ms(Ge.objId,!0),Te(Ge.content),Te("endobj")}Jt.publish("postPutAdditionalObjects")})(),j=[],(function(){for(var je in Qr)Qr.hasOwnProperty(je)&&(I===!1||I===!0&&R.hasOwnProperty(je))&&Oi(Qr[je])})(),(function(){var je;for(je in on)on.hasOwnProperty(je)&&$c(on[je])})(),(function(){for(var je in Vs)Vs.hasOwnProperty(je)&&uc(Vs[je])})(),(function(je){var Ge;for(Ge in Lr)Lr.hasOwnProperty(Ge)&&(Lr[Ge]instanceof b0?gl(Lr[Ge]):Lr[Ge]instanceof q1&&Go(Lr[Ge],je))})(j),Jt.publish("putResources"),j.forEach(Us),Us({resourcesOid:Fa,objectOid:Number.MAX_SAFE_INTEGER}),Jt.publish("postPutResources"),A!==null&&(Bs.oid=as(),Te("<<"),Te("/Filter /Standard"),Te("/V "+Bs.v),Te("/R "+Bs.r),Te("/U <"+Bs.toHexString(Bs.U)+">"),Te("/O <"+Bs.toHexString(Bs.O)+">"),Te("/P "+Bs.P),Te(">>"),Te("endobj")),So(),os();var ie=pe;return ln(),yl(),Te("startxref"),Te(""+ie),Te("%%EOF"),Ft(yt[ae]),ze.join(`
`)},dc=k.__private__.getBlob=function(j){return new Blob([Or(j)],{type:"application/pdf"})},th=k.output=k.__private__.output=(Ri=function(j,ie){switch(typeof(ie=ie||{})=="string"?ie={filename:ie}:ie.filename=ie.filename||"generated.pdf",j){case void 0:return Zs();case"save":k.save(ie.filename);break;case"arraybuffer":return Or(Zs());case"blob":return dc(Zs());case"bloburi":case"bloburl":if(kn.URL!==void 0&&typeof kn.URL.createObjectURL=="function")return kn.URL&&kn.URL.createObjectURL(dc(Zs()))||void 0;As.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var je="",Ge=Zs();try{je=F3(Ge)}catch{je=F3(unescape(encodeURIComponent(Ge)))}return"data:application/pdf;filename="+ie.filename+";base64,"+je;case"pdfobjectnewwindow":if(Object.prototype.toString.call(kn)==="[object Window]"){var tt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Et=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ie.pdfObjectUrl&&(tt=ie.pdfObjectUrl,Et="");var Ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+tt+'"'+Et+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ie)+");<\/script></body></html>",wr=kn.open();return wr!==null&&wr.document.write(Ut),wr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(kn)==="[object Window]"){var Cr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ie.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ie.filename+'" width="500px" height="400px" /></body></html>',yn=kn.open();if(yn!==null){yn.document.write(Cr);var $r=this;yn.document.documentElement.querySelector("#pdfViewer").onload=function(){yn.document.title=ie.filename,yn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open($r.output("bloburl"))}}return yn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(kn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var On='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ie)+'"></iframe></body></html>',bs=kn.open();if(bs!==null&&(bs.document.write(On),bs.document.title=ie.filename),bs||typeof safari>"u")return bs;break;case"datauri":case"dataurl":return kn.document.location.href=this.output("datauristring",ie);default:return null}},Ri.foo=function(){try{return Ri.apply(this,arguments)}catch(je){var j=je.stack||"";~j.indexOf(" at ")&&(j=j.split(" at ")[1]);var ie="Error in function "+j.split(`
`)[0].split("<")[0]+": "+je.message;if(!kn.console)throw new Error(ie);kn.console.error(ie,je),kn.alert&&alert(ie)}},Ri.foo.bar=Ri,Ri.foo),Li=function(j){return Array.isArray(bo)===!0&&bo.indexOf(j)>-1};switch(a){case"pt":_r=1;break;case"mm":_r=72/25.4;break;case"cm":_r=72/2.54;break;case"in":_r=72;break;case"px":_r=Li("px_scaling")==1?.75:96/72;break;case"pc":case"em":_r=12;break;case"ex":_r=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);_r=a}var Bs=null;X(),Ue();var cn=k.__private__.getPageInfo=k.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Wr[j].objId,pageNumber:j,pageContext:Wr[j]}},qc=k.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ie in Wr)if(Wr[ie].objId===j)break;return cn(ie)},Td=k.__private__.getCurrentPageInfo=k.getCurrentPageInfo=function(){return{objId:Wr[ae].objId,pageNumber:ae,pageContext:Wr[ae]}};k.addPage=function(){return mn.apply(this,arguments),this},k.setPage=function(){return eh.apply(this,arguments),Ft.call(this,yt[ae]),this},k.insertPage=function(j){return this.addPage(),this.movePage(ae,j),this},k.movePage=function(j,ie){var je,Ge;if(j>ie){je=yt[j],Ge=Wr[j];for(var tt=j;tt>ie;tt--)yt[tt]=yt[tt-1],Wr[tt]=Wr[tt-1];yt[ie]=je,Wr[ie]=Ge,this.setPage(ie)}else if(j<ie){je=yt[j],Ge=Wr[j];for(var Et=j;Et<ie;Et++)yt[Et]=yt[Et+1],Wr[Et]=Wr[Et+1];yt[ie]=je,Wr[ie]=Ge,this.setPage(ie)}return this},k.deletePage=function(){return fu.apply(this,arguments),this},k.__private__.text=k.text=function(j,ie,je,Ge,tt){var Et,Ut,wr,Cr,yn,$r,On,bs,Ja,Ba=(Ge=Ge||{}).scope||this;if(typeof j=="number"&&typeof ie=="number"&&(typeof je=="string"||Array.isArray(je))){var ei=je;je=ie,ie=j,j=ei}if(arguments[3]instanceof Yr==0?(wr=arguments[4],Cr=arguments[5],ns(On=arguments[3])==="object"&&On!==null||(typeof wr=="string"&&(Cr=wr,wr=null),typeof On=="string"&&(Cr=On,On=null),typeof On=="number"&&(wr=On,On=null),Ge={flags:On,angle:wr,align:Cr})):(de("The transform parameter of text() with a Matrix value"),Ja=tt),isNaN(ie)||isNaN(je)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return Ba;var Ws,Si="",Ml=typeof Ge.lineHeightFactor=="number"?Ge.lineHeightFactor:Ko,Ra=Ba.internal.scaleFactor;function cs(Sn){return Sn=Sn.split("	").join(Array(Ge.TabLen||9).join(" ")),Ya(Sn,On)}function xt(Sn){for(var Un,Ca=Sn.concat(),Es=[],Zo=Ca.length;Zo--;)typeof(Un=Ca.shift())=="string"?Es.push(Un):Array.isArray(Sn)&&(Un.length===1||Un[1]===void 0&&Un[2]===void 0)?Es.push(Un[0]):Es.push([Un[0],Un[1],Un[2]]);return Es}function so(Sn,Un){var Ca;if(typeof Sn=="string")Ca=Un(Sn)[0];else if(Array.isArray(Sn)){for(var Es,Zo,us=Sn.concat(),Yc=[],ch=us.length;ch--;)typeof(Es=us.shift())=="string"?Yc.push(Un(Es)[0]):Array.isArray(Es)&&typeof Es[0]=="string"&&(Zo=Un(Es[0],Es[1],Es[2]),Yc.push([Zo[0],Zo[1],Zo[2]]));Ca=Yc}return Ca}var xs=!1,jt=!0;if(typeof j=="string")xs=!0;else if(Array.isArray(j)){var bl=j.concat();Ut=[];for(var Ul,Ns=bl.length;Ns--;)(typeof(Ul=bl.shift())!="string"||Array.isArray(Ul)&&typeof Ul[0]!="string")&&(jt=!1);xs=jt}if(xs===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var Bl=Mt/Ba.internal.scaleFactor,Hl=Bl*(Ml-1);switch(Ge.baseline){case"bottom":je-=Hl;break;case"top":je+=Bl-Hl;break;case"hanging":je+=Bl-2*Hl;break;case"middle":je+=Bl/2-Hl}if(($r=Ge.maxWidth||0)>0&&(typeof j=="string"?j=Ba.splitTextToSize(j,$r):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce(function(Sn,Un){return Sn.concat(Ba.splitTextToSize(Un,$r))},[]))),Et={text:j,x:ie,y:je,options:Ge,mutex:{pdfEscape:Ya,activeFontKey:ar,fonts:Qr,activeFontSize:Mt}},Jt.publish("preProcessText",Et),j=Et.text,wr=(Ge=Et.options).angle,Ja instanceof Yr==0&&wr&&typeof wr=="number"){wr*=Math.PI/180,Ge.rotationDirection===0&&(wr=-wr),re===W&&(wr=-wr);var ja=Math.cos(wr),Qo=Math.sin(wr);Ja=new Yr(ja,Qo,-Qo,ja,0,0)}else wr&&wr instanceof Yr&&(Ja=wr);re!==W||Ja||(Ja=wo),(yn=Ge.charSpace||Ui)!==void 0&&(Si+=ke(Ae(yn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(bs=Ge.horizontalScale)!==void 0&&(Si+=ke(100*bs)+` Tz
`),Ge.lang;var Ln=-1,ga=Ge.renderingMode!==void 0?Ge.renderingMode:Ge.stroke,sn=Ba.internal.getCurrentPageInfo().pageContext;switch(ga){case 0:case!1:case"fill":Ln=0;break;case 1:case!0:case"stroke":Ln=1;break;case 2:case"fillThenStroke":Ln=2;break;case 3:case"invisible":Ln=3;break;case 4:case"fillAndAddForClipping":Ln=4;break;case 5:case"strokeAndAddPathForClipping":Ln=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ln=6;break;case 7:case"addToPathForClipping":Ln=7}var ti=sn.usedRenderingMode!==void 0?sn.usedRenderingMode:-1;Ln!==-1?Si+=Ln+` Tr
`:ti!==-1&&(Si+=`0 Tr
`),Ln!==-1&&(sn.usedRenderingMode=Ln),Cr=Ge.align||"left";var rn,wn=Mt*Ml,pc=Ba.internal.pageSize.getWidth(),io=Qr[ar];yn=Ge.charSpace||Ui,$r=Ge.maxWidth||0,On=Object.assign({autoencode:!0,noBOM:!0},Ge.flags);var oi=[],mc=function(Sn){return Ba.getStringUnitWidth(Sn,{font:io,charSpace:yn,fontSize:Mt,doKerning:!1})*Mt/Ra};if(Object.prototype.toString.call(j)==="[object Array]"){var ri;Ut=xt(j),Cr!=="left"&&(rn=Ut.map(mc));var Qa,Xa=0;if(Cr==="right"){ie-=rn[0],j=[],Ns=Ut.length;for(var Oa=0;Oa<Ns;Oa++)Oa===0?(Qa=Ao(ie),ri=ii(je)):(Qa=Ae(Xa-rn[Oa]),ri=-wn),j.push([Ut[Oa],Qa,ri]),Xa=rn[Oa]}else if(Cr==="center"){ie-=rn[0]/2,j=[],Ns=Ut.length;for(var xl=0;xl<Ns;xl++)xl===0?(Qa=Ao(ie),ri=ii(je)):(Qa=Ae((Xa-rn[xl])/2),ri=-wn),j.push([Ut[xl],Qa,ri]),Xa=rn[xl]}else if(Cr==="left"){j=[],Ns=Ut.length;for(var oh=0;oh<Ns;oh++)j.push(Ut[oh])}else if(Cr==="justify"&&io.encoding==="Identity-H"){j=[],Ns=Ut.length,$r=$r!==0?$r:pc;for(var lh=0,ca=0;ca<Ns;ca++)if(ri=ca===0?ii(je):-wn,Qa=ca===0?Ao(ie):lh,ca<Ns-1){var zl=Ae(($r-rn[ca])/(Ut[ca].split(" ").length-1)),Bi=Ut[ca].split(" ");j.push([Bi[0]+" ",Qa,ri]),lh=0;for(var Hi=1;Hi<Bi.length;Hi++){var Ai=(mc(Bi[Hi-1]+" "+Bi[Hi])-mc(Bi[Hi]))*Ra+zl;Hi==Bi.length-1?j.push([Bi[Hi],Ai,0]):j.push([Bi[Hi]+" ",Ai,0]),lh-=Ai}}else j.push([Ut[ca],Qa,ri]);j.push(["",lh,0])}else{if(Cr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],Ns=Ut.length,$r=$r!==0?$r:pc,ca=0;ca<Ns;ca++){ri=ca===0?ii(je):-wn,Qa=ca===0?Ao(ie):0;var $l=Ut[ca].split(" ").length-1,Kc=$l>0?($r-rn[ca])/$l:0;ca<Ns-1?oi.push(ke(Ae(Kc))):oi.push(0),j.push([Ut[ca],Qa,ri])}}}(typeof Ge.R2L=="boolean"?Ge.R2L:Rt)===!0&&(j=so(j,function(Sn,Un,Ca){return[Sn.split("").reverse().join(""),Un,Ca]})),Et={text:j,x:ie,y:je,options:Ge,mutex:{pdfEscape:Ya,activeFontKey:ar,fonts:Qr,activeFontSize:Mt}},Jt.publish("postProcessText",Et),j=Et.text,Ws=Et.mutex.isHex||!1;var gc=Qr[ar].encoding;gc!=="WinAnsiEncoding"&&gc!=="StandardEncoding"||(j=so(j,function(Sn,Un,Ca){return[cs(Sn),Un,Ca]})),Ut=xt(j),j=[];for(var yc,wl,Xo,vc=Array.isArray(Ut[0])?1:0,oo="",ql=function(Sn,Un,Ca){var Es="";return Ca instanceof Yr?(Ca=typeof Ge.angle=="number"?qo(Ca,new Yr(1,0,0,1,Sn,Un)):qo(new Yr(1,0,0,1,Sn,Un),Ca),re===W&&(Ca=qo(new Yr(1,0,0,-1,0,0),Ca)),Es=Ca.join(" ")+` Tm
`):Es=ke(Sn)+" "+ke(Un)+` Td
`,Es},Ts=0;Ts<Ut.length;Ts++){switch(oo="",vc){case 1:Xo=(Ws?"<":"(")+Ut[Ts][0]+(Ws?">":")"),yc=parseFloat(Ut[Ts][1]),wl=parseFloat(Ut[Ts][2]);break;case 0:Xo=(Ws?"<":"(")+Ut[Ts]+(Ws?">":")"),yc=Ao(ie),wl=ii(je)}oi!==void 0&&oi[Ts]!==void 0&&(oo=oi[Ts]+` Tw
`),Ts===0?j.push(oo+ql(yc,wl,Ja)+Xo):vc===0?j.push(oo+Xo):vc===1&&j.push(oo+ql(yc,wl,Ja)+Xo)}j=vc===0?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var Ci=`BT
/`;return Ci+=ar+" "+Mt+` Tf
`,Ci+=ke(Mt*Ml)+` TL
`,Ci+=Yo+`
`,Ci+=Si,Ci+=j,Te(Ci+="ET"),R[ar]=!0,Ba};var aa=k.__private__.clip=k.clip=function(j){return Te(j==="evenodd"?"W*":"W"),this};k.clipEvenOdd=function(){return aa("evenodd")},k.__private__.discardPath=k.discardPath=function(){return Te("n"),this};var Pi=k.__private__.isValidStyle=function(j){var ie=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(ie=!0),ie};k.__private__.setDefaultPathOperation=k.setDefaultPathOperation=function(j){return Pi(j)&&(w=j),this};var rh=k.__private__.getStyle=k.getStyle=function(j){var ie=w;switch(j){case"D":case"S":ie="S";break;case"F":ie="f";break;case"FD":case"DF":ie="B";break;case"f":case"f*":case"B":case"B*":ie=j}return ie},pu=k.close=function(){return Te("h"),this};k.stroke=function(){return Te("S"),this},k.fill=function(j){return Wo("f",j),this},k.fillEvenOdd=function(j){return Wo("f*",j),this},k.fillStroke=function(j){return Wo("B",j),this},k.fillStrokeEvenOdd=function(j){return Wo("B*",j),this};var Wo=function(j,ie){ns(ie)==="object"?Ea(ie,j):Te(j)},Gc=function(j){j===null||re===W&&j===void 0||(j=rh(j),Te(j))};function Ed(j,ie,je,Ge,tt){var Et=new q1(ie||this.boundingBox,je||this.xStep,Ge||this.yStep,this.gState,tt||this.matrix);Et.stream=this.stream;var Ut=j+"$$"+this.cloneIndex+++"$$";return pa(Ut,Et),Et}var Ea=function(j,ie){var je=Jn[j.key],Ge=Lr[je];if(Ge instanceof b0)Te("q"),Te(mu(ie)),Ge.gState&&k.setGState(Ge.gState),Te(j.matrix.toString()+" cm"),Te("/"+je+" sh"),Te("Q");else if(Ge instanceof q1){var tt=new Yr(1,0,0,-1,0,Pl());j.matrix&&(tt=tt.multiply(j.matrix||wo),je=Ed.call(Ge,j.key,j.boundingBox,j.xStep,j.yStep,tt).id),Te("q"),Te("/Pattern cs"),Te("/"+je+" scn"),Ge.gState&&k.setGState(Ge.gState),Te(ie),Te("Q")}},mu=function(j){switch(j){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},nh=k.moveTo=function(j,ie){return Te(ke(Ae(j))+" "+ke(Ce(ie))+" m"),this},Lh=k.lineTo=function(j,ie){return Te(ke(Ae(j))+" "+ke(Ce(ie))+" l"),this},Mi=k.curveTo=function(j,ie,je,Ge,tt,Et){return Te([ke(Ae(j)),ke(Ce(ie)),ke(Ae(je)),ke(Ce(Ge)),ke(Ae(tt)),ke(Ce(Et)),"c"].join(" ")),this};k.__private__.line=k.line=function(j,ie,je,Ge,tt){if(isNaN(j)||isNaN(ie)||isNaN(je)||isNaN(Ge)||!Pi(tt))throw new Error("Invalid arguments passed to jsPDF.line");return re===te?this.lines([[je-j,Ge-ie]],j,ie,[1,1],tt||"S"):this.lines([[je-j,Ge-ie]],j,ie,[1,1]).stroke()},k.__private__.lines=k.lines=function(j,ie,je,Ge,tt,Et){var Ut,wr,Cr,yn,$r,On,bs,Ja,Ba,ei,Ws,Si;if(typeof j=="number"&&(Si=je,je=ie,ie=j,j=Si),Ge=Ge||[1,1],Et=Et||!1,isNaN(ie)||isNaN(je)||!Array.isArray(j)||!Array.isArray(Ge)||!Pi(tt)||typeof Et!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(nh(ie,je),Ut=Ge[0],wr=Ge[1],yn=j.length,ei=ie,Ws=je,Cr=0;Cr<yn;Cr++)($r=j[Cr]).length===2?(ei=$r[0]*Ut+ei,Ws=$r[1]*wr+Ws,Lh(ei,Ws)):(On=$r[0]*Ut+ei,bs=$r[1]*wr+Ws,Ja=$r[2]*Ut+ei,Ba=$r[3]*wr+Ws,ei=$r[4]*Ut+ei,Ws=$r[5]*wr+Ws,Mi(On,bs,Ja,Ba,ei,Ws));return Et&&pu(),Gc(tt),this},k.path=function(j){for(var ie=0;ie<j.length;ie++){var je=j[ie],Ge=je.c;switch(je.op){case"m":nh(Ge[0],Ge[1]);break;case"l":Lh(Ge[0],Ge[1]);break;case"c":Mi.apply(this,Ge);break;case"h":pu()}}return this},k.__private__.rect=k.rect=function(j,ie,je,Ge,tt){if(isNaN(j)||isNaN(ie)||isNaN(je)||isNaN(Ge)||!Pi(tt))throw new Error("Invalid arguments passed to jsPDF.rect");return re===te&&(Ge=-Ge),Te([ke(Ae(j)),ke(Ce(ie)),ke(Ae(je)),ke(Ae(Ge)),"re"].join(" ")),Gc(tt),this},k.__private__.triangle=k.triangle=function(j,ie,je,Ge,tt,Et,Ut){if(isNaN(j)||isNaN(ie)||isNaN(je)||isNaN(Ge)||isNaN(tt)||isNaN(Et)||!Pi(Ut))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[je-j,Ge-ie],[tt-je,Et-Ge],[j-tt,ie-Et]],j,ie,[1,1],Ut,!0),this},k.__private__.roundedRect=k.roundedRect=function(j,ie,je,Ge,tt,Et,Ut){if(isNaN(j)||isNaN(ie)||isNaN(je)||isNaN(Ge)||isNaN(tt)||isNaN(Et)||!Pi(Ut))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var wr=4/3*(Math.SQRT2-1);return tt=Math.min(tt,.5*je),Et=Math.min(Et,.5*Ge),this.lines([[je-2*tt,0],[tt*wr,0,tt,Et-Et*wr,tt,Et],[0,Ge-2*Et],[0,Et*wr,-tt*wr,Et,-tt,Et],[2*tt-je,0],[-tt*wr,0,-tt,-Et*wr,-tt,-Et],[0,2*Et-Ge],[0,-Et*wr,tt*wr,-Et,tt,-Et]],j+tt,ie,[1,1],Ut,!0),this},k.__private__.ellipse=k.ellipse=function(j,ie,je,Ge,tt){if(isNaN(j)||isNaN(ie)||isNaN(je)||isNaN(Ge)||!Pi(tt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Et=4/3*(Math.SQRT2-1)*je,Ut=4/3*(Math.SQRT2-1)*Ge;return nh(j+je,ie),Mi(j+je,ie-Ut,j+Et,ie-Ge,j,ie-Ge),Mi(j-Et,ie-Ge,j-je,ie-Ut,j-je,ie),Mi(j-je,ie+Ut,j-Et,ie+Ge,j,ie+Ge),Mi(j+Et,ie+Ge,j+je,ie+Ut,j+je,ie),Gc(tt),this},k.__private__.circle=k.circle=function(j,ie,je,Ge){if(isNaN(j)||isNaN(ie)||isNaN(je)||!Pi(Ge))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,ie,je,je,Ge)},k.setFont=function(j,ie,je){return je&&(ie=De(ie,je)),ar=is(j,ie,{disableWarning:!1}),this};var ao=k.__private__.getFont=k.getFont=function(){return Qr[is.apply(k,arguments)]};k.__private__.getFontList=k.getFontList=function(){var j,ie,je={};for(j in xr)if(xr.hasOwnProperty(j))for(ie in je[j]=[],xr[j])xr[j].hasOwnProperty(ie)&&je[j].push(ie);return je},k.addFont=function(j,ie,je,Ge,tt){var Et=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Et.indexOf(arguments[3])!==-1?tt=arguments[3]:arguments[3]&&Et.indexOf(arguments[3])==-1&&(je=De(je,Ge)),ss.call(this,j,ie,je,tt=tt||"Identity-H")};var Ko,Xn=i.lineWidth||.200025,xi=k.__private__.getLineWidth=k.getLineWidth=function(){return Xn},tn=k.__private__.setLineWidth=k.setLineWidth=function(j){return Xn=j,Te(ke(Ae(j))+" w"),this};k.__private__.setLineDash=en.API.setLineDash=en.API.setLineDashPattern=function(j,ie){if(j=j||[],ie=ie||0,isNaN(ie)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map(function(je){return ke(Ae(je))}).join(" "),ie=ke(Ae(ie)),Te("["+j+"] "+ie+" d"),this};var Ph=k.__private__.getLineHeight=k.getLineHeight=function(){return Mt*Ko};k.__private__.getLineHeight=k.getLineHeight=function(){return Mt*Ko};var Mh=k.__private__.setLineHeightFactor=k.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(Ko=j),this},kd=k.__private__.getLineHeightFactor=k.getLineHeightFactor=function(){return Ko};Mh(i.lineHeight);var Ao=k.__private__.getHorizontalCoordinate=function(j){return Ae(j)},ii=k.__private__.getVerticalCoordinate=function(j){return re===W?j:Wr[ae].mediaBox.topRightY-Wr[ae].mediaBox.bottomLeftY-Ae(j)},ah=k.__private__.getHorizontalCoordinateString=k.getHorizontalCoordinateString=function(j){return ke(Ao(j))},vs=k.__private__.getVerticalCoordinateString=k.getVerticalCoordinateString=function(j){return ke(ii(j))},wi=i.strokeColor||"0 G";k.__private__.getStrokeColor=k.getDrawColor=function(){return vn(wi)},k.__private__.setStrokeColor=k.setDrawColor=function(j,ie,je,Ge){return wi=Cs({ch1:j,ch2:ie,ch3:je,ch4:Ge,pdfColorType:"draw",precision:2}),Te(wi),this};var Xt=i.fillColor||"0 g";k.__private__.getFillColor=k.getFillColor=function(){return vn(Xt)},k.__private__.setFillColor=k.setFillColor=function(j,ie,je,Ge){return Xt=Cs({ch1:j,ch2:ie,ch3:je,ch4:Ge,pdfColorType:"fill",precision:2}),Te(Xt),this};var Yo=i.textColor||"0 g",sh=k.__private__.getTextColor=k.getTextColor=function(){return vn(Yo)};k.__private__.setTextColor=k.setTextColor=function(j,ie,je,Ge){return Yo=Cs({ch1:j,ch2:ie,ch3:je,ch4:Ge,pdfColorType:"text",precision:3}),this};var Ui=i.charSpace,ls=k.__private__.getCharSpace=k.getCharSpace=function(){return parseFloat(Ui||0)};k.__private__.setCharSpace=k.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ui=j,this};var Jo=0;k.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},k.__private__.setLineCap=k.setLineCap=function(j){var ie=k.CapJoinStyles[j];if(ie===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Jo=ie,Te(ie+" J"),this};var wa=0;k.__private__.setLineJoin=k.setLineJoin=function(j){var ie=k.CapJoinStyles[j];if(ie===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return wa=ie,Te(ie+" j"),this},k.__private__.setLineMiterLimit=k.__private__.setMiterLimit=k.setLineMiterLimit=k.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Te(ke(Ae(j))+" M"),this},k.GState=hy,k.setGState=function(j){(j=typeof j=="string"?on[gn[j]]:vl(null,j)).equals(xa)||(Te("/"+j.id+" gs"),xa=j)};var vl=function(j,ie){if(!j||!gn[j]){var je=!1;for(var Ge in on)if(on.hasOwnProperty(Ge)&&on[Ge].equals(ie)){je=!0;break}if(je)ie=on[Ge];else{var tt="GS"+(Object.keys(on).length+1).toString(10);on[tt]=ie,ie.id=tt}return j&&(gn[j]=ie.id),Jt.publish("addGState",ie),ie}};k.addGState=function(j,ie){return vl(j,ie),this},k.saveGraphicsState=function(){return Te("q"),an.push({key:ar,size:Mt,color:Yo}),this},k.restoreGraphicsState=function(){Te("Q");var j=an.pop();return ar=j.key,Mt=j.size,Yo=j.color,xa=null,this},k.setCurrentTransformationMatrix=function(j){return Te(j.toString()+" cm"),this},k.comment=function(j){return Te("#"+j),this};var Co=function(j,ie){var je=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return je},set:function(Et){isNaN(Et)||(je=parseFloat(Et))}});var Ge=ie||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ge},set:function(Et){isNaN(Et)||(Ge=parseFloat(Et))}});var tt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return tt},set:function(Et){tt=Et.toString()}}),this},Fl=function(j,ie,je,Ge){Co.call(this,j,ie),this.type="rect";var tt=je||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return tt},set:function(Ut){isNaN(Ut)||(tt=parseFloat(Ut))}});var Et=Ge||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Et},set:function(Ut){isNaN(Ut)||(Et=parseFloat(Ut))}}),this},gu=function(){this.page=fn,this.currentPage=ae,this.pages=yt.slice(0),this.pagesContext=Wr.slice(0),this.x=Ar,this.y=ra,this.matrix=Nn,this.width=jl(ae),this.height=ih(ae),this.outputDestination=bt,this.id="",this.objectNumber=-1};gu.prototype.restore=function(){fn=this.page,ae=this.currentPage,Wr=this.pagesContext,yt=this.pages,Ar=this.x,ra=this.y,Nn=this.matrix,Wc(ae,this.width),Ol(ae,this.height),bt=this.outputDestination};var Vc=function(j,ie,je,Ge,tt){xo.push(new gu),fn=ae=0,yt=[],Ar=j,ra=ie,Nn=tt,Vo([je,Ge])};for(var Rl in k.beginFormObject=function(j,ie,je,Ge,tt){return Vc(j,ie,je,Ge,tt),this},k.endFormObject=function(j){return(function(ie){if(fa[ie])xo.pop().restore();else{var je=new gu,Ge="Xo"+(Object.keys(Vs).length+1).toString(10);je.id=Ge,fa[ie]=Ge,Vs[Ge]=je,Jt.publish("addFormObject",je),xo.pop().restore()}})(j),this},k.doFormObject=function(j,ie){var je=Vs[fa[j]];return Te("q"),Te(ie.toString()+" cm"),Te("/"+je.id+" Do"),Te("Q"),this},k.getFormObject=function(j){var ie=Vs[fa[j]];return{x:ie.x,y:ie.y,width:ie.width,height:ie.height,matrix:ie.matrix}},k.save=function(j,ie){return j=j||"generated.pdf",(ie=ie||{}).returnPromise=ie.returnPromise||!1,ie.returnPromise===!1?(g0(dc(Zs()),j),typeof g0.unload=="function"&&kn.setTimeout&&setTimeout(g0.unload,911),this):new Promise(function(je,Ge){try{var tt=g0(dc(Zs()),j);typeof g0.unload=="function"&&kn.setTimeout&&setTimeout(g0.unload,911),je(tt)}catch(Et){Ge(Et.message)}})},en.API)en.API.hasOwnProperty(Rl)&&(Rl==="events"&&en.API.events.length?(function(j,ie){var je,Ge,tt;for(tt=ie.length-1;tt!==-1;tt--)je=ie[tt][0],Ge=ie[tt][1],j.subscribe.apply(j,[je].concat(typeof Ge=="function"?[Ge]:Ge))})(Jt,en.API.events):k[Rl]=en.API[Rl]);function jl(j){return Wr[j].mediaBox.topRightX-Wr[j].mediaBox.bottomLeftX}function Wc(j,ie){Wr[j].mediaBox.topRightX=ie+Wr[j].mediaBox.bottomLeftX}function ih(j){return Wr[j].mediaBox.topRightY-Wr[j].mediaBox.bottomLeftY}function Ol(j,ie){Wr[j].mediaBox.topRightY=ie+Wr[j].mediaBox.bottomLeftY}var Ll=k.getPageWidth=function(j){return jl(j=j||ae)/_r},yu=k.setPageWidth=function(j,ie){Wc(j,ie*_r)},Pl=k.getPageHeight=function(j){return ih(j=j||ae)/_r},fc=k.setPageHeight=function(j,ie){Ol(j,ie*_r)};return k.internal={pdfEscape:Ya,getStyle:rh,getFont:ao,getFontSize:Qe,getCharSpace:ls,getTextColor:sh,getLineHeight:Ph,getLineHeightFactor:kd,getLineWidth:xi,write:Ht,getHorizontalCoordinate:Ao,getVerticalCoordinate:ii,getCoordinateString:ah,getVerticalCoordinateString:vs,collections:{},newObject:as,newAdditionalObject:pl,newObjectDeferred:Ps,newObjectDeferredBegin:Ms,getFilters:jn,putStream:na,events:Jt,scaleFactor:_r,pageSize:{getWidth:function(){return Ll(ae)},setWidth:function(j){yu(ae,j)},getHeight:function(){return Pl(ae)},setHeight:function(j){fc(ae,j)}},encryptionOptions:A,encryption:Bs,getEncryptor:function(j){return A!==null?Bs.encryptor(j,0):function(ie){return ie}},output:th,getNumberOfPages:hc,get pages(){return yt},out:Te,f2:z,f3:K,getPageInfo:cn,getPageInfoByObjId:qc,getCurrentPageInfo:Td,getPDFVersion:V,Point:Co,Rectangle:Fl,Matrix:Yr,hasHotfix:Li},Object.defineProperty(k.internal.pageSize,"width",{get:function(){return Ll(ae)},set:function(j){yu(ae,j)},enumerable:!0,configurable:!0}),Object.defineProperty(k.internal.pageSize,"height",{get:function(){return Pl(ae)},set:function(j){fc(ae,j)},enumerable:!0,configurable:!0}),(function(j){for(var ie=0,je=Vr.length;ie<je;ie++){var Ge=ss.call(this,j[ie][0],j[ie][1],j[ie][2],Vr[ie][3],!0);I===!1&&(R[Ge]=!0);var tt=j[ie][0].split("-");ys({id:Ge,fontName:tt[0],fontStyle:tt[1]||""})}Jt.publish("addFonts",{fonts:Qr,dictionary:xr})}).call(k,Vr),ar="F1",mn(n,r),Jt.publish("initialized"),k}H1.prototype.lsbFirstWord=function(i){return String.fromCharCode(255&i,i>>8&255,i>>16&255,i>>24&255)},H1.prototype.toHexString=function(i){return i.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},H1.prototype.hexToBytes=function(i){for(var t=[],r=0;r<i.length;r+=2)t.push(String.fromCharCode(parseInt(i.substr(r,2),16)));return t.join("")},H1.prototype.processOwnerPassword=function(i,t){return Rv(Fv(t).substr(0,5),i)},H1.prototype.encryptor=function(i,t){var r=Fv(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return Rv(r,a)}},hy.prototype.equals=function(i){var t,r="id,objectNumber,equals";if(!i||ns(i)!==ns(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!i.hasOwnProperty(t)||this[t]!==i[t])return!1;a++}for(t in i)i.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},en.API={events:[]},en.version="3.0.4";var yi=en.API,bx=1,M0=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},O1=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Rn=function(i){return i.toFixed(2)},df=function(i){return i.toFixed(5)};yi.__acroform__={};var cc=function(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i},L3=function(i){return i*bx},Th=function(i){var t=new ZS,r=Hr.internal.getHeight(i)||0,a=Hr.internal.getWidth(i)||0;return t.BBox=[0,0,Number(Rn(a)),Number(Rn(r))],t},GD=yi.__acroform__.setBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|1<<t},VD=yi.__acroform__.clearBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&~(1<<t)},WD=yi.__acroform__.getBit=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<t?1:0},_i=yi.__acroform__.getBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return WD(i,t-1)},Ii=yi.__acroform__.setBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return GD(i,t-1)},Di=yi.__acroform__.clearBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return VD(i,t-1)},KD=yi.__acroform__.calculateCoordinates=function(i,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=i[0],e=i[1],p=i[2],m=i[3],y={};return y.lowerLeft_X=r(n)||0,y.lowerLeft_Y=a(e+m)||0,y.upperRight_X=r(n+p)||0,y.upperRight_Y=a(e)||0,[Number(Rn(y.lowerLeft_X)),Number(Rn(y.lowerLeft_Y)),Number(Rn(y.upperRight_X)),Number(Rn(y.upperRight_Y))]},YD=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var t=[],r=i._V||i.DV,a=jv(i,r),n=i.scope.internal.getFont(i.fontName,i.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(i.scope.__private__.encodeColorString(i.color)),t.push("/"+n+" "+Rn(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var e=Th(i);return e.scope=i.scope,e.stream=t.join(`
`),e}},jv=function(i,t){var r=i.fontSize===0?i.maxFontSize:i.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=i.multiline?n.map(function(z){return z.split(`
`)}):n.map(function(z){return[z]});var e=r,p=Hr.internal.getHeight(i)||0;p=p<0?-p:p;var m=Hr.internal.getWidth(i)||0;m=m<0?-m:m;var y=function(z,K,Ae){if(z+1<n.length){var Ce=K+" "+n[z+1][0];return d2(Ce,i,Ae).width<=m-4}return!1};e++;e:for(;e>0;){t="",e--;var w,A,I=d2("3",i,e).height,R=i.multiline?p-e:(p-I)/2,k=R+=2,M=0,V=0,q=0;if(e<=0){t=`(...) Tj
`,t+="% Width of Text: "+d2(t,i,e=12).width+", FieldWidth:"+m+`
`;break}for(var U="",te=0,W=0;W<n.length;W++)if(n.hasOwnProperty(W)){var re=!1;if(n[W].length!==1&&q!==n[W].length-1){if((I+2)*(te+2)+2>p)continue e;U+=n[W][q],re=!0,V=W,W--}else{U=(U+=n[W][q]+" ").substr(U.length-1)==" "?U.substr(0,U.length-1):U;var xe=parseInt(W),ve=y(xe,U,e),De=W>=n.length-1;if(ve&&!De){U+=" ",q=0;continue}if(ve||De){if(De)V=xe;else if(i.multiline&&(I+2)*(te+2)+2>p)continue e}else{if(!i.multiline||(I+2)*(te+2)+2>p)continue e;V=xe}}for(var ke="",de=M;de<=V;de++){var Oe=n[de];if(i.multiline){if(de===V){ke+=Oe[q]+" ",q=(q+1)%Oe.length;continue}if(de===M){ke+=Oe[Oe.length-1]+" ";continue}}ke+=Oe[0]+" "}switch(ke=ke.substr(ke.length-1)==" "?ke.substr(0,ke.length-1):ke,A=d2(ke,i,e).width,i.textAlign){case"right":w=m-A-2;break;case"center":w=(m-A)/2;break;default:w=2}t+=Rn(w)+" "+Rn(k)+` Td
`,t+="("+M0(ke)+`) Tj
`,t+=-Rn(w)+` 0 Td
`,k=-(e+2),A=0,M=re?V:V+1,te++,U=""}break}return a.text=t,a.fontSize=e,a},d2=function(i,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(i,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},JD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},QD=function(i,t){var r={type:"reference",object:i};t.internal.getPageInfo(i.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(i.page).pageContext.annotations.push(r)},XD=function(i,t){if(t.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(Xu.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(JD)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");bx=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new eA,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var e=a[n];e.objId=void 0,e.hasAnnotation&&QD(e,r)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(r){(function(a,n){var e=!a;for(var p in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(p)){var m=a[p],y=[],w=m.Rect;if(m.Rect&&(m.Rect=KD(m.Rect,n)),n.internal.newObjectDeferredBegin(m.objId,!0),m.DA=Hr.createDefaultAppearanceStream(m),ns(m)==="object"&&typeof m.getKeyValueListForStream=="function"&&(y=m.getKeyValueListForStream()),m.Rect=w,m.hasAppearanceStream&&!m.appearanceStreamContent){var A=YD(m);y.push({key:"AP",value:"<</N "+A+">>"}),n.internal.acroformPlugin.xForms.push(A)}if(m.appearanceStreamContent){var I="";for(var R in m.appearanceStreamContent)if(m.appearanceStreamContent.hasOwnProperty(R)){var k=m.appearanceStreamContent[R];if(I+="/"+R+" ",I+="<<",Object.keys(k).length>=1||Array.isArray(k)){for(var p in k)if(k.hasOwnProperty(p)){var M=k[p];typeof M=="function"&&(M=M.call(n,m)),I+="/"+p+" "+M+" ",n.internal.acroformPlugin.xForms.indexOf(M)>=0||n.internal.acroformPlugin.xForms.push(M)}}else typeof(M=k)=="function"&&(M=M.call(n,m)),I+="/"+p+" "+M,n.internal.acroformPlugin.xForms.indexOf(M)>=0||n.internal.acroformPlugin.xForms.push(M);I+=">>"}y.push({key:"AP",value:`<<
`+I+">>"})}n.internal.putStream({additionalKeyValues:y,objectId:m.objId}),n.internal.out("endobj")}e&&(function(V,q){for(var U in V)if(V.hasOwnProperty(U)){var te=U,W=V[U];q.internal.newObjectDeferredBegin(W.objId,!0),ns(W)==="object"&&typeof W.putStream=="function"&&W.putStream(),delete V[te]}})(n.internal.acroformPlugin.xForms,n)})(r,i)}),i.internal.acroformPlugin.isInitialized=!0}},XS=yi.__acroform__.arrayToPdfArray=function(i,t,r){var a=function(p){return p};if(Array.isArray(i)){for(var n="[",e=0;e<i.length;e++)switch(e!==0&&(n+=" "),ns(i[e])){case"boolean":case"number":case"object":n+=i[e].toString();break;case"string":i[e].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+M0(a(i[e].toString()))+")"):n+=i[e].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},j5=function(i,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(i=i||"").toString(),"("+M0(a(i))+")"},Dh=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Dh.prototype.toString=function(){return this.objId+" 0 R"},Dh.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},Dh.prototype.getKeyValueListForStream=function(){var i=[],t=Object.getOwnPropertyNames(this).filter(function(e){return e!="content"&&e!="appearanceStreamContent"&&e!="scope"&&e!="objId"&&e.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?i.push({key:a,value:XS(n,this.objId,this.scope)}):n instanceof Dh?(n.scope=this.scope,i.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&i.push({key:a,value:n}))}return i};var ZS=function(){Dh.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){i=r.trim()},get:function(){return i||null}})};cc(ZS,Dh);var eA=function(){Dh.call(this);var i,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+M0(r(i))+")"}},set:function(r){i=r}})};cc(eA,Dh);var Xu=function i(){Dh.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(U){if(isNaN(U))throw new Error('Invalid value "'+U+'" for attribute F supplied.');t=U}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!_i(t,3)},set:function(U){U?this.F=Ii(t,3):this.F=Di(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(U){if(isNaN(U))throw new Error('Invalid value "'+U+'" for attribute Ff supplied.');r=U}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(U){a=U!==void 0?U:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(U){a[0]=U}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(U){a[1]=U}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(U){a[2]=U}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(U){a[3]=U}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(U){switch(U){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=U;break;default:throw new Error('Invalid value "'+U+'" for attribute FT supplied.')}}});var e=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!e||e.length<1){if(this instanceof dy)return;e="FieldObject"+i.FieldNum++}var U=function(te){return te};return this.scope&&(U=this.scope.internal.getEncryptor(this.objId)),"("+M0(U(e))+")"},set:function(U){e=U.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return e},set:function(U){e=U}});var p="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return p},set:function(U){p=U}});var m="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return m},set:function(U){m=U}});var y=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return y},set:function(U){y=U}});var w=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return w===void 0?50/bx:w},set:function(U){w=U}});var A="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return A},set:function(U){A=U}});var I="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!I||this instanceof dy||this instanceof T0))return j5(I,this.objId,this.scope)},set:function(U){U=U.toString(),I=U}});var R=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(R)return this instanceof yo==0?j5(R,this.objId,this.scope):R},set:function(U){U=U.toString(),R=this instanceof yo==0?U.substr(0,1)==="("?O1(U.substr(1,U.length-2)):O1(U):U}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof yo==1?O1(R.substr(1,R.length-1)):R},set:function(U){U=U.toString(),R=this instanceof yo==1?"/"+U:U}});var k=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(k)return k},set:function(U){this.V=U}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(k)return this instanceof yo==0?j5(k,this.objId,this.scope):k},set:function(U){U=U.toString(),k=this instanceof yo==0?U.substr(0,1)==="("?O1(U.substr(1,U.length-2)):O1(U):U}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof yo==1?O1(k.substr(1,k.length-1)):k},set:function(U){U=U.toString(),k=this instanceof yo==1?"/"+U:U}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var M,V=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return V},set:function(U){U=!!U,V=U}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(M)return M},set:function(U){M=U}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,1)},set:function(U){U?this.Ff=Ii(this.Ff,1):this.Ff=Di(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,2)},set:function(U){U?this.Ff=Ii(this.Ff,2):this.Ff=Di(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,3)},set:function(U){U?this.Ff=Ii(this.Ff,3):this.Ff=Di(this.Ff,3)}});var q=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(q!==null)return q},set:function(U){if([0,1,2].indexOf(U)===-1)throw new Error('Invalid value "'+U+'" for attribute Q supplied.');q=U}}),Object.defineProperty(this,"textAlign",{get:function(){var U;switch(q){case 0:default:U="left";break;case 1:U="center";break;case 2:U="right"}return U},configurable:!0,enumerable:!0,set:function(U){switch(U){case"right":case 2:q=2;break;case"center":case 1:q=1;break;default:q=0}}})};cc(Xu,Dh);var X1=function(){Xu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(r){i=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(r){i=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return XS(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(e,p,m){m||(m=1);for(var y,w=[];y=p.exec(e);)w.push(y[m]);return w})(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,18)},set:function(r){r?this.Ff=Ii(this.Ff,18):this.Ff=Di(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ii(this.Ff,19):this.Ff=Di(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,20)},set:function(r){r?(this.Ff=Ii(this.Ff,20),t.sort()):this.Ff=Di(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,22)},set:function(r){r?this.Ff=Ii(this.Ff,22):this.Ff=Di(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,23)},set:function(r){r?this.Ff=Ii(this.Ff,23):this.Ff=Di(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,27)},set:function(r){r?this.Ff=Ii(this.Ff,27):this.Ff=Di(this.Ff,27)}}),this.hasAppearanceStream=!1};cc(X1,Xu);var Z1=function(){X1.call(this),this.fontName="helvetica",this.combo=!1};cc(Z1,X1);var ep=function(){Z1.call(this),this.combo=!0};cc(ep,Z1);var k2=function(){ep.call(this),this.edit=!0};cc(k2,ep);var yo=function(){Xu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,15)},set:function(r){r?this.Ff=Ii(this.Ff,15):this.Ff=Di(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,16)},set:function(r){r?this.Ff=Ii(this.Ff,16):this.Ff=Di(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,17)},set:function(r){r?this.Ff=Ii(this.Ff,17):this.Ff=Di(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,26)},set:function(r){r?this.Ff=Ii(this.Ff,26):this.Ff=Di(this.Ff,26)}});var i,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(e){return e};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+M0(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){ns(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(r){i=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(r){i="/"+r}})};cc(yo,Xu);var _2=function(){yo.call(this),this.pushButton=!0};cc(_2,yo);var tp=function(){yo.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t!==void 0?t:[]}})};cc(tp,yo);var dy=function(){var i,t;Xu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(n){i=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(m){return m};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var e,p=[];for(e in p.push("<<"),a)p.push("/"+e+" ("+M0(n(a[e]))+")");return p.push(">>"),p.join(`
`)},set:function(n){ns(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Hr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};cc(dy,Xu),tp.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=i.createAppearanceStream(r.optionName),r.caption=i.getCA()}},tp.prototype.createOption=function(i){var t=new dy;return t.Parent=this,t.optionName=i,this.Kids.push(t),ZD.call(this.scope,t),t};var I2=function(){yo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Hr.CheckBox.createAppearanceStream()};cc(I2,yo);var T0=function(){Xu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,13)},set:function(t){t?this.Ff=Ii(this.Ff,13):this.Ff=Di(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,21)},set:function(t){t?this.Ff=Ii(this.Ff,21):this.Ff=Di(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,23)},set:function(t){t?this.Ff=Ii(this.Ff,23):this.Ff=Di(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,24)},set:function(t){t?this.Ff=Ii(this.Ff,24):this.Ff=Di(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,25)},set:function(t){t?this.Ff=Ii(this.Ff,25):this.Ff=Di(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,26)},set:function(t){t?this.Ff=Ii(this.Ff,26):this.Ff=Di(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){Number.isInteger(t)&&(i=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};cc(T0,Xu);var D2=function(){T0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,14)},set:function(i){i?this.Ff=Ii(this.Ff,14):this.Ff=Di(this.Ff,14)}}),this.password=!0};cc(D2,T0);var Hr={CheckBox:{createAppearanceStream:function(){return{N:{On:Hr.CheckBox.YesNormal},D:{On:Hr.CheckBox.YesPushDown,Off:Hr.CheckBox.OffPushDown}}},YesPushDown:function(i){var t=Th(i);t.scope=i.scope;var r=[],a=i.scope.internal.getFont(i.fontName,i.fontStyle).id,n=i.scope.__private__.encodeColorString(i.color),e=jv(i,i.caption);return r.push("0.749023 g"),r.push("0 0 "+Rn(Hr.internal.getWidth(i))+" "+Rn(Hr.internal.getHeight(i))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Rn(e.fontSize)+" Tf "+n),r.push("BT"),r.push(e.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(i){var t=Th(i);t.scope=i.scope;var r=i.scope.internal.getFont(i.fontName,i.fontStyle).id,a=i.scope.__private__.encodeColorString(i.color),n=[],e=Hr.internal.getHeight(i),p=Hr.internal.getWidth(i),m=jv(i,i.caption);return n.push("1 g"),n.push("0 0 "+Rn(p)+" "+Rn(e)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Rn(p-1)+" "+Rn(e-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Rn(m.fontSize)+" Tf "+a),n.push(m.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(i){var t=Th(i);t.scope=i.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Rn(Hr.internal.getWidth(i))+" "+Rn(Hr.internal.getHeight(i))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(i){var t={D:{Off:Hr.RadioButton.Circle.OffPushDown},N:{}};return t.N[i]=Hr.RadioButton.Circle.YesNormal,t.D[i]=Hr.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(i){var t=Th(i);t.scope=i.scope;var r=[],a=Hr.internal.getWidth(i)<=Hr.internal.getHeight(i)?Hr.internal.getWidth(i)/4:Hr.internal.getHeight(i)/4;a=Number((.9*a).toFixed(5));var n=Hr.internal.Bezier_C,e=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+df(Hr.internal.getWidth(i)/2)+" "+df(Hr.internal.getHeight(i)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+e+" "+e+" "+a+" 0 "+a+" c"),r.push("-"+e+" "+a+" -"+a+" "+e+" -"+a+" 0 c"),r.push("-"+a+" -"+e+" -"+e+" -"+a+" 0 -"+a+" c"),r.push(e+" -"+a+" "+a+" -"+e+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(i){var t=Th(i);t.scope=i.scope;var r=[],a=Hr.internal.getWidth(i)<=Hr.internal.getHeight(i)?Hr.internal.getWidth(i)/4:Hr.internal.getHeight(i)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),e=Number((n*Hr.internal.Bezier_C).toFixed(5)),p=Number((a*Hr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+df(Hr.internal.getWidth(i)/2)+" "+df(Hr.internal.getHeight(i)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+e+" "+e+" "+n+" 0 "+n+" c"),r.push("-"+e+" "+n+" -"+n+" "+e+" -"+n+" 0 c"),r.push("-"+n+" -"+e+" -"+e+" -"+n+" 0 -"+n+" c"),r.push(e+" -"+n+" "+n+" -"+e+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+df(Hr.internal.getWidth(i)/2)+" "+df(Hr.internal.getHeight(i)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+p+" "+p+" "+a+" 0 "+a+" c"),r.push("-"+p+" "+a+" -"+a+" "+p+" -"+a+" 0 c"),r.push("-"+a+" -"+p+" -"+p+" -"+a+" 0 -"+a+" c"),r.push(p+" -"+a+" "+a+" -"+p+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(i){var t=Th(i);t.scope=i.scope;var r=[],a=Hr.internal.getWidth(i)<=Hr.internal.getHeight(i)?Hr.internal.getWidth(i)/4:Hr.internal.getHeight(i)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),e=Number((n*Hr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+df(Hr.internal.getWidth(i)/2)+" "+df(Hr.internal.getHeight(i)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+e+" "+e+" "+n+" 0 "+n+" c"),r.push("-"+e+" "+n+" -"+n+" "+e+" -"+n+" 0 c"),r.push("-"+n+" -"+e+" -"+e+" -"+n+" 0 -"+n+" c"),r.push(e+" -"+n+" "+n+" -"+e+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(i){var t={D:{Off:Hr.RadioButton.Cross.OffPushDown},N:{}};return t.N[i]=Hr.RadioButton.Cross.YesNormal,t.D[i]=Hr.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(i){var t=Th(i);t.scope=i.scope;var r=[],a=Hr.internal.calculateCross(i);return r.push("q"),r.push("1 1 "+Rn(Hr.internal.getWidth(i)-2)+" "+Rn(Hr.internal.getHeight(i)-2)+" re"),r.push("W"),r.push("n"),r.push(Rn(a.x1.x)+" "+Rn(a.x1.y)+" m"),r.push(Rn(a.x2.x)+" "+Rn(a.x2.y)+" l"),r.push(Rn(a.x4.x)+" "+Rn(a.x4.y)+" m"),r.push(Rn(a.x3.x)+" "+Rn(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(i){var t=Th(i);t.scope=i.scope;var r=Hr.internal.calculateCross(i),a=[];return a.push("0.749023 g"),a.push("0 0 "+Rn(Hr.internal.getWidth(i))+" "+Rn(Hr.internal.getHeight(i))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Rn(Hr.internal.getWidth(i)-2)+" "+Rn(Hr.internal.getHeight(i)-2)+" re"),a.push("W"),a.push("n"),a.push(Rn(r.x1.x)+" "+Rn(r.x1.y)+" m"),a.push(Rn(r.x2.x)+" "+Rn(r.x2.y)+" l"),a.push(Rn(r.x4.x)+" "+Rn(r.x4.y)+" m"),a.push(Rn(r.x3.x)+" "+Rn(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(i){var t=Th(i);t.scope=i.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Rn(Hr.internal.getWidth(i))+" "+Rn(Hr.internal.getHeight(i))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(i){var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,r=i.scope.__private__.encodeColorString(i.color);return"/"+t+" "+i.fontSize+" Tf "+r}};Hr.internal={Bezier_C:.551915024494,calculateCross:function(i){var t=Hr.internal.getWidth(i),r=Hr.internal.getHeight(i),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},Hr.internal.getWidth=function(i){var t=0;return ns(i)==="object"&&(t=L3(i.Rect[2])),t},Hr.internal.getHeight=function(i){var t=0;return ns(i)==="object"&&(t=L3(i.Rect[3])),t};var ZD=yi.addField=function(i){if(XD(this,i),!(i instanceof Xu))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=i).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};yi.AcroFormChoiceField=X1,yi.AcroFormListBox=Z1,yi.AcroFormComboBox=ep,yi.AcroFormEditBox=k2,yi.AcroFormButton=yo,yi.AcroFormPushButton=_2,yi.AcroFormRadioButton=tp,yi.AcroFormCheckBox=I2,yi.AcroFormTextField=T0,yi.AcroFormPasswordField=D2,yi.AcroFormAppearance=Hr,yi.AcroForm={ChoiceField:X1,ListBox:Z1,ComboBox:ep,EditBox:k2,Button:yo,PushButton:_2,RadioButton:tp,CheckBox:I2,TextField:T0,PasswordField:D2,Appearance:Hr},en.AcroForm={ChoiceField:X1,ListBox:Z1,ComboBox:ep,EditBox:k2,Button:yo,PushButton:_2,RadioButton:tp,CheckBox:I2,TextField:T0,PasswordField:D2,Appearance:Hr};en.AcroForm;function tA(i){return i.reduce(function(t,r,a){return t[r]=a,t},{})}(function(i){var t="addImage_";i.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=i.__addimage__.getImageFileTypeByImageData=function(z,K){var Ae,Ce,Be,Ee,Pe,Ue=r;if((K=K||r)==="RGBA"||z.data!==void 0&&z.data instanceof Uint8ClampedArray&&"height"in z&&"width"in z)return"RGBA";if(ve(z))for(Pe in a)for(Be=a[Pe],Ae=0;Ae<Be.length;Ae+=1){for(Ee=!0,Ce=0;Ce<Be[Ae].length;Ce+=1)if(Be[Ae][Ce]!==void 0&&Be[Ae][Ce]!==z[Ce]){Ee=!1;break}if(Ee===!0){Ue=Pe;break}}else for(Pe in a)for(Be=a[Pe],Ae=0;Ae<Be.length;Ae+=1){for(Ee=!0,Ce=0;Ce<Be[Ae].length;Ce+=1)if(Be[Ae][Ce]!==void 0&&Be[Ae][Ce]!==z.charCodeAt(Ce)){Ee=!1;break}if(Ee===!0){Ue=Pe;break}}return Ue===r&&K!==r&&(Ue=K),Ue},e=function z(K){for(var Ae=this.internal.write,Ce=this.internal.putStream,Be=(0,this.internal.getFilters)();Be.indexOf("FlateEncode")!==-1;)Be.splice(Be.indexOf("FlateEncode"),1);K.objectId=this.internal.newObject();var Ee=[];if(Ee.push({key:"Type",value:"/XObject"}),Ee.push({key:"Subtype",value:"/Image"}),Ee.push({key:"Width",value:K.width}),Ee.push({key:"Height",value:K.height}),K.colorSpace===U.INDEXED?Ee.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(K.palette.length/3-1)+" "+("sMask"in K&&K.sMask!==void 0?K.objectId+2:K.objectId+1)+" 0 R]"}):(Ee.push({key:"ColorSpace",value:"/"+K.colorSpace}),K.colorSpace===U.DEVICE_CMYK&&Ee.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Ee.push({key:"BitsPerComponent",value:K.bitsPerComponent}),"decodeParameters"in K&&K.decodeParameters!==void 0&&Ee.push({key:"DecodeParms",value:"<<"+K.decodeParameters+">>"}),"transparency"in K&&Array.isArray(K.transparency)&&K.transparency.length>0){for(var Pe="",Ue=0,_e=K.transparency.length;Ue<_e;Ue++)Pe+=K.transparency[Ue]+" "+K.transparency[Ue]+" ";Ee.push({key:"Mask",value:"["+Pe+"]"})}K.sMask!==void 0&&Ee.push({key:"SMask",value:K.objectId+1+" 0 R"});var Le=K.filter!==void 0?["/"+K.filter]:void 0;if(Ce({data:K.data,additionalKeyValues:Ee,alreadyAppliedFilters:Le,objectId:K.objectId}),Ae("endobj"),"sMask"in K&&K.sMask!==void 0){var X,H=(X=K.sMaskBitsPerComponent)!==null&&X!==void 0?X:K.bitsPerComponent,ae={width:K.width,height:K.height,colorSpace:"DeviceGray",bitsPerComponent:H,data:K.sMask};"filter"in K&&(ae.decodeParameters="/Predictor ".concat(K.predictor," /Colors 1 /BitsPerComponent ").concat(H," /Columns ").concat(K.width),ae.filter=K.filter),z.call(this,ae)}if(K.colorSpace===U.INDEXED){var Z=this.internal.newObject();Ce({data:ke(new Uint8Array(K.palette)),objectId:Z}),Ae("endobj")}},p=function(){var z=this.internal.collections[t+"images"];for(var K in z)e.call(this,z[K])},m=function(){var z,K=this.internal.collections[t+"images"],Ae=this.internal.write;for(var Ce in K)Ae("/I"+(z=K[Ce]).index,z.objectId,"0","R")},y=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",p),this.internal.events.subscribe("putXobjectDict",m))},w=function(){var z=this.internal.collections[t+"images"];return y.call(this),z},A=function(){return Object.keys(this.internal.collections[t+"images"]).length},I=function(z){return typeof i["process"+z.toUpperCase()]=="function"},R=function(z){return ns(z)==="object"&&z.nodeType===1},k=function(z,K){if(z.nodeName==="IMG"&&z.hasAttribute("src")){var Ae=""+z.getAttribute("src");if(Ae.indexOf("data:image/")===0)return E2(unescape(Ae).split("base64,").pop());var Ce=i.loadFile(Ae,!0);if(Ce!==void 0)return Ce}if(z.nodeName==="CANVAS"){if(z.width===0||z.height===0)throw new Error("Given canvas must have data. Canvas width: "+z.width+", height: "+z.height);var Be;switch(K){case"PNG":Be="image/png";break;case"WEBP":Be="image/webp";break;default:Be="image/jpeg"}return E2(z.toDataURL(Be,1).split("base64,").pop())}},M=function(z){var K=this.internal.collections[t+"images"];if(K){for(var Ae in K)if(z===K[Ae].alias)return K[Ae]}},V=function(z,K,Ae){return z||K||(z=-96,K=-96),z<0&&(z=-1*Ae.width*72/z/this.internal.scaleFactor),K<0&&(K=-1*Ae.height*72/K/this.internal.scaleFactor),z===0&&(z=K*Ae.width/Ae.height),K===0&&(K=z*Ae.height/Ae.width),[z,K]},q=function(z,K,Ae,Ce,Be,Ee){var Pe=V.call(this,Ae,Ce,Be),Ue=this.internal.getCoordinateString,_e=this.internal.getVerticalCoordinateString,Le=w.call(this);if(Ae=Pe[0],Ce=Pe[1],Le[Be.index]=Be,Ee){Ee*=Math.PI/180;var X=Math.cos(Ee),H=Math.sin(Ee),ae=function(se){return se.toFixed(4)},Z=[ae(X),ae(H),ae(-1*H),ae(X),0,0,"cm"]}this.internal.write("q"),Ee?(this.internal.write([1,"0","0",1,Ue(z),_e(K+Ce),"cm"].join(" ")),this.internal.write(Z.join(" ")),this.internal.write([Ue(Ae),"0","0",Ue(Ce),"0","0","cm"].join(" "))):this.internal.write([Ue(Ae),"0","0",Ue(Ce),Ue(z),_e(K+Ce),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Be.index+" Do"),this.internal.write("Q")},U=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var te=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},W=i.__addimage__.sHashCode=function(z){var K,Ae,Ce=0;if(typeof z=="string")for(Ae=z.length,K=0;K<Ae;K++)Ce=(Ce<<5)-Ce+z.charCodeAt(K),Ce|=0;else if(ve(z))for(Ae=z.byteLength/2,K=0;K<Ae;K++)Ce=(Ce<<5)-Ce+z[K],Ce|=0;return Ce},re=i.__addimage__.validateStringAsBase64=function(z){(z=z||"").toString().trim();var K=!0;return z.length===0&&(K=!1),z.length%4!=0&&(K=!1),/^[A-Za-z0-9+/]+$/.test(z.substr(0,z.length-2))===!1&&(K=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(z.substr(-2))===!1&&(K=!1),K},xe=i.__addimage__.extractImageFromDataUrl=function(z){if(z==null||!(z=z.trim()).startsWith("data:"))return null;var K=z.indexOf(",");return K<0?null:z.substring(0,K).trim().endsWith("base64")?z.substring(K+1):null};i.__addimage__.isArrayBuffer=function(z){return z instanceof ArrayBuffer};var ve=i.__addimage__.isArrayBufferView=function(z){return z instanceof Int8Array||z instanceof Uint8Array||z instanceof Uint8ClampedArray||z instanceof Int16Array||z instanceof Uint16Array||z instanceof Int32Array||z instanceof Uint32Array||z instanceof Float32Array||z instanceof Float64Array},De=i.__addimage__.binaryStringToUint8Array=function(z){for(var K=z.length,Ae=new Uint8Array(K),Ce=0;Ce<K;Ce++)Ae[Ce]=z.charCodeAt(Ce);return Ae},ke=i.__addimage__.arrayBufferToBinaryString=function(z){for(var K="",Ae=ve(z)?z:new Uint8Array(z),Ce=0;Ce<Ae.length;Ce+=8192)K+=String.fromCharCode.apply(null,Ae.subarray(Ce,Ce+8192));return K};i.addImage=function(){var z,K,Ae,Ce,Be,Ee,Pe,Ue,_e;if(typeof arguments[1]=="number"?(K=r,Ae=arguments[1],Ce=arguments[2],Be=arguments[3],Ee=arguments[4],Pe=arguments[5],Ue=arguments[6],_e=arguments[7]):(K=arguments[1],Ae=arguments[2],Ce=arguments[3],Be=arguments[4],Ee=arguments[5],Pe=arguments[6],Ue=arguments[7],_e=arguments[8]),ns(z=arguments[0])==="object"&&!R(z)&&"imageData"in z){var Le=z;z=Le.imageData,K=Le.format||K||r,Ae=Le.x||Ae||0,Ce=Le.y||Ce||0,Be=Le.w||Le.width||Be,Ee=Le.h||Le.height||Ee,Pe=Le.alias||Pe,Ue=Le.compression||Ue,_e=Le.rotation||Le.angle||_e}var X=this.internal.getFilters();if(Ue===void 0&&X.indexOf("FlateEncode")!==-1&&(Ue="SLOW"),isNaN(Ae)||isNaN(Ce))throw new Error("Invalid coordinates passed to jsPDF.addImage");y.call(this);var H=de.call(this,z,K,Pe,Ue);return q.call(this,Ae,Ce,Be,Ee,H,_e),this};var de=function(z,K,Ae,Ce){var Be,Ee,Pe;if(typeof z=="string"&&n(z)===r){z=unescape(z);var Ue=Oe(z,!1);(Ue!==""||(Ue=i.loadFile(z,!0))!==void 0)&&(z=Ue)}if(R(z)&&(z=k(z,K)),K=n(z,K),!I(K))throw new Error("addImage does not support files of type '"+K+"', please ensure that a plugin for '"+K+"' support is added.");if(((Pe=Ae)==null||Pe.length===0)&&(Ae=(function(_e){return typeof _e=="string"||ve(_e)?W(_e):ve(_e.data)?W(_e.data):null})(z)),(Be=M.call(this,Ae))||(z instanceof Uint8Array||K==="RGBA"||(Ee=z,z=De(z)),Be=this["process"+K.toUpperCase()](z,A.call(this),Ae,(function(_e){return _e&&typeof _e=="string"&&(_e=_e.toUpperCase()),_e in i.image_compression?_e:te.NONE})(Ce),Ee)),!Be)throw new Error("An unknown error occurred whilst processing the image.");return Be},Oe=i.__addimage__.convertBase64ToBinaryString=function(z,K){K=typeof K!="boolean"||K;var Ae,Ce="";if(typeof z=="string"){var Be;Ae=(Be=xe(z))!==null&&Be!==void 0?Be:z;try{Ce=E2(Ae)}catch(Ee){if(K)throw re(Ae)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Ee.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Ce};i.getImageProperties=function(z){var K,Ae,Ce="";if(R(z)&&(z=k(z)),typeof z=="string"&&n(z)===r&&((Ce=Oe(z,!1))===""&&(Ce=i.loadFile(z)||""),z=Ce),Ae=n(z),!I(Ae))throw new Error("addImage does not support files of type '"+Ae+"', please ensure that a plugin for '"+Ae+"' support is added.");if(z instanceof Uint8Array||(z=De(z)),!(K=this["process"+Ae.toUpperCase()](z)))throw new Error("An unknown error occurred whilst processing the image");return K.fileType=Ae,K}})(en.API),(function(i){var t=function(r){if(r!==void 0&&r!="")return!0};en.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(r){for(var a,n,e,p=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString,y=this.internal.getPageInfoByObjId(r.objId),w=r.pageContext.annotations,A=!1,I=0;I<w.length&&!A;I++)switch((a=w[I]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(A=!0);break;case"reference":case"text":case"freetext":A=!0}if(A!=0){this.internal.write("/Annots [");for(var R=0;R<w.length;R++){a=w[R];var k=this.internal.pdfEscape,M=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var V=this.internal.newAdditionalObject(),q=this.internal.newAdditionalObject(),U=this.internal.getEncryptor(V.objId),te=a.title||"Note";e="<</Type /Annot /Subtype /Text "+(n="/Rect ["+p(a.bounds.x)+" "+m(a.bounds.y+a.bounds.h)+" "+p(a.bounds.x+a.bounds.w)+" "+m(a.bounds.y)+"] ")+"/Contents ("+k(U(a.contents))+")",e+=" /Popup "+q.objId+" 0 R",e+=" /P "+y.objId+" 0 R",e+=" /T ("+k(U(te))+") >>",V.content=e;var W=V.objId+" 0 R";e="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+p(a.bounds.x+30)+" "+m(a.bounds.y+a.bounds.h)+" "+p(a.bounds.x+a.bounds.w+30)+" "+m(a.bounds.y)+"] ")+" /Parent "+W,a.open&&(e+=" /Open true"),e+=" >>",q.content=e,this.internal.write(V.objId,"0 R",q.objId,"0 R");break;case"freetext":n="/Rect ["+p(a.bounds.x)+" "+m(a.bounds.y)+" "+p(a.bounds.x+a.bounds.w)+" "+m(a.bounds.y+a.bounds.h)+"] ";var re=a.color||"#000000";e="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+k(M(a.contents))+")",e+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+re+")",e+=" /Border [0 0 0]",e+=" >>",this.internal.write(e);break;case"link":if(a.options.name){var xe=this.annotations._nameMap[a.options.name];a.options.pageNumber=xe.page,a.options.top=xe.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",e="",a.options.url)e="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+k(M(a.options.url))+") >>";else if(a.options.pageNumber)switch(e="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":e+=" /Fit]";break;case"FitH":e+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,e+=" /FitV "+a.options.left+"]";break;default:var ve=m(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),e+=" /XYZ "+a.options.left+" "+ve+" "+a.options.zoom+"]"}e!=""&&(e+=" >>",this.internal.write(e))}}this.internal.write("]")}}]),i.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},i.link=function(r,a,n,e,p){var m=this.internal.getCurrentPageInfo(),y=this.internal.getCoordinateString,w=this.internal.getVerticalCoordinateString;m.pageContext.annotations.push({finalBounds:{x:y(r),y:w(a),w:y(r+n),h:w(a+e)},options:p,type:"link"})},i.textWithLink=function(r,a,n,e){var p,m,y=this.getTextWidth(r),w=this.internal.getLineHeight()/this.internal.scaleFactor;if(e.maxWidth!==void 0){m=e.maxWidth;var A=this.splitTextToSize(r,m).length;p=Math.ceil(w*A)}else m=y,p=w;return this.text(r,a,n,e),n+=.2*w,e.align==="center"&&(a-=y/2),e.align==="right"&&(a-=y),this.link(a,n-w,m,p,e),y},i.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(en.API),(function(i){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];i.__arabicParser__={};var e=i.__arabicParser__.isInArabicSubstitutionA=function(V){return t[V.charCodeAt(0)]!==void 0},p=i.__arabicParser__.isArabicLetter=function(V){return typeof V=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(V)},m=i.__arabicParser__.isArabicEndLetter=function(V){return p(V)&&e(V)&&t[V.charCodeAt(0)].length<=2},y=i.__arabicParser__.isArabicAlfLetter=function(V){return p(V)&&n.indexOf(V.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(V){return p(V)&&e(V)&&t[V.charCodeAt(0)].length>=1};var w=i.__arabicParser__.arabicLetterHasFinalForm=function(V){return p(V)&&e(V)&&t[V.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(V){return p(V)&&e(V)&&t[V.charCodeAt(0)].length>=3};var A=i.__arabicParser__.arabicLetterHasMedialForm=function(V){return p(V)&&e(V)&&t[V.charCodeAt(0)].length==4},I=i.__arabicParser__.resolveLigatures=function(V){var q=0,U=r,te="",W=0;for(q=0;q<V.length;q+=1)U[V.charCodeAt(q)]!==void 0?(W++,typeof(U=U[V.charCodeAt(q)])=="number"&&(te+=String.fromCharCode(U),U=r,W=0),q===V.length-1&&(U=r,te+=V.charAt(q-(W-1)),q-=W-1,W=0)):(U=r,te+=V.charAt(q-W),q-=W,W=0);return te};i.__arabicParser__.isArabicDiacritic=function(V){return V!==void 0&&a[V.charCodeAt(0)]!==void 0};var R=i.__arabicParser__.getCorrectForm=function(V,q,U){return p(V)?e(V)===!1?-1:!w(V)||!p(q)&&!p(U)||!p(U)&&m(q)||m(V)&&!p(q)||m(V)&&y(q)||m(V)&&m(q)?0:A(V)&&p(q)&&!m(q)&&p(U)&&w(U)?3:m(V)||!p(U)?1:2:-1},k=function(V){var q=0,U=0,te=0,W="",re="",xe="",ve=(V=V||"").split("\\s+"),De=[];for(q=0;q<ve.length;q+=1){for(De.push(""),U=0;U<ve[q].length;U+=1)W=ve[q][U],re=ve[q][U-1],xe=ve[q][U+1],p(W)?(te=R(W,re,xe),De[q]+=te!==-1?String.fromCharCode(t[W.charCodeAt(0)][te]):W):De[q]+=W;De[q]=I(De[q])}return De.join(" ")},M=i.__arabicParser__.processArabic=i.processArabic=function(){var V,q=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,U=[];if(Array.isArray(q)){var te=0;for(U=[],te=0;te<q.length;te+=1)Array.isArray(q[te])?U.push([k(q[te][0]),q[te][1],q[te][2]]):U.push([k(q[te])]);V=U}else V=k(q);return typeof arguments[0]=="string"?V:(arguments[0].text=V,arguments[0])};i.events.push(["preProcessText",M])})(en.API),en.API.autoPrint=function(i){var t;return(i=i||{}).variant=i.variant||"non-conform",i.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(i){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(m){r=m}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(m){a=isNaN(m)||Number.isInteger(m)===!1||m<0?150:m,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(m){n=isNaN(m)||Number.isInteger(m)===!1||m<0?300:m,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var e=[];Object.defineProperty(this,"childNodes",{get:function(){return e},set:function(m){e=m}});var p={};Object.defineProperty(this,"style",{get:function(){return p},set:function(m){p=m}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(en.API),(function(i){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new e,this.internal.__cell__.pages=1},e=function(){var y=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return y},set:function(V){y=V}});var w=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return w},set:function(V){w=V}});var A=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return A},set:function(V){A=V}});var I=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return I},set:function(V){I=V}});var R=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return R},set:function(V){R=V}});var k=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return k},set:function(V){k=V}});var M=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return M},set:function(V){M=V}}),this};e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},e.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(y){return a.call(this),this.internal.__cell__.headerFunction=typeof y=="function"?y:void 0,this},i.getTextDimensions=function(y,w){a.call(this);var A=(w=w||{}).fontSize||this.getFontSize(),I=w.font||this.getFont(),R=w.scaleFactor||this.internal.scaleFactor,k=0,M=0,V=0,q=this;if(!Array.isArray(y)&&typeof y!="string"){if(typeof y!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");y=String(y)}var U=w.maxWidth;U>0?typeof y=="string"?y=this.splitTextToSize(y,U):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(W,re){return W.concat(q.splitTextToSize(re,U))},[])):y=Array.isArray(y)?y:[y];for(var te=0;te<y.length;te++)k<(V=this.getStringUnitWidth(y[te],{font:I})*A)&&(k=V);return k!==0&&(M=y.length),{w:k/=R,h:Math.max((M*A*this.getLineHeightFactor()-A*(this.getLineHeightFactor()-1))/R,0)}},i.cellAddPage=function(){a.call(this),this.addPage();var y=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new e(y.left,y.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var p=i.cell=function(){var y;y=arguments[0]instanceof e?arguments[0]:new e(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var w=this.internal.__cell__.lastCell,A=this.internal.__cell__.padding,I=this.internal.__cell__.margins||t,R=this.internal.__cell__.tableHeaderRow,k=this.internal.__cell__.printHeaders;return w.lineNumber!==void 0&&(w.lineNumber===y.lineNumber?(y.x=(w.x||0)+(w.width||0),y.y=w.y||0):w.y+w.height+y.height+I.bottom>this.getPageHeight()?(this.cellAddPage(),y.y=I.top,k&&R&&(this.printHeaderRow(y.lineNumber,!0),y.y+=R[0].height)):y.y=w.y+w.height||y.y),y.text[0]!==void 0&&(this.rect(y.x,y.y,y.width,y.height,r===!0?"FD":void 0),y.align==="right"?this.text(y.text,y.x+y.width-A,y.y+A,{align:"right",baseline:"top"}):y.align==="center"?this.text(y.text,y.x+y.width/2,y.y+A,{align:"center",baseline:"top",maxWidth:y.width-A-A}):this.text(y.text,y.x+A,y.y+A,{align:"left",baseline:"top",maxWidth:y.width-A-A})),this.internal.__cell__.lastCell=y,this};i.table=function(y,w,A,I,R){if(a.call(this),!A)throw new Error("No data for PDF table.");var k,M,V,q,U=[],te=[],W=[],re={},xe={},ve=[],De=[],ke=(R=R||{}).autoSize||!1,de=R.printHeaders!==!1,Oe=R.css&&R.css["font-size"]!==void 0?16*R.css["font-size"]:R.fontSize||12,z=R.margins||Object.assign({width:this.getPageWidth()},t),K=typeof R.padding=="number"?R.padding:3,Ae=R.headerBackgroundColor||"#c8c8c8",Ce=R.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=de,this.internal.__cell__.margins=z,this.internal.__cell__.table_font_size=Oe,this.internal.__cell__.padding=K,this.internal.__cell__.headerBackgroundColor=Ae,this.internal.__cell__.headerTextColor=Ce,this.setFontSize(Oe),I==null)te=U=Object.keys(A[0]),W=U.map(function(){return"left"});else if(Array.isArray(I)&&ns(I[0])==="object")for(U=I.map(function(Le){return Le.name}),te=I.map(function(Le){return Le.prompt||Le.name||""}),W=I.map(function(Le){return Le.align||"left"}),k=0;k<I.length;k+=1)xe[I[k].name]=.7499990551181103*I[k].width;else Array.isArray(I)&&typeof I[0]=="string"&&(te=U=I,W=U.map(function(){return"left"}));if(ke||Array.isArray(I)&&typeof I[0]=="string")for(k=0;k<U.length;k+=1){for(re[q=U[k]]=A.map(function(Le){return Le[q]}),this.setFont(void 0,"bold"),ve.push(this.getTextDimensions(te[k],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),M=re[q],this.setFont(void 0,"normal"),V=0;V<M.length;V+=1)ve.push(this.getTextDimensions(M[V],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);xe[q]=Math.max.apply(null,ve)+K+K,ve=[]}if(de){var Be={};for(k=0;k<U.length;k+=1)Be[U[k]]={},Be[U[k]].text=te[k],Be[U[k]].align=W[k];var Ee=m.call(this,Be,xe);De=U.map(function(Le){return new e(y,w,xe[Le],Ee,Be[Le].text,void 0,Be[Le].align)}),this.setTableHeaderRow(De),this.printHeaderRow(1,!1)}var Pe=I.reduce(function(Le,X){return Le[X.name]=X.align,Le},{});for(k=0;k<A.length;k+=1){"rowStart"in R&&R.rowStart instanceof Function&&R.rowStart({row:k,data:A[k]},this);var Ue=m.call(this,A[k],xe);for(V=0;V<U.length;V+=1){var _e=A[k][U[V]];"cellStart"in R&&R.cellStart instanceof Function&&R.cellStart({row:k,col:V,data:_e},this),p.call(this,new e(y,w,xe[U[V]],Ue,_e,k+2,Pe[U[V]]))}}return this.internal.__cell__.table_x=y,this.internal.__cell__.table_y=w,this};var m=function(y,w){var A=this.internal.__cell__.padding,I=this.internal.__cell__.table_font_size,R=this.internal.scaleFactor;return Object.keys(y).map(function(k){var M=y[k];return this.splitTextToSize(M.hasOwnProperty("text")?M.text:M,w[k]-A-A)},this).map(function(k){return this.getLineHeightFactor()*k.length*I/R+A+A},this).reduce(function(k,M){return Math.max(k,M)},0)};i.setTableHeaderRow=function(y){a.call(this),this.internal.__cell__.tableHeaderRow=y},i.printHeaderRow=function(y,w){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var A;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var I=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new e(I[0],I[1],I[2],I[3],void 0,-1)}this.setFont(void 0,"bold");for(var R=[],k=0;k<this.internal.__cell__.tableHeaderRow.length;k+=1){A=this.internal.__cell__.tableHeaderRow[k].clone(),w&&(A.y=this.internal.__cell__.margins.top||0,R.push(A)),A.lineNumber=y;var M=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),p.call(this,A),this.setTextColor(M)}R.length>0&&this.setTableHeaderRow(R),this.setFont(void 0,"normal"),r=!1}})(en.API);var rA={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},nA=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ov=tA(nA),aA=[100,200,300,400,500,600,700,800,900],eF=tA(aA);function O5(i){var t=i.family.replace(/"|'/g,"").toLowerCase(),r=(function(e){return rA[e=e||"normal"]?e:"normal"})(i.style),a=(function(e){return e?typeof e=="number"?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):e==="bold"?700:400:400})(i.weight),n=(function(e){return typeof Ov[e=e||"normal"]=="number"?e:"normal"})(i.stretch);return{family:t,style:r,weight:a,stretch:n,src:i.src||[],ref:i.ref||{name:t,style:[n,r,a].join(" ")}}}function P3(i,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(i[t[n]])return i[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(i[t[n]])return i[t[n]]}var tF={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},M3={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function U3(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function B3(i){return i.trimLeft()}function rF(i,t){for(var r=0;r<i.length;){if(i.charAt(r)===t)return[i.substring(0,r),i.substring(r+1)];r+=1}return null}function nF(i){var t=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],i.substring(t[0].length)]}var f2,H3,z3,L1,p2,$3,q3,G3,L5=["times"];function V3(i,t,r,a,n){var e=4,p=K3;switch(n){case en.API.image_compression.FAST:e=1,p=W3;break;case en.API.image_compression.MEDIUM:e=6,p=Y3;break;case en.API.image_compression.SLOW:e=9,p=J3}i=(function(y,w,A,I){for(var R,k=y.length/w,M=new Uint8Array(y.length+k),V=[aF,W3,K3,Y3,J3],q=0;q<k;q+=1){var U=q*w,te=y.subarray(U,U+w);if(I)M.set(I(te,A,R),U+q);else{for(var W=V.length,re=[],xe=0;xe<W;xe+=1)re[xe]=V[xe](te,A,R);var ve=iF(re.concat());M.set(re[ve],U+q)}R=te}return M})(i,t,Math.ceil(r*a/8),p);var m=kv(i,{level:e});return en.API.__addimage__.arrayBufferToBinaryString(m)}function aF(i){var t=Array.apply([],i);return t.unshift(0),t}function W3(i,t){var r=i.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var e=i[n-t]||0;a[n+1]=i[n]-e+256&255}return a}function K3(i,t,r){var a=i.length,n=[];n[0]=2;for(var e=0;e<a;e+=1){var p=r&&r[e]||0;n[e+1]=i[e]-p+256&255}return n}function Y3(i,t,r){var a=i.length,n=[];n[0]=3;for(var e=0;e<a;e+=1){var p=i[e-t]||0,m=r&&r[e]||0;n[e+1]=i[e]+256-(p+m>>>1)&255}return n}function J3(i,t,r){var a=i.length,n=[];n[0]=4;for(var e=0;e<a;e+=1){var p=sF(i[e-t]||0,r&&r[e]||0,r&&r[e-t]||0);n[e+1]=i[e]-p+256&255}return n}function sF(i,t,r){if(i===t&&t===r)return i;var a=Math.abs(t-r),n=Math.abs(i-r),e=Math.abs(i+t-r-r);return a<=n&&a<=e?i:n<=e?t:r}function iF(i){var t=i.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return t.indexOf(Math.min.apply(null,t))}function P5(i,t,r){var a=t*r,n=Math.floor(a/8),e=16-(a-8*n+r),p=(1<<r)-1;return sA(i,n)>>e&p}function Q3(i,t,r,a){var n=r*a,e=Math.floor(n/8),p=16-(n-8*e+a),m=(1<<a)-1,y=(t&m)<<p;(function(w,A,I){if(A+1<w.byteLength)w.setUint16(A,I,!1);else{var R=I>>8&255;w.setUint8(A,R)}})(i,e,sA(i,e)&~(m<<p)&65535|y)}function sA(i,t){return t+1<i.byteLength?i.getUint16(t,!1):i.getUint8(t)<<8}function oF(i){var t=0;if(i[t++]!==71||i[t++]!==73||i[t++]!==70||i[t++]!==56||(i[t++]+1&253)!=56||i[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=i[t++]|i[t++]<<8,a=i[t++]|i[t++]<<8,n=i[t++],e=n>>7,p=1<<1+(7&n);i[t++],i[t++];var m=null,y=null;e&&(m=t,y=p,t+=3*p);var w=!0,A=[],I=0,R=null,k=0,M=null;for(this.width=r,this.height=a;w&&t<i.length;)switch(i[t++]){case 33:switch(i[t++]){case 255:if(i[t]!==11||i[t+1]==78&&i[t+2]==69&&i[t+3]==84&&i[t+4]==83&&i[t+5]==67&&i[t+6]==65&&i[t+7]==80&&i[t+8]==69&&i[t+9]==50&&i[t+10]==46&&i[t+11]==48&&i[t+12]==3&&i[t+13]==1&&i[t+16]==0)t+=14,M=i[t++]|i[t++]<<8,t++;else for(t+=12;;){if(!((z=i[t++])>=0))throw Error("Invalid block size");if(z===0)break;t+=z}break;case 249:if(i[t++]!==4||i[t+4]!==0)throw new Error("Invalid graphics extension block.");var V=i[t++];I=i[t++]|i[t++]<<8,R=i[t++],1&V||(R=null),k=V>>2&7,t++;break;case 254:for(;;){if(!((z=i[t++])>=0))throw Error("Invalid block size");if(z===0)break;t+=z}break;default:throw new Error("Unknown graphic control label: 0x"+i[t-1].toString(16))}break;case 44:var q=i[t++]|i[t++]<<8,U=i[t++]|i[t++]<<8,te=i[t++]|i[t++]<<8,W=i[t++]|i[t++]<<8,re=i[t++],xe=re>>6&1,ve=1<<1+(7&re),De=m,ke=y,de=!1;re>>7&&(de=!0,De=t,ke=ve,t+=3*ve);var Oe=t;for(t++;;){var z;if(!((z=i[t++])>=0))throw Error("Invalid block size");if(z===0)break;t+=z}A.push({x:q,y:U,width:te,height:W,has_local_palette:de,palette_offset:De,palette_size:ke,data_offset:Oe,data_length:t-Oe,transparent_index:R,interlaced:!!xe,delay:I,disposal:k});break;case 59:w=!1;break;default:throw new Error("Unknown gif block: 0x"+i[t-1].toString(16))}this.numFrames=function(){return A.length},this.loopCount=function(){return M},this.frameInfo=function(K){if(K<0||K>=A.length)throw new Error("Frame index out of range.");return A[K]},this.decodeAndBlitFrameBGRA=function(K,Ae){var Ce=this.frameInfo(K),Be=Ce.width*Ce.height,Ee=new Uint8Array(Be);X3(i,Ce.data_offset,Ee,Be);var Pe=Ce.palette_offset,Ue=Ce.transparent_index;Ue===null&&(Ue=256);var _e=Ce.width,Le=r-_e,X=_e,H=4*(Ce.y*r+Ce.x),ae=4*((Ce.y+Ce.height)*r+Ce.x),Z=H,se=4*Le;Ce.interlaced===!0&&(se+=4*r*7);for(var ye=8,ce=0,ze=Ee.length;ce<ze;++ce){var pe=Ee[ce];if(X===0&&(X=_e,(Z+=se)>=ae&&(se=4*Le+4*r*(ye-1),Z=H+(_e+Le)*(ye<<1),ye>>=1)),pe===Ue)Z+=4;else{var Ve=i[Pe+3*pe],yt=i[Pe+3*pe+1],vt=i[Pe+3*pe+2];Ae[Z++]=vt,Ae[Z++]=yt,Ae[Z++]=Ve,Ae[Z++]=255}--X}},this.decodeAndBlitFrameRGBA=function(K,Ae){var Ce=this.frameInfo(K),Be=Ce.width*Ce.height,Ee=new Uint8Array(Be);X3(i,Ce.data_offset,Ee,Be);var Pe=Ce.palette_offset,Ue=Ce.transparent_index;Ue===null&&(Ue=256);var _e=Ce.width,Le=r-_e,X=_e,H=4*(Ce.y*r+Ce.x),ae=4*((Ce.y+Ce.height)*r+Ce.x),Z=H,se=4*Le;Ce.interlaced===!0&&(se+=4*r*7);for(var ye=8,ce=0,ze=Ee.length;ce<ze;++ce){var pe=Ee[ce];if(X===0&&(X=_e,(Z+=se)>=ae&&(se=4*Le+4*r*(ye-1),Z=H+(_e+Le)*(ye<<1),ye>>=1)),pe===Ue)Z+=4;else{var Ve=i[Pe+3*pe],yt=i[Pe+3*pe+1],vt=i[Pe+3*pe+2];Ae[Z++]=Ve,Ae[Z++]=yt,Ae[Z++]=vt,Ae[Z++]=255}--X}}}function X3(i,t,r,a){for(var n=i[t++],e=1<<n,p=e+1,m=p+1,y=n+1,w=(1<<y)-1,A=0,I=0,R=0,k=i[t++],M=new Int32Array(4096),V=null;;){for(;A<16&&k!==0;)I|=i[t++]<<A,A+=8,k===1?k=i[t++]:--k;if(A<y)break;var q=I&w;if(I>>=y,A-=y,q!==e){if(q===p)break;for(var U=q<m?q:V,te=0,W=U;W>e;)W=M[W]>>8,++te;var re=W;if(R+te+(U!==q?1:0)>a)return void As.log("Warning, gif stream longer than expected.");r[R++]=re;var xe=R+=te;for(U!==q&&(r[R++]=re),W=U;te--;)W=M[W],r[--xe]=255&W,W>>=8;V!==null&&m<4096&&(M[m++]=V<<8|re,m>=w+1&&y<12&&(++y,w=w<<1|1)),V=q}else m=p+1,w=(1<<(y=n+1))-1,V=null}return R!==a&&As.log("Warning, gif stream shorter than expected."),r}function M5(i){var t,r,a,n,e,p=Math.floor,m=new Array(64),y=new Array(64),w=new Array(64),A=new Array(64),I=new Array(65535),R=new Array(65535),k=new Array(64),M=new Array(64),V=[],q=0,U=7,te=new Array(64),W=new Array(64),re=new Array(64),xe=new Array(256),ve=new Array(2048),De=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ke=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],de=[0,1,2,3,4,5,6,7,8,9,10,11],Oe=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],z=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],K=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ae=[0,1,2,3,4,5,6,7,8,9,10,11],Ce=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Be=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Ee(H,ae){for(var Z=0,se=0,ye=new Array,ce=1;ce<=16;ce++){for(var ze=1;ze<=H[ce];ze++)ye[ae[se]]=[],ye[ae[se]][0]=Z,ye[ae[se]][1]=ce,se++,Z++;Z*=2}return ye}function Pe(H){for(var ae=H[0],Z=H[1]-1;Z>=0;)ae&1<<Z&&(q|=1<<U),Z--,--U<0&&(q==255?(Ue(255),Ue(0)):Ue(q),U=7,q=0)}function Ue(H){V.push(H)}function _e(H){Ue(H>>8&255),Ue(255&H)}function Le(H,ae,Z,se,ye){for(var ce,ze=ye[0],pe=ye[240],Ve=(function(Mt,zr){var Qe,Rt,Ct,er,nr,ur,Sr,kr,ar,_r,Ar=0;for(ar=0;ar<8;++ar){Qe=Mt[Ar],Rt=Mt[Ar+1],Ct=Mt[Ar+2],er=Mt[Ar+3],nr=Mt[Ar+4],ur=Mt[Ar+5],Sr=Mt[Ar+6];var ra=Qe+(kr=Mt[Ar+7]),Nn=Qe-kr,Qr=Rt+Sr,xr=Rt-Sr,an=Ct+ur,Lr=Ct-ur,Jn=er+nr,on=er-nr,gn=ra+Jn,xa=ra-Jn,fn=Qr+an,Wr=Qr-an;Mt[Ar]=gn+fn,Mt[Ar+4]=gn-fn;var Jt=.707106781*(Wr+xa);Mt[Ar+2]=xa+Jt,Mt[Ar+6]=xa-Jt;var bo=.382683433*((gn=on+Lr)-(Wr=xr+Nn)),Vs=.5411961*gn+bo,fa=1.306562965*Wr+bo,xo=.707106781*(fn=Lr+xr),Yr=Nn+xo,qo=Nn-xo;Mt[Ar+5]=qo+Vs,Mt[Ar+3]=qo-Vs,Mt[Ar+1]=Yr+fa,Mt[Ar+7]=Yr-fa,Ar+=8}for(Ar=0,ar=0;ar<8;++ar){Qe=Mt[Ar],Rt=Mt[Ar+8],Ct=Mt[Ar+16],er=Mt[Ar+24],nr=Mt[Ar+32],ur=Mt[Ar+40],Sr=Mt[Ar+48];var wo=Qe+(kr=Mt[Ar+56]),pa=Qe-kr,Ri=Rt+Sr,as=Rt-Sr,Ps=Ct+ur,Ms=Ct-ur,pl=er+nr,ji=er-nr,Fa=wo+pl,vn=wo-pl,Cs=Ri+Ps,jn=Ri-Ps;Mt[Ar]=Fa+Cs,Mt[Ar+32]=Fa-Cs;var na=.707106781*(jn+vn);Mt[Ar+16]=vn+na,Mt[Ar+48]=vn-na;var bi=.382683433*((Fa=ji+Ms)-(jn=as+pa)),ml=.5411961*Fa+bi,Oi=1.306562965*jn+bi,uc=.707106781*(Cs=Ms+as),gl=pa+uc,Go=pa-uc;Mt[Ar+40]=Go+ml,Mt[Ar+24]=Go-ml,Mt[Ar+8]=gl+Oi,Mt[Ar+56]=gl-Oi,Ar++}for(ar=0;ar<64;++ar)_r=Mt[ar]*zr[ar],k[ar]=_r>0?_r+.5|0:_r-.5|0;return k})(H,ae),yt=0;yt<64;++yt)M[De[yt]]=Ve[yt];var vt=M[0]-Z;Z=M[0],vt==0?Pe(se[0]):(Pe(se[R[ce=32767+vt]]),Pe(I[ce]));for(var bt=63;bt>0&&M[bt]==0;)bt--;if(bt==0)return Pe(ze),Z;for(var Ft,Te=1;Te<=bt;){for(var Ht=Te;M[Te]==0&&Te<=bt;)++Te;var Or=Te-Ht;if(Or>=16){Ft=Or>>4;for(var Vr=1;Vr<=Ft;++Vr)Pe(pe);Or&=15}ce=32767+M[Te],Pe(ye[(Or<<4)+R[ce]]),Pe(I[ce]),Te++}return bt!=63&&Pe(ze),Z}function X(H){H=Math.min(Math.max(H,1),100),e!=H&&((function(ae){for(var Z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],se=0;se<64;se++){var ye=p((Z[se]*ae+50)/100);ye=Math.min(Math.max(ye,1),255),m[De[se]]=ye}for(var ce=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ze=0;ze<64;ze++){var pe=p((ce[ze]*ae+50)/100);pe=Math.min(Math.max(pe,1),255),y[De[ze]]=pe}for(var Ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],yt=0,vt=0;vt<8;vt++)for(var bt=0;bt<8;bt++)w[yt]=1/(m[De[yt]]*Ve[vt]*Ve[bt]*8),A[yt]=1/(y[De[yt]]*Ve[vt]*Ve[bt]*8),yt++})(H<50?Math.floor(5e3/H):Math.floor(200-2*H)),e=H)}this.encode=function(H,ae){ae&&X(ae),V=new Array,q=0,U=7,_e(65496),_e(65504),_e(16),Ue(74),Ue(70),Ue(73),Ue(70),Ue(0),Ue(1),Ue(1),Ue(0),_e(1),_e(1),Ue(0),Ue(0),(function(){_e(65499),_e(132),Ue(0);for(var Rt=0;Rt<64;Rt++)Ue(m[Rt]);Ue(1);for(var Ct=0;Ct<64;Ct++)Ue(y[Ct])})(),(function(Rt,Ct){_e(65472),_e(17),Ue(8),_e(Ct),_e(Rt),Ue(3),Ue(1),Ue(17),Ue(0),Ue(2),Ue(17),Ue(1),Ue(3),Ue(17),Ue(1)})(H.width,H.height),(function(){_e(65476),_e(418),Ue(0);for(var Rt=0;Rt<16;Rt++)Ue(ke[Rt+1]);for(var Ct=0;Ct<=11;Ct++)Ue(de[Ct]);Ue(16);for(var er=0;er<16;er++)Ue(Oe[er+1]);for(var nr=0;nr<=161;nr++)Ue(z[nr]);Ue(1);for(var ur=0;ur<16;ur++)Ue(K[ur+1]);for(var Sr=0;Sr<=11;Sr++)Ue(Ae[Sr]);Ue(17);for(var kr=0;kr<16;kr++)Ue(Ce[kr+1]);for(var ar=0;ar<=161;ar++)Ue(Be[ar])})(),_e(65498),_e(12),Ue(3),Ue(1),Ue(0),Ue(2),Ue(17),Ue(3),Ue(17),Ue(0),Ue(63),Ue(0);var Z=0,se=0,ye=0;q=0,U=7,this.encode.displayName="_encode_";for(var ce,ze,pe,Ve,yt,vt,bt,Ft,Te,Ht=H.data,Or=H.width,Vr=H.height,Mt=4*Or,zr=0;zr<Vr;){for(ce=0;ce<Mt;){for(yt=Mt*zr+ce,bt=-1,Ft=0,Te=0;Te<64;Te++)vt=yt+(Ft=Te>>3)*Mt+(bt=4*(7&Te)),zr+Ft>=Vr&&(vt-=Mt*(zr+1+Ft-Vr)),ce+bt>=Mt&&(vt-=ce+bt-Mt+4),ze=Ht[vt++],pe=Ht[vt++],Ve=Ht[vt++],te[Te]=(ve[ze]+ve[pe+256|0]+ve[Ve+512|0]>>16)-128,W[Te]=(ve[ze+768|0]+ve[pe+1024|0]+ve[Ve+1280|0]>>16)-128,re[Te]=(ve[ze+1280|0]+ve[pe+1536|0]+ve[Ve+1792|0]>>16)-128;Z=Le(te,w,Z,t,a),se=Le(W,A,se,r,n),ye=Le(re,A,ye,r,n),ce+=32}zr+=8}if(U>=0){var Qe=[];Qe[1]=U+1,Qe[0]=(1<<U+1)-1,Pe(Qe)}return _e(65497),new Uint8Array(V)},i=i||50,(function(){for(var H=String.fromCharCode,ae=0;ae<256;ae++)xe[ae]=H(ae)})(),t=Ee(ke,de),r=Ee(K,Ae),a=Ee(Oe,z),n=Ee(Ce,Be),(function(){for(var H=1,ae=2,Z=1;Z<=15;Z++){for(var se=H;se<ae;se++)R[32767+se]=Z,I[32767+se]=[],I[32767+se][1]=Z,I[32767+se][0]=se;for(var ye=-(ae-1);ye<=-H;ye++)R[32767+ye]=Z,I[32767+ye]=[],I[32767+ye][1]=Z,I[32767+ye][0]=ae-1+ye;H<<=1,ae<<=1}})(),(function(){for(var H=0;H<256;H++)ve[H]=19595*H,ve[H+256|0]=38470*H,ve[H+512|0]=7471*H+32768,ve[H+768|0]=-11059*H,ve[H+1024|0]=-21709*H,ve[H+1280|0]=32768*H+8421375,ve[H+1536|0]=-27439*H,ve[H+1792|0]=-5329*H})(),X(i)}function Bu(i,t){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Z3(i){function t(de){if(!de)throw Error("assert :P")}function r(de,Oe,z){for(var K=0;4>K;K++)if(de[Oe+K]!=z.charCodeAt(K))return!0;return!1}function a(de,Oe,z,K,Ae){for(var Ce=0;Ce<Ae;Ce++)de[Oe+Ce]=z[K+Ce]}function n(de,Oe,z,K){for(var Ae=0;Ae<K;Ae++)de[Oe+Ae]=z}function e(de){return new Int32Array(de)}function p(de,Oe){for(var z=[],K=0;K<de;K++)z.push(new Oe);return z}function m(de,Oe){var z=[];return(function K(Ae,Ce,Be){for(var Ee=Be[Ce],Pe=0;Pe<Ee&&(Ae.push(Be.length>Ce+1?[]:new Oe),!(Be.length<Ce+1));Pe++)K(Ae[Pe],Ce+1,Be)})(z,0,de),z}var y=function(){var de=this;function Oe(C,_){for(var P=1<<_-1>>>0;C&P;)P>>>=1;return P?(C&P-1)+P:C}function z(C,_,P,Y,oe){t(!(Y%P));do C[_+(Y-=P)]=oe;while(0<Y)}function K(C,_,P,Y,oe){if(t(2328>=oe),512>=oe)var fe=e(512);else if((fe=e(oe))==null)return 0;return(function(ge,Se,Ne,Re,Ke,ot){var Fe,Ze,nt=Se,At=1<<Ne,st=e(16),wt=e(16);for(t(Ke!=0),t(Re!=null),t(ge!=null),t(0<Ne),Ze=0;Ze<Ke;++Ze){if(15<Re[Ze])return 0;++st[Re[Ze]]}if(st[0]==Ke)return 0;for(wt[1]=0,Fe=1;15>Fe;++Fe){if(st[Fe]>1<<Fe)return 0;wt[Fe+1]=wt[Fe]+st[Fe]}for(Ze=0;Ze<Ke;++Ze)Fe=Re[Ze],0<Re[Ze]&&(ot[wt[Fe]++]=Ze);if(wt[15]==1)return(Re=new Ae).g=0,Re.value=ot[0],z(ge,nt,1,At,Re),At;var kt,$t=-1,Lt=At-1,Ir=0,yr=1,An=1,Er=1<<Ne;for(Ze=0,Fe=1,Ke=2;Fe<=Ne;++Fe,Ke<<=1){if(yr+=An<<=1,0>(An-=st[Fe]))return 0;for(;0<st[Fe];--st[Fe])(Re=new Ae).g=Fe,Re.value=ot[Ze++],z(ge,nt+Ir,Ke,Er,Re),Ir=Oe(Ir,Fe)}for(Fe=Ne+1,Ke=2;15>=Fe;++Fe,Ke<<=1){if(yr+=An<<=1,0>(An-=st[Fe]))return 0;for(;0<st[Fe];--st[Fe]){if(Re=new Ae,(Ir&Lt)!=$t){for(nt+=Er,kt=1<<($t=Fe)-Ne;15>$t&&!(0>=(kt-=st[$t]));)++$t,kt<<=1;At+=Er=1<<(kt=$t-Ne),ge[Se+($t=Ir&Lt)].g=kt+Ne,ge[Se+$t].value=nt-Se-$t}Re.g=Fe-Ne,Re.value=ot[Ze++],z(ge,nt+(Ir>>Ne),Ke,Er,Re),Ir=Oe(Ir,Fe)}}return yr!=2*wt[15]-1?0:At})(C,_,P,Y,oe,fe)}function Ae(){this.value=this.g=0}function Ce(){this.value=this.g=0}function Be(){this.G=p(5,Ae),this.H=e(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=p(mc,Ce)}function Ee(C,_,P,Y){t(C!=null),t(_!=null),t(2147483648>Y),C.Ca=254,C.I=0,C.b=-8,C.Ka=0,C.oa=_,C.pa=P,C.Jd=_,C.Yc=P+Y,C.Zc=4<=Y?P+Y-4+1:P,ze(C)}function Pe(C,_){for(var P=0;0<_--;)P|=Ve(C,128)<<_;return P}function Ue(C,_){var P=Pe(C,_);return pe(C)?-P:P}function _e(C,_,P,Y){var oe,fe=0;for(t(C!=null),t(_!=null),t(4294967288>Y),C.Sb=Y,C.Ra=0,C.u=0,C.h=0,4<Y&&(Y=4),oe=0;oe<Y;++oe)fe+=_[P+oe]<<8*oe;C.Ra=fe,C.bb=Y,C.oa=_,C.pa=P}function Le(C){for(;8<=C.u&&C.bb<C.Sb;)C.Ra>>>=8,C.Ra+=C.oa[C.pa+C.bb]<<Xa-8>>>0,++C.bb,C.u-=8;se(C)&&(C.h=1,C.u=0)}function X(C,_){if(t(0<=_),!C.h&&_<=Qa){var P=Z(C)&ri[_];return C.u+=_,Le(C),P}return C.h=1,C.u=0}function H(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function ae(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Z(C){return C.Ra>>>(C.u&Xa-1)>>>0}function se(C){return t(C.bb<=C.Sb),C.h||C.bb==C.Sb&&C.u>Xa}function ye(C,_){C.u=_,C.h=se(C)}function ce(C){C.u>=Oa&&(t(C.u>=Oa),Le(C))}function ze(C){t(C!=null&&C.oa!=null),C.pa<C.Zc?(C.I=(C.oa[C.pa++]|C.I<<8)>>>0,C.b+=8):(t(C!=null&&C.oa!=null),C.pa<C.Yc?(C.b+=8,C.I=C.oa[C.pa++]|C.I<<8):C.Ka?C.b=0:(C.I<<=8,C.b+=8,C.Ka=1))}function pe(C){return Pe(C,1)}function Ve(C,_){var P=C.Ca;0>C.b&&ze(C);var Y=C.b,oe=P*_>>>8,fe=(C.I>>>Y>oe)+0;for(fe?(P-=oe,C.I-=oe+1<<Y>>>0):P=oe+1,Y=P,oe=0;256<=Y;)oe+=8,Y>>=8;return Y=7^oe+xl[Y],C.b-=Y,C.Ca=(P<<Y)-1,fe}function yt(C,_,P){C[_+0]=P>>24&255,C[_+1]=P>>16&255,C[_+2]=P>>8&255,C[_+3]=255&P}function vt(C,_){return C[_+0]|C[_+1]<<8}function bt(C,_){return vt(C,_)|C[_+2]<<16}function Ft(C,_){return vt(C,_)|vt(C,_+2)<<16}function Te(C,_){var P=1<<_;return t(C!=null),t(0<_),C.X=e(P),C.X==null?0:(C.Mb=32-_,C.Xa=_,1)}function Ht(C,_){t(C!=null),t(_!=null),t(C.Xa==_.Xa),a(_.X,0,C.X,0,1<<_.Xa)}function Or(){this.X=[],this.Xa=this.Mb=0}function Vr(C,_,P,Y){t(P!=null),t(Y!=null);var oe=P[0],fe=Y[0];return oe==0&&(oe=(C*fe+_/2)/_),fe==0&&(fe=(_*oe+C/2)/C),0>=oe||0>=fe?0:(P[0]=oe,Y[0]=fe,1)}function Mt(C,_){return C+(1<<_)-1>>>_}function zr(C,_){return((4278255360&C)+(4278255360&_)>>>0&4278255360)+((16711935&C)+(16711935&_)>>>0&16711935)>>>0}function Qe(C,_){de[_]=function(P,Y,oe,fe,ge,Se,Ne){var Re;for(Re=0;Re<ge;++Re){var Ke=de[C](Se[Ne+Re-1],oe,fe+Re);Se[Ne+Re]=zr(P[Y+Re],Ke)}}}function Rt(){this.ud=this.hd=this.jd=0}function Ct(C,_){return((4278124286&(C^_))>>>1)+(C&_)>>>0}function er(C){return 0<=C&&256>C?C:0>C?0:255<C?255:void 0}function nr(C,_){return er(C+(C-_+.5>>1))}function ur(C,_,P){return Math.abs(_-P)-Math.abs(C-P)}function Sr(C,_,P,Y,oe,fe,ge){for(Y=fe[ge-1],P=0;P<oe;++P)fe[ge+P]=Y=zr(C[_+P],Y)}function kr(C,_,P,Y,oe){var fe;for(fe=0;fe<P;++fe){var ge=C[_+fe],Se=ge>>8&255,Ne=16711935&(Ne=(Ne=16711935&ge)+((Se<<16)+Se));Y[oe+fe]=(4278255360&ge)+Ne>>>0}}function ar(C,_){_.jd=255&C,_.hd=C>>8&255,_.ud=C>>16&255}function _r(C,_,P,Y,oe,fe){var ge;for(ge=0;ge<Y;++ge){var Se=_[P+ge],Ne=Se>>>8,Re=Se,Ke=255&(Ke=(Ke=Se>>>16)+((C.jd<<24>>24)*(Ne<<24>>24)>>>5));Re=255&(Re=(Re+=(C.hd<<24>>24)*(Ne<<24>>24)>>>5)+((C.ud<<24>>24)*(Ke<<24>>24)>>>5)),oe[fe+ge]=(4278255360&Se)+(Ke<<16)+Re}}function Ar(C,_,P,Y,oe){de[_]=function(fe,ge,Se,Ne,Re,Ke,ot,Fe,Ze){for(Ne=ot;Ne<Fe;++Ne)for(ot=0;ot<Ze;++ot)Re[Ke++]=oe(Se[Y(fe[ge++])])},de[C]=function(fe,ge,Se,Ne,Re,Ke,ot){var Fe=8>>fe.b,Ze=fe.Ea,nt=fe.K[0],At=fe.w;if(8>Fe)for(fe=(1<<fe.b)-1,At=(1<<Fe)-1;ge<Se;++ge){var st,wt=0;for(st=0;st<Ze;++st)st&fe||(wt=Y(Ne[Re++])),Ke[ot++]=oe(nt[wt&At]),wt>>=Fe}else de["VP8LMapColor"+P](Ne,Re,nt,At,Ke,ot,ge,Se,Ze)}}function ra(C,_,P,Y,oe){for(P=_+P;_<P;){var fe=C[_++];Y[oe++]=fe>>16&255,Y[oe++]=fe>>8&255,Y[oe++]=255&fe}}function Nn(C,_,P,Y,oe){for(P=_+P;_<P;){var fe=C[_++];Y[oe++]=fe>>16&255,Y[oe++]=fe>>8&255,Y[oe++]=255&fe,Y[oe++]=fe>>24&255}}function Qr(C,_,P,Y,oe){for(P=_+P;_<P;){var fe=(ge=C[_++])>>16&240|ge>>12&15,ge=240&ge|ge>>28&15;Y[oe++]=fe,Y[oe++]=ge}}function xr(C,_,P,Y,oe){for(P=_+P;_<P;){var fe=(ge=C[_++])>>16&248|ge>>13&7,ge=ge>>5&224|ge>>3&31;Y[oe++]=fe,Y[oe++]=ge}}function an(C,_,P,Y,oe){for(P=_+P;_<P;){var fe=C[_++];Y[oe++]=255&fe,Y[oe++]=fe>>8&255,Y[oe++]=fe>>16&255}}function Lr(C,_,P,Y,oe,fe){if(fe==0)for(P=_+P;_<P;)yt(Y,((fe=C[_++])[0]>>24|fe[1]>>8&65280|fe[2]<<8&16711680|fe[3]<<24)>>>0),oe+=32;else a(Y,oe,C,_,P)}function Jn(C,_){de[_][0]=de[C+"0"],de[_][1]=de[C+"1"],de[_][2]=de[C+"2"],de[_][3]=de[C+"3"],de[_][4]=de[C+"4"],de[_][5]=de[C+"5"],de[_][6]=de[C+"6"],de[_][7]=de[C+"7"],de[_][8]=de[C+"8"],de[_][9]=de[C+"9"],de[_][10]=de[C+"10"],de[_][11]=de[C+"11"],de[_][12]=de[C+"12"],de[_][13]=de[C+"13"],de[_][14]=de[C+"0"],de[_][15]=de[C+"0"]}function on(C){return C==uh||C==Hh||C==Su||C==Fd}function gn(){this.eb=[],this.size=this.A=this.fb=0}function xa(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function fn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new gn,this.f.kb=new xa,this.sd=null}function Wr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Jt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function bo(C){return alert("todo:WebPSamplerProcessPlane"),C.T}function Vs(C,_){var P=C.T,Y=_.ba.f.RGBA,oe=Y.eb,fe=Y.fb+C.ka*Y.A,ge=ui[_.ba.S],Se=C.y,Ne=C.O,Re=C.f,Ke=C.N,ot=C.ea,Fe=C.W,Ze=_.cc,nt=_.dc,At=_.Mc,st=_.Nc,wt=C.ka,kt=C.ka+C.T,$t=C.U,Lt=$t+1>>1;for(wt==0?ge(Se,Ne,null,null,Re,Ke,ot,Fe,Re,Ke,ot,Fe,oe,fe,null,null,$t):(ge(_.ec,_.fc,Se,Ne,Ze,nt,At,st,Re,Ke,ot,Fe,oe,fe-Y.A,oe,fe,$t),++P);wt+2<kt;wt+=2)Ze=Re,nt=Ke,At=ot,st=Fe,Ke+=C.Rc,Fe+=C.Rc,fe+=2*Y.A,ge(Se,(Ne+=2*C.fa)-C.fa,Se,Ne,Ze,nt,At,st,Re,Ke,ot,Fe,oe,fe-Y.A,oe,fe,$t);return Ne+=C.fa,C.j+kt<C.o?(a(_.ec,_.fc,Se,Ne,$t),a(_.cc,_.dc,Re,Ke,Lt),a(_.Mc,_.Nc,ot,Fe,Lt),P--):1&kt||ge(Se,Ne,null,null,Re,Ke,ot,Fe,Re,Ke,ot,Fe,oe,fe+Y.A,null,null,$t),P}function fa(C,_,P){var Y=C.F,oe=[C.J];if(Y!=null){var fe=C.U,ge=_.ba.S,Se=ge==xu||ge==Su;_=_.ba.f.RGBA;var Ne=[0],Re=C.ka;Ne[0]=C.T,C.Kb&&(Re==0?--Ne[0]:(--Re,oe[0]-=C.width),C.j+C.ka+C.T==C.o&&(Ne[0]=C.o-C.j-Re));var Ke=_.eb;Re=_.fb+Re*_.A,C=bu(Y,oe[0],C.width,fe,Ne,Ke,Re+(Se?0:3),_.A),t(P==Ne),C&&on(ge)&&Zi(Ke,Re,Se,fe,Ne,_.A)}return 0}function xo(C){var _=C.ma,P=_.ba.S,Y=11>P,oe=P==La||P==To||P==xu||P==wu||P==12||on(P);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!pc(_.Oa,C,oe?11:12))return 0;if(oe&&on(P)&&xt(),C.da)alert("todo:use_scaling");else{if(Y){if(_.Ib=bo,C.Kb){if(P=C.U+1>>1,_.memory=e(C.U+2*P),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+C.U,_.Mc=_.cc,_.Nc=_.dc+P,_.Ib=Vs,xt()}}else alert("todo:EmitYUV");oe&&(_.Jb=fa,Y&&Ra())}if(Y&&!Nc){for(C=0;256>C;++C)Ks[C]=89858*(C-128)+Cu>>Do,bp[C]=-22014*(C-128)+Cu,jf[C]=-45773*(C-128),qh[C]=113618*(C-128)+Cu>>Do;for(C=Qc;C<Ni;++C)_=76283*(C-16)+Cu>>Do,U0[C-Qc]=So(_,255),qi[C-Qc]=So(_+8>>4,15);Nc=1}return 1}function Yr(C){var _=C.ma,P=C.U,Y=C.T;return t(!(1&C.ka)),0>=P||0>=Y?0:(P=_.Ib(C,_),_.Jb!=null&&_.Jb(C,_,P),_.Dc+=P,1)}function qo(C){C.ma.memory=null}function wo(C,_,P,Y){return X(C,8)!=47?0:(_[0]=X(C,14)+1,P[0]=X(C,14)+1,Y[0]=X(C,1),X(C,3)!=0?0:!C.h)}function pa(C,_){if(4>C)return C+1;var P=C-2>>1;return(2+(1&C)<<P)+X(_,P)+1}function Ri(C,_){return 120<_?_-120:1<=(P=((P=ko[_-1])>>4)*C+(8-(15&P)))?P:1;var P}function as(C,_,P){var Y=Z(P),oe=C[_+=255&Y].g-8;return 0<oe&&(ye(P,P.u+8),Y=Z(P),_+=C[_].value,_+=Y&(1<<oe)-1),ye(P,P.u+C[_].g),C[_].value}function Ps(C,_,P){return P.g+=C.g,P.value+=C.value<<_>>>0,t(8>=P.g),C.g}function Ms(C,_,P){var Y=C.xc;return t((_=Y==0?0:C.vc[C.md*(P>>Y)+(_>>Y)])<C.Wb),C.Ya[_]}function pl(C,_,P,Y){var oe=C.ab,fe=C.c*_,ge=C.C;_=ge+_;var Se=P,Ne=Y;for(Y=C.Ta,P=C.Ua;0<oe--;){var Re=C.gc[oe],Ke=ge,ot=_,Fe=Se,Ze=Ne,nt=(Ne=Y,Se=P,Re.Ea);switch(t(Ke<ot),t(ot<=Re.nc),Re.hc){case 2:ca(Fe,Ze,(ot-Ke)*nt,Ne,Se);break;case 0:var At=Ke,st=ot,wt=Ne,kt=Se,$t=(Er=Re).Ea;At==0&&(oh(Fe,Ze,null,null,1,wt,kt),Sr(Fe,Ze+1,0,0,$t-1,wt,kt+1),Ze+=$t,kt+=$t,++At);for(var Lt=1<<Er.b,Ir=Lt-1,yr=Mt($t,Er.b),An=Er.K,Er=Er.w+(At>>Er.b)*yr;At<st;){var Pn=An,za=Er,En=1;for(lh(Fe,Ze,wt,kt-$t,1,wt,kt);En<$t;){var pr=(En&~Ir)+Lt;pr>$t&&(pr=$t),(0,$l[Pn[za++]>>8&15])(Fe,Ze+ +En,wt,kt+En-$t,pr-En,wt,kt+En),En=pr}Ze+=$t,kt+=$t,++At&Ir||(Er+=yr)}ot!=Re.nc&&a(Ne,Se-nt,Ne,Se+(ot-Ke-1)*nt,nt);break;case 1:for(nt=Fe,st=Ze,$t=(Fe=Re.Ea)-(kt=Fe&~(wt=(Ze=1<<Re.b)-1)),At=Mt(Fe,Re.b),Lt=Re.K,Re=Re.w+(Ke>>Re.b)*At;Ke<ot;){for(Ir=Lt,yr=Re,An=new Rt,Er=st+kt,Pn=st+Fe;st<Er;)ar(Ir[yr++],An),Kc(An,nt,st,Ze,Ne,Se),st+=Ze,Se+=Ze;st<Pn&&(ar(Ir[yr++],An),Kc(An,nt,st,$t,Ne,Se),st+=$t,Se+=$t),++Ke&wt||(Re+=At)}break;case 3:if(Fe==Ne&&Ze==Se&&0<Re.b){for(st=Ne,Fe=nt=Se+(ot-Ke)*nt-(kt=(ot-Ke)*Mt(Re.Ea,Re.b)),Ze=Ne,wt=Se,At=[],kt=($t=kt)-1;0<=kt;--kt)At[kt]=Ze[wt+kt];for(kt=$t-1;0<=kt;--kt)st[Fe+kt]=At[kt];zl(Re,Ke,ot,Ne,nt,Ne,Se)}else zl(Re,Ke,ot,Fe,Ze,Ne,Se)}Se=Y,Ne=P}Ne!=P&&a(Y,P,Se,Ne,fe)}function ji(C,_){var P=C.V,Y=C.Ba+C.c*C.C,oe=_-C.C;if(t(_<=C.l.o),t(16>=oe),0<oe){var fe=C.l,ge=C.Ta,Se=C.Ua,Ne=fe.width;if(pl(C,oe,P,Y),oe=Se=[Se],t((P=C.C)<(Y=_)),t(fe.v<fe.va),Y>fe.o&&(Y=fe.o),P<fe.j){var Re=fe.j-P;P=fe.j,oe[0]+=Re*Ne}if(P>=Y?P=0:(oe[0]+=4*fe.v,fe.ka=P-fe.j,fe.U=fe.va-fe.v,fe.T=Y-P,P=1),P){if(Se=Se[0],11>(P=C.ca).S){var Ke=P.f.RGBA,ot=(Y=P.S,oe=fe.U,fe=fe.T,Re=Ke.eb,Ke.A),Fe=fe;for(Ke=Ke.fb+C.Ma*Ke.A;0<Fe--;){var Ze=ge,nt=Se,At=oe,st=Re,wt=Ke;switch(Y){case Bh:gc(Ze,nt,At,st,wt);break;case La:yc(Ze,nt,At,st,wt);break;case uh:yc(Ze,nt,At,st,wt),Zi(st,wt,0,At,1,0);break;case Dd:vc(Ze,nt,At,st,wt);break;case To:Lr(Ze,nt,At,st,wt,1);break;case Hh:Lr(Ze,nt,At,st,wt,1),Zi(st,wt,0,At,1,0);break;case xu:Lr(Ze,nt,At,st,wt,0);break;case Su:Lr(Ze,nt,At,st,wt,0),Zi(st,wt,1,At,1,0);break;case wu:wl(Ze,nt,At,st,wt);break;case Fd:wl(Ze,nt,At,st,wt),No(st,wt,At,1,0);break;case co:Xo(Ze,nt,At,st,wt);break;default:t(0)}Se+=Ne,Ke+=ot}C.Ma+=fe}else alert("todo:EmitRescaledRowsYUVA");t(C.Ma<=P.height)}}C.C=_,t(C.C<=C.i)}function Fa(C){var _;if(0<C.ua)return 0;for(_=0;_<C.Wb;++_){var P=C.Ya[_].G,Y=C.Ya[_].H;if(0<P[1][Y[1]+0].g||0<P[2][Y[2]+0].g||0<P[3][Y[3]+0].g)return 0}return 1}function vn(C,_,P,Y,oe,fe){if(C.Z!=0){var ge=C.qd,Se=C.rd;for(t(Gl[C.Z]!=null);_<P;++_)Gl[C.Z](ge,Se,Y,oe,Y,oe,fe),ge=Y,Se=oe,oe+=fe;C.qd=ge,C.rd=Se}}function Cs(C,_){var P=C.l.ma,Y=P.Z==0||P.Z==1?C.l.j:C.C;if(Y=C.C<Y?Y:C.C,t(_<=C.l.o),_>Y){var oe=C.l.width,fe=P.ca,ge=P.tb+oe*Y,Se=C.V,Ne=C.Ba+C.c*Y,Re=C.gc;t(C.ab==1),t(Re[0].hc==3),Hi(Re[0],Y,_,Se,Ne,fe,ge),vn(P,Y,_,fe,ge,oe)}C.C=C.Ma=_}function jn(C,_,P,Y,oe,fe,ge){var Se=C.$/Y,Ne=C.$%Y,Re=C.m,Ke=C.s,ot=P+C.$,Fe=ot;oe=P+Y*oe;var Ze=P+Y*fe,nt=280+Ke.ua,At=C.Pb?Se:16777216,st=0<Ke.ua?Ke.Wa:null,wt=Ke.wc,kt=ot<Ze?Ms(Ke,Ne,Se):null;t(C.C<fe),t(Ze<=oe);var $t=!1;e:for(;;){for(;$t||ot<Ze;){var Lt=0;if(Se>=At){var Ir=ot-P;t((At=C).Pb),At.wd=At.m,At.xd=Ir,0<At.s.ua&&Ht(At.s.Wa,At.s.vb),At=Se+Sc}if(Ne&wt||(kt=Ms(Ke,Ne,Se)),t(kt!=null),kt.Qb&&(_[ot]=kt.qb,$t=!0),!$t)if(ce(Re),kt.jc){Lt=Re,Ir=_;var yr=ot,An=kt.pd[Z(Lt)&mc-1];t(kt.jc),256>An.g?(ye(Lt,Lt.u+An.g),Ir[yr]=An.value,Lt=0):(ye(Lt,Lt.u+An.g-256),t(256<=An.value),Lt=An.value),Lt==0&&($t=!0)}else Lt=as(kt.G[0],kt.H[0],Re);if(Re.h)break;if($t||256>Lt){if(!$t)if(kt.nd)_[ot]=(kt.qb|Lt<<8)>>>0;else{if(ce(Re),$t=as(kt.G[1],kt.H[1],Re),ce(Re),Ir=as(kt.G[2],kt.H[2],Re),yr=as(kt.G[3],kt.H[3],Re),Re.h)break;_[ot]=(yr<<24|$t<<16|Lt<<8|Ir)>>>0}if($t=!1,++ot,++Ne>=Y&&(Ne=0,++Se,ge!=null&&Se<=fe&&!(Se%16)&&ge(C,Se),st!=null))for(;Fe<ot;)Lt=_[Fe++],st.X[(506832829*Lt&4294967295)>>>st.Mb]=Lt}else if(280>Lt){if(Lt=pa(Lt-256,Re),Ir=as(kt.G[4],kt.H[4],Re),ce(Re),Ir=Ri(Y,Ir=pa(Ir,Re)),Re.h)break;if(ot-P<Ir||oe-ot<Lt)break e;for(yr=0;yr<Lt;++yr)_[ot+yr]=_[ot+yr-Ir];for(ot+=Lt,Ne+=Lt;Ne>=Y;)Ne-=Y,++Se,ge!=null&&Se<=fe&&!(Se%16)&&ge(C,Se);if(t(ot<=oe),Ne&wt&&(kt=Ms(Ke,Ne,Se)),st!=null)for(;Fe<ot;)Lt=_[Fe++],st.X[(506832829*Lt&4294967295)>>>st.Mb]=Lt}else{if(!(Lt<nt))break e;for($t=Lt-280,t(st!=null);Fe<ot;)Lt=_[Fe++],st.X[(506832829*Lt&4294967295)>>>st.Mb]=Lt;Lt=ot,t(!($t>>>(Ir=st).Xa)),_[Lt]=Ir.X[$t],$t=!0}$t||t(Re.h==se(Re))}if(C.Pb&&Re.h&&ot<oe)t(C.m.h),C.a=5,C.m=C.wd,C.$=C.xd,0<C.s.ua&&Ht(C.s.vb,C.s.Wa);else{if(Re.h)break e;ge?.(C,Se>fe?fe:Se),C.a=0,C.$=ot-P}return 1}return C.a=3,0}function na(C){t(C!=null),C.vc=null,C.yc=null,C.Ya=null;var _=C.Wa;_!=null&&(_.X=null),C.vb=null,t(C!=null)}function bi(){var C=new yn;return C==null?null:(C.a=0,C.xb=ho,Jn("Predictor","VP8LPredictors"),Jn("Predictor","VP8LPredictors_C"),Jn("PredictorAdd","VP8LPredictorsAdd"),Jn("PredictorAdd","VP8LPredictorsAdd_C"),ca=kr,Kc=_r,gc=ra,yc=Nn,wl=Qr,Xo=xr,vc=an,de.VP8LMapColor32b=Bi,de.VP8LMapColor8b=Ai,C)}function ml(C,_,P,Y,oe){var fe=1,ge=[C],Se=[_],Ne=Y.m,Re=Y.s,Ke=null,ot=0;e:for(;;){if(P)for(;fe&&X(Ne,1);){var Fe=ge,Ze=Se,nt=Y,At=1,st=nt.m,wt=nt.gc[nt.ab],kt=X(st,2);if(nt.Oc&1<<kt)fe=0;else{switch(nt.Oc|=1<<kt,wt.hc=kt,wt.Ea=Fe[0],wt.nc=Ze[0],wt.K=[null],++nt.ab,t(4>=nt.ab),kt){case 0:case 1:wt.b=X(st,3)+2,At=ml(Mt(wt.Ea,wt.b),Mt(wt.nc,wt.b),0,nt,wt.K),wt.K=wt.K[0];break;case 3:var $t,Lt=X(st,8)+1,Ir=16<Lt?0:4<Lt?1:2<Lt?2:3;if(Fe[0]=Mt(wt.Ea,Ir),wt.b=Ir,$t=At=ml(Lt,1,0,nt,wt.K)){var yr,An=Lt,Er=wt,Pn=1<<(8>>Er.b),za=e(Pn);if(za==null)$t=0;else{var En=Er.K[0],pr=Er.w;for(za[0]=Er.K[0][0],yr=1;yr<1*An;++yr)za[yr]=zr(En[pr+yr],za[yr-1]);for(;yr<4*Pn;++yr)za[yr]=0;Er.K[0]=null,Er.K[0]=za,$t=1}}At=$t;break;case 2:break;default:t(0)}fe=At}}if(ge=ge[0],Se=Se[0],fe&&X(Ne,1)&&!(fe=1<=(ot=X(Ne,4))&&11>=ot)){Y.a=3;break e}var sr;if(sr=fe)t:{var $a,qr,In,ya=Y,Ys=ge,hi=Se,Ma=ot,_s=P,Ti=ya.m,Is=ya.s,Dn=[null],Hn=1,hs=0,ua=_o[Ma];r:for(;;){if(_s&&X(Ti,1)){var ni=X(Ti,3)+2,ws=Mt(Ys,ni),ia=Mt(hi,ni),ds=ws*ia;if(!ml(ws,ia,0,ya,Dn))break r;for(Dn=Dn[0],Is.xc=ni,$a=0;$a<ds;++$a){var va=Dn[$a]>>8&65535;Dn[$a]=va,va>=Hn&&(Hn=va+1)}}if(Ti.h)break r;for(qr=0;5>qr;++qr){var Ds=wc[qr];!qr&&0<Ma&&(Ds+=1<<Ma),hs<Ds&&(hs=Ds)}var zs=p(Hn*ua,Ae),oa=Hn,Zn=p(oa,Be);if(Zn==null)var di=null;else t(65536>=oa),di=Zn;var es=e(hs);if(di==null||es==null||zs==null){ya.a=1;break r}var Zr=zs;for($a=In=0;$a<Hn;++$a){var Kr=di[$a],Vn=Kr.G,eo=Kr.H,Fo=0,Gi=1,$s=0;for(qr=0;5>qr;++qr){Ds=wc[qr],Vn[qr]=Zr,eo[qr]=In,!qr&&0<Ma&&(Ds+=1<<Ma);a:{var Ec,kc=Ds,Wh=ya,qa=es,Of=Zr,jd=In,Od=0,_c=Wh.m,xp=X(_c,1);if(n(qa,0,0,kc),xp){var Lf=X(_c,1)+1,Pf=X(_c,1),fh=X(_c,Pf==0?1:8);qa[fh]=1,Lf==2&&(qa[fh=X(_c,8)]=1);var fi=1}else{var Fs=e(19),Kh=X(_c,4)+4;if(19<Kh){Wh.a=3;var Xc=0;break a}for(Ec=0;Ec<Kh;++Ec)Fs[dh[Ec]]=X(_c,3);var Tu=void 0,Eu=void 0,Jl=Wh,Yh=Fs,fo=kc,Ld=qa,Pd=0,Ql=Jl.m,Md=8,Mf=p(128,Ae);n:for(;K(Mf,0,7,Yh,19);){if(X(Ql,1)){var Ud=2+2*X(Ql,3);if((Tu=2+X(Ql,Ud))>fo)break n}else Tu=fo;for(Eu=0;Eu<fo&&Tu--;){ce(Ql);var Jh=Mf[0+(127&Z(Ql))];ye(Ql,Ql.u+Jh.g);var Ic=Jh.value;if(16>Ic)Ld[Eu++]=Ic,Ic!=0&&(Md=Ic);else{var Uf=Ic==16,Bf=Ic-16,ku=Au[Bf],Hf=X(Ql,Eo[Bf])+ku;if(Eu+Hf>fo)break n;for(var B0=Uf?Md:0;0<Hf--;)Ld[Eu++]=B0}}Pd=1;break n}Pd||(Jl.a=3),fi=Pd}(fi=fi&&!_c.h)&&(Od=K(Of,jd,8,qa,kc)),fi&&Od!=0?Xc=Od:(Wh.a=3,Xc=0)}if(Xc==0)break r;if(Gi&&hh[qr]==1&&(Gi=Zr[In].g==0),Fo+=Zr[In].g,In+=Xc,3>=qr){var Zc,Qh=es[0];for(Zc=1;Zc<Ds;++Zc)es[Zc]>Qh&&(Qh=es[Zc]);$s+=Qh}}if(Kr.nd=Gi,Kr.Qb=0,Gi&&(Kr.qb=(Vn[3][eo[3]+0].value<<24|Vn[1][eo[1]+0].value<<16|Vn[2][eo[2]+0].value)>>>0,Fo==0&&256>Vn[0][eo[0]+0].value&&(Kr.Qb=1,Kr.qb+=Vn[0][eo[0]+0].value<<8)),Kr.jc=!Kr.Qb&&6>$s,Kr.jc){var eu,po=Kr;for(eu=0;eu<mc;++eu){var tl=eu,Xl=po.pd[tl],Bd=po.G[0][po.H[0]+tl];256<=Bd.value?(Xl.g=Bd.g+256,Xl.value=Bd.value):(Xl.g=0,Xl.value=0,tl>>=Ps(Bd,8,Xl),tl>>=Ps(po.G[1][po.H[1]+tl],16,Xl),tl>>=Ps(po.G[2][po.H[2]+tl],0,Xl),Ps(po.G[3][po.H[3]+tl],24,Xl))}}}Is.vc=Dn,Is.Wb=Hn,Is.Ya=di,Is.yc=zs,sr=1;break t}sr=0}if(!(fe=sr)){Y.a=3;break e}if(0<ot){if(Re.ua=1<<ot,!Te(Re.Wa,ot)){Y.a=1,fe=0;break e}}else Re.ua=0;var Hd=Y,Rs=ge,ph=Se,Zl=Hd.s,Dc=Zl.xc;if(Hd.c=Rs,Hd.i=ph,Zl.md=Mt(Rs,Dc),Zl.wc=Dc==0?-1:(1<<Dc)-1,P){Y.xb=Pa;break e}if((Ke=e(ge*Se))==null){Y.a=1,fe=0;break e}fe=(fe=jn(Y,Ke,0,ge,Se,Se,null))&&!Ne.h;break e}return fe?(oe!=null?oe[0]=Ke:(t(Ke==null),t(P)),Y.$=0,P||na(Re)):na(Re),fe}function Oi(C,_){var P=C.c*C.i,Y=P+_+16*_;return t(C.c<=_),C.V=e(Y),C.V==null?(C.Ta=null,C.Ua=0,C.a=1,0):(C.Ta=C.V,C.Ua=C.Ba+P+_,1)}function uc(C,_){var P=C.C,Y=_-P,oe=C.V,fe=C.Ba+C.c*P;for(t(_<=C.l.o);0<Y;){var ge=16<Y?16:Y,Se=C.l.ma,Ne=C.l.width,Re=Ne*ge,Ke=Se.ca,ot=Se.tb+Ne*P,Fe=C.Ta,Ze=C.Ua;pl(C,ge,oe,fe),zi(Fe,Ze,Ke,ot,Re),vn(Se,P,P+ge,Ke,ot,Ne),Y-=ge,oe+=ge*C.c,P+=ge}t(P==_),C.C=C.Ma=_}function gl(){this.ub=this.yd=this.td=this.Rb=0}function Go(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function $c(){this.Fb=this.Bb=this.Cb=0,this.Zb=e(4),this.Lb=e(4)}function Us(){this.Yb=(function(){var C=[];return(function _(P,Y,oe){for(var fe=oe[Y],ge=0;ge<fe&&(P.push(oe.length>Y+1?[]:0),!(oe.length<Y+1));ge++)_(P[ge],Y+1,oe)})(C,0,[3,11]),C})()}function ys(){this.jb=e(3),this.Wc=m([4,8],Us),this.Xc=m([4,17],Us)}function ss(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new e(4),this.od=new e(4)}function Ya(){this.ld=this.La=this.dd=this.tc=0}function Vo(){this.Na=this.la=0}function mn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function fu(){this.ad=e(384),this.Za=0,this.Ob=e(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function eh(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ya),this.Y=0,this.ya=Array(new fu),this.aa=0,this.l=new os}function hc(){this.y=e(16),this.f=e(8),this.ea=e(8)}function is(){this.cb=this.a=0,this.sc="",this.m=new H,this.Od=new gl,this.Kc=new Go,this.ed=new ss,this.Qa=new $c,this.Ic=this.$c=this.Aa=0,this.D=new eh,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=p(8,H),this.ia=0,this.pb=p(4,mn),this.Pa=new ys,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new hc),this.Hd=0,this.rb=Array(new Vo),this.sb=0,this.wa=Array(new Ya),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new fu),this.L=this.aa=0,this.gd=m([4,2],Ya),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function So(C,_){return 0>C?0:C>_?_:C}function os(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function yl(){var C=new is;return C!=null&&(C.a=0,C.sc="OK",C.cb=0,C.Xb=0,uo||(uo=dc)),C}function ma(C,_,P){return C.a==0&&(C.a=_,C.sc=P,C.cb=0),0}function ln(C,_,P){return 3<=P&&C[_+0]==157&&C[_+1]==1&&C[_+2]==42}function Zs(C,_){if(C==null)return 0;if(C.a=0,C.sc="OK",_==null)return ma(C,2,"null VP8Io passed to VP8GetHeaders()");var P=_.data,Y=_.w,oe=_.ha;if(4>oe)return ma(C,7,"Truncated header.");var fe=P[Y+0]|P[Y+1]<<8|P[Y+2]<<16,ge=C.Od;if(ge.Rb=!(1&fe),ge.td=fe>>1&7,ge.yd=fe>>4&1,ge.ub=fe>>5,3<ge.td)return ma(C,3,"Incorrect keyframe parameters.");if(!ge.yd)return ma(C,4,"Frame not displayable.");Y+=3,oe-=3;var Se=C.Kc;if(ge.Rb){if(7>oe)return ma(C,7,"cannot parse picture header");if(!ln(P,Y,oe))return ma(C,3,"Bad code word");Se.c=16383&(P[Y+4]<<8|P[Y+3]),Se.Td=P[Y+4]>>6,Se.i=16383&(P[Y+6]<<8|P[Y+5]),Se.Ud=P[Y+6]>>6,Y+=7,oe-=7,C.za=Se.c+15>>4,C.Ub=Se.i+15>>4,_.width=Se.c,_.height=Se.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,n((fe=C.Pa).jb,0,255,fe.jb.length),t((fe=C.Qa)!=null),fe.Cb=0,fe.Bb=0,fe.Fb=1,n(fe.Zb,0,0,fe.Zb.length),n(fe.Lb,0,0,fe.Lb)}if(ge.ub>oe)return ma(C,7,"bad partition length");Ee(fe=C.m,P,Y,ge.ub),Y+=ge.ub,oe-=ge.ub,ge.Rb&&(Se.Ld=pe(fe),Se.Kd=pe(fe)),Se=C.Qa;var Ne,Re=C.Pa;if(t(fe!=null),t(Se!=null),Se.Cb=pe(fe),Se.Cb){if(Se.Bb=pe(fe),pe(fe)){for(Se.Fb=pe(fe),Ne=0;4>Ne;++Ne)Se.Zb[Ne]=pe(fe)?Ue(fe,7):0;for(Ne=0;4>Ne;++Ne)Se.Lb[Ne]=pe(fe)?Ue(fe,6):0}if(Se.Bb)for(Ne=0;3>Ne;++Ne)Re.jb[Ne]=pe(fe)?Pe(fe,8):255}else Se.Bb=0;if(fe.Ka)return ma(C,3,"cannot parse segment header");if((Se=C.ed).zd=pe(fe),Se.Tb=Pe(fe,6),Se.wb=Pe(fe,3),Se.Pc=pe(fe),Se.Pc&&pe(fe)){for(Re=0;4>Re;++Re)pe(fe)&&(Se.vd[Re]=Ue(fe,6));for(Re=0;4>Re;++Re)pe(fe)&&(Se.od[Re]=Ue(fe,6))}if(C.L=Se.Tb==0?0:Se.zd?1:2,fe.Ka)return ma(C,3,"cannot parse filter header");var Ke=oe;if(oe=Ne=Y,Y=Ne+Ke,Se=Ke,C.Xb=(1<<Pe(C.m,2))-1,Ke<3*(Re=C.Xb))P=7;else{for(Ne+=3*Re,Se-=3*Re,Ke=0;Ke<Re;++Ke){var ot=P[oe+0]|P[oe+1]<<8|P[oe+2]<<16;ot>Se&&(ot=Se),Ee(C.Jc[+Ke],P,Ne,ot),Ne+=ot,Se-=ot,oe+=3}Ee(C.Jc[+Re],P,Ne,Se),P=Ne<Y?0:5}if(P!=0)return ma(C,P,"cannot parse partitions");for(P=Pe(Ne=C.m,7),oe=pe(Ne)?Ue(Ne,4):0,Y=pe(Ne)?Ue(Ne,4):0,Se=pe(Ne)?Ue(Ne,4):0,Re=pe(Ne)?Ue(Ne,4):0,Ne=pe(Ne)?Ue(Ne,4):0,Ke=C.Qa,ot=0;4>ot;++ot){if(Ke.Cb){var Fe=Ke.Zb[ot];Ke.Fb||(Fe+=P)}else{if(0<ot){C.pb[ot]=C.pb[0];continue}Fe=P}var Ze=C.pb[ot];Ze.Sc[0]=el[So(Fe+oe,127)],Ze.Sc[1]=Io[So(Fe+0,127)],Ze.Eb[0]=2*el[So(Fe+Y,127)],Ze.Eb[1]=101581*Io[So(Fe+Se,127)]>>16,8>Ze.Eb[1]&&(Ze.Eb[1]=8),Ze.Qc[0]=el[So(Fe+Re,117)],Ze.Qc[1]=Io[So(Fe+Ne,127)],Ze.lc=Fe+Ne}if(!ge.Rb)return ma(C,4,"Not a key frame.");for(pe(fe),ge=C.Pa,P=0;4>P;++P){for(oe=0;8>oe;++oe)for(Y=0;3>Y;++Y)for(Se=0;11>Se;++Se)Re=Ve(fe,Ha[P][oe][Y][Se])?Pe(fe,8):Rf[P][oe][Y][Se],ge.Wc[P][oe].Yb[Y][Se]=Re;for(oe=0;17>oe;++oe)ge.Xc[P][oe]=ge.Wc[P][Gn[oe]]}return C.kc=pe(fe),C.kc&&(C.Bd=Pe(fe,8)),C.cb=1}function dc(C,_,P,Y,oe,fe,ge){var Se=_[oe].Yb[P];for(P=0;16>oe;++oe){if(!Ve(C,Se[P+0]))return oe;for(;!Ve(C,Se[P+1]);)if(Se=_[++oe].Yb[0],P=0,oe==16)return 16;var Ne=_[oe+1].Yb;if(Ve(C,Se[P+2])){var Re=C,Ke=0;if(Ve(Re,(Fe=Se)[(ot=P)+3]))if(Ve(Re,Fe[ot+6])){for(Se=0,ot=2*(Ke=Ve(Re,Fe[ot+8]))+(Fe=Ve(Re,Fe[ot+9+Ke])),Ke=0,Fe=zh[ot];Fe[Se];++Se)Ke+=Ke+Ve(Re,Fe[Se]);Ke+=3+(8<<ot)}else Ve(Re,Fe[ot+7])?(Ke=7+2*Ve(Re,165),Ke+=Ve(Re,145)):Ke=5+Ve(Re,159);else Ke=Ve(Re,Fe[ot+4])?3+Ve(Re,Fe[ot+5]):2;Se=Ne[2]}else Ke=1,Se=Ne[1];Ne=ge+Rd[oe],0>(Re=C).b&&ze(Re);var ot,Fe=Re.b,Ze=(ot=Re.Ca>>1)-(Re.I>>Fe)>>31;--Re.b,Re.Ca+=Ze,Re.Ca|=1,Re.I-=(ot+1&Ze)<<Fe,fe[Ne]=((Ke^Ze)-Ze)*Y[(0<oe)+0]}return 16}function th(C){var _=C.rb[C.sb-1];_.la=0,_.Na=0,n(C.zc,0,0,C.zc.length),C.ja=0}function Li(C,_,P,Y,oe){oe=C[_+P+32*Y]+(oe>>3),C[_+P+32*Y]=-256&oe?0>oe?0:255:oe}function Bs(C,_,P,Y,oe,fe){Li(C,_,0,P,Y+oe),Li(C,_,1,P,Y+fe),Li(C,_,2,P,Y-fe),Li(C,_,3,P,Y-oe)}function cn(C){return(20091*C>>16)+C}function qc(C,_,P,Y){var oe,fe=0,ge=e(16);for(oe=0;4>oe;++oe){var Se=C[_+0]+C[_+8],Ne=C[_+0]-C[_+8],Re=(35468*C[_+4]>>16)-cn(C[_+12]),Ke=cn(C[_+4])+(35468*C[_+12]>>16);ge[fe+0]=Se+Ke,ge[fe+1]=Ne+Re,ge[fe+2]=Ne-Re,ge[fe+3]=Se-Ke,fe+=4,_++}for(oe=fe=0;4>oe;++oe)Se=(C=ge[fe+0]+4)+ge[fe+8],Ne=C-ge[fe+8],Re=(35468*ge[fe+4]>>16)-cn(ge[fe+12]),Li(P,Y,0,0,Se+(Ke=cn(ge[fe+4])+(35468*ge[fe+12]>>16))),Li(P,Y,1,0,Ne+Re),Li(P,Y,2,0,Ne-Re),Li(P,Y,3,0,Se-Ke),fe++,Y+=32}function Td(C,_,P,Y){var oe=C[_+0]+4,fe=35468*C[_+4]>>16,ge=cn(C[_+4]),Se=35468*C[_+1]>>16;Bs(P,Y,0,oe+ge,C=cn(C[_+1]),Se),Bs(P,Y,1,oe+fe,C,Se),Bs(P,Y,2,oe-fe,C,Se),Bs(P,Y,3,oe-ge,C,Se)}function aa(C,_,P,Y,oe){qc(C,_,P,Y),oe&&qc(C,_+16,P,Y+4)}function Pi(C,_,P,Y){ql(C,_+0,P,Y,1),ql(C,_+32,P,Y+128,1)}function rh(C,_,P,Y){var oe;for(C=C[_+0]+4,oe=0;4>oe;++oe)for(_=0;4>_;++_)Li(P,Y,_,oe,C)}function pu(C,_,P,Y){C[_+0]&&Sn(C,_+0,P,Y),C[_+16]&&Sn(C,_+16,P,Y+4),C[_+32]&&Sn(C,_+32,P,Y+128),C[_+48]&&Sn(C,_+48,P,Y+128+4)}function Wo(C,_,P,Y){var oe,fe=e(16);for(oe=0;4>oe;++oe){var ge=C[_+0+oe]+C[_+12+oe],Se=C[_+4+oe]+C[_+8+oe],Ne=C[_+4+oe]-C[_+8+oe],Re=C[_+0+oe]-C[_+12+oe];fe[0+oe]=ge+Se,fe[8+oe]=ge-Se,fe[4+oe]=Re+Ne,fe[12+oe]=Re-Ne}for(oe=0;4>oe;++oe)ge=(C=fe[0+4*oe]+3)+fe[3+4*oe],Se=fe[1+4*oe]+fe[2+4*oe],Ne=fe[1+4*oe]-fe[2+4*oe],Re=C-fe[3+4*oe],P[Y+0]=ge+Se>>3,P[Y+16]=Re+Ne>>3,P[Y+32]=ge-Se>>3,P[Y+48]=Re-Ne>>3,Y+=64}function Gc(C,_,P){var Y,oe=_-32,fe=$i,ge=255-C[oe-1];for(Y=0;Y<P;++Y){var Se,Ne=fe,Re=ge+C[_-1];for(Se=0;Se<P;++Se)C[_+Se]=Ne[Re+C[oe+Se]];_+=32}}function Ed(C,_){Gc(C,_,4)}function Ea(C,_){Gc(C,_,8)}function mu(C,_){Gc(C,_,16)}function nh(C,_){var P;for(P=0;16>P;++P)a(C,_+32*P,C,_-32,16)}function Lh(C,_){var P;for(P=16;0<P;--P)n(C,_,C[_-1],16),_+=32}function Mi(C,_,P){var Y;for(Y=0;16>Y;++Y)n(_,P+32*Y,C,16)}function ao(C,_){var P,Y=16;for(P=0;16>P;++P)Y+=C[_-1+32*P]+C[_+P-32];Mi(Y>>5,C,_)}function Ko(C,_){var P,Y=8;for(P=0;16>P;++P)Y+=C[_-1+32*P];Mi(Y>>4,C,_)}function Xn(C,_){var P,Y=8;for(P=0;16>P;++P)Y+=C[_+P-32];Mi(Y>>4,C,_)}function xi(C,_){Mi(128,C,_)}function tn(C,_,P){return C+2*_+P+2>>2}function Ph(C,_){var P,Y=_-32;for(Y=new Uint8Array([tn(C[Y-1],C[Y+0],C[Y+1]),tn(C[Y+0],C[Y+1],C[Y+2]),tn(C[Y+1],C[Y+2],C[Y+3]),tn(C[Y+2],C[Y+3],C[Y+4])]),P=0;4>P;++P)a(C,_+32*P,Y,0,Y.length)}function Mh(C,_){var P=C[_-1],Y=C[_-1+32],oe=C[_-1+64],fe=C[_-1+96];yt(C,_+0,16843009*tn(C[_-1-32],P,Y)),yt(C,_+32,16843009*tn(P,Y,oe)),yt(C,_+64,16843009*tn(Y,oe,fe)),yt(C,_+96,16843009*tn(oe,fe,fe))}function kd(C,_){var P,Y=4;for(P=0;4>P;++P)Y+=C[_+P-32]+C[_-1+32*P];for(Y>>=3,P=0;4>P;++P)n(C,_+32*P,Y,4)}function Ao(C,_){var P=C[_-1+0],Y=C[_-1+32],oe=C[_-1+64],fe=C[_-1-32],ge=C[_+0-32],Se=C[_+1-32],Ne=C[_+2-32],Re=C[_+3-32];C[_+0+96]=tn(Y,oe,C[_-1+96]),C[_+1+96]=C[_+0+64]=tn(P,Y,oe),C[_+2+96]=C[_+1+64]=C[_+0+32]=tn(fe,P,Y),C[_+3+96]=C[_+2+64]=C[_+1+32]=C[_+0+0]=tn(ge,fe,P),C[_+3+64]=C[_+2+32]=C[_+1+0]=tn(Se,ge,fe),C[_+3+32]=C[_+2+0]=tn(Ne,Se,ge),C[_+3+0]=tn(Re,Ne,Se)}function ii(C,_){var P=C[_+1-32],Y=C[_+2-32],oe=C[_+3-32],fe=C[_+4-32],ge=C[_+5-32],Se=C[_+6-32],Ne=C[_+7-32];C[_+0+0]=tn(C[_+0-32],P,Y),C[_+1+0]=C[_+0+32]=tn(P,Y,oe),C[_+2+0]=C[_+1+32]=C[_+0+64]=tn(Y,oe,fe),C[_+3+0]=C[_+2+32]=C[_+1+64]=C[_+0+96]=tn(oe,fe,ge),C[_+3+32]=C[_+2+64]=C[_+1+96]=tn(fe,ge,Se),C[_+3+64]=C[_+2+96]=tn(ge,Se,Ne),C[_+3+96]=tn(Se,Ne,Ne)}function ah(C,_){var P=C[_-1+0],Y=C[_-1+32],oe=C[_-1+64],fe=C[_-1-32],ge=C[_+0-32],Se=C[_+1-32],Ne=C[_+2-32],Re=C[_+3-32];C[_+0+0]=C[_+1+64]=fe+ge+1>>1,C[_+1+0]=C[_+2+64]=ge+Se+1>>1,C[_+2+0]=C[_+3+64]=Se+Ne+1>>1,C[_+3+0]=Ne+Re+1>>1,C[_+0+96]=tn(oe,Y,P),C[_+0+64]=tn(Y,P,fe),C[_+0+32]=C[_+1+96]=tn(P,fe,ge),C[_+1+32]=C[_+2+96]=tn(fe,ge,Se),C[_+2+32]=C[_+3+96]=tn(ge,Se,Ne),C[_+3+32]=tn(Se,Ne,Re)}function vs(C,_){var P=C[_+0-32],Y=C[_+1-32],oe=C[_+2-32],fe=C[_+3-32],ge=C[_+4-32],Se=C[_+5-32],Ne=C[_+6-32],Re=C[_+7-32];C[_+0+0]=P+Y+1>>1,C[_+1+0]=C[_+0+64]=Y+oe+1>>1,C[_+2+0]=C[_+1+64]=oe+fe+1>>1,C[_+3+0]=C[_+2+64]=fe+ge+1>>1,C[_+0+32]=tn(P,Y,oe),C[_+1+32]=C[_+0+96]=tn(Y,oe,fe),C[_+2+32]=C[_+1+96]=tn(oe,fe,ge),C[_+3+32]=C[_+2+96]=tn(fe,ge,Se),C[_+3+64]=tn(ge,Se,Ne),C[_+3+96]=tn(Se,Ne,Re)}function wi(C,_){var P=C[_-1+0],Y=C[_-1+32],oe=C[_-1+64],fe=C[_-1+96];C[_+0+0]=P+Y+1>>1,C[_+2+0]=C[_+0+32]=Y+oe+1>>1,C[_+2+32]=C[_+0+64]=oe+fe+1>>1,C[_+1+0]=tn(P,Y,oe),C[_+3+0]=C[_+1+32]=tn(Y,oe,fe),C[_+3+32]=C[_+1+64]=tn(oe,fe,fe),C[_+3+64]=C[_+2+64]=C[_+0+96]=C[_+1+96]=C[_+2+96]=C[_+3+96]=fe}function Xt(C,_){var P=C[_-1+0],Y=C[_-1+32],oe=C[_-1+64],fe=C[_-1+96],ge=C[_-1-32],Se=C[_+0-32],Ne=C[_+1-32],Re=C[_+2-32];C[_+0+0]=C[_+2+32]=P+ge+1>>1,C[_+0+32]=C[_+2+64]=Y+P+1>>1,C[_+0+64]=C[_+2+96]=oe+Y+1>>1,C[_+0+96]=fe+oe+1>>1,C[_+3+0]=tn(Se,Ne,Re),C[_+2+0]=tn(ge,Se,Ne),C[_+1+0]=C[_+3+32]=tn(P,ge,Se),C[_+1+32]=C[_+3+64]=tn(Y,P,ge),C[_+1+64]=C[_+3+96]=tn(oe,Y,P),C[_+1+96]=tn(fe,oe,Y)}function Yo(C,_){var P;for(P=0;8>P;++P)a(C,_+32*P,C,_-32,8)}function sh(C,_){var P;for(P=0;8>P;++P)n(C,_,C[_-1],8),_+=32}function Ui(C,_,P){var Y;for(Y=0;8>Y;++Y)n(_,P+32*Y,C,8)}function ls(C,_){var P,Y=8;for(P=0;8>P;++P)Y+=C[_+P-32]+C[_-1+32*P];Ui(Y>>4,C,_)}function Jo(C,_){var P,Y=4;for(P=0;8>P;++P)Y+=C[_+P-32];Ui(Y>>3,C,_)}function wa(C,_){var P,Y=4;for(P=0;8>P;++P)Y+=C[_-1+32*P];Ui(Y>>3,C,_)}function vl(C,_){Ui(128,C,_)}function Co(C,_,P){var Y=C[_-P],oe=C[_+0],fe=3*(oe-Y)+lo[1020+C[_-2*P]-C[_+P]],ge=sa[112+(fe+4>>3)];C[_-P]=$i[255+Y+sa[112+(fe+3>>3)]],C[_+0]=$i[255+oe-ge]}function Fl(C,_,P,Y){var oe=C[_+0],fe=C[_+P];return li[255+C[_-2*P]-C[_-P]]>Y||li[255+fe-oe]>Y}function gu(C,_,P,Y){return 4*li[255+C[_-P]-C[_+0]]+li[255+C[_-2*P]-C[_+P]]<=Y}function Vc(C,_,P,Y,oe){var fe=C[_-3*P],ge=C[_-2*P],Se=C[_-P],Ne=C[_+0],Re=C[_+P],Ke=C[_+2*P],ot=C[_+3*P];return 4*li[255+Se-Ne]+li[255+ge-Re]>Y?0:li[255+C[_-4*P]-fe]<=oe&&li[255+fe-ge]<=oe&&li[255+ge-Se]<=oe&&li[255+ot-Ke]<=oe&&li[255+Ke-Re]<=oe&&li[255+Re-Ne]<=oe}function Rl(C,_,P,Y){var oe=2*Y+1;for(Y=0;16>Y;++Y)gu(C,_+Y,P,oe)&&Co(C,_+Y,P)}function jl(C,_,P,Y){var oe=2*Y+1;for(Y=0;16>Y;++Y)gu(C,_+Y*P,1,oe)&&Co(C,_+Y*P,1)}function Wc(C,_,P,Y){var oe;for(oe=3;0<oe;--oe)Rl(C,_+=4*P,P,Y)}function ih(C,_,P,Y){var oe;for(oe=3;0<oe;--oe)jl(C,_+=4,P,Y)}function Ol(C,_,P,Y,oe,fe,ge,Se){for(fe=2*fe+1;0<oe--;){if(Vc(C,_,P,fe,ge))if(Fl(C,_,P,Se))Co(C,_,P);else{var Ne=C,Re=_,Ke=P,ot=Ne[Re-2*Ke],Fe=Ne[Re-Ke],Ze=Ne[Re+0],nt=Ne[Re+Ke],At=Ne[Re+2*Ke],st=27*(kt=lo[1020+3*(Ze-Fe)+lo[1020+ot-nt]])+63>>7,wt=18*kt+63>>7,kt=9*kt+63>>7;Ne[Re-3*Ke]=$i[255+Ne[Re-3*Ke]+kt],Ne[Re-2*Ke]=$i[255+ot+wt],Ne[Re-Ke]=$i[255+Fe+st],Ne[Re+0]=$i[255+Ze-st],Ne[Re+Ke]=$i[255+nt-wt],Ne[Re+2*Ke]=$i[255+At-kt]}_+=Y}}function Ll(C,_,P,Y,oe,fe,ge,Se){for(fe=2*fe+1;0<oe--;){if(Vc(C,_,P,fe,ge))if(Fl(C,_,P,Se))Co(C,_,P);else{var Ne=C,Re=_,Ke=P,ot=Ne[Re-Ke],Fe=Ne[Re+0],Ze=Ne[Re+Ke],nt=sa[112+(4+(At=3*(Fe-ot))>>3)],At=sa[112+(At+3>>3)],st=nt+1>>1;Ne[Re-2*Ke]=$i[255+Ne[Re-2*Ke]+st],Ne[Re-Ke]=$i[255+ot+At],Ne[Re+0]=$i[255+Fe-nt],Ne[Re+Ke]=$i[255+Ze-st]}_+=Y}}function yu(C,_,P,Y,oe,fe){Ol(C,_,P,1,16,Y,oe,fe)}function Pl(C,_,P,Y,oe,fe){Ol(C,_,1,P,16,Y,oe,fe)}function fc(C,_,P,Y,oe,fe){var ge;for(ge=3;0<ge;--ge)Ll(C,_+=4*P,P,1,16,Y,oe,fe)}function j(C,_,P,Y,oe,fe){var ge;for(ge=3;0<ge;--ge)Ll(C,_+=4,1,P,16,Y,oe,fe)}function ie(C,_,P,Y,oe,fe,ge,Se){Ol(C,_,oe,1,8,fe,ge,Se),Ol(P,Y,oe,1,8,fe,ge,Se)}function je(C,_,P,Y,oe,fe,ge,Se){Ol(C,_,1,oe,8,fe,ge,Se),Ol(P,Y,1,oe,8,fe,ge,Se)}function Ge(C,_,P,Y,oe,fe,ge,Se){Ll(C,_+4*oe,oe,1,8,fe,ge,Se),Ll(P,Y+4*oe,oe,1,8,fe,ge,Se)}function tt(C,_,P,Y,oe,fe,ge,Se){Ll(C,_+4,1,oe,8,fe,ge,Se),Ll(P,Y+4,1,oe,8,fe,ge,Se)}function Et(){this.ba=new fn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Jt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ut(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function wr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Cr(){this.ua=0,this.Wa=new Or,this.vb=new Or,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Be,this.yc=new Ae}function yn(){this.xb=this.a=0,this.l=new os,this.ca=new fn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new ae,this.Pb=0,this.wd=new ae,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Cr,this.ab=0,this.gc=p(4,wr),this.Oc=0}function $r(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new os,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function On(C,_,P,Y,oe,fe,ge){for(C=C==null?0:C[_+0],_=0;_<ge;++_)oe[fe+_]=C+P[Y+_]&255,C=oe[fe+_]}function bs(C,_,P,Y,oe,fe,ge){var Se;if(C==null)On(null,null,P,Y,oe,fe,ge);else for(Se=0;Se<ge;++Se)oe[fe+Se]=C[_+Se]+P[Y+Se]&255}function Ja(C,_,P,Y,oe,fe,ge){if(C==null)On(null,null,P,Y,oe,fe,ge);else{var Se,Ne=C[_+0],Re=Ne,Ke=Ne;for(Se=0;Se<ge;++Se)Re=Ke+(Ne=C[_+Se])-Re,Ke=P[Y+Se]+(-256&Re?0>Re?0:255:Re)&255,Re=Ne,oe[fe+Se]=Ke}}function Ba(C,_,P,Y){var oe=_.width,fe=_.o;if(t(C!=null&&_!=null),0>P||0>=Y||P+Y>fe)return null;if(!C.Cc){if(C.ga==null){var ge;if(C.ga=new $r,(ge=C.ga==null)||(ge=_.width*_.o,t(C.Gb.length==0),C.Gb=e(ge),C.Uc=0,C.Gb==null?ge=0:(C.mb=C.Gb,C.nb=C.Uc,C.rc=null,ge=1),ge=!ge),!ge){ge=C.ga;var Se=C.Fa,Ne=C.P,Re=C.qc,Ke=C.mb,ot=C.nb,Fe=Ne+1,Ze=Re-1,nt=ge.l;if(t(Se!=null&&Ke!=null&&_!=null),Gl[0]=null,Gl[1]=On,Gl[2]=bs,Gl[3]=Ja,ge.ca=Ke,ge.tb=ot,ge.c=_.width,ge.i=_.height,t(0<ge.c&&0<ge.i),1>=Re)_=0;else if(ge.$a=3&Se[Ne+0],ge.Z=Se[Ne+0]>>2&3,ge.Lc=Se[Ne+0]>>4&3,Ne=Se[Ne+0]>>6&3,0>ge.$a||1<ge.$a||4<=ge.Z||1<ge.Lc||Ne)_=0;else if(nt.put=Yr,nt.ac=xo,nt.bc=qo,nt.ma=ge,nt.width=_.width,nt.height=_.height,nt.Da=_.Da,nt.v=_.v,nt.va=_.va,nt.j=_.j,nt.o=_.o,ge.$a)e:{t(ge.$a==1),_=bi();t:for(;;){if(_==null){_=0;break e}if(t(ge!=null),ge.mc=_,_.c=ge.c,_.i=ge.i,_.l=ge.l,_.l.ma=ge,_.l.width=ge.c,_.l.height=ge.i,_.a=0,_e(_.m,Se,Fe,Ze),!ml(ge.c,ge.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&Fa(_.s)?(ge.ic=1,Se=_.c*_.i,_.Ta=null,_.Ua=0,_.V=e(Se),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(ge.ic=0,_=Oi(_,ge.c)),!_))break t;_=1;break e}ge.mc=null,_=0}else _=Ze>=ge.c*ge.i;ge=!_}if(ge)return null;C.ga.Lc!=1?C.Ga=0:Y=fe-P}t(C.ga!=null),t(P+Y<=fe);e:{if(_=(Se=C.ga).c,fe=Se.l.o,Se.$a==0){if(Fe=C.rc,Ze=C.Vc,nt=C.Fa,Ne=C.P+1+P*_,Re=C.mb,Ke=C.nb+P*_,t(Ne<=C.P+C.qc),Se.Z!=0)for(t(Gl[Se.Z]!=null),ge=0;ge<Y;++ge)Gl[Se.Z](Fe,Ze,nt,Ne,Re,Ke,_),Fe=Re,Ze=Ke,Ke+=_,Ne+=_;else for(ge=0;ge<Y;++ge)a(Re,Ke,nt,Ne,_),Fe=Re,Ze=Ke,Ke+=_,Ne+=_;C.rc=Fe,C.Vc=Ze}else{if(t(Se.mc!=null),_=P+Y,t((ge=Se.mc)!=null),t(_<=ge.i),ge.C>=_)_=1;else if(Se.ic||Ra(),Se.ic){Se=ge.V,Fe=ge.Ba,Ze=ge.c;var At=ge.i,st=(nt=1,Ne=ge.$/Ze,Re=ge.$%Ze,Ke=ge.m,ot=ge.s,ge.$),wt=Ze*At,kt=Ze*_,$t=ot.wc,Lt=st<kt?Ms(ot,Re,Ne):null;t(st<=wt),t(_<=At),t(Fa(ot));t:for(;;){for(;!Ke.h&&st<kt;){if(Re&$t||(Lt=Ms(ot,Re,Ne)),t(Lt!=null),ce(Ke),256>(At=as(Lt.G[0],Lt.H[0],Ke)))Se[Fe+st]=At,++st,++Re>=Ze&&(Re=0,++Ne<=_&&!(Ne%16)&&Cs(ge,Ne));else{if(!(280>At)){nt=0;break t}At=pa(At-256,Ke);var Ir,yr=as(Lt.G[4],Lt.H[4],Ke);if(ce(Ke),!(st>=(yr=Ri(Ze,yr=pa(yr,Ke)))&&wt-st>=At)){nt=0;break t}for(Ir=0;Ir<At;++Ir)Se[Fe+st+Ir]=Se[Fe+st+Ir-yr];for(st+=At,Re+=At;Re>=Ze;)Re-=Ze,++Ne<=_&&!(Ne%16)&&Cs(ge,Ne);st<kt&&Re&$t&&(Lt=Ms(ot,Re,Ne))}t(Ke.h==se(Ke))}Cs(ge,Ne>_?_:Ne);break t}!nt||Ke.h&&st<wt?(nt=0,ge.a=Ke.h?5:3):ge.$=st,_=nt}else _=jn(ge,ge.V,ge.Ba,ge.c,ge.i,_,uc);if(!_){Y=0;break e}}P+Y>=fe&&(C.Cc=1),Y=1}if(!Y)return null;if(C.Cc&&((Y=C.ga)!=null&&(Y.mc=null),C.ga=null,0<C.Ga))return alert("todo:WebPDequantizeLevels"),null}return C.nb+P*oe}function ei(C,_,P,Y,oe,fe){for(;0<oe--;){var ge,Se=C,Ne=_+(P?1:0),Re=C,Ke=_+(P?0:3);for(ge=0;ge<Y;++ge){var ot=Re[Ke+4*ge];ot!=255&&(ot*=32897,Se[Ne+4*ge+0]=Se[Ne+4*ge+0]*ot>>23,Se[Ne+4*ge+1]=Se[Ne+4*ge+1]*ot>>23,Se[Ne+4*ge+2]=Se[Ne+4*ge+2]*ot>>23)}_+=fe}}function Ws(C,_,P,Y,oe){for(;0<Y--;){var fe;for(fe=0;fe<P;++fe){var ge=C[_+2*fe+0],Se=15&(Re=C[_+2*fe+1]),Ne=4369*Se,Re=(240&Re|Re>>4)*Ne>>16;C[_+2*fe+0]=(240&ge|ge>>4)*Ne>>16&240|(15&ge|ge<<4)*Ne>>16>>4&15,C[_+2*fe+1]=240&Re|Se}_+=oe}}function Si(C,_,P,Y,oe,fe,ge,Se){var Ne,Re,Ke=255;for(Re=0;Re<oe;++Re){for(Ne=0;Ne<Y;++Ne){var ot=C[_+Ne];fe[ge+4*Ne]=ot,Ke&=ot}_+=P,ge+=Se}return Ke!=255}function Ml(C,_,P,Y,oe){var fe;for(fe=0;fe<oe;++fe)P[Y+fe]=C[_+fe]>>8}function Ra(){Zi=ei,No=Ws,bu=Si,zi=Ml}function cs(C,_,P){de[C]=function(Y,oe,fe,ge,Se,Ne,Re,Ke,ot,Fe,Ze,nt,At,st,wt,kt,$t){var Lt,Ir=$t-1>>1,yr=Se[Ne+0]|Re[Ke+0]<<16,An=ot[Fe+0]|Ze[nt+0]<<16;t(Y!=null);var Er=3*yr+An+131074>>2;for(_(Y[oe+0],255&Er,Er>>16,At,st),fe!=null&&(Er=3*An+yr+131074>>2,_(fe[ge+0],255&Er,Er>>16,wt,kt)),Lt=1;Lt<=Ir;++Lt){var Pn=Se[Ne+Lt]|Re[Ke+Lt]<<16,za=ot[Fe+Lt]|Ze[nt+Lt]<<16,En=yr+Pn+An+za+524296,pr=En+2*(Pn+An)>>3;Er=pr+yr>>1,yr=(En=En+2*(yr+za)>>3)+Pn>>1,_(Y[oe+2*Lt-1],255&Er,Er>>16,At,st+(2*Lt-1)*P),_(Y[oe+2*Lt-0],255&yr,yr>>16,At,st+(2*Lt-0)*P),fe!=null&&(Er=En+An>>1,yr=pr+za>>1,_(fe[ge+2*Lt-1],255&Er,Er>>16,wt,kt+(2*Lt-1)*P),_(fe[ge+2*Lt+0],255&yr,yr>>16,wt,kt+(2*Lt+0)*P)),yr=Pn,An=za}1&$t||(Er=3*yr+An+131074>>2,_(Y[oe+$t-1],255&Er,Er>>16,At,st+($t-1)*P),fe!=null&&(Er=3*An+yr+131074>>2,_(fe[ge+$t-1],255&Er,Er>>16,wt,kt+($t-1)*P)))}}function xt(){ui[Bh]=Sl,ui[La]=Vl,ui[Dd]=Ac,ui[To]=Wl,ui[xu]=Cc,ui[wu]=Kl,ui[co]=Al,ui[uh]=Vl,ui[Hh]=Wl,ui[Su]=Cc,ui[Fd]=Kl}function so(C){return C&-16384?0>C?0:255:C>>Yl}function xs(C,_){return so((19077*C>>8)+(26149*_>>8)-14234)}function jt(C,_,P){return so((19077*C>>8)-(6419*_>>8)-(13320*P>>8)+8708)}function bl(C,_){return so((19077*C>>8)+(33050*_>>8)-17685)}function Ul(C,_,P,Y,oe){Y[oe+0]=xs(C,P),Y[oe+1]=jt(C,_,P),Y[oe+2]=bl(C,_)}function Ns(C,_,P,Y,oe){Y[oe+0]=bl(C,_),Y[oe+1]=jt(C,_,P),Y[oe+2]=xs(C,P)}function Bl(C,_,P,Y,oe){var fe=jt(C,_,P);_=fe<<3&224|bl(C,_)>>3,Y[oe+0]=248&xs(C,P)|fe>>5,Y[oe+1]=_}function Hl(C,_,P,Y,oe){var fe=240&bl(C,_)|15;Y[oe+0]=240&xs(C,P)|jt(C,_,P)>>4,Y[oe+1]=fe}function ja(C,_,P,Y,oe){Y[oe+0]=255,Ul(C,_,P,Y,oe+1)}function Qo(C,_,P,Y,oe){Ns(C,_,P,Y,oe),Y[oe+3]=255}function Ln(C,_,P,Y,oe){Ul(C,_,P,Y,oe),Y[oe+3]=255}function ga(C,_,P){de[C]=function(Y,oe,fe,ge,Se,Ne,Re,Ke,ot){for(var Fe=Ke+(-2&ot)*P;Ke!=Fe;)_(Y[oe+0],fe[ge+0],Se[Ne+0],Re,Ke),_(Y[oe+1],fe[ge+0],Se[Ne+0],Re,Ke+P),oe+=2,++ge,++Ne,Ke+=2*P;1&ot&&_(Y[oe+0],fe[ge+0],Se[Ne+0],Re,Ke)}}function sn(C,_,P){return P==0?C==0?_==0?6:5:_==0?4:0:P}function ti(C,_,P,Y,oe){switch(C>>>30){case 3:ql(_,P,Y,oe,0);break;case 2:Ts(_,P,Y,oe);break;case 1:Sn(_,P,Y,oe)}}function rn(C,_){var P,Y,oe=_.M,fe=_.Nb,ge=C.oc,Se=C.pc+40,Ne=C.oc,Re=C.pc+584,Ke=C.oc,ot=C.pc+600;for(P=0;16>P;++P)ge[Se+32*P-1]=129;for(P=0;8>P;++P)Ne[Re+32*P-1]=129,Ke[ot+32*P-1]=129;for(0<oe?ge[Se-1-32]=Ne[Re-1-32]=Ke[ot-1-32]=129:(n(ge,Se-32-1,127,21),n(Ne,Re-32-1,127,9),n(Ke,ot-32-1,127,9)),Y=0;Y<C.za;++Y){var Fe=_.ya[_.aa+Y];if(0<Y){for(P=-1;16>P;++P)a(ge,Se+32*P-4,ge,Se+32*P+12,4);for(P=-1;8>P;++P)a(Ne,Re+32*P-4,Ne,Re+32*P+4,4),a(Ke,ot+32*P-4,Ke,ot+32*P+4,4)}var Ze=C.Gd,nt=C.Hd+Y,At=Fe.ad,st=Fe.Hc;if(0<oe&&(a(ge,Se-32,Ze[nt].y,0,16),a(Ne,Re-32,Ze[nt].f,0,8),a(Ke,ot-32,Ze[nt].ea,0,8)),Fe.Za){var wt=ge,kt=Se-32+16;for(0<oe&&(Y>=C.za-1?n(wt,kt,Ze[nt].y[15],4):a(wt,kt,Ze[nt+1].y,0,4)),P=0;4>P;P++)wt[kt+128+P]=wt[kt+256+P]=wt[kt+384+P]=wt[kt+0+P];for(P=0;16>P;++P,st<<=2)wt=ge,kt=Se+Hs[P],_n[Fe.Ob[P]](wt,kt),ti(st,At,16*+P,wt,kt)}else if(wt=sn(Y,oe,Fe.Ob[0]),ks[wt](ge,Se),st!=0)for(P=0;16>P;++P,st<<=2)ti(st,At,16*+P,ge,Se+Hs[P]);for(P=Fe.Gc,wt=sn(Y,oe,Fe.Dd),Za[wt](Ne,Re),Za[wt](Ke,ot),st=At,wt=Ne,kt=Re,255&(Fe=0|P)&&(170&Fe?Ci(st,256,wt,kt):Un(st,256,wt,kt)),Fe=Ke,st=ot,255&(P>>=8)&&(170&P?Ci(At,320,Fe,st):Un(At,320,Fe,st)),oe<C.Ub-1&&(a(Ze[nt].y,0,ge,Se+480,16),a(Ze[nt].f,0,Ne,Re+224,8),a(Ze[nt].ea,0,Ke,ot+224,8)),P=8*fe*C.B,Ze=C.sa,nt=C.ta+16*Y+16*fe*C.R,At=C.qa,Fe=C.ra+8*Y+P,st=C.Ha,wt=C.Ia+8*Y+P,P=0;16>P;++P)a(Ze,nt+P*C.R,ge,Se+32*P,16);for(P=0;8>P;++P)a(At,Fe+P*C.B,Ne,Re+32*P,8),a(st,wt+P*C.B,Ke,ot+32*P,8)}}function wn(C,_,P,Y,oe,fe,ge,Se,Ne){var Re=[0],Ke=[0],ot=0,Fe=Ne!=null?Ne.kd:0,Ze=Ne??new Ut;if(C==null||12>P)return 7;Ze.data=C,Ze.w=_,Ze.ha=P,_=[_],P=[P],Ze.gb=[Ze.gb];e:{var nt=_,At=P,st=Ze.gb;if(t(C!=null),t(At!=null),t(st!=null),st[0]=0,12<=At[0]&&!r(C,nt[0],"RIFF")){if(r(C,nt[0]+8,"WEBP")){st=3;break e}var wt=Ft(C,nt[0]+4);if(12>wt||4294967286<wt){st=3;break e}if(Fe&&wt>At[0]-8){st=7;break e}st[0]=wt,nt[0]+=12,At[0]-=12}st=0}if(st!=0)return st;for(wt=0<Ze.gb[0],P=P[0];;){e:{var kt=C;At=_,st=P;var $t=Re,Lt=Ke,Ir=nt=[0];if((Er=ot=[ot])[0]=0,8>st[0])st=7;else{if(!r(kt,At[0],"VP8X")){if(Ft(kt,At[0]+4)!=10){st=3;break e}if(18>st[0]){st=7;break e}var yr=Ft(kt,At[0]+8),An=1+bt(kt,At[0]+12);if(2147483648<=An*(kt=1+bt(kt,At[0]+15))){st=3;break e}Ir!=null&&(Ir[0]=yr),$t!=null&&($t[0]=An),Lt!=null&&(Lt[0]=kt),At[0]+=18,st[0]-=18,Er[0]=1}st=0}}if(ot=ot[0],nt=nt[0],st!=0)return st;if(At=!!(2&nt),!wt&&ot)return 3;if(fe!=null&&(fe[0]=!!(16&nt)),ge!=null&&(ge[0]=At),Se!=null&&(Se[0]=0),ge=Re[0],nt=Ke[0],ot&&At&&Ne==null){st=0;break}if(4>P){st=7;break}if(wt&&ot||!wt&&!ot&&!r(C,_[0],"ALPH")){P=[P],Ze.na=[Ze.na],Ze.P=[Ze.P],Ze.Sa=[Ze.Sa];e:{yr=C,st=_,wt=P;var Er=Ze.gb;$t=Ze.na,Lt=Ze.P,Ir=Ze.Sa,An=22,t(yr!=null),t(wt!=null),kt=st[0];var Pn=wt[0];for(t($t!=null),t(Ir!=null),$t[0]=null,Lt[0]=null,Ir[0]=0;;){if(st[0]=kt,wt[0]=Pn,8>Pn){st=7;break e}var za=Ft(yr,kt+4);if(4294967286<za){st=3;break e}var En=8+za+1&-2;if(An+=En,0<Er&&An>Er){st=3;break e}if(!r(yr,kt,"VP8 ")||!r(yr,kt,"VP8L")){st=0;break e}if(Pn[0]<En){st=7;break e}r(yr,kt,"ALPH")||($t[0]=yr,Lt[0]=kt+8,Ir[0]=za),kt+=En,Pn-=En}}if(P=P[0],Ze.na=Ze.na[0],Ze.P=Ze.P[0],Ze.Sa=Ze.Sa[0],st!=0)break}P=[P],Ze.Ja=[Ze.Ja],Ze.xa=[Ze.xa];e:if(Er=C,st=_,wt=P,$t=Ze.gb[0],Lt=Ze.Ja,Ir=Ze.xa,yr=st[0],kt=!r(Er,yr,"VP8 "),An=!r(Er,yr,"VP8L"),t(Er!=null),t(wt!=null),t(Lt!=null),t(Ir!=null),8>wt[0])st=7;else{if(kt||An){if(Er=Ft(Er,yr+4),12<=$t&&Er>$t-12){st=3;break e}if(Fe&&Er>wt[0]-8){st=7;break e}Lt[0]=Er,st[0]+=8,wt[0]-=8,Ir[0]=An}else Ir[0]=5<=wt[0]&&Er[yr+0]==47&&!(Er[yr+4]>>5),Lt[0]=wt[0];st=0}if(P=P[0],Ze.Ja=Ze.Ja[0],Ze.xa=Ze.xa[0],_=_[0],st!=0)break;if(4294967286<Ze.Ja)return 3;if(Se==null||At||(Se[0]=Ze.xa?2:1),ge=[ge],nt=[nt],Ze.xa){if(5>P){st=7;break}Se=ge,Fe=nt,At=fe,C==null||5>P?C=0:5<=P&&C[_+0]==47&&!(C[_+4]>>5)?(wt=[0],Er=[0],$t=[0],_e(Lt=new ae,C,_,P),wo(Lt,wt,Er,$t)?(Se!=null&&(Se[0]=wt[0]),Fe!=null&&(Fe[0]=Er[0]),At!=null&&(At[0]=$t[0]),C=1):C=0):C=0}else{if(10>P){st=7;break}Se=nt,C==null||10>P||!ln(C,_+3,P-3)?C=0:(Fe=C[_+0]|C[_+1]<<8|C[_+2]<<16,At=16383&(C[_+7]<<8|C[_+6]),C=16383&(C[_+9]<<8|C[_+8]),1&Fe||3<(Fe>>1&7)||!(Fe>>4&1)||Fe>>5>=Ze.Ja||!At||!C?C=0:(ge&&(ge[0]=At),Se&&(Se[0]=C),C=1))}if(!C||(ge=ge[0],nt=nt[0],ot&&(Re[0]!=ge||Ke[0]!=nt)))return 3;Ne!=null&&(Ne[0]=Ze,Ne.offset=_-Ne.w,t(4294967286>_-Ne.w),t(Ne.offset==Ne.ha-P));break}return st==0||st==7&&ot&&Ne==null?(fe!=null&&(fe[0]|=Ze.na!=null&&0<Ze.na.length),Y!=null&&(Y[0]=ge),oe!=null&&(oe[0]=nt),0):st}function pc(C,_,P){var Y=_.width,oe=_.height,fe=0,ge=0,Se=Y,Ne=oe;if(_.Da=C!=null&&0<C.Da,_.Da&&(Se=C.cd,Ne=C.bd,fe=C.v,ge=C.j,11>P||(fe&=-2,ge&=-2),0>fe||0>ge||0>=Se||0>=Ne||fe+Se>Y||ge+Ne>oe))return 0;if(_.v=fe,_.j=ge,_.va=fe+Se,_.o=ge+Ne,_.U=Se,_.T=Ne,_.da=C!=null&&0<C.da,_.da){if(!Vr(Se,Ne,P=[C.ib],fe=[C.hb]))return 0;_.ib=P[0],_.hb=fe[0]}return _.ob=C!=null&&C.ob,_.Kb=C==null||!C.Sd,_.da&&(_.ob=_.ib<3*Y/4&&_.hb<3*oe/4,_.Kb=0),1}function io(C){if(C==null)return 2;if(11>C.S){var _=C.f.RGBA;_.fb+=(C.height-1)*_.A,_.A=-_.A}else _=C.f.kb,C=C.height,_.O+=(C-1)*_.fa,_.fa=-_.fa,_.N+=(C-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(C-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(C-1)*_.lb,_.lb=-_.lb);return 0}function oi(C,_,P,Y){if(Y==null||0>=C||0>=_)return 2;if(P!=null){if(P.Da){var oe=P.cd,fe=P.bd,ge=-2&P.v,Se=-2&P.j;if(0>ge||0>Se||0>=oe||0>=fe||ge+oe>C||Se+fe>_)return 2;C=oe,_=fe}if(P.da){if(!Vr(C,_,oe=[P.ib],fe=[P.hb]))return 2;C=oe[0],_=fe[0]}}Y.width=C,Y.height=_;e:{var Ne=Y.width,Re=Y.height;if(C=Y.S,0>=Ne||0>=Re||!(C>=Bh&&13>C))C=2;else{if(0>=Y.Rd&&Y.sd==null){ge=fe=oe=_=0;var Ke=(Se=Ne*Vh[C])*Re;if(11>C||(fe=(Re+1)/2*(_=(Ne+1)/2),C==12&&(ge=(oe=Ne)*Re)),(Re=e(Ke+2*fe+ge))==null){C=1;break e}Y.sd=Re,11>C?((Ne=Y.f.RGBA).eb=Re,Ne.fb=0,Ne.A=Se,Ne.size=Ke):((Ne=Y.f.kb).y=Re,Ne.O=0,Ne.fa=Se,Ne.Fd=Ke,Ne.f=Re,Ne.N=0+Ke,Ne.Ab=_,Ne.Cd=fe,Ne.ea=Re,Ne.W=0+Ke+fe,Ne.Db=_,Ne.Ed=fe,C==12&&(Ne.F=Re,Ne.J=0+Ke+2*fe),Ne.Tc=ge,Ne.lb=oe)}if(_=1,oe=Y.S,fe=Y.width,ge=Y.height,oe>=Bh&&13>oe)if(11>oe)C=Y.f.RGBA,_&=(Se=Math.abs(C.A))*(ge-1)+fe<=C.size,_&=Se>=fe*Vh[oe],_&=C.eb!=null;else{C=Y.f.kb,Se=(fe+1)/2,Ke=(ge+1)/2,Ne=Math.abs(C.fa),Re=Math.abs(C.Ab);var ot=Math.abs(C.Db),Fe=Math.abs(C.lb),Ze=Fe*(ge-1)+fe;_&=Ne*(ge-1)+fe<=C.Fd,_&=Re*(Ke-1)+Se<=C.Cd,_=(_&=ot*(Ke-1)+Se<=C.Ed)&Ne>=fe&Re>=Se&ot>=Se,_&=C.y!=null,_&=C.f!=null,_&=C.ea!=null,oe==12&&(_&=Fe>=fe,_&=Ze<=C.Tc,_&=C.F!=null)}else _=0;C=_?0:2}}return C!=0||P!=null&&P.fd&&(C=io(Y)),C}var mc=64,ri=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Qa=24,Xa=32,Oa=8,xl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Qe("Predictor0","PredictorAdd0"),de.Predictor0=function(){return 4278190080},de.Predictor1=function(C){return C},de.Predictor2=function(C,_,P){return _[P+0]},de.Predictor3=function(C,_,P){return _[P+1]},de.Predictor4=function(C,_,P){return _[P-1]},de.Predictor5=function(C,_,P){return Ct(Ct(C,_[P+1]),_[P+0])},de.Predictor6=function(C,_,P){return Ct(C,_[P-1])},de.Predictor7=function(C,_,P){return Ct(C,_[P+0])},de.Predictor8=function(C,_,P){return Ct(_[P-1],_[P+0])},de.Predictor9=function(C,_,P){return Ct(_[P+0],_[P+1])},de.Predictor10=function(C,_,P){return Ct(Ct(C,_[P-1]),Ct(_[P+0],_[P+1]))},de.Predictor11=function(C,_,P){var Y=_[P+0];return 0>=ur(Y>>24&255,C>>24&255,(_=_[P-1])>>24&255)+ur(Y>>16&255,C>>16&255,_>>16&255)+ur(Y>>8&255,C>>8&255,_>>8&255)+ur(255&Y,255&C,255&_)?Y:C},de.Predictor12=function(C,_,P){var Y=_[P+0];return(er((C>>24&255)+(Y>>24&255)-((_=_[P-1])>>24&255))<<24|er((C>>16&255)+(Y>>16&255)-(_>>16&255))<<16|er((C>>8&255)+(Y>>8&255)-(_>>8&255))<<8|er((255&C)+(255&Y)-(255&_)))>>>0},de.Predictor13=function(C,_,P){var Y=_[P-1];return(nr((C=Ct(C,_[P+0]))>>24&255,Y>>24&255)<<24|nr(C>>16&255,Y>>16&255)<<16|nr(C>>8&255,Y>>8&255)<<8|nr(255&C,255&Y))>>>0};var oh=de.PredictorAdd0;de.PredictorAdd1=Sr,Qe("Predictor2","PredictorAdd2"),Qe("Predictor3","PredictorAdd3"),Qe("Predictor4","PredictorAdd4"),Qe("Predictor5","PredictorAdd5"),Qe("Predictor6","PredictorAdd6"),Qe("Predictor7","PredictorAdd7"),Qe("Predictor8","PredictorAdd8"),Qe("Predictor9","PredictorAdd9"),Qe("Predictor10","PredictorAdd10"),Qe("Predictor11","PredictorAdd11"),Qe("Predictor12","PredictorAdd12"),Qe("Predictor13","PredictorAdd13");var lh=de.PredictorAdd2;Ar("ColorIndexInverseTransform","MapARGB","32b",function(C){return C>>8&255},function(C){return C}),Ar("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(C){return C},function(C){return C>>8&255});var ca,zl=de.ColorIndexInverseTransform,Bi=de.MapARGB,Hi=de.VP8LColorIndexInverseTransformAlpha,Ai=de.MapAlpha,$l=de.VP8LPredictorsAdd=[];$l.length=16,(de.VP8LPredictors=[]).length=16,(de.VP8LPredictorsAdd_C=[]).length=16,(de.VP8LPredictors_C=[]).length=16;var Kc,gc,yc,wl,Xo,vc,oo,ql,Ts,Ci,Sn,Un,Ca,Es,Zo,us,Yc,ch,If,_d,Id,Df,Ff,vu,Zi,No,bu,zi,bc=e(511),Uh=e(2041),Cn=e(225),xc=e(767),Jc=0,lo=Uh,sa=Cn,$i=xc,li=bc,Bh=0,La=1,Dd=2,To=3,xu=4,wu=5,co=6,uh=7,Hh=8,Su=9,Fd=10,Eo=[2,3,7],Au=[3,3,11],wc=[280,256,256,256,40],hh=[0,1,1,1,0],dh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ko=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],_o=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Sc=8,el=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Io=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],uo=null,zh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Rd=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],$h=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Rf=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ci=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ha=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Gn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ks=[],_n=[],Za=[],Pa=1,ho=2,Gl=[],ui=[];cs("UpsampleRgbLinePair",Ul,3),cs("UpsampleBgrLinePair",Ns,3),cs("UpsampleRgbaLinePair",Ln,4),cs("UpsampleBgraLinePair",Qo,4),cs("UpsampleArgbLinePair",ja,4),cs("UpsampleRgba4444LinePair",Hl,2),cs("UpsampleRgb565LinePair",Bl,2);var Sl=de.UpsampleRgbLinePair,Ac=de.UpsampleBgrLinePair,Vl=de.UpsampleRgbaLinePair,Wl=de.UpsampleBgraLinePair,Cc=de.UpsampleArgbLinePair,Kl=de.UpsampleRgba4444LinePair,Al=de.UpsampleRgb565LinePair,Do=16,Cu=1<<Do-1,Qc=-227,Ni=482,Yl=6,Nc=0,Ks=e(256),qh=e(256),jf=e(256),bp=e(256),U0=e(Ni-Qc),qi=e(Ni-Qc);ga("YuvToRgbRow",Ul,3),ga("YuvToBgrRow",Ns,3),ga("YuvToRgbaRow",Ln,4),ga("YuvToBgraRow",Qo,4),ga("YuvToArgbRow",ja,4),ga("YuvToRgba4444Row",Hl,2),ga("YuvToRgb565Row",Bl,2);var Hs=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Tc=[0,2,8],Nu=[8,7,6,4,4,2,2,2,1,1,1,1],Gh=1;this.WebPDecodeRGBA=function(C,_,P,Y,oe){var fe=La,ge=new Et,Se=new fn;ge.ba=Se,Se.S=fe,Se.width=[Se.width],Se.height=[Se.height];var Ne=Se.width,Re=Se.height,Ke=new Wr;if(Ke==null||C==null)var ot=2;else t(Ke!=null),ot=wn(C,_,P,Ke.width,Ke.height,Ke.Pd,Ke.Qd,Ke.format,null);if(ot!=0?Ne=0:(Ne!=null&&(Ne[0]=Ke.width[0]),Re!=null&&(Re[0]=Ke.height[0]),Ne=1),Ne){Se.width=Se.width[0],Se.height=Se.height[0],Y!=null&&(Y[0]=Se.width),oe!=null&&(oe[0]=Se.height);e:{if(Y=new os,(oe=new Ut).data=C,oe.w=_,oe.ha=P,oe.kd=1,_=[0],t(oe!=null),((C=wn(oe.data,oe.w,oe.ha,null,null,null,_,null,oe))==0||C==7)&&_[0]&&(C=4),(_=C)==0){if(t(ge!=null),Y.data=oe.data,Y.w=oe.w+oe.offset,Y.ha=oe.ha-oe.offset,Y.put=Yr,Y.ac=xo,Y.bc=qo,Y.ma=ge,oe.xa){if((C=bi())==null){ge=1;break e}if((function(Fe,Ze){var nt=[0],At=[0],st=[0];t:for(;;){if(Fe==null)return 0;if(Ze==null)return Fe.a=2,0;if(Fe.l=Ze,Fe.a=0,_e(Fe.m,Ze.data,Ze.w,Ze.ha),!wo(Fe.m,nt,At,st)){Fe.a=3;break t}if(Fe.xb=ho,Ze.width=nt[0],Ze.height=At[0],!ml(nt[0],At[0],1,Fe,null))break t;return 1}return t(Fe.a!=0),0})(C,Y)){if(Y=(_=oi(Y.width,Y.height,ge.Oa,ge.ba))==0){t:{Y=C;r:for(;;){if(Y==null){Y=0;break t}if(t(Y.s.yc!=null),t(Y.s.Ya!=null),t(0<Y.s.Wb),t((P=Y.l)!=null),t((oe=P.ma)!=null),Y.xb!=0){if(Y.ca=oe.ba,Y.tb=oe.tb,t(Y.ca!=null),!pc(oe.Oa,P,To)){Y.a=2;break r}if(!Oi(Y,P.width)||P.da)break r;if((P.da||on(Y.ca.S))&&Ra(),11>Y.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Y.ca.f.kb.F!=null&&Ra()),Y.Pb&&0<Y.s.ua&&Y.s.vb.X==null&&!Te(Y.s.vb,Y.s.Wa.Xa)){Y.a=1;break r}Y.xb=0}if(!jn(Y,Y.V,Y.Ba,Y.c,Y.i,P.o,ji))break r;oe.Dc=Y.Ma,Y=1;break t}t(Y.a!=0),Y=0}Y=!Y}Y&&(_=C.a)}else _=C.a}else{if((C=new yl)==null){ge=1;break e}if(C.Fa=oe.na,C.P=oe.P,C.qc=oe.Sa,Zs(C,Y)){if((_=oi(Y.width,Y.height,ge.Oa,ge.ba))==0){if(C.Aa=0,P=ge.Oa,t((oe=C)!=null),P!=null){if(0<(Ne=0>(Ne=P.Md)?0:100<Ne?255:255*Ne/100)){for(Re=Ke=0;4>Re;++Re)12>(ot=oe.pb[Re]).lc&&(ot.ia=Ne*Nu[0>ot.lc?0:ot.lc]>>3),Ke|=ot.ia;Ke&&(alert("todo:VP8InitRandom"),oe.ia=1)}oe.Ga=P.Id,100<oe.Ga?oe.Ga=100:0>oe.Ga&&(oe.Ga=0)}(function(Fe,Ze){if(Fe==null)return 0;if(Ze==null)return ma(Fe,2,"NULL VP8Io parameter in VP8Decode().");if(!Fe.cb&&!Zs(Fe,Ze))return 0;if(t(Fe.cb),Ze.ac==null||Ze.ac(Ze)){Ze.ob&&(Fe.L=0);var nt=Tc[Fe.L];if(Fe.L==2?(Fe.yb=0,Fe.zb=0):(Fe.yb=Ze.v-nt>>4,Fe.zb=Ze.j-nt>>4,0>Fe.yb&&(Fe.yb=0),0>Fe.zb&&(Fe.zb=0)),Fe.Va=Ze.o+15+nt>>4,Fe.Hb=Ze.va+15+nt>>4,Fe.Hb>Fe.za&&(Fe.Hb=Fe.za),Fe.Va>Fe.Ub&&(Fe.Va=Fe.Ub),0<Fe.L){var At=Fe.ed;for(nt=0;4>nt;++nt){var st;if(Fe.Qa.Cb){var wt=Fe.Qa.Lb[nt];Fe.Qa.Fb||(wt+=At.Tb)}else wt=At.Tb;for(st=0;1>=st;++st){var kt=Fe.gd[nt][st],$t=wt;if(At.Pc&&($t+=At.vd[0],st&&($t+=At.od[0])),0<($t=0>$t?0:63<$t?63:$t)){var Lt=$t;0<At.wb&&(Lt=4<At.wb?Lt>>2:Lt>>1)>9-At.wb&&(Lt=9-At.wb),1>Lt&&(Lt=1),kt.dd=Lt,kt.tc=2*$t+Lt,kt.ld=40<=$t?2:15<=$t?1:0}else kt.tc=0;kt.La=st}}}nt=0}else ma(Fe,6,"Frame setup failed"),nt=Fe.a;if(nt=nt==0){if(nt){Fe.$c=0,0<Fe.Aa||(Fe.Ic=Gh);t:{nt=Fe.Ic,At=4*(Lt=Fe.za);var Ir=32*Lt,yr=Lt+1,An=0<Fe.L?Lt*(0<Fe.Aa?2:1):0,Er=(Fe.Aa==2?2:1)*Lt;if((kt=At+832+(st=3*(16*nt+Tc[Fe.L])/2*Ir)+(wt=Fe.Fa!=null&&0<Fe.Fa.length?Fe.Kc.c*Fe.Kc.i:0))!=kt)nt=0;else{if(kt>Fe.Vb){if(Fe.Vb=0,Fe.Ec=e(kt),Fe.Fc=0,Fe.Ec==null){nt=ma(Fe,1,"no memory during frame initialization.");break t}Fe.Vb=kt}kt=Fe.Ec,$t=Fe.Fc,Fe.Ac=kt,Fe.Bc=$t,$t+=At,Fe.Gd=p(Ir,hc),Fe.Hd=0,Fe.rb=p(yr+1,Vo),Fe.sb=1,Fe.wa=An?p(An,Ya):null,Fe.Y=0,Fe.D.Nb=0,Fe.D.wa=Fe.wa,Fe.D.Y=Fe.Y,0<Fe.Aa&&(Fe.D.Y+=Lt),t(!0),Fe.oc=kt,Fe.pc=$t,$t+=832,Fe.ya=p(Er,fu),Fe.aa=0,Fe.D.ya=Fe.ya,Fe.D.aa=Fe.aa,Fe.Aa==2&&(Fe.D.aa+=Lt),Fe.R=16*Lt,Fe.B=8*Lt,Lt=(Ir=Tc[Fe.L])*Fe.R,Ir=Ir/2*Fe.B,Fe.sa=kt,Fe.ta=$t+Lt,Fe.qa=Fe.sa,Fe.ra=Fe.ta+16*nt*Fe.R+Ir,Fe.Ha=Fe.qa,Fe.Ia=Fe.ra+8*nt*Fe.B+Ir,Fe.$c=0,$t+=st,Fe.mb=wt?kt:null,Fe.nb=wt?$t:null,t($t+wt<=Fe.Fc+Fe.Vb),th(Fe),n(Fe.Ac,Fe.Bc,0,At),nt=1}}if(nt){if(Ze.ka=0,Ze.y=Fe.sa,Ze.O=Fe.ta,Ze.f=Fe.qa,Ze.N=Fe.ra,Ze.ea=Fe.Ha,Ze.Vd=Fe.Ia,Ze.fa=Fe.R,Ze.Rc=Fe.B,Ze.F=null,Ze.J=0,!Jc){for(nt=-255;255>=nt;++nt)bc[255+nt]=0>nt?-nt:nt;for(nt=-1020;1020>=nt;++nt)Uh[1020+nt]=-128>nt?-128:127<nt?127:nt;for(nt=-112;112>=nt;++nt)Cn[112+nt]=-16>nt?-16:15<nt?15:nt;for(nt=-255;510>=nt;++nt)xc[255+nt]=0>nt?0:255<nt?255:nt;Jc=1}oo=Wo,ql=aa,Ci=Pi,Sn=rh,Un=pu,Ts=Td,Ca=yu,Es=Pl,Zo=ie,us=je,Yc=fc,ch=j,If=Ge,_d=tt,Id=Rl,Df=jl,Ff=Wc,vu=ih,_n[0]=kd,_n[1]=Ed,_n[2]=Ph,_n[3]=Mh,_n[4]=Ao,_n[5]=ah,_n[6]=ii,_n[7]=vs,_n[8]=Xt,_n[9]=wi,ks[0]=ao,ks[1]=mu,ks[2]=nh,ks[3]=Lh,ks[4]=Ko,ks[5]=Xn,ks[6]=xi,Za[0]=ls,Za[1]=Ea,Za[2]=Yo,Za[3]=sh,Za[4]=wa,Za[5]=Jo,Za[6]=vl,nt=1}else nt=0}nt&&(nt=(function(Pn,za){for(Pn.M=0;Pn.M<Pn.Va;++Pn.M){var En,pr=Pn.Jc[Pn.M&Pn.Xb],sr=Pn.m,$a=Pn;for(En=0;En<$a.za;++En){var qr=sr,In=$a,ya=In.Ac,Ys=In.Bc+4*En,hi=In.zc,Ma=In.ya[In.aa+En];if(In.Qa.Bb?Ma.$b=Ve(qr,In.Pa.jb[0])?2+Ve(qr,In.Pa.jb[2]):Ve(qr,In.Pa.jb[1]):Ma.$b=0,In.kc&&(Ma.Ad=Ve(qr,In.Bd)),Ma.Za=!Ve(qr,145)+0,Ma.Za){var _s=Ma.Ob,Ti=0;for(In=0;4>In;++In){var Is,Dn=hi[0+In];for(Is=0;4>Is;++Is){Dn=ci[ya[Ys+Is]][Dn];for(var Hn=$h[Ve(qr,Dn[0])];0<Hn;)Hn=$h[2*Hn+Ve(qr,Dn[Hn])];Dn=-Hn,ya[Ys+Is]=Dn}a(_s,Ti,ya,Ys,4),Ti+=4,hi[0+In]=Dn}}else Dn=Ve(qr,156)?Ve(qr,128)?1:3:Ve(qr,163)?2:0,Ma.Ob[0]=Dn,n(ya,Ys,Dn,4),n(hi,0,Dn,4);Ma.Dd=Ve(qr,142)?Ve(qr,114)?Ve(qr,183)?1:3:2:0}if($a.m.Ka)return ma(Pn,7,"Premature end-of-partition0 encountered.");for(;Pn.ja<Pn.za;++Pn.ja){if($a=pr,qr=(sr=Pn).rb[sr.sb-1],ya=sr.rb[sr.sb+sr.ja],En=sr.ya[sr.aa+sr.ja],Ys=sr.kc?En.Ad:0)qr.la=ya.la=0,En.Za||(qr.Na=ya.Na=0),En.Hc=0,En.Gc=0,En.ia=0;else{var hs,ua;if(qr=ya,ya=$a,Ys=sr.Pa.Xc,hi=sr.ya[sr.aa+sr.ja],Ma=sr.pb[hi.$b],In=hi.ad,_s=0,Ti=sr.rb[sr.sb-1],Dn=Is=0,n(In,_s,0,384),hi.Za)var ni=0,ws=Ys[3];else{Hn=e(16);var ia=qr.Na+Ti.Na;if(ia=uo(ya,Ys[1],ia,Ma.Eb,0,Hn,0),qr.Na=Ti.Na=(0<ia)+0,1<ia)oo(Hn,0,In,_s);else{var ds=Hn[0]+3>>3;for(Hn=0;256>Hn;Hn+=16)In[_s+Hn]=ds}ni=1,ws=Ys[0]}var va=15&qr.la,Ds=15&Ti.la;for(Hn=0;4>Hn;++Hn){var zs=1&Ds;for(ds=ua=0;4>ds;++ds)va=va>>1|(zs=(ia=uo(ya,ws,ia=zs+(1&va),Ma.Sc,ni,In,_s))>ni)<<7,ua=ua<<2|(3<ia?3:1<ia?2:In[_s+0]!=0),_s+=16;va>>=4,Ds=Ds>>1|zs<<7,Is=(Is<<8|ua)>>>0}for(ws=va,ni=Ds>>4,hs=0;4>hs;hs+=2){for(ua=0,va=qr.la>>4+hs,Ds=Ti.la>>4+hs,Hn=0;2>Hn;++Hn){for(zs=1&Ds,ds=0;2>ds;++ds)ia=zs+(1&va),va=va>>1|(zs=0<(ia=uo(ya,Ys[2],ia,Ma.Qc,0,In,_s)))<<3,ua=ua<<2|(3<ia?3:1<ia?2:In[_s+0]!=0),_s+=16;va>>=2,Ds=Ds>>1|zs<<5}Dn|=ua<<4*hs,ws|=va<<4<<hs,ni|=(240&Ds)<<hs}qr.la=ws,Ti.la=ni,hi.Hc=Is,hi.Gc=Dn,hi.ia=43690&Dn?0:Ma.ia,Ys=!(Is|Dn)}if(0<sr.L&&(sr.wa[sr.Y+sr.ja]=sr.gd[En.$b][En.Za],sr.wa[sr.Y+sr.ja].La|=!Ys),$a.Ka)return ma(Pn,7,"Premature end-of-file encountered.")}if(th(Pn),sr=za,$a=1,En=(pr=Pn).D,qr=0<pr.L&&pr.M>=pr.zb&&pr.M<=pr.Va,pr.Aa==0)t:{if(En.M=pr.M,En.uc=qr,rn(pr,En),$a=1,En=(ua=pr.D).Nb,qr=(Dn=Tc[pr.L])*pr.R,ya=Dn/2*pr.B,Hn=16*En*pr.R,ds=8*En*pr.B,Ys=pr.sa,hi=pr.ta-qr+Hn,Ma=pr.qa,In=pr.ra-ya+ds,_s=pr.Ha,Ti=pr.Ia-ya+ds,Ds=(va=ua.M)==0,Is=va>=pr.Va-1,pr.Aa==2&&rn(pr,ua),ua.uc)for(zs=(ia=pr).D.M,t(ia.D.uc),ua=ia.yb;ua<ia.Hb;++ua){ni=ua,ws=zs;var oa=(Zn=($s=ia).D).Nb;hs=$s.R;var Zn=Zn.wa[Zn.Y+ni],di=$s.sa,es=$s.ta+16*oa*hs+16*ni,Zr=Zn.dd,Kr=Zn.tc;if(Kr!=0)if(t(3<=Kr),$s.L==1)0<ni&&Df(di,es,hs,Kr+4),Zn.La&&vu(di,es,hs,Kr),0<ws&&Id(di,es,hs,Kr+4),Zn.La&&Ff(di,es,hs,Kr);else{var Vn=$s.B,eo=$s.qa,Fo=$s.ra+8*oa*Vn+8*ni,Gi=$s.Ha,$s=$s.Ia+8*oa*Vn+8*ni;oa=Zn.ld,0<ni&&(Es(di,es,hs,Kr+4,Zr,oa),us(eo,Fo,Gi,$s,Vn,Kr+4,Zr,oa)),Zn.La&&(ch(di,es,hs,Kr,Zr,oa),_d(eo,Fo,Gi,$s,Vn,Kr,Zr,oa)),0<ws&&(Ca(di,es,hs,Kr+4,Zr,oa),Zo(eo,Fo,Gi,$s,Vn,Kr+4,Zr,oa)),Zn.La&&(Yc(di,es,hs,Kr,Zr,oa),If(eo,Fo,Gi,$s,Vn,Kr,Zr,oa))}}if(pr.ia&&alert("todo:DitherRow"),sr.put!=null){if(ua=16*va,va=16*(va+1),Ds?(sr.y=pr.sa,sr.O=pr.ta+Hn,sr.f=pr.qa,sr.N=pr.ra+ds,sr.ea=pr.Ha,sr.W=pr.Ia+ds):(ua-=Dn,sr.y=Ys,sr.O=hi,sr.f=Ma,sr.N=In,sr.ea=_s,sr.W=Ti),Is||(va-=Dn),va>sr.o&&(va=sr.o),sr.F=null,sr.J=null,pr.Fa!=null&&0<pr.Fa.length&&ua<va&&(sr.J=Ba(pr,sr,ua,va-ua),sr.F=pr.mb,sr.F==null&&sr.F.length==0)){$a=ma(pr,3,"Could not decode alpha data.");break t}ua<sr.j&&(Dn=sr.j-ua,ua=sr.j,t(!(1&Dn)),sr.O+=pr.R*Dn,sr.N+=pr.B*(Dn>>1),sr.W+=pr.B*(Dn>>1),sr.F!=null&&(sr.J+=sr.width*Dn)),ua<va&&(sr.O+=sr.v,sr.N+=sr.v>>1,sr.W+=sr.v>>1,sr.F!=null&&(sr.J+=sr.v),sr.ka=ua-sr.j,sr.U=sr.va-sr.v,sr.T=va-ua,$a=sr.put(sr))}En+1!=pr.Ic||Is||(a(pr.sa,pr.ta-qr,Ys,hi+16*pr.R,qr),a(pr.qa,pr.ra-ya,Ma,In+8*pr.B,ya),a(pr.Ha,pr.Ia-ya,_s,Ti+8*pr.B,ya))}if(!$a)return ma(Pn,6,"Output aborted.")}return 1})(Fe,Ze)),Ze.bc!=null&&Ze.bc(Ze),nt&=1}return nt?(Fe.cb=0,nt):0})(C,Y)||(_=C.a)}}else _=C.a}_==0&&ge.Oa!=null&&ge.Oa.fd&&(_=io(ge.ba))}ge=_}fe=ge!=0?null:11>fe?Se.f.RGBA.eb:Se.f.kb.y}else fe=null;return fe};var Vh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function w(de,Oe){for(var z="",K=0;K<4;K++)z+=String.fromCharCode(de[Oe++]);return z}function A(de,Oe){return de[Oe+0]|de[Oe+1]<<8}function I(de,Oe){return(de[Oe+0]|de[Oe+1]<<8|de[Oe+2]<<16)>>>0}function R(de,Oe){return(de[Oe+0]|de[Oe+1]<<8|de[Oe+2]<<16|de[Oe+3]<<24)>>>0}new y;var k=[0],M=[0],V=[],q=new y,U=i,te=(function(de,Oe){var z={},K=0,Ae=!1,Ce=0,Be=0;if(z.frames=[],!(function(H,ae){for(var Z=0;Z<4;Z++)if(H[ae+Z]!="RIFF".charCodeAt(Z))return!0;return!1})(de,Oe)){for(R(de,Oe+=4),Oe+=8;Oe<de.length;){var Ee=w(de,Oe),Pe=R(de,Oe+=4);Oe+=4;var Ue=Pe+(1&Pe);switch(Ee){case"VP8 ":case"VP8L":z.frames[K]===void 0&&(z.frames[K]={}),(X=z.frames[K]).src_off=Ae?Be:Oe-8,X.src_size=Ce+Pe+8,K++,Ae&&(Ae=!1,Ce=0,Be=0);break;case"VP8X":(X=z.header={}).feature_flags=de[Oe];var _e=Oe+4;X.canvas_width=1+I(de,_e),_e+=3,X.canvas_height=1+I(de,_e),_e+=3;break;case"ALPH":Ae=!0,Ce=Ue+8,Be=Oe-8;break;case"ANIM":(X=z.header).bgcolor=R(de,Oe),_e=Oe+4,X.loop_count=A(de,_e),_e+=2;break;case"ANMF":var Le,X;(X=z.frames[K]={}).offset_x=2*I(de,Oe),Oe+=3,X.offset_y=2*I(de,Oe),Oe+=3,X.width=1+I(de,Oe),Oe+=3,X.height=1+I(de,Oe),Oe+=3,X.duration=I(de,Oe),Oe+=3,Le=de[Oe++],X.dispose=1&Le,X.blend=Le>>1&1}Ee!="ANMF"&&(Oe+=Ue)}return z}})(U,0);te.response=U,te.rgbaoutput=!0,te.dataurl=!1;var W=te.header?te.header:null,re=te.frames?te.frames:null;if(W){W.loop_counter=W.loop_count,k=[W.canvas_height],M=[W.canvas_width];for(var xe=0;xe<re.length&&re[xe].blend!=0;xe++);}var ve=re[0],De=q.WebPDecodeRGBA(U,ve.src_off,ve.src_size,M,k);ve.rgba=De,ve.imgwidth=M[0],ve.imgheight=k[0];for(var ke=0;ke<M[0]*k[0]*4;ke++)V[ke]=De[ke];return this.width=M,this.height=k,this.data=V,this}(function(i){var t,r,a,n,e,p,m,y,w,A=function(H){return H=H||{},this.isStrokeTransparent=H.isStrokeTransparent||!1,this.strokeOpacity=H.strokeOpacity||1,this.strokeStyle=H.strokeStyle||"#000000",this.fillStyle=H.fillStyle||"#000000",this.isFillTransparent=H.isFillTransparent||!1,this.fillOpacity=H.fillOpacity||1,this.font=H.font||"10px sans-serif",this.textBaseline=H.textBaseline||"alphabetic",this.textAlign=H.textAlign||"left",this.lineWidth=H.lineWidth||1,this.lineJoin=H.lineJoin||"miter",this.lineCap=H.lineCap||"butt",this.path=H.path||[],this.transform=H.transform!==void 0?H.transform.clone():new y,this.globalCompositeOperation=H.globalCompositeOperation||"normal",this.globalAlpha=H.globalAlpha||1,this.clip_path=H.clip_path||[],this.currentPoint=H.currentPoint||new p,this.miterLimit=H.miterLimit||10,this.lastPoint=H.lastPoint||new p,this.lineDashOffset=H.lineDashOffset||0,this.lineDash=H.lineDash||[],this.margin=H.margin||[0,0,0,0],this.prevPageLastElemOffset=H.prevPageLastElemOffset||0,this.ignoreClearRect=typeof H.ignoreClearRect!="boolean"||H.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new I(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,e=this.internal.getVerticalCoordinate,p=this.internal.Point,m=this.internal.Rectangle,y=this.internal.Matrix,w=new A}]);var I=function(H){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ae=H;Object.defineProperty(this,"pdf",{get:function(){return ae}});var Z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Z},set:function(Te){Z=!!Te}});var se=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return se},set:function(Te){se=!!Te}});var ye=0;Object.defineProperty(this,"posX",{get:function(){return ye},set:function(Te){isNaN(Te)||(ye=Te)}});var ce=0;Object.defineProperty(this,"posY",{get:function(){return ce},set:function(Te){isNaN(Te)||(ce=Te)}}),Object.defineProperty(this,"margin",{get:function(){return w.margin},set:function(Te){var Ht;typeof Te=="number"?Ht=[Te,Te,Te,Te]:((Ht=new Array(4))[0]=Te[0],Ht[1]=Te.length>=2?Te[1]:Ht[0],Ht[2]=Te.length>=3?Te[2]:Ht[0],Ht[3]=Te.length>=4?Te[3]:Ht[1]),w.margin=Ht}});var ze=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ze},set:function(Te){ze=Te}});var pe=0;Object.defineProperty(this,"lastBreak",{get:function(){return pe},set:function(Te){pe=Te}});var Ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ve},set:function(Te){Ve=Te}}),Object.defineProperty(this,"ctx",{get:function(){return w},set:function(Te){Te instanceof A&&(w=Te)}}),Object.defineProperty(this,"path",{get:function(){return w.path},set:function(Te){w.path=Te}});var yt=[];Object.defineProperty(this,"ctxStack",{get:function(){return yt},set:function(Te){yt=Te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Te){var Ht;Ht=R(Te),this.ctx.fillStyle=Ht.style,this.ctx.isFillTransparent=Ht.a===0,this.ctx.fillOpacity=Ht.a,this.pdf.setFillColor(Ht.r,Ht.g,Ht.b,{a:Ht.a}),this.pdf.setTextColor(Ht.r,Ht.g,Ht.b,{a:Ht.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Te){var Ht=R(Te);this.ctx.strokeStyle=Ht.style,this.ctx.isStrokeTransparent=Ht.a===0,this.ctx.strokeOpacity=Ht.a,Ht.a===0?this.pdf.setDrawColor(255,255,255):(Ht.a,this.pdf.setDrawColor(Ht.r,Ht.g,Ht.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Te){["butt","round","square"].indexOf(Te)!==-1&&(this.ctx.lineCap=Te,this.pdf.setLineCap(Te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Te){isNaN(Te)||(this.ctx.lineWidth=Te,this.pdf.setLineWidth(Te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Te){["bevel","round","miter"].indexOf(Te)!==-1&&(this.ctx.lineJoin=Te,this.pdf.setLineJoin(Te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Te){isNaN(Te)||(this.ctx.miterLimit=Te,this.pdf.setMiterLimit(Te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Te){this.ctx.textBaseline=Te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Te){["right","end","center","left","start"].indexOf(Te)!==-1&&(this.ctx.textAlign=Te)}});var vt=null,bt=null,Ft=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ft},set:function(Te){vt=null,bt=null,Ft=Te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Te){var Ht;if(this.ctx.font=Te,(Ht=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Te))!==null){var Or=Ht[1];Ht[2];var Vr=Ht[3],Mt=Ht[4];Ht[5];var zr=Ht[6],Qe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Mt)[2];Mt=Math.floor(Qe==="px"?parseFloat(Mt)*this.pdf.internal.scaleFactor:Qe==="em"?parseFloat(Mt)*this.pdf.getFontSize():parseFloat(Mt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Mt);var Rt=(function(Ar){var ra,Nn,Qr=[],xr=Ar.trim();if(xr==="")return L5;if(xr in M3)return[M3[xr]];for(;xr!=="";){switch(Nn=null,ra=(xr=B3(xr)).charAt(0)){case'"':case"'":Nn=rF(xr.substring(1),ra);break;default:Nn=nF(xr)}if(Nn===null||(Qr.push(Nn[0]),(xr=B3(Nn[1]))!==""&&xr.charAt(0)!==","))return L5;xr=xr.replace(/^,/,"")}return Qr})(zr);if(this.fontFaces){var Ct=(function(Ar,ra){var Nn=Ar.getFontList(),Qr=JSON.stringify(Nn);if(vt===null||bt!==Qr){var xr=(function(an){var Lr=[];return Object.keys(an).forEach(function(Jn){an[Jn].forEach(function(on){var gn=null;switch(on){case"bold":gn={family:Jn,weight:"bold"};break;case"italic":gn={family:Jn,style:"italic"};break;case"bolditalic":gn={family:Jn,weight:"bold",style:"italic"};break;case"":case"normal":gn={family:Jn}}gn!==null&&(gn.ref={name:Jn,style:on},Lr.push(gn))})}),Lr})(Nn);vt=(function(an){for(var Lr={},Jn=0;Jn<an.length;++Jn){var on=O5(an[Jn]),gn=on.family,xa=on.stretch,fn=on.style,Wr=on.weight;Lr[gn]=Lr[gn]||{},Lr[gn][xa]=Lr[gn][xa]||{},Lr[gn][xa][fn]=Lr[gn][xa][fn]||{},Lr[gn][xa][fn][Wr]=on}return Lr})(xr.concat(ra)),bt=Qr}return vt})(this.pdf,this.fontFaces),er=Rt.map(function(Ar){return{family:Ar,stretch:"normal",weight:Vr,style:Or}}),nr=(function(Ar,ra,Nn){for(var Qr=(Nn=Nn||{}).defaultFontFamily||"times",xr=Object.assign({},tF,Nn.genericFontFamilies||{}),an=null,Lr=null,Jn=0;Jn<ra.length;++Jn)if(xr[(an=O5(ra[Jn])).family]&&(an.family=xr[an.family]),Ar.hasOwnProperty(an.family)){Lr=Ar[an.family];break}if(!(Lr=Lr||Ar[Qr]))throw new Error("Could not find a font-family for the rule '"+U3(an)+"' and default family '"+Qr+"'.");if(Lr=(function(on,gn){if(gn[on])return gn[on];var xa=Ov[on],fn=xa<=Ov.normal?-1:1,Wr=P3(gn,nA,xa,fn);if(!Wr)throw new Error("Could not find a matching font-stretch value for "+on);return Wr})(an.stretch,Lr),Lr=(function(on,gn){if(gn[on])return gn[on];for(var xa=rA[on],fn=0;fn<xa.length;++fn)if(gn[xa[fn]])return gn[xa[fn]];throw new Error("Could not find a matching font-style for "+on)})(an.style,Lr),!(Lr=(function(on,gn){if(gn[on])return gn[on];if(on===400&&gn[500])return gn[500];if(on===500&&gn[400])return gn[400];var xa=eF[on],fn=P3(gn,aA,xa,on<400?-1:1);if(!fn)throw new Error("Could not find a matching font-weight for value "+on);return fn})(an.weight,Lr)))throw new Error("Failed to resolve a font for the rule '"+U3(an)+"'.");return Lr})(Ct,er);this.pdf.setFont(nr.ref.name,nr.ref.style)}else{var ur="";(Vr==="bold"||parseInt(Vr,10)>=700||Or==="bold")&&(ur="bold"),Or==="italic"&&(ur+="italic"),ur.length===0&&(ur="normal");for(var Sr="",kr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ar=0;ar<Rt.length;ar++){if(this.pdf.internal.getFont(Rt[ar],ur,{noFallback:!0,disableWarning:!0})!==void 0){Sr=Rt[ar];break}if(ur==="bolditalic"&&this.pdf.internal.getFont(Rt[ar],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Sr=Rt[ar],ur="bold";else if(this.pdf.internal.getFont(Rt[ar],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Sr=Rt[ar],ur="normal";break}}if(Sr===""){for(var _r=0;_r<Rt.length;_r++)if(kr[Rt[_r]]){Sr=kr[Rt[_r]];break}}Sr=Sr===""?"Times":Sr,this.pdf.setFont(Sr,ur)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Te){this.ctx.globalCompositeOperation=Te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Te){this.ctx.globalAlpha=Te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Te){this.ctx.lineDashOffset=Te,X.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Te){this.ctx.lineDash=Te,X.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Te){this.ctx.ignoreClearRect=!!Te}})};I.prototype.setLineDash=function(H){this.lineDash=H},I.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},I.prototype.fill=function(){re.call(this,"fill",!1)},I.prototype.stroke=function(){re.call(this,"stroke",!1)},I.prototype.beginPath=function(){this.path=[{type:"begin"}]},I.prototype.moveTo=function(H,ae){if(isNaN(H)||isNaN(ae))throw As.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Z=this.ctx.transform.applyToPoint(new p(H,ae));this.path.push({type:"mt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new p(H,ae)},I.prototype.closePath=function(){var H=new p(0,0),ae=0;for(ae=this.path.length-1;ae!==-1;ae--)if(this.path[ae].type==="begin"&&ns(this.path[ae+1])==="object"&&typeof this.path[ae+1].x=="number"){H=new p(this.path[ae+1].x,this.path[ae+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new p(H.x,H.y)},I.prototype.lineTo=function(H,ae){if(isNaN(H)||isNaN(ae))throw As.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Z=this.ctx.transform.applyToPoint(new p(H,ae));this.path.push({type:"lt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new p(Z.x,Z.y)},I.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),re.call(this,null,!0)},I.prototype.quadraticCurveTo=function(H,ae,Z,se){if(isNaN(Z)||isNaN(se)||isNaN(H)||isNaN(ae))throw As.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ye=this.ctx.transform.applyToPoint(new p(Z,se)),ce=this.ctx.transform.applyToPoint(new p(H,ae));this.path.push({type:"qct",x1:ce.x,y1:ce.y,x:ye.x,y:ye.y}),this.ctx.lastPoint=new p(ye.x,ye.y)},I.prototype.bezierCurveTo=function(H,ae,Z,se,ye,ce){if(isNaN(ye)||isNaN(ce)||isNaN(H)||isNaN(ae)||isNaN(Z)||isNaN(se))throw As.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ze=this.ctx.transform.applyToPoint(new p(ye,ce)),pe=this.ctx.transform.applyToPoint(new p(H,ae)),Ve=this.ctx.transform.applyToPoint(new p(Z,se));this.path.push({type:"bct",x1:pe.x,y1:pe.y,x2:Ve.x,y2:Ve.y,x:ze.x,y:ze.y}),this.ctx.lastPoint=new p(ze.x,ze.y)},I.prototype.arc=function(H,ae,Z,se,ye,ce){if(isNaN(H)||isNaN(ae)||isNaN(Z)||isNaN(se)||isNaN(ye))throw As.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ce=!!ce,!this.ctx.transform.isIdentity){var ze=this.ctx.transform.applyToPoint(new p(H,ae));H=ze.x,ae=ze.y;var pe=this.ctx.transform.applyToPoint(new p(0,Z)),Ve=this.ctx.transform.applyToPoint(new p(0,0));Z=Math.sqrt(Math.pow(pe.x-Ve.x,2)+Math.pow(pe.y-Ve.y,2))}Math.abs(ye-se)>=2*Math.PI&&(se=0,ye=2*Math.PI),this.path.push({type:"arc",x:H,y:ae,radius:Z,startAngle:se,endAngle:ye,counterclockwise:ce})},I.prototype.arcTo=function(H,ae,Z,se,ye){throw new Error("arcTo not implemented.")},I.prototype.rect=function(H,ae,Z,se){if(isNaN(H)||isNaN(ae)||isNaN(Z)||isNaN(se))throw As.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(H,ae),this.lineTo(H+Z,ae),this.lineTo(H+Z,ae+se),this.lineTo(H,ae+se),this.lineTo(H,ae),this.lineTo(H+Z,ae),this.lineTo(H,ae)},I.prototype.fillRect=function(H,ae,Z,se){if(isNaN(H)||isNaN(ae)||isNaN(Z)||isNaN(se))throw As.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!k.call(this)){var ye={};this.lineCap!=="butt"&&(ye.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ye.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(H,ae,Z,se),this.fill(),ye.hasOwnProperty("lineCap")&&(this.lineCap=ye.lineCap),ye.hasOwnProperty("lineJoin")&&(this.lineJoin=ye.lineJoin)}},I.prototype.strokeRect=function(H,ae,Z,se){if(isNaN(H)||isNaN(ae)||isNaN(Z)||isNaN(se))throw As.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");M.call(this)||(this.beginPath(),this.rect(H,ae,Z,se),this.stroke())},I.prototype.clearRect=function(H,ae,Z,se){if(isNaN(H)||isNaN(ae)||isNaN(Z)||isNaN(se))throw As.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(H,ae,Z,se))},I.prototype.save=function(H){H=typeof H!="boolean"||H;for(var ae=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("q");if(this.pdf.setPage(ae),H){this.ctx.fontSize=this.pdf.internal.getFontSize();var se=new A(this.ctx);this.ctxStack.push(this.ctx),this.ctx=se}},I.prototype.restore=function(H){H=typeof H!="boolean"||H;for(var ae=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("Q");this.pdf.setPage(ae),H&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},I.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var R=function(H){var ae,Z,se,ye;if(H.isCanvasGradient===!0&&(H=H.getColor()),!H)return{r:0,g:0,b:0,a:0,style:H};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(H))ae=0,Z=0,se=0,ye=0;else{var ce=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(H);if(ce!==null)ae=parseInt(ce[1]),Z=parseInt(ce[2]),se=parseInt(ce[3]),ye=1;else if((ce=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(H))!==null)ae=parseInt(ce[1]),Z=parseInt(ce[2]),se=parseInt(ce[3]),ye=parseFloat(ce[4]);else{if(ye=1,typeof H=="string"&&H.charAt(0)!=="#"){var ze=new YS(H);H=ze.ok?ze.toHex():"#000000"}H.length===4?(ae=H.substring(1,2),ae+=ae,Z=H.substring(2,3),Z+=Z,se=H.substring(3,4),se+=se):(ae=H.substring(1,3),Z=H.substring(3,5),se=H.substring(5,7)),ae=parseInt(ae,16),Z=parseInt(Z,16),se=parseInt(se,16)}}return{r:ae,g:Z,b:se,a:ye,style:H}},k=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},M=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};I.prototype.fillText=function(H,ae,Z,se){if(isNaN(ae)||isNaN(Z)||typeof H!="string")throw As.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(se=isNaN(se)?void 0:se,!k.call(this)){var ye=Ue(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;K.call(this,{text:H,x:ae,y:Z,scale:ce,angle:ye,align:this.textAlign,maxWidth:se})}},I.prototype.strokeText=function(H,ae,Z,se){if(isNaN(ae)||isNaN(Z)||typeof H!="string")throw As.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!M.call(this)){se=isNaN(se)?void 0:se;var ye=Ue(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;K.call(this,{text:H,x:ae,y:Z,scale:ce,renderingMode:"stroke",angle:ye,align:this.textAlign,maxWidth:se})}},I.prototype.measureText=function(H){if(typeof H!="string")throw As.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ae=this.pdf,Z=this.pdf.internal.scaleFactor,se=ae.internal.getFontSize(),ye=ae.getStringUnitWidth(H)*se/ae.internal.scaleFactor;return new function(ce){var ze=(ce=ce||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ze}}),this}({width:ye*=Math.round(96*Z/72*1e4)/1e4})},I.prototype.scale=function(H,ae){if(isNaN(H)||isNaN(ae))throw As.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Z=new y(H,0,0,ae,0,0);this.ctx.transform=this.ctx.transform.multiply(Z)},I.prototype.rotate=function(H){if(isNaN(H))throw As.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ae=new y(Math.cos(H),Math.sin(H),-Math.sin(H),Math.cos(H),0,0);this.ctx.transform=this.ctx.transform.multiply(ae)},I.prototype.translate=function(H,ae){if(isNaN(H)||isNaN(ae))throw As.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Z=new y(1,0,0,1,H,ae);this.ctx.transform=this.ctx.transform.multiply(Z)},I.prototype.transform=function(H,ae,Z,se,ye,ce){if(isNaN(H)||isNaN(ae)||isNaN(Z)||isNaN(se)||isNaN(ye)||isNaN(ce))throw As.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ze=new y(H,ae,Z,se,ye,ce);this.ctx.transform=this.ctx.transform.multiply(ze)},I.prototype.setTransform=function(H,ae,Z,se,ye,ce){H=isNaN(H)?1:H,ae=isNaN(ae)?0:ae,Z=isNaN(Z)?0:Z,se=isNaN(se)?1:se,ye=isNaN(ye)?0:ye,ce=isNaN(ce)?0:ce,this.ctx.transform=new y(H,ae,Z,se,ye,ce)};var V=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};I.prototype.drawImage=function(H,ae,Z,se,ye,ce,ze,pe,Ve){var yt=this.pdf.getImageProperties(H),vt=1,bt=1,Ft=1,Te=1;se!==void 0&&pe!==void 0&&(Ft=pe/se,Te=Ve/ye,vt=yt.width/se*pe/se,bt=yt.height/ye*Ve/ye),ce===void 0&&(ce=ae,ze=Z,ae=0,Z=0),se!==void 0&&pe===void 0&&(pe=se,Ve=ye),se===void 0&&pe===void 0&&(pe=yt.width,Ve=yt.height);var Ht=this.ctx.transform.decompose(),Or=Ue(Ht.rotate.shx),Vr=new y,Mt=(Vr=(Vr=(Vr=Vr.multiply(Ht.translate)).multiply(Ht.skew)).multiply(Ht.scale)).applyToRectangle(new m(ce-ae*Ft,ze-Z*Te,se*vt,ye*bt));if(this.autoPaging){for(var zr,Qe=q.call(this,Mt),Rt=[],Ct=0;Ct<Qe.length;Ct+=1)Rt.indexOf(Qe[Ct])===-1&&Rt.push(Qe[Ct]);W(Rt);for(var er=Rt[0],nr=Rt[Rt.length-1],ur=er;ur<nr+1;ur++){this.pdf.setPage(ur);var Sr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],kr=ur===1?this.posY+this.margin[0]:this.margin[0],ar=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_r=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ar=ur===1?0:ar+(ur-2)*_r;if(this.ctx.clip_path.length!==0){var ra=this.path;zr=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=te(zr,this.posX+this.margin[3],-Ar+kr+this.ctx.prevPageLastElemOffset),xe.call(this,"fill",!0),this.path=ra}var Nn=JSON.parse(JSON.stringify(Mt));Nn=te([Nn],this.posX+this.margin[3],-Ar+kr+this.ctx.prevPageLastElemOffset)[0];var Qr=(ur>er||ur<nr)&&V.call(this);Qr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Sr,_r,null).clip().discardPath()),this.pdf.addImage(H,"JPEG",Nn.x,Nn.y,Nn.w,Nn.h,null,null,Or),Qr&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(H,"JPEG",Mt.x,Mt.y,Mt.w,Mt.h,null,null,Or)};var q=function(H,ae,Z){var se=[];ae=ae||this.pdf.internal.pageSize.width,Z=Z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ye=this.posY+this.ctx.prevPageLastElemOffset;switch(H.type){default:case"mt":case"lt":se.push(Math.floor((H.y+ye)/Z)+1);break;case"arc":se.push(Math.floor((H.y+ye-H.radius)/Z)+1),se.push(Math.floor((H.y+ye+H.radius)/Z)+1);break;case"qct":var ce=_e(this.ctx.lastPoint.x,this.ctx.lastPoint.y,H.x1,H.y1,H.x,H.y);se.push(Math.floor((ce.y+ye)/Z)+1),se.push(Math.floor((ce.y+ce.h+ye)/Z)+1);break;case"bct":var ze=Le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,H.x1,H.y1,H.x2,H.y2,H.x,H.y);se.push(Math.floor((ze.y+ye)/Z)+1),se.push(Math.floor((ze.y+ze.h+ye)/Z)+1);break;case"rect":se.push(Math.floor((H.y+ye)/Z)+1),se.push(Math.floor((H.y+H.h+ye)/Z)+1)}for(var pe=0;pe<se.length;pe+=1)for(;this.pdf.internal.getNumberOfPages()<se[pe];)U.call(this);return se},U=function(){var H=this.fillStyle,ae=this.strokeStyle,Z=this.font,se=this.lineCap,ye=this.lineWidth,ce=this.lineJoin;this.pdf.addPage(),this.fillStyle=H,this.strokeStyle=ae,this.font=Z,this.lineCap=se,this.lineWidth=ye,this.lineJoin=ce},te=function(H,ae,Z){for(var se=0;se<H.length;se++)switch(H[se].type){case"bct":H[se].x2+=ae,H[se].y2+=Z;case"qct":H[se].x1+=ae,H[se].y1+=Z;default:H[se].x+=ae,H[se].y+=Z}return H},W=function(H){return H.sort(function(ae,Z){return ae-Z})},re=function(H,ae){var Z=this.fillStyle,se=this.strokeStyle,ye=this.lineCap,ce=this.lineWidth,ze=Math.abs(ce*this.ctx.transform.scaleX),pe=this.lineJoin;if(this.autoPaging){for(var Ve,yt,vt=JSON.parse(JSON.stringify(this.path)),bt=JSON.parse(JSON.stringify(this.path)),Ft=[],Te=0;Te<bt.length;Te++)if(bt[Te].x!==void 0)for(var Ht=q.call(this,bt[Te]),Or=0;Or<Ht.length;Or+=1)Ft.indexOf(Ht[Or])===-1&&Ft.push(Ht[Or]);for(var Vr=0;Vr<Ft.length;Vr++)for(;this.pdf.internal.getNumberOfPages()<Ft[Vr];)U.call(this);W(Ft);for(var Mt=Ft[0],zr=Ft[Ft.length-1],Qe=Mt;Qe<zr+1;Qe++){this.pdf.setPage(Qe),this.fillStyle=Z,this.strokeStyle=se,this.lineCap=ye,this.lineWidth=ze,this.lineJoin=pe;var Rt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ct=Qe===1?this.posY+this.margin[0]:this.margin[0],er=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ur=Qe===1?0:er+(Qe-2)*nr;if(this.ctx.clip_path.length!==0){var Sr=this.path;Ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=te(Ve,this.posX+this.margin[3],-ur+Ct+this.ctx.prevPageLastElemOffset),xe.call(this,H,!0),this.path=Sr}if(yt=JSON.parse(JSON.stringify(vt)),this.path=te(yt,this.posX+this.margin[3],-ur+Ct+this.ctx.prevPageLastElemOffset),ae===!1||Qe===0){var kr=(Qe>Mt||Qe<zr)&&V.call(this);kr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Rt,nr,null).clip().discardPath()),xe.call(this,H,ae),kr&&this.pdf.restoreGraphicsState()}this.lineWidth=ce}this.path=vt}else this.lineWidth=ze,xe.call(this,H,ae),this.lineWidth=ce},xe=function(H,ae){if((H!=="stroke"||ae||!M.call(this))&&(H==="stroke"||ae||!k.call(this))){for(var Z,se,ye=[],ce=this.path,ze=0;ze<ce.length;ze++){var pe=ce[ze];switch(pe.type){case"begin":ye.push({begin:!0});break;case"close":ye.push({close:!0});break;case"mt":ye.push({start:pe,deltas:[],abs:[]});break;case"lt":var Ve=ye.length;if(ce[ze-1]&&!isNaN(ce[ze-1].x)&&(Z=[pe.x-ce[ze-1].x,pe.y-ce[ze-1].y],Ve>0)){for(;Ve>=0;Ve--)if(ye[Ve-1].close!==!0&&ye[Ve-1].begin!==!0){ye[Ve-1].deltas.push(Z),ye[Ve-1].abs.push(pe);break}}break;case"bct":Z=[pe.x1-ce[ze-1].x,pe.y1-ce[ze-1].y,pe.x2-ce[ze-1].x,pe.y2-ce[ze-1].y,pe.x-ce[ze-1].x,pe.y-ce[ze-1].y],ye[ye.length-1].deltas.push(Z);break;case"qct":var yt=ce[ze-1].x+2/3*(pe.x1-ce[ze-1].x),vt=ce[ze-1].y+2/3*(pe.y1-ce[ze-1].y),bt=pe.x+2/3*(pe.x1-pe.x),Ft=pe.y+2/3*(pe.y1-pe.y),Te=pe.x,Ht=pe.y;Z=[yt-ce[ze-1].x,vt-ce[ze-1].y,bt-ce[ze-1].x,Ft-ce[ze-1].y,Te-ce[ze-1].x,Ht-ce[ze-1].y],ye[ye.length-1].deltas.push(Z);break;case"arc":ye.push({deltas:[],abs:[],arc:!0}),Array.isArray(ye[ye.length-1].abs)&&ye[ye.length-1].abs.push(pe)}}se=ae?null:H==="stroke"?"stroke":"fill";for(var Or=!1,Vr=0;Vr<ye.length;Vr++)if(ye[Vr].arc)for(var Mt=ye[Vr].abs,zr=0;zr<Mt.length;zr++){var Qe=Mt[zr];Qe.type==="arc"?ke.call(this,Qe.x,Qe.y,Qe.radius,Qe.startAngle,Qe.endAngle,Qe.counterclockwise,void 0,ae,!Or):Ae.call(this,Qe.x,Qe.y),Or=!0}else if(ye[Vr].close===!0)this.pdf.internal.out("h"),Or=!1;else if(ye[Vr].begin!==!0){var Rt=ye[Vr].start.x,Ct=ye[Vr].start.y;Ce.call(this,ye[Vr].deltas,Rt,Ct),Or=!0}se&&de.call(this,se),ae&&Oe.call(this)}},ve=function(H){var ae=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Z=ae*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return H-Z;case"top":return H+ae-Z;case"hanging":return H+ae-2*Z;case"middle":return H+ae/2-Z;default:return H}},De=function(H){return H+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};I.prototype.createLinearGradient=function(){var H=function(){};return H.colorStops=[],H.addColorStop=function(ae,Z){this.colorStops.push([ae,Z])},H.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},H.isCanvasGradient=!0,H},I.prototype.createPattern=function(){return this.createLinearGradient()},I.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ke=function(H,ae,Z,se,ye,ce,ze,pe,Ve){for(var yt=Ee.call(this,Z,se,ye,ce),vt=0;vt<yt.length;vt++){var bt=yt[vt];vt===0&&(Ve?z.call(this,bt.x1+H,bt.y1+ae):Ae.call(this,bt.x1+H,bt.y1+ae)),Be.call(this,H,ae,bt.x2,bt.y2,bt.x3,bt.y3,bt.x4,bt.y4)}pe?Oe.call(this):de.call(this,ze)},de=function(H){switch(H){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Oe=function(){this.pdf.clip(),this.pdf.discardPath()},z=function(H,ae){this.pdf.internal.out(r(H)+" "+a(ae)+" m")},K=function(H){var ae;switch(H.align){case"right":case"end":ae="right";break;case"center":ae="center";break;default:ae="left"}var Z,se,ye,ce=this.pdf.getTextDimensions(H.text),ze=ve.call(this,H.y),pe=De.call(this,ze)-ce.h,Ve=this.ctx.transform.applyToPoint(new p(H.x,ze));if(this.autoPaging){var yt=this.ctx.transform.decompose(),vt=new y;vt=(vt=(vt=vt.multiply(yt.translate)).multiply(yt.skew)).multiply(yt.scale);for(var bt=this.ctx.transform.applyToRectangle(new m(H.x,ze,ce.w,ce.h)),Ft=vt.applyToRectangle(new m(H.x,pe,ce.w,ce.h)),Te=q.call(this,Ft),Ht=[],Or=0;Or<Te.length;Or+=1)Ht.indexOf(Te[Or])===-1&&Ht.push(Te[Or]);W(Ht);for(var Vr=Ht[0],Mt=Ht[Ht.length-1],zr=Vr;zr<Mt+1;zr++){this.pdf.setPage(zr);var Qe=zr===1?this.posY+this.margin[0]:this.margin[0],Rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[2],er=Ct-this.margin[0],nr=this.pdf.internal.pageSize.width-this.margin[1],ur=nr-this.margin[3],Sr=zr===1?0:Rt+(zr-2)*er;if(this.ctx.clip_path.length!==0){var kr=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=te(Z,this.posX+this.margin[3],-1*Sr+Qe),xe.call(this,"fill",!0),this.path=kr}var ar=te([JSON.parse(JSON.stringify(Ft))],this.posX+this.margin[3],-Sr+Qe+this.ctx.prevPageLastElemOffset)[0];H.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*H.scale),ye=this.lineWidth,this.lineWidth=ye*H.scale);var _r=this.autoPaging!=="text";if(_r||ar.y+ar.h<=Ct){if(_r||ar.y>=Qe&&ar.x<=nr){var Ar=_r?H.text:this.pdf.splitTextToSize(H.text,H.maxWidth||nr-ar.x)[0],ra=te([JSON.parse(JSON.stringify(bt))],this.posX+this.margin[3],-Sr+Qe+this.ctx.prevPageLastElemOffset)[0],Nn=_r&&(zr>Vr||zr<Mt)&&V.call(this);Nn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ur,er,null).clip().discardPath()),this.pdf.text(Ar,ra.x,ra.y,{angle:H.angle,align:ae,renderingMode:H.renderingMode}),Nn&&this.pdf.restoreGraphicsState()}}else ar.y<Ct&&(this.ctx.prevPageLastElemOffset+=Ct-ar.y);H.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=ye)}}else H.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*H.scale),ye=this.lineWidth,this.lineWidth=ye*H.scale),this.pdf.text(H.text,Ve.x+this.posX,Ve.y+this.posY,{angle:H.angle,align:ae,renderingMode:H.renderingMode,maxWidth:H.maxWidth}),H.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=ye)},Ae=function(H,ae,Z,se){Z=Z||0,se=se||0,this.pdf.internal.out(r(H+Z)+" "+a(ae+se)+" l")},Ce=function(H,ae,Z){return this.pdf.lines(H,ae,Z,null,null)},Be=function(H,ae,Z,se,ye,ce,ze,pe){this.pdf.internal.out([t(n(Z+H)),t(e(se+ae)),t(n(ye+H)),t(e(ce+ae)),t(n(ze+H)),t(e(pe+ae)),"c"].join(" "))},Ee=function(H,ae,Z,se){for(var ye=2*Math.PI,ce=Math.PI/2;ae>Z;)ae-=ye;var ze=Math.abs(Z-ae);ze<ye&&se&&(ze=ye-ze);for(var pe=[],Ve=se?-1:1,yt=ae;ze>1e-5;){var vt=yt+Ve*Math.min(ze,ce);pe.push(Pe.call(this,H,yt,vt)),ze-=Math.abs(vt-yt),yt=vt}return pe},Pe=function(H,ae,Z){var se=(Z-ae)/2,ye=H*Math.cos(se),ce=H*Math.sin(se),ze=ye,pe=-ce,Ve=ze*ze+pe*pe,yt=Ve+ze*ye+pe*ce,vt=4/3*(Math.sqrt(2*Ve*yt)-yt)/(ze*ce-pe*ye),bt=ze-vt*pe,Ft=pe+vt*ze,Te=bt,Ht=-Ft,Or=se+ae,Vr=Math.cos(Or),Mt=Math.sin(Or);return{x1:H*Math.cos(ae),y1:H*Math.sin(ae),x2:bt*Vr-Ft*Mt,y2:bt*Mt+Ft*Vr,x3:Te*Vr-Ht*Mt,y3:Te*Mt+Ht*Vr,x4:H*Math.cos(Z),y4:H*Math.sin(Z)}},Ue=function(H){return 180*H/Math.PI},_e=function(H,ae,Z,se,ye,ce){var ze=H+.5*(Z-H),pe=ae+.5*(se-ae),Ve=ye+.5*(Z-ye),yt=ce+.5*(se-ce),vt=Math.min(H,ye,ze,Ve),bt=Math.max(H,ye,ze,Ve),Ft=Math.min(ae,ce,pe,yt),Te=Math.max(ae,ce,pe,yt);return new m(vt,Ft,bt-vt,Te-Ft)},Le=function(H,ae,Z,se,ye,ce,ze,pe){var Ve,yt,vt,bt,Ft,Te,Ht,Or,Vr,Mt,zr,Qe,Rt,Ct,er=Z-H,nr=se-ae,ur=ye-Z,Sr=ce-se,kr=ze-ye,ar=pe-ce;for(yt=0;yt<41;yt++)Vr=(Ht=(vt=H+(Ve=yt/40)*er)+Ve*((Ft=Z+Ve*ur)-vt))+Ve*(Ft+Ve*(ye+Ve*kr-Ft)-Ht),Mt=(Or=(bt=ae+Ve*nr)+Ve*((Te=se+Ve*Sr)-bt))+Ve*(Te+Ve*(ce+Ve*ar-Te)-Or),yt==0?(zr=Vr,Qe=Mt,Rt=Vr,Ct=Mt):(zr=Math.min(zr,Vr),Qe=Math.min(Qe,Mt),Rt=Math.max(Rt,Vr),Ct=Math.max(Ct,Mt));return new m(Math.round(zr),Math.round(Qe),Math.round(Rt-zr),Math.round(Ct-Qe))},X=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var H,ae,Z=(H=this.ctx.lineDash,ae=this.ctx.lineDashOffset,JSON.stringify({lineDash:H,lineDashOffset:ae}));this.prevLineDash!==Z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Z)}}})(en.API),(function(i){var t=function(p){var m,y,w,A,I,R,k,M,V,q;for(y=[],w=0,A=(p+=m="\0\0\0\0".slice(p.length%4||4)).length;A>w;w+=4)(I=(p.charCodeAt(w)<<24)+(p.charCodeAt(w+1)<<16)+(p.charCodeAt(w+2)<<8)+p.charCodeAt(w+3))!==0?(R=(I=((I=((I=((I=(I-(q=I%85))/85)-(V=I%85))/85)-(M=I%85))/85)-(k=I%85))/85)%85,y.push(R+33,k+33,M+33,V+33,q+33)):y.push(122);return(function(U,te){for(var W=te;W>0;W--)U.pop()})(y,m.length),String.fromCharCode.apply(String,y)+"~>"},r=function(p){var m,y,w,A,I,R=String,k="length",M=255,V="charCodeAt",q="slice",U="replace";for(p[q](-2),p=p[q](0,-2)[U](/\s/g,"")[U]("z","!!!!!"),w=[],A=0,I=(p+=m="uuuuu"[q](p[k]%5||5))[k];I>A;A+=5)y=52200625*(p[V](A)-33)+614125*(p[V](A+1)-33)+7225*(p[V](A+2)-33)+85*(p[V](A+3)-33)+(p[V](A+4)-33),w.push(M&y>>24,M&y>>16,M&y>>8,M&y);return(function(te,W){for(var re=W;re>0;re--)te.pop()})(w,m[k]),R.fromCharCode.apply(R,w)},a=function(p){return p.split("").map(function(m){return("0"+m.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(p){var m=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((p=p.replace(/\s/g,"")).indexOf(">")!==-1&&(p=p.substr(0,p.indexOf(">"))),p.length%2&&(p+="0"),m.test(p)===!1)return"";for(var y="",w=0;w<p.length;w+=2)y+=String.fromCharCode("0x"+(p[w]+p[w+1]));return y},e=function(p){for(var m=new Uint8Array(p.length),y=p.length;y--;)m[y]=p.charCodeAt(y);return(m=kv(m)).reduce(function(w,A){return w+String.fromCharCode(A)},"")};i.processDataByFilters=function(p,m){var y=0,w=p||"",A=[];for(typeof(m=m||[])=="string"&&(m=[m]),y=0;y<m.length;y+=1)switch(m[y]){case"ASCII85Decode":case"/ASCII85Decode":w=r(w),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":w=t(w),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":w=n(w),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":w=a(w),A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":w=e(w),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+m[y]+'" is not implemented')}return{data:w,reverseChain:A.reverse().join(" ")}}})(en.API),(function(i){i.loadFile=function(t,r,a){return(function(n,e,p){e=e!==!1,p=typeof p=="function"?p:function(){};var m=void 0;try{m=(function(y,w,A){var I=new XMLHttpRequest,R=0,k=function(M){var V=M.length,q=[],U=String.fromCharCode;for(R=0;R<V;R+=1)q.push(U(255&M.charCodeAt(R)));return q.join("")};if(I.open("GET",y,!w),I.overrideMimeType("text/plain; charset=x-user-defined"),w===!1&&(I.onload=function(){I.status===200?A(k(this.responseText)):A(void 0)}),I.send(null),w&&I.status===200)return k(I.responseText)})(n,e,p)}catch{}return m})(t,r,a)},i.loadImageFile=i.loadFile})(en.API),(function(i){function t(){return(kn.html2canvas?Promise.resolve(kn.html2canvas):h5(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load html2canvas: "+m))}).then(function(m){return m.default?m.default:m})}function r(){return(kn.DOMPurify?Promise.resolve(kn.DOMPurify):h5(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load dompurify: "+m))}).then(function(m){return m.default?m.default:m})}var a=function(m){var y=ns(m);return y==="undefined"?"undefined":y==="string"||m instanceof String?"string":y==="number"||m instanceof Number?"number":y==="function"||m instanceof Function?"function":m&&m.constructor===Array?"array":m&&m.nodeType===1?"element":y==="object"?"object":"unknown"},n=function(m,y){var w=document.createElement(m);for(var A in y.className&&(w.className=y.className),y.innerHTML&&y.dompurify&&(w.innerHTML=y.dompurify.sanitize(y.innerHTML)),y.style)w.style[A]=y.style[A];return w},e=function m(y,w){for(var A=y.nodeType===3?document.createTextNode(y.nodeValue):y.cloneNode(!1),I=y.firstChild;I;I=I.nextSibling)w!==!0&&I.nodeType===1&&I.nodeName==="SCRIPT"||A.appendChild(m(I,w));return y.nodeType===1&&(y.nodeName==="CANVAS"?(A.width=y.width,A.height=y.height,A.getContext("2d").drawImage(y,0,0)):y.nodeName!=="TEXTAREA"&&y.nodeName!=="SELECT"||(A.value=y.value),A.addEventListener("load",function(){A.scrollTop=y.scrollTop,A.scrollLeft=y.scrollLeft},!0)),A},p=function m(y){var w=Object.assign(m.convert(Promise.resolve()),JSON.parse(JSON.stringify(m.template))),A=m.convert(Promise.resolve(),w);return(A=A.setProgress(1,m,1,[m])).set(y)};(p.prototype=Object.create(Promise.prototype)).constructor=p,p.convert=function(m,y){return m.__proto__=y||p.prototype,m},p.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},p.prototype.from=function(m,y){return this.then(function(){switch(y=y||(function(w){switch(a(w)){case"string":return"string";case"element":return w.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(m),y){case"string":return this.then(r).then(function(w){return this.set({src:n("div",{innerHTML:m,dompurify:w})})});case"element":return this.set({src:m});case"canvas":return this.set({canvas:m});case"img":return this.set({img:m});default:return this.error("Unknown source type.")}})},p.prototype.to=function(m){switch(m){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},p.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var m={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},y=e(this.prop.src,this.opt.html2canvas.javascriptEnabled);y.tagName==="BODY"&&(m.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:m}),this.prop.container.appendChild(y),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},p.prototype.toCanvas=function(){var m=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(m).then(t).then(function(y){var w=Object.assign({},this.opt.html2canvas);return delete w.onrendered,y(this.prop.container,w)}).then(function(y){(this.opt.html2canvas.onrendered||function(){})(y),this.prop.canvas=y,document.body.removeChild(this.prop.overlay)})},p.prototype.toContext2d=function(){var m=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(m).then(t).then(function(y){var w=this.opt.jsPDF,A=this.opt.fontFaces,I=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,R=Object.assign({async:!0,allowTaint:!0,scale:I,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete R.onrendered,w.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,w.context2d.posX=this.opt.x,w.context2d.posY=this.opt.y,w.context2d.margin=this.opt.margin,w.context2d.fontFaces=A,A)for(var k=0;k<A.length;++k){var M=A[k],V=M.src.find(function(q){return q.format==="truetype"});V&&w.addFont(V.url,M.ref.name,M.ref.style)}return R.windowHeight=R.windowHeight||0,R.windowHeight=R.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):R.windowHeight,w.context2d.save(!0),y(this.prop.container,R)}).then(function(y){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(y),this.prop.canvas=y,document.body.removeChild(this.prop.overlay)})},p.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var m=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=m})},p.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},p.prototype.output=function(m,y,w){return(w=w||"pdf").toLowerCase()==="img"||w.toLowerCase()==="image"?this.outputImg(m,y):this.outputPdf(m,y)},p.prototype.outputPdf=function(m,y){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(m,y)})},p.prototype.outputImg=function(m){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(m){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+m+'" is not supported.'}})},p.prototype.save=function(m){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(m?{filename:m}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},p.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},p.prototype.set=function(m){if(a(m)!=="object")return this;var y=Object.keys(m||{}).map(function(w){if(w in p.template.prop)return function(){this.prop[w]=m[w]};switch(w){case"margin":return this.setMargin.bind(this,m.margin);case"jsPDF":return function(){return this.opt.jsPDF=m.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,m.pageSize);default:return function(){this.opt[w]=m[w]}}},this);return this.then(function(){return this.thenList(y)})},p.prototype.get=function(m,y){return this.then(function(){var w=m in p.template.prop?this.prop[m]:this.opt[m];return y?y(w):w})},p.prototype.setMargin=function(m){return this.then(function(){switch(a(m)){case"number":m=[m,m,m,m];case"array":if(m.length===2&&(m=[m[0],m[1],m[0],m[1]]),m.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=m}).then(this.setPageSize)},p.prototype.setPageSize=function(m){function y(w,A){return Math.floor(w*A/72*96)}return this.then(function(){(m=m||en.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(m.inner={width:m.width-this.opt.margin[1]-this.opt.margin[3],height:m.height-this.opt.margin[0]-this.opt.margin[2]},m.inner.px={width:y(m.inner.width,m.k),height:y(m.inner.height,m.k)},m.inner.ratio=m.inner.height/m.inner.width),this.prop.pageSize=m})},p.prototype.setProgress=function(m,y,w,A){return m!=null&&(this.progress.val=m),y!=null&&(this.progress.state=y),w!=null&&(this.progress.n=w),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},p.prototype.updateProgress=function(m,y,w,A){return this.setProgress(m?this.progress.val+m:null,y||null,w?this.progress.n+w:null,A?this.progress.stack.concat(A):null)},p.prototype.then=function(m,y){var w=this;return this.thenCore(m,y,function(A,I){return w.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(R){return w.updateProgress(null,A),R}).then(A,I).then(function(R){return w.updateProgress(1),R})})},p.prototype.thenCore=function(m,y,w){w=w||Promise.prototype.then;var A=this;m&&(m=m.bind(A)),y&&(y=y.bind(A));var I=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?A:p.convert(Object.assign({},A),Promise.prototype),R=w.call(I,m,y);return p.convert(R,A.__proto__)},p.prototype.thenExternal=function(m,y){return Promise.prototype.then.call(this,m,y)},p.prototype.thenList=function(m){var y=this;return m.forEach(function(w){y=y.thenCore(w)}),y},p.prototype.catch=function(m){m&&(m=m.bind(this));var y=Promise.prototype.catch.call(this,m);return p.convert(y,this)},p.prototype.catchExternal=function(m){return Promise.prototype.catch.call(this,m)},p.prototype.error=function(m){return this.then(function(){throw new Error(m)})},p.prototype.using=p.prototype.set,p.prototype.saveAs=p.prototype.save,p.prototype.export=p.prototype.output,p.prototype.run=p.prototype.then,en.getPageSize=function(m,y,w){if(ns(m)==="object"){var A=m;m=A.orientation,y=A.unit||y,w=A.format||w}y=y||"mm",w=w||"a4",m=(""+(m||"P")).toLowerCase();var I,R=(""+w).toLowerCase(),k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(y){case"pt":I=1;break;case"mm":I=72/25.4;break;case"cm":I=72/2.54;break;case"in":I=72;break;case"px":I=.75;break;case"pc":case"em":I=12;break;case"ex":I=6;break;default:throw"Invalid unit: "+y}var M,V=0,q=0;if(k.hasOwnProperty(R))V=k[R][1]/I,q=k[R][0]/I;else try{V=w[1],q=w[0]}catch{throw new Error("Invalid format: "+w)}if(m==="p"||m==="portrait")m="p",q>V&&(M=q,q=V,V=M);else{if(m!=="l"&&m!=="landscape")throw"Invalid orientation: "+m;m="l",V>q&&(M=q,q=V,V=M)}return{width:q,height:V,unit:y,k:I,orientation:m}},i.html=function(m,y){(y=y||{}).callback=y.callback||function(){},y.html2canvas=y.html2canvas||{},y.html2canvas.canvas=y.html2canvas.canvas||this.canvas,y.jsPDF=y.jsPDF||this,y.fontFaces=y.fontFaces?y.fontFaces.map(O5):null;var w=new p(y);return y.worker?w:w.from(m).doCallback()}})(en.API),en.API.addJS=function(i){return z3=i,this.internal.events.subscribe("postPutResources",function(){f2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(f2+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),H3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+z3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){f2!==void 0&&H3!==void 0&&this.internal.out("/Names <</JavaScript "+f2+" 0 R>>")}),this},(function(i){var t;i.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),e=0;e<n.length;e++){var p=n[e],m=a.exec(p);if(m!=null){var y=m[1];r.internal.newObjectDeferredBegin(y,!1)}r.internal.write(p)}if(this.outline.createNamedDestinations){var w=this.internal.pages.length,A=[];for(e=0;e<w;e++){var I=r.internal.newObject();A.push(I);var R=r.internal.getPageInfo(e+1);r.internal.write("<< /D["+R.objId+" 0 R /XYZ null null null]>> endobj")}var k=r.internal.newObject();for(r.internal.write("<< /Names [ "),e=0;e<A.length;e++)r.internal.write("(page_"+(e+1)+")"+A[e]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+k+" 0 R"),r.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),i.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,e){var p={title:n,options:e,children:[]};return a==null&&(a=this.root),a.children.push(p),p},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,e=0;e<a.children.length;e++){var p=a.children[e];this.objStart(p),this.line("/Title "+this.makeString(p.title)),this.line("/Parent "+this.makeRef(a)),e>0&&this.line("/Prev "+this.makeRef(a.children[e-1])),e<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[e+1])),p.children.length>0&&(this.line("/First "+this.makeRef(p.children[0])),this.line("/Last "+this.makeRef(p.children[p.children.length-1])));var m=this.count=this.count_r({count:0},p);if(m>0&&this.line("/Count "+m),p.options&&p.options.pageNumber){var y=r.internal.getPageInfo(p.options.pageNumber);this.line("/Dest ["+y.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var w=0;w<a.children.length;w++)this.renderItems(a.children[w])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var e=0;e<n.children.length;e++)a.count++,this.count_r(a,n.children[e]);return a.count}}])})(en.API),(function(i){var t=[192,193,194,195,196,197,198,199];i.processJPEG=function(r,a,n,e,p,m){var y,w=this.decode.DCT_DECODE,A=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=p||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,y=(function(I){for(var R,k=256*I.charCodeAt(4)+I.charCodeAt(5),M=I.length,V={width:0,height:0,numcomponents:1},q=4;q<M;q+=2){if(q+=k,t.indexOf(I.charCodeAt(q+1))!==-1){R=256*I.charCodeAt(q+5)+I.charCodeAt(q+6),V={width:256*I.charCodeAt(q+7)+I.charCodeAt(q+8),height:R,numcomponents:I.charCodeAt(q+9)};break}k=256*I.charCodeAt(q+2)+I.charCodeAt(q+3)}return V})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),y.numcomponents){case 1:m=this.color_spaces.DEVICE_GRAY;break;case 4:m=this.color_spaces.DEVICE_CMYK;break;case 3:m=this.color_spaces.DEVICE_RGB}A={data:r,width:y.width,height:y.height,colorSpace:m,bitsPerComponent:8,filter:w,index:a,alias:n}}return A}})(en.API),en.API.processPNG=function(i,t,r,a){if(this.__addimage__.isArrayBuffer(i)&&(i=new Uint8Array(i)),this.__addimage__.isArrayBufferView(i)){var n,e=BD(i,{checkCrc:!0}),p=e.width,m=e.height,y=e.channels,w=e.palette,A=e.depth;n=w&&y===1?(function(ke){for(var de=ke.width,Oe=ke.height,z=ke.data,K=ke.palette,Ae=ke.depth,Ce=!1,Be=[],Ee=[],Pe=void 0,Ue=!1,_e=0,Le=0;Le<K.length;Le++){var X=V4(K[Le],4),H=X[0],ae=X[1],Z=X[2],se=X[3];Be.push(H,ae,Z),se!=null&&(se===0?(_e++,Ee.length<1&&Ee.push(Le)):se<255&&(Ue=!0))}if(Ue||_e>1){Ce=!0,Ee=void 0;var ye=de*Oe;Pe=new Uint8Array(ye);for(var ce=new DataView(z.buffer),ze=0;ze<ye;ze++){var pe=P5(ce,ze,Ae),Ve=V4(K[pe],4)[3];Pe[ze]=Ve}}else _e===0&&(Ee=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Ce?8:void 0,colorBytes:z,alphaBytes:Pe,needSMask:Ce,palette:Be,mask:Ee}})(e):y===2||y===4?(function(ke){for(var de=ke.data,Oe=ke.width,z=ke.height,K=ke.channels,Ae=ke.depth,Ce=K===2?"DeviceGray":"DeviceRGB",Be=K-1,Ee=Oe*z,Pe=Be,Ue=Ee*Pe,_e=1*Ee,Le=Math.ceil(Ue*Ae/8),X=Math.ceil(_e*Ae/8),H=new Uint8Array(Le),ae=new Uint8Array(X),Z=new DataView(de.buffer),se=new DataView(H.buffer),ye=new DataView(ae.buffer),ce=!1,ze=0;ze<Ee;ze++){for(var pe=ze*K,Ve=0;Ve<Pe;Ve++)Q3(se,P5(Z,pe+Ve,Ae),ze*Pe+Ve,Ae);var yt=P5(Z,pe+Pe,Ae);yt<(1<<Ae)-1&&(ce=!0),Q3(ye,yt,1*ze,Ae)}return{colorSpace:Ce,colorsPerPixel:Be,sMaskBitsPerComponent:ce?Ae:void 0,colorBytes:H,alphaBytes:ae,needSMask:ce}})(e):(function(ke){var de=ke.data,Oe=ke.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Oe,colorsPerPixel:Oe==="DeviceGray"?1:3,colorBytes:de instanceof Uint16Array?(function(z){for(var K=z.length,Ae=new Uint8Array(2*K),Ce=new DataView(Ae.buffer,Ae.byteOffset,Ae.byteLength),Be=0;Be<K;Be++)Ce.setUint16(2*Be,z[Be],!1);return Ae})(de):de,needSMask:!1}})(e);var I,R,k,M=n,V=M.colorSpace,q=M.colorsPerPixel,U=M.sMaskBitsPerComponent,te=M.colorBytes,W=M.alphaBytes,re=M.needSMask,xe=M.palette,ve=M.mask,De=null;return a!==en.API.image_compression.NONE&&typeof kv=="function"?(De=(function(ke){var de;switch(ke){case en.API.image_compression.FAST:de=11;break;case en.API.image_compression.MEDIUM:de=13;break;case en.API.image_compression.SLOW:de=14;break;default:de=12}return de})(a),I=this.decode.FLATE_DECODE,R="/Predictor ".concat(De," /Colors ").concat(q," /BitsPerComponent ").concat(A," /Columns ").concat(p),i=V3(te,Math.ceil(p*q*A/8),q,A,a),re&&(k=V3(W,Math.ceil(p*U/8),1,U,a))):(I=void 0,R=void 0,i=te,re&&(k=W)),(this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i))&&(i=this.__addimage__.arrayBufferToBinaryString(i)),(k&&this.__addimage__.isArrayBuffer(k)||this.__addimage__.isArrayBufferView(k))&&(k=this.__addimage__.arrayBufferToBinaryString(k)),{alias:r,data:i,index:t,filter:I,decodeParameters:R,transparency:ve,palette:xe,sMask:k,predictor:De,width:p,height:m,bitsPerComponent:A,sMaskBitsPerComponent:U,colorSpace:V}}},(function(i){i.processGIF89A=function(t,r,a,n){var e=new oF(t),p=e.width,m=e.height,y=[];e.decodeAndBlitFrameRGBA(0,y);var w={data:y,width:p,height:m},A=new M5(100).encode(w,100);return i.processJPEG.call(this,A,r,a,n)},i.processGIF87A=i.processGIF89A})(en.API),Bu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var t=0;t<i;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),e=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:e}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Bu.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[i]()}catch(r){As.log("bit decode error:"+r)}},Bu.prototype.bit1=function(){var i,t=Math.ceil(this.width/8),r=t%4;for(i=this.height-1;i>=0;i--){for(var a=this.bottom_up?i:this.height-1-i,n=0;n<t;n++)for(var e=this.datav.getUint8(this.pos++,!0),p=a*this.width*4+8*n*4,m=0;m<8&&8*n+m<this.width;m++){var y=this.palette[e>>7-m&1];this.data[p+4*m]=y.blue,this.data[p+4*m+1]=y.green,this.data[p+4*m+2]=y.red,this.data[p+4*m+3]=255}r!==0&&(this.pos+=4-r)}},Bu.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),t=i%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<i;n++){var e=this.datav.getUint8(this.pos++,!0),p=a*this.width*4+2*n*4,m=e>>4,y=15&e,w=this.palette[m];if(this.data[p]=w.blue,this.data[p+1]=w.green,this.data[p+2]=w.red,this.data[p+3]=255,2*n+1>=this.width)break;w=this.palette[y],this.data[p+4]=w.blue,this.data[p+4+1]=w.green,this.data[p+4+2]=w.red,this.data[p+4+3]=255}t!==0&&(this.pos+=4-t)}},Bu.prototype.bit8=function(){for(var i=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),e=r*this.width*4+4*a;if(n<this.palette.length){var p=this.palette[n];this.data[e]=p.red,this.data[e+1]=p.green,this.data[e+2]=p.blue,this.data[e+3]=255}else this.data[e]=255,this.data[e+1]=255,this.data[e+2]=255,this.data[e+3]=255}i!==0&&(this.pos+=4-i)}},Bu.prototype.bit15=function(){for(var i=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var e=this.datav.getUint16(this.pos,!0);this.pos+=2;var p=(e&t)/t*255|0,m=(e>>5&t)/t*255|0,y=(e>>10&t)/t*255|0,w=e>>15?255:0,A=a*this.width*4+4*n;this.data[A]=y,this.data[A+1]=m,this.data[A+2]=p,this.data[A+3]=w}this.pos+=i}},Bu.prototype.bit16=function(){for(var i=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,e=0;e<this.width;e++){var p=this.datav.getUint16(this.pos,!0);this.pos+=2;var m=(p&t)/t*255|0,y=(p>>5&r)/r*255|0,w=(p>>11)/t*255|0,A=n*this.width*4+4*e;this.data[A]=w,this.data[A+1]=y,this.data[A+2]=m,this.data[A+3]=255}this.pos+=i}},Bu.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var t=this.bottom_up?i:this.height-1-i,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),e=this.datav.getUint8(this.pos++,!0),p=t*this.width*4+4*r;this.data[p]=e,this.data[p+1]=n,this.data[p+2]=a,this.data[p+3]=255}this.pos+=this.width%4}},Bu.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var t=this.bottom_up?i:this.height-1-i,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),e=this.datav.getUint8(this.pos++,!0),p=this.datav.getUint8(this.pos++,!0),m=t*this.width*4+4*r;this.data[m]=e,this.data[m+1]=n,this.data[m+2]=a,this.data[m+3]=p}},Bu.prototype.getData=function(){return this.data},(function(i){i.processBMP=function(t,r,a,n){var e=new Bu(t,!1),p=e.width,m=e.height,y={data:e.getData(),width:p,height:m},w=new M5(100).encode(y,100);return i.processJPEG.call(this,w,r,a,n)}})(en.API),Z3.prototype.getData=function(){return this.data},(function(i){i.processWEBP=function(t,r,a,n){var e=new Z3(t),p=e.width,m=e.height,y={data:e.getData(),width:p,height:m},w=new M5(100).encode(y,100);return i.processJPEG.call(this,w,r,a,n)}})(en.API),en.API.processRGBA=function(i,t,r){for(var a=i.data,n=a.length,e=new Uint8Array(n/4*3),p=new Uint8Array(n/4),m=0,y=0,w=0;w<n;w+=4){var A=a[w],I=a[w+1],R=a[w+2],k=a[w+3];e[m++]=A,e[m++]=I,e[m++]=R,p[y++]=k}var M=this.__addimage__.arrayBufferToBinaryString(e);return{alpha:this.__addimage__.arrayBufferToBinaryString(p),data:M,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},en.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},L1=en.API,p2=L1.getCharWidthsArray=function(i,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),e=t.fontSize||this.internal.getFontSize(),p=t.charSpace||this.internal.getCharSpace(),m=t.widths?t.widths:n.metadata.Unicode.widths,y=m.fof?m.fof:1,w=t.kerning?t.kerning:n.metadata.Unicode.kerning,A=w.fof?w.fof:1,I=t.doKerning!==!1,R=0,k=i.length,M=0,V=m[0]||y,q=[];for(r=0;r<k;r++)a=i.charCodeAt(r),typeof n.metadata.widthOfString=="function"?q.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+p*(1e3/e)||0)/1e3):(R=I&&ns(w[a])==="object"&&!isNaN(parseInt(w[a][M],10))?w[a][M]/A:0,q.push((m[a]||V)/y+R)),M=a;return q},$3=L1.getStringUnitWidth=function(i,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return L1.processArabic&&(i=L1.processArabic(i)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(i,r,n)/r:p2.apply(this,arguments).reduce(function(e,p){return e+p},0)},q3=function(i,t,r,a){for(var n=[],e=0,p=i.length,m=0;e!==p&&m+t[e]<r;)m+=t[e],e++;n.push(i.slice(0,e));var y=e;for(m=0;e!==p;)m+t[e]>a&&(n.push(i.slice(y,e)),m=0,y=e),m+=t[e],e++;return y!==e&&n.push(i.slice(y,e)),n},G3=function(i,t,r){r||(r={});var a,n,e,p,m,y,w,A=[],I=[A],R=r.textIndent||0,k=0,M=0,V=i.split(" "),q=p2.apply(this,[" ",r])[0];if(y=r.lineIndent===-1?V[0].length+2:r.lineIndent||0){var U=Array(y).join(" "),te=[];V.map(function(re){(re=re.split(/\s*\n/)).length>1?te=te.concat(re.map(function(xe,ve){return(ve&&xe.length?`
`:"")+xe})):te.push(re[0])}),V=te,y=$3.apply(this,[U,r])}for(e=0,p=V.length;e<p;e++){var W=0;if(a=V[e],y&&a[0]==`
`&&(a=a.substr(1),W=1),R+k+(M=(n=p2.apply(this,[a,r])).reduce(function(re,xe){return re+xe},0))>t||W){if(M>t){for(m=q3.apply(this,[a,n,t-(R+k),t]),A.push(m.shift()),A=[m.pop()];m.length;)I.push([m.shift()]);M=n.slice(a.length-(A[0]?A[0].length:0)).reduce(function(re,xe){return re+xe},0)}else A=[a];I.push(A),R=M+y,k=q}else A.push(a),R+=k+M,k=q}return w=y?function(re,xe){return(xe?U:"")+re.join(" ")}:function(re){return re.join(" ")},I.map(w)},L1.splitTextToSize=function(i,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),e=(function(A){if(A.widths&&A.kerning)return{widths:A.widths,kerning:A.kerning};var I=this.internal.getFont(A.fontName,A.fontStyle),R="Unicode";return I.metadata[R]?{widths:I.metadata[R].widths||{0:1},kerning:I.metadata[R].kerning||{}}:{font:I.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(i)?i:String(i).split(/\r?\n/);var p=1*this.internal.scaleFactor*t/n;e.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,e.lineIndent=r.lineIndent;var m,y,w=[];for(m=0,y=a.length;m<y;m++)w=w.concat(G3.apply(this,[a[m],p,e]));return w},(function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},e=0;e<16;e++)a[r[e]]=t[e],n[t[e]]=r[e];var p=function(R){return"0x"+parseInt(R,10).toString(16)},m=i.__fontmetrics__.compress=function(R){var k,M,V,q,U=["{"];for(var te in R){if(k=R[te],isNaN(parseInt(te,10))?M="'"+te+"'":(te=parseInt(te,10),M=(M=p(te).slice(2)).slice(0,-1)+n[M.slice(-1)]),typeof k=="number")k<0?(V=p(k).slice(3),q="-"):(V=p(k).slice(2),q=""),V=q+V.slice(0,-1)+n[V.slice(-1)];else{if(ns(k)!=="object")throw new Error("Don't know what to do with value type "+ns(k)+".");V=m(k)}U.push(M+V)}return U.push("}"),U.join("")},y=i.__fontmetrics__.uncompress=function(R){if(typeof R!="string")throw new Error("Invalid argument passed to uncompress.");for(var k,M,V,q,U={},te=1,W=U,re=[],xe="",ve="",De=R.length-1,ke=1;ke<De;ke+=1)(q=R[ke])=="'"?k?(V=k.join(""),k=void 0):k=[]:k?k.push(q):q=="{"?(re.push([W,V]),W={},V=void 0):q=="}"?((M=re.pop())[0][M[1]]=W,V=void 0,W=M[0]):q=="-"?te=-1:V===void 0?a.hasOwnProperty(q)?(xe+=a[q],V=parseInt(xe,16)*te,te=1,xe=""):xe+=q:a.hasOwnProperty(q)?(ve+=a[q],W[V]=parseInt(ve,16)*te,te=1,V=void 0,ve=""):ve+=q;return U},w={codePages:["WinAnsiEncoding"],WinAnsiEncoding:y("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:w,"Courier-Bold":w,"Courier-BoldOblique":w,"Courier-Oblique":w,Helvetica:w,"Helvetica-Bold":w,"Helvetica-BoldOblique":w,"Helvetica-Oblique":w,"Times-Roman":w,"Times-Bold":w,"Times-BoldItalic":w,"Times-Italic":w}},I={Unicode:{"Courier-Oblique":y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":y("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":y("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":y("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:y("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:y("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":y("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:y("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":y("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":y("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":y("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(R){var k=R.font,M=I.Unicode[k.postScriptName];M&&(k.metadata.Unicode={},k.metadata.Unicode.widths=M.widths,k.metadata.Unicode.kerning=M.kerning);var V=A.Unicode[k.postScriptName];V&&(k.metadata.Unicode.encoding=V,k.encoding=V.codePages[0])}])})(en.API),(function(i){var t=function(r){for(var a=r.length,n=new Uint8Array(a),e=0;e<a;e++)n[e]=r.charCodeAt(e);return n};i.API.events.push(["addFont",function(r){var a=void 0,n=r.font,e=r.instance;if(!n.isStandardFont){if(e===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=e.existsFileInVFS(n.postScriptName)===!1?e.loadFile(n.postScriptName):e.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(p,m){m=/^\x00\x01\x00\x00/.test(m)?t(m):t(E2(m)),p.metadata=i.API.TTFFont.open(m),p.metadata.Unicode=p.metadata.Unicode||{encoding:{},kerning:{},widths:[]},p.metadata.glyIdsUsed=[0]})(n,a)}}])})(en),en.API.addSvgAsImage=function(i,t,r,a,n,e,p,m){if(isNaN(t)||isNaN(r))throw As.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw As.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var y=document.createElement("canvas");y.width=a,y.height=n;var w=y.getContext("2d");w.fillStyle="#fff",w.fillRect(0,0,y.width,y.height);var A={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},I=this;return(kn.canvg?Promise.resolve(kn.canvg):h5(()=>import("./index.es-J0fMPJ34.js"),[])).catch(function(R){return Promise.reject(new Error("Could not load canvg: "+R))}).then(function(R){return R.default?R.default:R}).then(function(R){return R.fromString(w,i,A)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(R){return R.render(A)}).then(function(){I.addImage(y.toDataURL("image/jpeg",1),t,r,a,n,p,m)})},en.API.putTotalPages=function(i){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(i,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},en.API.viewerPreferences=function(i,t){var r;i=i||{},t=t||!1;var a,n,e,p={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},m=Object.keys(p),y=[],w=0,A=0,I=0;function R(M,V){var q,U=!1;for(q=0;q<M.length;q+=1)M[q]===V&&(U=!0);return U}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(p)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,i==="reset"||t===!0){var k=m.length;for(I=0;I<k;I+=1)r[m[I]].value=r[m[I]].defaultValue,r[m[I]].explicitSet=!1}if(ns(i)==="object"){for(n in i)if(e=i[n],R(m,n)&&e!==void 0){if(r[n].type==="boolean"&&typeof e=="boolean")r[n].value=e;else if(r[n].type==="name"&&R(r[n].valueSet,e))r[n].value=e;else if(r[n].type==="integer"&&Number.isInteger(e))r[n].value=e;else if(r[n].type==="array"){for(w=0;w<e.length;w+=1)if(a=!0,e[w].length===1&&typeof e[w][0]=="number")y.push(String(e[w]-1));else if(e[w].length>1){for(A=0;A<e[w].length;A+=1)typeof e[w][A]!="number"&&(a=!1);a===!0&&y.push([e[w][0]-1,e[w][1]-1].join(" "))}r[n].value="["+y.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var M,V=[];for(M in r)r[M].explicitSet===!0&&(r[M].type==="name"?V.push("/"+M+" /"+r[M].value):V.push("/"+M+" "+r[M].value));V.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+V.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(i){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),e=unescape(encodeURIComponent(a)),p=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),m=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),y=unescape(encodeURIComponent("</x:xmpmeta>")),w=e.length+p.length+m.length+n.length+y.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+w+" >>"),this.internal.write("stream"),this.internal.write(n+e+p+m+y),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}})(en.API),(function(i){var t=i.API,r=t.pdfEscape16=function(e,p){for(var m,y=p.metadata.Unicode.widths,w=["","0","00","000","0000"],A=[""],I=0,R=e.length;I<R;++I){if(m=p.metadata.characterToGlyph(e.charCodeAt(I)),p.metadata.glyIdsUsed.push(m),p.metadata.toUnicode[m]=e.charCodeAt(I),y.indexOf(m)==-1&&(y.push(m),y.push([parseInt(p.metadata.widthOfGlyph(m),10)])),m=="0")return A.join("");m=m.toString(16),A.push(w[4-m.length],m)}return A.join("")},a=function(e){var p,m,y,w,A,I,R;for(A=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,y=[],I=0,R=(m=Object.keys(e).sort(function(k,M){return k-M})).length;I<R;I++)p=m[I],y.length>=100&&(A+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar`,y=[]),e[p]!==void 0&&e[p]!==null&&typeof e[p].toString=="function"&&(w=("0000"+e[p].toString(16)).slice(-4),p=("0000"+(+p).toString(16)).slice(-4),y.push("<"+p+"><"+w+">"));return y.length&&(A+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar
`),A+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(e){(function(p){var m=p.font,y=p.out,w=p.newObject,A=p.putStream;if(m.metadata instanceof i.API.TTFFont&&m.encoding==="Identity-H"){for(var I=m.metadata.Unicode.widths,R=m.metadata.subset.encode(m.metadata.glyIdsUsed,1),k="",M=0;M<R.length;M++)k+=String.fromCharCode(R[M]);var V=w();A({data:k,addLength1:!0,objectId:V}),y("endobj");var q=w();A({data:a(m.metadata.toUnicode),addLength1:!0,objectId:q}),y("endobj");var U=w();y("<<"),y("/Type /FontDescriptor"),y("/FontName /"+z1(m.fontName)),y("/FontFile2 "+V+" 0 R"),y("/FontBBox "+i.API.PDFObject.convert(m.metadata.bbox)),y("/Flags "+m.metadata.flags),y("/StemV "+m.metadata.stemV),y("/ItalicAngle "+m.metadata.italicAngle),y("/Ascent "+m.metadata.ascender),y("/Descent "+m.metadata.decender),y("/CapHeight "+m.metadata.capHeight),y(">>"),y("endobj");var te=w();y("<<"),y("/Type /Font"),y("/BaseFont /"+z1(m.fontName)),y("/FontDescriptor "+U+" 0 R"),y("/W "+i.API.PDFObject.convert(I)),y("/CIDToGIDMap /Identity"),y("/DW 1000"),y("/Subtype /CIDFontType2"),y("/CIDSystemInfo"),y("<<"),y("/Supplement 0"),y("/Registry (Adobe)"),y("/Ordering ("+m.encoding+")"),y(">>"),y(">>"),y("endobj"),m.objectNumber=w(),y("<<"),y("/Type /Font"),y("/Subtype /Type0"),y("/ToUnicode "+q+" 0 R"),y("/BaseFont /"+z1(m.fontName)),y("/Encoding /"+m.encoding),y("/DescendantFonts ["+te+" 0 R]"),y(">>"),y("endobj"),m.isAlreadyPutted=!0}})(e)}]),t.events.push(["putFont",function(e){(function(p){var m=p.font,y=p.out,w=p.newObject,A=p.putStream;if(m.metadata instanceof i.API.TTFFont&&m.encoding==="WinAnsiEncoding"){for(var I=m.metadata.rawData,R="",k=0;k<I.length;k++)R+=String.fromCharCode(I[k]);var M=w();A({data:R,addLength1:!0,objectId:M}),y("endobj");var V=w();A({data:a(m.metadata.toUnicode),addLength1:!0,objectId:V}),y("endobj");var q=w();y("<<"),y("/Descent "+m.metadata.decender),y("/CapHeight "+m.metadata.capHeight),y("/StemV "+m.metadata.stemV),y("/Type /FontDescriptor"),y("/FontFile2 "+M+" 0 R"),y("/Flags 96"),y("/FontBBox "+i.API.PDFObject.convert(m.metadata.bbox)),y("/FontName /"+z1(m.fontName)),y("/ItalicAngle "+m.metadata.italicAngle),y("/Ascent "+m.metadata.ascender),y(">>"),y("endobj"),m.objectNumber=w();for(var U=0;U<m.metadata.hmtx.widths.length;U++)m.metadata.hmtx.widths[U]=parseInt(m.metadata.hmtx.widths[U]*(1e3/m.metadata.head.unitsPerEm));y("<</Subtype/TrueType/Type/Font/ToUnicode "+V+" 0 R/BaseFont/"+z1(m.fontName)+"/FontDescriptor "+q+" 0 R/Encoding/"+m.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(m.metadata.hmtx.widths)+">>"),y("endobj"),m.isAlreadyPutted=!0}})(e)}]);var n=function(e){var p,m=e.text||"",y=e.x,w=e.y,A=e.options||{},I=e.mutex||{},R=I.pdfEscape,k=I.activeFontKey,M=I.fonts,V=k,q="",U=0,te="",W=M[V].encoding;if(M[V].encoding!=="Identity-H")return{text:m,x:y,y:w,options:A,mutex:I};for(te=m,V=k,Array.isArray(m)&&(te=m[0]),U=0;U<te.length;U+=1)M[V].metadata.hasOwnProperty("cmap")&&(p=M[V].metadata.cmap.unicode.codeMap[te[U].charCodeAt(0)]),p||te[U].charCodeAt(0)<256&&M[V].metadata.hasOwnProperty("Unicode")?q+=te[U]:q+="";var re="";return parseInt(V.slice(1))<14||W==="WinAnsiEncoding"?re=R(q,V).split("").map(function(xe){return xe.charCodeAt(0).toString(16)}).join(""):W==="Identity-H"&&(re=r(q,M[V])),I.isHex=!0,{text:re,x:y,y:w,options:A,mutex:I}};t.events.push(["postProcessText",function(e){var p=e.text||"",m=[],y={text:p,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(p)){var w=0;for(w=0;w<p.length;w+=1)Array.isArray(p[w])&&p[w].length===3?m.push([n(Object.assign({},y,{text:p[w][0]})).text,p[w][1],p[w][2]]):m.push(n(Object.assign({},y,{text:p[w]})).text);e.text=m}else e.text=n(Object.assign({},y,{text:p})).text}])})(en),(function(i){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},i.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},i.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(en.API),(function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(a){var n,e,p,m,y,w,A,I=t,R=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],k=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},V={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},q=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],U=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),te=!1,W=0;this.__bidiEngine__={};var re=function(z){var K=z.charCodeAt(),Ae=K>>8,Ce=V[Ae];return Ce!==void 0?I[256*Ce+(255&K)]:Ae===252||Ae===253?"AL":U.test(Ae)?"L":Ae===8?"R":"N"},xe=function(z){for(var K,Ae=0;Ae<z.length;Ae++){if((K=re(z.charAt(Ae)))==="L")return!1;if(K==="R")return!0}return!1},ve=function(z,K,Ae,Ce){var Be,Ee,Pe,Ue,_e=K[Ce];switch(_e){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":te=!1;break;case"N":case"AN":break;case"EN":te&&(_e="AN");break;case"AL":te=!0,_e="R";break;case"WS":case"BN":_e="N";break;case"CS":Ce<1||Ce+1>=K.length||(Be=Ae[Ce-1])!=="EN"&&Be!=="AN"||(Ee=K[Ce+1])!=="EN"&&Ee!=="AN"?_e="N":te&&(Ee="AN"),_e=Ee===Be?Ee:"N";break;case"ES":_e=(Be=Ce>0?Ae[Ce-1]:"B")==="EN"&&Ce+1<K.length&&K[Ce+1]==="EN"?"EN":"N";break;case"ET":if(Ce>0&&Ae[Ce-1]==="EN"){_e="EN";break}if(te){_e="N";break}for(Pe=Ce+1,Ue=K.length;Pe<Ue&&K[Pe]==="ET";)Pe++;_e=Pe<Ue&&K[Pe]==="EN"?"EN":"N";break;case"NSM":if(p&&!m){for(Ue=K.length,Pe=Ce+1;Pe<Ue&&K[Pe]==="NSM";)Pe++;if(Pe<Ue){var Le=z[Ce],X=Le>=1425&&Le<=2303||Le===64286;if(Be=K[Pe],X&&(Be==="R"||Be==="AL")){_e="R";break}}}_e=Ce<1||(Be=K[Ce-1])==="B"?"N":Ae[Ce-1];break;case"B":te=!1,n=!0,_e=W;break;case"S":e=!0,_e="N"}return _e},De=function(z,K,Ae){var Ce=z.split("");return Ae&&ke(Ce,Ae,{hiLevel:W}),Ce.reverse(),K&&K.reverse(),Ce.join("")},ke=function(z,K,Ae){var Ce,Be,Ee,Pe,Ue,_e=-1,Le=z.length,X=0,H=[],ae=W?k:R,Z=[];for(te=!1,n=!1,e=!1,Be=0;Be<Le;Be++)Z[Be]=re(z[Be]);for(Ee=0;Ee<Le;Ee++){if(Ue=X,H[Ee]=ve(z,Z,H,Ee),Ce=240&(X=ae[Ue][M[H[Ee]]]),X&=15,K[Ee]=Pe=ae[X][5],Ce>0)if(Ce===16){for(Be=_e;Be<Ee;Be++)K[Be]=1;_e=-1}else _e=-1;if(ae[X][6])_e===-1&&(_e=Ee);else if(_e>-1){for(Be=_e;Be<Ee;Be++)K[Be]=Pe;_e=-1}Z[Ee]==="B"&&(K[Ee]=0),Ae.hiLevel|=Pe}e&&(function(se,ye,ce){for(var ze=0;ze<ce;ze++)if(se[ze]==="S"){ye[ze]=W;for(var pe=ze-1;pe>=0&&se[pe]==="WS";pe--)ye[pe]=W}})(Z,K,Le)},de=function(z,K,Ae,Ce,Be){if(!(Be.hiLevel<z)){if(z===1&&W===1&&!n)return K.reverse(),void(Ae&&Ae.reverse());for(var Ee,Pe,Ue,_e,Le=K.length,X=0;X<Le;){if(Ce[X]>=z){for(Ue=X+1;Ue<Le&&Ce[Ue]>=z;)Ue++;for(_e=X,Pe=Ue-1;_e<Pe;_e++,Pe--)Ee=K[_e],K[_e]=K[Pe],K[Pe]=Ee,Ae&&(Ee=Ae[_e],Ae[_e]=Ae[Pe],Ae[Pe]=Ee);X=Ue}X++}}},Oe=function(z,K,Ae){var Ce=z.split(""),Be={hiLevel:W};return Ae||(Ae=[]),ke(Ce,Ae,Be),(function(Ee,Pe,Ue){if(Ue.hiLevel!==0&&A)for(var _e,Le=0;Le<Ee.length;Le++)Pe[Le]===1&&(_e=q.indexOf(Ee[Le]))>=0&&(Ee[Le]=q[_e+1])})(Ce,Ae,Be),de(2,Ce,K,Ae,Be),de(1,Ce,K,Ae,Be),Ce.join("")};return this.__bidiEngine__.doBidiReorder=function(z,K,Ae){if((function(Be,Ee){if(Ee)for(var Pe=0;Pe<Be.length;Pe++)Ee[Pe]=Pe;m===void 0&&(m=xe(Be)),w===void 0&&(w=xe(Be))})(z,K),p||!y||w)if(p&&y&&m^w)W=m?1:0,z=De(z,K,Ae);else if(!p&&y&&w)W=m?1:0,z=Oe(z,K,Ae),z=De(z,K);else if(!p||m||y||w){if(p&&!y&&m^w)z=De(z,K),m?(W=0,z=Oe(z,K,Ae)):(W=1,z=Oe(z,K,Ae),z=De(z,K));else if(p&&m&&!y&&w)W=1,z=Oe(z,K,Ae),z=De(z,K);else if(!p&&!y&&m^w){var Ce=A;m?(W=1,z=Oe(z,K,Ae),W=0,A=!1,z=Oe(z,K,Ae),A=Ce):(W=0,z=Oe(z,K,Ae),z=De(z,K),W=1,A=!1,z=Oe(z,K,Ae),A=Ce,z=De(z,K))}}else W=0,z=Oe(z,K,Ae);else W=m?1:0,z=Oe(z,K,Ae);return z},this.__bidiEngine__.setOptions=function(z){z&&(p=z.isInputVisual,y=z.isOutputVisual,m=z.isInputRtl,w=z.isOutputRtl,A=z.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var e=a.options||{};a.mutex,e.lang;var p=[];if(e.isInputVisual=typeof e.isInputVisual!="boolean"||e.isInputVisual,r.setOptions(e),Object.prototype.toString.call(n)==="[object Array]"){var m=0;for(p=[],m=0;m<n.length;m+=1)Object.prototype.toString.call(n[m])==="[object Array]"?p.push([r.doBidiReorder(n[m][0]),n[m][1],n[m][2]]):p.push([r.doBidiReorder(n[m])]);a.text=p}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(en),en.API.TTFFont=(function(){function i(t){var r;if(this.rawData=t,r=this.contents=new Tf(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new SF(this),this.registerTTF()}return i.open=function(t){return new i(t)},i.prototype.parse=function(){return this.directory=new lF(this.contents),this.head=new uF(this),this.name=new mF(this),this.cmap=new iA(this),this.toUnicode={},this.hhea=new hF(this),this.maxp=new gF(this),this.hmtx=new yF(this),this.post=new fF(this),this.os2=new dF(this),this.loca=new wF(this),this.glyf=new vF(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var t,r,a,n,e;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var p,m,y,w;for(w=[],p=0,m=(y=this.bbox).length;p<m;p++)t=y[p],w.push(Math.round(t*this.scaleFactor));return w}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(e=this.familyClass)===1||e===2||e===3||e===4||e===5||e===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},i.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},i.prototype.widthOfString=function(t,r,a){var n,e,p,m;for(p=0,e=0,m=(t=""+t).length;0<=m?e<m:e>m;e=0<=m?++e:--e)n=t.charCodeAt(e),p+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return p*(r/1e3)},i.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},i})();var Zu,Tf=(function(){function i(t){this.data=t??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(t){return this.data[this.pos++]=t},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},i.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},i.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},i.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},i.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(t){return this.writeInt16(t)},i.prototype.readLongLong=function(){var t,r,a,n,e,p,m,y;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),e=this.readByte(),p=this.readByte(),m=this.readByte(),y=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^e)+65536*(255^p)+256*(255^m)+(255^y)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*e+65536*p+256*m+y},i.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(t){return this.writeInt32(t)},i.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},i.prototype.write=function(t){var r,a,n,e;for(e=[],a=0,n=t.length;a<n;a++)r=t[a],e.push(this.writeByte(r));return e},i})(),lF=(function(){var i;function t(r){var a,n,e;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,e=this.tableCount;0<=e?n<e:n>e;n=0<=e?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,e,p,m,y,w,A,I,R,k,M,V;for(V in k=Object.keys(r).length,y=Math.log(2),I=16*Math.floor(Math.log(k)/y),p=Math.floor(I/y),A=16*k-I,(n=new Tf).writeInt(this.scalarType),n.writeShort(k),n.writeShort(I),n.writeShort(p),n.writeShort(A),e=16*k,w=n.pos+e,m=null,M=[],r)for(R=r[V],n.writeString(V),n.writeInt(i(R)),n.writeInt(w),n.writeInt(R.length),M=M.concat(R),V==="head"&&(m=w),w+=R.length;w%4;)M.push(0),w++;return n.write(M),a=2981146554-i(n.data),n.pos=m+8,n.writeUInt32(a),n.data},i=function(r){var a,n,e,p;for(r=oA.call(r);r.length%4;)r.push(0);for(e=new Tf(r),n=0,a=0,p=r.length;a<p;a=a+=4)n+=e.readUInt32();return 4294967295&n},t})(),cF={}.hasOwnProperty,jh=function(i,t){for(var r in t)cF.call(t,r)&&(i[r]=t[r]);function a(){this.constructor=i}return a.prototype=t.prototype,i.prototype=new a,i.__super__=t.prototype,i};Zu=(function(){function i(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i})();var uF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="head",i.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},i.prototype.encode=function(t){var r;return(r=new Tf).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},i})(),ew=(function(){function i(t,r){var a,n,e,p,m,y,w,A,I,R,k,M,V,q,U,te,W;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),I=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(y=0;y<256;++y)this.codeMap[y]=t.readByte();break;case 4:for(k=t.readUInt16(),R=k/2,t.pos+=6,e=(function(){var re,xe;for(xe=[],y=re=0;0<=R?re<R:re>R;y=0<=R?++re:--re)xe.push(t.readUInt16());return xe})(),t.pos+=2,V=(function(){var re,xe;for(xe=[],y=re=0;0<=R?re<R:re>R;y=0<=R?++re:--re)xe.push(t.readUInt16());return xe})(),w=(function(){var re,xe;for(xe=[],y=re=0;0<=R?re<R:re>R;y=0<=R?++re:--re)xe.push(t.readUInt16());return xe})(),A=(function(){var re,xe;for(xe=[],y=re=0;0<=R?re<R:re>R;y=0<=R?++re:--re)xe.push(t.readUInt16());return xe})(),n=(this.length-t.pos+this.offset)/2,m=(function(){var re,xe;for(xe=[],y=re=0;0<=n?re<n:re>n;y=0<=n?++re:--re)xe.push(t.readUInt16());return xe})(),y=U=0,W=e.length;U<W;y=++U)for(q=e[y],a=te=M=V[y];M<=q?te<=q:te>=q;a=M<=q?++te:--te)A[y]===0?p=a+w[y]:(p=m[A[y]/2+(a-M)-(R-y)]||0)!==0&&(p+=w[y]),this.codeMap[a]=65535&p}t.pos=I}return i.encode=function(t,r){var a,n,e,p,m,y,w,A,I,R,k,M,V,q,U,te,W,re,xe,ve,De,ke,de,Oe,z,K,Ae,Ce,Be,Ee,Pe,Ue,_e,Le,X,H,ae,Z,se,ye,ce,ze,pe,Ve,yt,vt;switch(Ce=new Tf,p=Object.keys(t).sort(function(bt,Ft){return bt-Ft}),r){case"macroman":for(V=0,q=(function(){var bt=[];for(M=0;M<256;++M)bt.push(0);return bt})(),te={0:0},e={},Be=0,_e=p.length;Be<_e;Be++)te[pe=t[n=p[Be]]]==null&&(te[pe]=++V),e[n]={old:t[n],new:te[t[n]]},q[n]=te[t[n]];return Ce.writeUInt16(1),Ce.writeUInt16(0),Ce.writeUInt32(12),Ce.writeUInt16(0),Ce.writeUInt16(262),Ce.writeUInt16(0),Ce.write(q),{charMap:e,subtable:Ce.data,maxGlyphID:V+1};case"unicode":for(K=[],I=[],W=0,te={},a={},U=w=null,Ee=0,Le=p.length;Ee<Le;Ee++)te[xe=t[n=p[Ee]]]==null&&(te[xe]=++W),a[n]={old:xe,new:te[xe]},m=te[xe]-n,U!=null&&m===w||(U&&I.push(U),K.push(n),w=m),U=n;for(U&&I.push(U),I.push(65535),K.push(65535),Oe=2*(de=K.length),ke=2*Math.pow(Math.log(de)/Math.LN2,2),R=Math.log(ke/2)/Math.LN2,De=2*de-ke,y=[],ve=[],k=[],M=Pe=0,X=K.length;Pe<X;M=++Pe){if(z=K[M],A=I[M],z===65535){y.push(0),ve.push(0);break}if(z-(Ae=a[z].new)>=32768)for(y.push(0),ve.push(2*(k.length+de-M)),n=Ue=z;z<=A?Ue<=A:Ue>=A;n=z<=A?++Ue:--Ue)k.push(a[n].new);else y.push(Ae-z),ve.push(0)}for(Ce.writeUInt16(3),Ce.writeUInt16(1),Ce.writeUInt32(12),Ce.writeUInt16(4),Ce.writeUInt16(16+8*de+2*k.length),Ce.writeUInt16(0),Ce.writeUInt16(Oe),Ce.writeUInt16(ke),Ce.writeUInt16(R),Ce.writeUInt16(De),ce=0,H=I.length;ce<H;ce++)n=I[ce],Ce.writeUInt16(n);for(Ce.writeUInt16(0),ze=0,ae=K.length;ze<ae;ze++)n=K[ze],Ce.writeUInt16(n);for(Ve=0,Z=y.length;Ve<Z;Ve++)m=y[Ve],Ce.writeUInt16(m);for(yt=0,se=ve.length;yt<se;yt++)re=ve[yt],Ce.writeUInt16(re);for(vt=0,ye=k.length;vt<ye;vt++)V=k[vt],Ce.writeUInt16(V);return{charMap:a,subtable:Ce.data,maxGlyphID:W+1}}},i})(),iA=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="cmap",i.prototype.parse=function(t){var r,a,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new ew(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},i.encode=function(t,r){var a,n;return r==null&&(r="macroman"),a=ew.encode(t,r),(n=new Tf).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},i})(),hF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="hhea",i.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},i})(),dF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="OS/2",i.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(t.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(t.readInt());return a})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(t.readInt());return a})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},i})(),fF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="post",i.prototype.parse=function(t){var r,a,n;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var e;for(a=t.readUInt16(),this.glyphNameIndex=[],e=0;0<=a?e<a:e>a;e=0<=a?++e:--e)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],n=[];t.pos<this.offset+this.length;)r=t.readByte(),n.push(this.names.push(t.readString(r)));return n;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 262144:return this.map=(function(){var p,m,y;for(y=[],e=p=0,m=this.file.maxp.numGlyphs;0<=m?p<m:p>m;e=0<=m?++p:--p)y.push(t.readUInt32());return y}).call(this)}},i})(),pF=function(i,t){this.raw=i,this.length=i.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},mF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="name",i.prototype.parse=function(t){var r,a,n,e,p,m,y,w,A,I,R;for(t.pos=this.offset,t.readShort(),r=t.readShort(),m=t.readShort(),a=[],e=0;0<=r?e<r:e>r;e=0<=r?++e:--e)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+m+t.readShort()});for(y={},e=A=0,I=a.length;A<I;e=++A)n=a[e],t.pos=n.offset,w=t.readString(n.length),p=new pF(w,n),y[R=n.nameID]==null&&(y[R]=[]),y[n.nameID].push(p);this.strings=y,this.copyright=y[0],this.fontFamily=y[1],this.fontSubfamily=y[2],this.uniqueSubfamily=y[3],this.fontName=y[4],this.version=y[5];try{this.postscriptName=y[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=y[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=y[7],this.manufacturer=y[8],this.designer=y[9],this.description=y[10],this.vendorUrl=y[11],this.designerUrl=y[12],this.license=y[13],this.licenseUrl=y[14],this.preferredFamily=y[15],this.preferredSubfamily=y[17],this.compatibleFull=y[18],this.sampleText=y[19]},i})(),gF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="maxp",i.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},i})(),yF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="hmtx",i.prototype.parse=function(t){var r,a,n,e,p,m,y;for(t.pos=this.offset,this.metrics=[],r=0,m=this.file.hhea.numberOfMetrics;0<=m?r<m:r>m;r=0<=m?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var w,A;for(A=[],r=w=0;0<=n?w<n:w>n;r=0<=n?++w:--w)A.push(t.readInt16());return A})(),this.widths=(function(){var w,A,I,R;for(R=[],w=0,A=(I=this.metrics).length;w<A;w++)e=I[w],R.push(e.advance);return R}).call(this),a=this.widths[this.widths.length-1],y=[],r=p=0;0<=n?p<n:p>n;r=0<=n?++p:--p)y.push(this.widths.push(a));return y},i.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},i})(),oA=[].slice,vF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="glyf",i.prototype.parse=function(){return this.cache={}},i.prototype.glyphFor=function(t){var r,a,n,e,p,m,y,w,A,I;return t in this.cache?this.cache[t]:(e=this.file.loca,r=this.file.contents,a=e.indexOf(t),(n=e.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+a,p=(m=new Tf(r.read(n))).readShort(),w=m.readShort(),I=m.readShort(),y=m.readShort(),A=m.readShort(),this.cache[t]=p===-1?new xF(m,w,I,y,A):new bF(m,p,w,I,y,A),this.cache[t]))},i.prototype.encode=function(t,r,a){var n,e,p,m,y;for(p=[],e=[],m=0,y=r.length;m<y;m++)n=t[r[m]],e.push(p.length),n&&(p=p.concat(n.encode(a)));return e.push(p.length),{table:p,offsets:e}},i})(),bF=(function(){function i(t,r,a,n,e,p){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=e,this.yMax=p,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i})(),xF=(function(){function i(t,r,a,n,e){var p,m;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=e,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],p=this.raw;m=p.readShort(),this.glyphOffsets.push(p.pos),this.glyphIDs.push(p.readUInt16()),32&m;)p.pos+=1&m?4:2,128&m?p.pos+=8:64&m?p.pos+=4:8&m&&(p.pos+=2)}return i.prototype.encode=function(){var t,r,a;for(r=new Tf(oA.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},i})(),wF=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return jh(i,Zu),i.prototype.tag="loca",i.prototype.parse=function(t){var r,a;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,e;for(e=[],a=0,n=this.length;a<n;a+=2)e.push(2*t.readUInt16());return e}).call(this):(function(){var n,e;for(e=[],a=0,n=this.length;a<n;a+=4)e.push(t.readUInt32());return e}).call(this)},i.prototype.indexOf=function(t){return this.offsets[t]},i.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},i.prototype.encode=function(t,r){for(var a=new Uint32Array(this.offsets.length),n=0,e=0,p=0;p<a.length;++p)if(a[p]=n,e<r.length&&r[e]==p){++e,a[p]=n;var m=this.offsets[p],y=this.offsets[p+1]-m;y>0&&(n+=y)}for(var w=new Array(4*a.length),A=0;A<a.length;++A)w[4*A+3]=255&a[A],w[4*A+2]=(65280&a[A])>>8,w[4*A+1]=(16711680&a[A])>>16,w[4*A]=(4278190080&a[A])>>24;return w},i})(),SF=(function(){function i(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var t,r,a,n,e;for(r in n=this.font.cmap.tables[0].codeMap,t={},e=this.subset)a=e[r],t[r]=n[a];return t},i.prototype.glyphsFor=function(t){var r,a,n,e,p,m,y;for(n={},p=0,m=t.length;p<m;p++)n[e=t[p]]=this.font.glyf.glyphFor(e);for(e in r=[],n)(a=n[e])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(e in y=this.glyphsFor(r))a=y[e],n[e]=a;return n},i.prototype.encode=function(t,r){var a,n,e,p,m,y,w,A,I,R,k,M,V,q,U;for(n in a=iA.encode(this.generateCmap(),"unicode"),p=this.glyphsFor(t),k={0:0},U=a.charMap)k[(y=U[n]).old]=y.new;for(M in R=a.maxGlyphID,p)M in k||(k[M]=R++);return A=(function(te){var W,re;for(W in re={},te)re[te[W]]=W;return re})(k),I=Object.keys(A).sort(function(te,W){return te-W}),V=(function(){var te,W,re;for(re=[],te=0,W=I.length;te<W;te++)m=I[te],re.push(A[m]);return re})(),e=this.font.glyf.encode(p,V,k),w=this.font.loca.encode(e.offsets,V),q={cmap:this.font.cmap.raw(),glyf:e.table,loca:w,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(q["OS/2"]=this.font.os2.raw()),this.font.directory.encode(q)},i})();en.API.PDFObject=(function(){var i;function t(){}return i=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,e,p;if(Array.isArray(r))return"["+(function(){var m,y,w;for(w=[],m=0,y=r.length;m<y;m++)a=r[m],w.push(t.convert(a));return w})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+i(r.getUTCFullYear(),4)+i(r.getUTCMonth(),2)+i(r.getUTCDate(),2)+i(r.getUTCHours(),2)+i(r.getUTCMinutes(),2)+i(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in e=["<<"],r)p=r[n],e.push("/"+n+" "+t.convert(p));return e.push(">>"),e.join(`
`)}return""+r},t})();function lA(i,t,r,a,n){a=a||{};var e=1.15,p=n.internal.scaleFactor,m=n.internal.getFontSize()/p,y=n.getLineHeightFactor?n.getLineHeightFactor():e,w=m*y,A=/\r\n|\r|\n/g,I="",R=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(I=typeof i=="string"?i.split(A):i,R=I.length||1),r+=m*(2-e),a.valign==="middle"?r-=R/2*w:a.valign==="bottom"&&(r-=R*w),a.halign==="center"||a.halign==="right"){var k=m;if(a.halign==="center"&&(k*=.5),I&&R>=1){for(var M=0;M<I.length;M++)n.text(I[M],t-n.getStringUnitWidth(I[M])*k,r),r+=w;return n}t-=n.getStringUnitWidth(i)*k}return a.halign==="justify"?n.text(i,t,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(i,t,r),n}var tw={},rp=(function(){function i(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return i.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:tw=t},i.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},i.prototype.applyStyles=function(t,r){var a,n,e;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var p=this.jsPDFDocument.internal.getFont(),m=p.fontStyle,y=p.fontName;if(t.font&&(y=t.font),t.fontStyle){m=t.fontStyle;var w=this.getFontList()[y];w&&w.indexOf(m)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(w[0]),m=w[0])}if(this.jsPDFDocument.setFont(y,m),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var A=i.unifyColor(t.fillColor);A&&(a=this.jsPDFDocument).setFillColor.apply(a,A),A=i.unifyColor(t.textColor),A&&(n=this.jsPDFDocument).setTextColor.apply(n,A),A=i.unifyColor(t.lineColor),A&&(e=this.jsPDFDocument).setDrawColor.apply(e,A),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},i.prototype.splitTextToSize=function(t,r,a){return this.jsPDFDocument.splitTextToSize(t,r,a)},i.prototype.rect=function(t,r,a,n,e){return this.jsPDFDocument.rect(t,r,a,n,e)},i.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},i.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},i.prototype.getDocument=function(){return this.jsPDFDocument},i.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},i.prototype.addPage=function(){return this.jsPDFDocument.addPage()},i.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},i.prototype.getGlobalOptions=function(){return tw||{}},i.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},i.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},i.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},i.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},i.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},i.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},i})(),Lv=function(i,t){return Lv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Lv(i,t)};function cA(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Lv(i,t);function r(){this.constructor=i}i.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var uA=(function(i){cA(t,i);function t(r){var a=i.call(this)||this;return a._element=r,a}return t})(Array);function AF(i){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/i,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function CF(i){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[i]}function fy(i,t,r){r.applyStyles(t,!0);var a=Array.isArray(i)?i:[i],n=a.map(function(e){return r.getTextWidth(e)}).reduce(function(e,p){return Math.max(e,p)},0);return n}function hA(i,t,r,a){var n=t.settings.tableLineWidth,e=t.settings.tableLineColor;i.applyStyles({lineWidth:n,lineColor:e});var p=dA(n,!1);p&&i.rect(r.x,r.y,t.getWidth(i.pageSize().width),a.y-r.y,p)}function dA(i,t){var r=i>0,a=t||t===0;return r&&a?"DF":r?"S":a?"F":null}function qy(i,t){var r,a,n,e;if(i=i||t,Array.isArray(i)){if(i.length>=4)return{top:i[0],right:i[1],bottom:i[2],left:i[3]};if(i.length===3)return{top:i[0],right:i[1],bottom:i[2],left:i[1]};if(i.length===2)return{top:i[0],right:i[1],bottom:i[0],left:i[1]};i.length===1?i=i[0]:i=t}return typeof i=="object"?(typeof i.vertical=="number"&&(i.top=i.vertical,i.bottom=i.vertical),typeof i.horizontal=="number"&&(i.right=i.horizontal,i.left=i.horizontal),{left:(r=i.left)!==null&&r!==void 0?r:t,top:(a=i.top)!==null&&a!==void 0?a:t,right:(n=i.right)!==null&&n!==void 0?n:t,bottom:(e=i.bottom)!==null&&e!==void 0?e:t}):(typeof i!="number"&&(i=t),{top:i,right:i,bottom:i,left:i})}function fA(i,t){var r=qy(t.settings.margin,0);return i.pageSize().width-(r.left+r.right)}function NF(i,t,r,a,n){var e={},p=1.3333333333333333,m=U5(t,function(W){return n.getComputedStyle(W).backgroundColor});m!=null&&(e.fillColor=m);var y=U5(t,function(W){return n.getComputedStyle(W).color});y!=null&&(e.textColor=y);var w=EF(a,r);w&&(e.cellPadding=w);var A="borderTopColor",I=p*r,R=a.borderTopWidth;if(a.borderBottomWidth===R&&a.borderRightWidth===R&&a.borderLeftWidth===R){var k=(parseFloat(R)||0)/I;k&&(e.lineWidth=k)}else e.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/I,right:(parseFloat(a.borderRightWidth)||0)/I,bottom:(parseFloat(a.borderBottomWidth)||0)/I,left:(parseFloat(a.borderLeftWidth)||0)/I},e.lineWidth.top||(e.lineWidth.right?A="borderRightColor":e.lineWidth.bottom?A="borderBottomColor":e.lineWidth.left&&(A="borderLeftColor"));var M=U5(t,function(W){return n.getComputedStyle(W)[A]});M!=null&&(e.lineColor=M);var V=["left","right","center","justify"];V.indexOf(a.textAlign)!==-1&&(e.halign=a.textAlign),V=["middle","bottom","top"],V.indexOf(a.verticalAlign)!==-1&&(e.valign=a.verticalAlign);var q=parseInt(a.fontSize||"");isNaN(q)||(e.fontSize=q/p);var U=TF(a);U&&(e.fontStyle=U);var te=(a.fontFamily||"").toLowerCase();return i.indexOf(te)!==-1&&(e.font=te),e}function TF(i){var t="";return(i.fontWeight==="bold"||i.fontWeight==="bolder"||parseInt(i.fontWeight)>=700)&&(t="bold"),(i.fontStyle==="italic"||i.fontStyle==="oblique")&&(t+="italic"),t}function U5(i,t){var r=pA(i,t);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],e=parseInt(a[4]);return e===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function pA(i,t){var r=t(i);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?i.parentElement==null?null:pA(i.parentElement,t):r}function EF(i,t){var r=[i.paddingTop,i.paddingRight,i.paddingBottom,i.paddingLeft],a=96/(72/t),n=(parseInt(i.lineHeight)-parseInt(i.fontSize))/t/2,e=r.map(function(m){return parseInt(m||"0")/a}),p=qy(e,0);return n>p.top&&(p.top=n),n>p.bottom&&(p.bottom=n),p}function mA(i,t,r,a,n){var e,p;a===void 0&&(a=!1),n===void 0&&(n=!1);var m;typeof t=="string"?m=r.document.querySelector(t):m=t;var y=Object.keys(i.getFontList()),w=i.scaleFactor(),A=[],I=[],R=[];if(!m)return console.error("Html table could not be found with input: ",t),{head:A,body:I,foot:R};for(var k=0;k<m.rows.length;k++){var M=m.rows[k],V=(p=(e=M?.parentElement)===null||e===void 0?void 0:e.tagName)===null||p===void 0?void 0:p.toLowerCase(),q=kF(y,w,r,M,a,n);q&&(V==="thead"?A.push(q):V==="tfoot"?R.push(q):I.push(q))}return{head:A,body:I,foot:R}}function kF(i,t,r,a,n,e){for(var p=new uA(a),m=0;m<a.cells.length;m++){var y=a.cells[m],w=r.getComputedStyle(y);if(n||w.display!=="none"){var A=void 0;e&&(A=NF(i,y,t,w,r)),p.push({rowSpan:y.rowSpan,colSpan:y.colSpan,styles:A,_element:y,content:_F(y)})}}var I=r.getComputedStyle(a);if(p.length>0&&(n||I.display!=="none"))return p}function _F(i){var t=i.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function IF(i,t,r){for(var a=0,n=[i,t,r];a<n.length;a++){var e=n[a];e&&typeof e!="object"&&console.error("The options parameter should be of type object, is: "+typeof e),e.startY&&typeof e.startY!="number"&&(console.error("Invalid value for startY option",e.startY),delete e.startY)}}function gd(i,t,r,a,n){if(i==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(i),p=1;p<arguments.length;p++){var m=arguments[p];if(m!=null)for(var y in m)Object.prototype.hasOwnProperty.call(m,y)&&(e[y]=m[y])}return e}function gA(i,t){var r=new rp(i),a=r.getDocumentOptions(),n=r.getGlobalOptions();IF(n,a,t);var e=gd({},n,a,t),p;typeof window<"u"&&(p=window);var m=DF(n,a,t),y=FF(n,a,t),w=RF(r,e),A=OF(r,e,p);return{id:t.tableId,content:A,hooks:y,styles:m,settings:w}}function DF(i,t,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(y){if(y==="columnStyles"){var w=i[y],A=t[y],I=r[y];a.columnStyles=gd({},w,A,I)}else{var R=[i,t,r],k=R.map(function(M){return M[y]||{}});a[y]=gd({},k[0],k[1],k[2])}},e=0,p=Object.keys(a);e<p.length;e++){var m=p[e];n(m)}return a}function FF(i,t,r){for(var a=[i,t,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},e=0,p=a;e<p.length;e++){var m=p[e];m.didParseCell&&n.didParseCell.push(m.didParseCell),m.willDrawCell&&n.willDrawCell.push(m.willDrawCell),m.didDrawCell&&n.didDrawCell.push(m.didDrawCell),m.willDrawPage&&n.willDrawPage.push(m.willDrawPage),m.didDrawPage&&n.didDrawPage.push(m.didDrawPage)}return n}function RF(i,t){var r,a,n,e,p,m,y,w,A,I,R,k,M=qy(t.margin,40/i.scaleFactor()),V=(r=jF(i,t.startY))!==null&&r!==void 0?r:M.top,q;t.showFoot===!0?q="everyPage":t.showFoot===!1?q="never":q=(a=t.showFoot)!==null&&a!==void 0?a:"everyPage";var U;t.showHead===!0?U="everyPage":t.showHead===!1?U="never":U=(n=t.showHead)!==null&&n!==void 0?n:"everyPage";var te=(e=t.useCss)!==null&&e!==void 0?e:!1,W=t.theme||(te?"plain":"striped"),re=!!t.horizontalPageBreak,xe=(p=t.horizontalPageBreakRepeat)!==null&&p!==void 0?p:null;return{includeHiddenHtml:(m=t.includeHiddenHtml)!==null&&m!==void 0?m:!1,useCss:te,theme:W,startY:V,margin:M,pageBreak:(y=t.pageBreak)!==null&&y!==void 0?y:"auto",rowPageBreak:(w=t.rowPageBreak)!==null&&w!==void 0?w:"auto",tableWidth:(A=t.tableWidth)!==null&&A!==void 0?A:"auto",showHead:U,showFoot:q,tableLineWidth:(I=t.tableLineWidth)!==null&&I!==void 0?I:0,tableLineColor:(R=t.tableLineColor)!==null&&R!==void 0?R:200,horizontalPageBreak:re,horizontalPageBreakRepeat:xe,horizontalPageBreakBehaviour:(k=t.horizontalPageBreakBehaviour)!==null&&k!==void 0?k:"afterAllRows"}}function jF(i,t){var r=i.getLastAutoTable(),a=i.scaleFactor(),n=i.pageNumber(),e=!1;if(r&&r.startPageNumber){var p=r.startPageNumber+r.pageNumber-1;e=p===n}return typeof t=="number"?t:(t==null||t===!1)&&e&&r?.finalY!=null?r.finalY+20/a:null}function OF(i,t,r){var a=t.head||[],n=t.body||[],e=t.foot||[];if(t.html){var p=t.includeHiddenHtml;if(r){var m=mA(i,t.html,r,p,t.useCss)||{};a=m.head||a,n=m.body||a,e=m.foot||a}else console.error("Cannot parse html in non browser environment")}var y=t.columns||LF(a,n,e);return{columns:y,head:a,body:n,foot:e}}function LF(i,t,r){var a=i[0]||t[0]||r[0]||[],n=[];return Object.keys(a).filter(function(e){return e!=="_element"}).forEach(function(e){var p=1,m;Array.isArray(a)?m=a[parseInt(e)]:m=a[e],typeof m=="object"&&!Array.isArray(m)&&(p=m?.colSpan||1);for(var y=0;y<p;y++){var w=void 0;Array.isArray(a)?w=n.length:w=e+(y>0?"_".concat(y):"");var A={dataKey:w};n.push(A)}}),n}var Pv=(function(){function i(t,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=t.getDocument()}return i})(),PF=(function(i){cA(t,i);function t(r,a,n,e,p,m){var y=i.call(this,r,a,m)||this;return y.cell=n,y.row=e,y.column=p,y.section=e.section,y}return t})(Pv),MF=(function(){function i(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return i.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(t)},0)},i.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(t)},0)},i.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},i.prototype.callCellHooks=function(t,r,a,n,e,p){for(var m=0,y=r;m<y.length;m++){var w=y[m],A=new PF(t,this,a,n,e,p),I=w(A)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],I)return!1}return!0},i.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var e=n[a];e(new Pv(t,this,r))}},i.prototype.callWillDrawPageHooks=function(t,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var e=n[a];e(new Pv(t,this,r))}},i.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,e){return n+e.wrappedWidth},0);return r}else{var a=this.settings.margin;return t-a.left-a.right}},i})(),yA=(function(){function i(t,r,a,n,e){e===void 0&&(e=!1),this.height=0,this.raw=t,t instanceof uA&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=e}return i.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(a,n){var e;return Math.max(a,((e=r.cells[n.index])===null||e===void 0?void 0:e.height)||0)},0)},i.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},i.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},i.prototype.getMinimumRowHeight=function(t,r){var a=this;return t.reduce(function(n,e){var p=a.cells[e.index];if(!p)return 0;var m=r.getLineHeight(p.styles.fontSize),y=p.padding("vertical"),w=y+m;return w>n?w:n},0)},i})(),vA=(function(){function i(t,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=t;var e=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,e=(n=t.content)!==null&&n!==void 0?n:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var p=e!=null?""+e:"",m=/\r\n|\r|\n/g;this.text=p.split(m)}return i.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:t}},i.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/t*r,e=a*n+this.padding("vertical");return Math.max(e,this.styles.minCellHeight)},i.prototype.padding=function(t){var r=qy(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},i})(),UF=(function(){function i(t,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=a}return i.prototype.getMaxCustomCellWidth=function(t){for(var r=0,a=0,n=t.allRows();a<n.length;a++){var e=n[a],p=e.cells[this.index];p&&typeof p.styles.cellWidth=="number"&&(r=Math.max(r,p.styles.cellWidth))}return r},i})();function BF(i,t){HF(i,t);var r=[],a=0;t.columns.forEach(function(e){var p=e.getMaxCustomCellWidth(t);p?e.width=p:(e.width=e.wrappedWidth,r.push(e)),a+=e.width});var n=t.getWidth(i.pageSize().width)-a;n&&(n=Mv(r,n,function(e){return Math.max(e.minReadableWidth,e.minWidth)})),n&&(n=Mv(r,n,function(e){return e.minWidth})),n=Math.abs(n),!t.settings.horizontalPageBreak&&n>.1/i.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),$F(t),qF(t,i),zF(t)}function HF(i,t){var r=i.scaleFactor(),a=t.settings.horizontalPageBreak,n=fA(i,t);t.allRows().forEach(function(e){for(var p=0,m=t.columns;p<m.length;p++){var y=m[p],w=e.cells[y.index];if(w){var A=t.hooks.didParseCell;t.callCellHooks(i,A,w,e,y,null);var I=w.padding("horizontal");w.contentWidth=fy(w.text,w.styles,i)+I;var R=fy(w.text.join(" ").split(/[^\S\u00A0]+/),w.styles,i);if(w.minReadableWidth=R+w.padding("horizontal"),typeof w.styles.cellWidth=="number")w.minWidth=w.styles.cellWidth,w.wrappedWidth=w.styles.cellWidth;else if(w.styles.cellWidth==="wrap"||a===!0)w.contentWidth>n?(w.minWidth=n,w.wrappedWidth=n):(w.minWidth=w.contentWidth,w.wrappedWidth=w.contentWidth);else{var k=10/r;w.minWidth=w.styles.minCellWidth||k,w.wrappedWidth=w.contentWidth,w.minWidth>w.wrappedWidth&&(w.wrappedWidth=w.minWidth)}}}}),t.allRows().forEach(function(e){for(var p=0,m=t.columns;p<m.length;p++){var y=m[p],w=e.cells[y.index];if(w&&w.colSpan===1)y.wrappedWidth=Math.max(y.wrappedWidth,w.wrappedWidth),y.minWidth=Math.max(y.minWidth,w.minWidth),y.minReadableWidth=Math.max(y.minReadableWidth,w.minReadableWidth);else{var A=t.styles.columnStyles[y.dataKey]||t.styles.columnStyles[y.index]||{},I=A.cellWidth||A.minCellWidth;I&&typeof I=="number"&&(y.minWidth=I,y.wrappedWidth=I)}w&&(w.colSpan>1&&!y.minWidth&&(y.minWidth=w.minWidth),w.colSpan>1&&!y.wrappedWidth&&(y.wrappedWidth=w.minWidth))}})}function Mv(i,t,r){for(var a=t,n=i.reduce(function(k,M){return k+M.wrappedWidth},0),e=0;e<i.length;e++){var p=i[e],m=p.wrappedWidth/n,y=a*m,w=p.width+y,A=r(p),I=w<A?A:w;t-=I-p.width,p.width=I}if(t=Math.round(t*1e10)/1e10,t){var R=i.filter(function(k){return t<0?k.width>r(k):!0});R.length&&(t=Mv(R,t,r))}return t}function zF(i){for(var t={},r=1,a=i.allRows(),n=0;n<a.length;n++)for(var e=a[n],p=0,m=i.columns;p<m.length;p++){var y=m[p],w=t[y.index];if(r>1)r--,delete e.cells[y.index];else if(w)w.cell.height+=e.height,r=w.cell.colSpan,delete e.cells[y.index],w.left--,w.left<=1&&delete t[y.index];else{var A=e.cells[y.index];if(!A)continue;if(A.height=e.height,A.rowSpan>1){var I=a.length-n,R=A.rowSpan>I?I:A.rowSpan;t[y.index]={cell:A,left:R,row:e}}}}}function $F(i){for(var t=i.allRows(),r=0;r<t.length;r++)for(var a=t[r],n=null,e=0,p=0,m=0;m<i.columns.length;m++){var y=i.columns[m];if(p-=1,p>1&&i.columns[m+1])e+=y.width,delete a.cells[y.index];else if(n){var w=n;delete a.cells[y.index],n=null,w.width=y.width+e}else{var w=a.cells[y.index];if(!w)continue;if(p=w.colSpan,e=0,w.colSpan>1){n=w,e+=y.width;continue}w.width=y.width+e}}}function qF(i,t){for(var r={count:0,height:0},a=0,n=i.allRows();a<n.length;a++){for(var e=n[a],p=0,m=i.columns;p<m.length;p++){var y=m[p],w=e.cells[y.index];if(w){t.applyStyles(w.styles,!0);var A=w.width-w.padding("horizontal");if(w.styles.overflow==="linebreak")w.text=t.splitTextToSize(w.text,A+1/t.scaleFactor(),{fontSize:w.styles.fontSize});else if(w.styles.overflow==="ellipsize")w.text=rw(w.text,A,w.styles,t,"...");else if(w.styles.overflow==="hidden")w.text=rw(w.text,A,w.styles,t,"");else if(typeof w.styles.overflow=="function"){var I=w.styles.overflow(w.text,A);typeof I=="string"?w.text=[I]:w.text=I}w.contentHeight=w.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var R=w.contentHeight/w.rowSpan;w.rowSpan>1&&r.count*r.height<R*w.rowSpan?r={height:R,count:w.rowSpan}:r&&r.count>0&&r.height>R&&(R=r.height),R>e.height&&(e.height=R)}}r.count--}}function rw(i,t,r,a,n){return i.map(function(e){return GF(e,t,r,a,n)})}function GF(i,t,r,a,n){var e=1e4*a.scaleFactor();if(t=Math.ceil(t*e)/e,t>=fy(i,r,a))return i;for(;t<fy(i+n,r,a)&&!(i.length<=1);)i=i.substring(0,i.length-1);return i.trim()+n}function bA(i,t){var r=new rp(i),a=VF(t,r.scaleFactor()),n=new MF(t,a);return BF(r,n),r.applyStyles(r.userStyles),n}function VF(i,t){var r=i.content,a=KF(r.columns);if(r.head.length===0){var n=nw(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=nw(a,"foot");n&&r.foot.push(n)}var e=i.settings.theme,p=i.styles;return{columns:a,head:B5("head",r.head,a,p,e,t),body:B5("body",r.body,a,p,e,t),foot:B5("foot",r.foot,a,p,e,t)}}function B5(i,t,r,a,n,e){var p={},m=t.map(function(y,w){for(var A=0,I={},R=0,k=0,M=0,V=r;M<V.length;M++){var q=V[M];if(p[q.index]==null||p[q.index].left===0)if(k===0){var U=void 0;Array.isArray(y)?U=y[q.index-R-A]:U=y[q.dataKey];var te={};typeof U=="object"&&!Array.isArray(U)&&(te=U?.styles||{});var W=YF(i,q,w,n,a,e,te),re=new vA(U,W,i);I[q.dataKey]=re,I[q.index]=re,k=re.colSpan-1,p[q.index]={left:re.rowSpan-1,times:k}}else k--,R++;else p[q.index].left--,k=p[q.index].times,A++}return new yA(y,w,i,I)});return m}function nw(i,t){var r={};return i.forEach(function(a){if(a.raw!=null){var n=WF(t,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function WF(i,t){if(i==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(i==="foot"&&typeof t=="object")return t.footer;return null}function KF(i){return i.map(function(t,r){var a,n;return typeof t=="object"?n=(a=t.dataKey)!==null&&a!==void 0?a:r:n=r,new UF(n,t,r)})}function YF(i,t,r,a,n,e,p){var m=CF(a),y;i==="head"?y=n.headStyles:i==="body"?y=n.bodyStyles:i==="foot"&&(y=n.footStyles);var w=gd({},m.table,m[i],n.styles,y),A=n.columnStyles[t.dataKey]||n.columnStyles[t.index]||{},I=i==="body"?A:{},R=i==="body"&&r%2===0?gd({},m.alternateRow,n.alternateRowStyles):{},k=AF(e),M=gd({},k,w,R,I);return gd(M,p)}function JF(i,t,r){var a;r===void 0&&(r={});var n=fA(i,t),e=new Map,p=[],m=[],y=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?y=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(y=[t.settings.horizontalPageBreakRepeat]),y.forEach(function(R){var k=t.columns.find(function(M){return M.dataKey===R||M.index===R});k&&!e.has(k.index)&&(e.set(k.index,!0),p.push(k.index),m.push(t.columns[k.index]),n-=k.wrappedWidth)});for(var w=!0,A=(a=r?.start)!==null&&a!==void 0?a:0;A<t.columns.length;){if(e.has(A)){A++;continue}var I=t.columns[A].wrappedWidth;if(w||n>=I)w=!1,p.push(A),m.push(t.columns[A]),n-=I;else break;A++}return{colIndexes:p,columns:m,lastIndex:A-1}}function QF(i,t){for(var r=[],a=0;a<t.columns.length;a++){var n=JF(i,t,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function xA(i,t){var r=t.settings,a=r.startY,n=r.margin,e={x:n.left,y:a},p=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),m=a+n.bottom+p;if(r.pageBreak==="avoid"){var y=t.body,w=y.reduce(function(R,k){return R+k.height},0);m+=w}var A=new rp(i);(r.pageBreak==="always"||r.startY!=null&&m>A.pageSize().height)&&(SA(A),e.y=n.top),t.callWillDrawPageHooks(A,e);var I=gd({},e);t.startPageNumber=A.pageNumber(),r.horizontalPageBreak?XF(A,t,I,e):(A.applyStyles(A.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(R){return Ad(A,t,R,e,t.columns)}),A.applyStyles(A.userStyles),t.body.forEach(function(R,k){var M=k===t.body.length-1;py(A,t,R,M,I,e,t.columns)}),A.applyStyles(A.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(R){return Ad(A,t,R,e,t.columns)})),hA(A,t,I,e),t.callEndPageHooks(A,e),t.finalY=e.y,i.lastAutoTable=t,A.applyStyles(A.userStyles)}function XF(i,t,r,a){var n=QF(i,t),e=t.settings;if(e.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(w,A){i.applyStyles(i.userStyles),A>0?Rm(i,t,r,a,w.columns,!0):aw(i,t,a,w.columns),ZF(i,t,r,a,w.columns),H5(i,t,a,w.columns)});else for(var p=-1,m=n[0],y=function(){var w=p;if(m){i.applyStyles(i.userStyles);var A=m.columns;p>=0?Rm(i,t,r,a,A,!0):aw(i,t,a,A),w=sw(i,t,p+1,a,A),H5(i,t,a,A)}var I=w-p;n.slice(1).forEach(function(R){i.applyStyles(i.userStyles),Rm(i,t,r,a,R.columns,!0),sw(i,t,p+1,a,R.columns,I),H5(i,t,a,R.columns)}),p=w};p<t.body.length-1;)y()}function aw(i,t,r,a){var n=t.settings;i.applyStyles(i.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&t.head.forEach(function(e){return Ad(i,t,e,r,a)})}function ZF(i,t,r,a,n){i.applyStyles(i.userStyles),t.body.forEach(function(e,p){var m=p===t.body.length-1;py(i,t,e,m,r,a,n)})}function sw(i,t,r,a,n,e){i.applyStyles(i.userStyles),e=e??t.body.length;var p=Math.min(r+e,t.body.length),m=-1;return t.body.slice(r,p).forEach(function(y,w){var A=r+w===t.body.length-1,I=wA(i,t,A,a);y.canEntireRowFit(I,n)&&(Ad(i,t,y,a,n),m=r+w)}),m}function H5(i,t,r,a){var n=t.settings;i.applyStyles(i.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&t.foot.forEach(function(e){return Ad(i,t,e,r,a)})}function eR(i,t,r){var a=r.getLineHeight(i.styles.fontSize),n=i.padding("vertical"),e=Math.floor((t-n)/a);return Math.max(0,e)}function tR(i,t,r,a){var n={};i.spansMultiplePages=!0,i.height=0;for(var e=0,p=0,m=r.columns;p<m.length;p++){var y=m[p],w=i.cells[y.index];if(w){Array.isArray(w.text)||(w.text=[w.text]);var A=new vA(w.raw,w.styles,w.section);A=gd(A,w),A.text=[];var I=eR(w,t,a);w.text.length>I&&(A.text=w.text.splice(I,w.text.length));var R=a.scaleFactor(),k=a.getLineHeightFactor();w.contentHeight=w.getContentHeight(R,k),w.contentHeight>=t&&(w.contentHeight=t,A.styles.minCellHeight-=t),w.contentHeight>i.height&&(i.height=w.contentHeight),A.contentHeight=A.getContentHeight(R,k),A.contentHeight>e&&(e=A.contentHeight),n[y.index]=A}}var M=new yA(i.raw,-1,i.section,n,!0);M.height=e;for(var V=0,q=r.columns;V<q.length;V++){var y=q[V],A=M.cells[y.index];A&&(A.height=M.height);var w=i.cells[y.index];w&&(w.height=i.height)}return M}function rR(i,t,r,a){var n=i.pageSize().height,e=a.settings.margin,p=e.top+e.bottom,m=n-p;t.section==="body"&&(m-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var y=t.getMinimumRowHeight(a.columns,i),w=y<r;if(y>m)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!w)return!1;var A=t.hasRowSpan(a.columns),I=t.getMaxCellHeight(a.columns)>m;return I?(A&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(A||a.settings.rowPageBreak==="avoid")}function py(i,t,r,a,n,e,p){var m=wA(i,t,a,e);if(r.canEntireRowFit(m,p))Ad(i,t,r,e,p);else if(rR(i,r,m,t)){var y=tR(r,m,t,i);Ad(i,t,r,e,p),Rm(i,t,n,e,p),py(i,t,y,a,n,e,p)}else Rm(i,t,n,e,p),py(i,t,r,a,n,e,p)}function Ad(i,t,r,a,n){a.x=t.settings.margin.left;for(var e=0,p=n;e<p.length;e++){var m=p[e],y=r.cells[m.index];if(!y){a.x+=m.width;continue}i.applyStyles(y.styles),y.x=a.x,y.y=a.y;var w=t.callCellHooks(i,t.hooks.willDrawCell,y,r,m,a);if(w===!1){a.x+=m.width;continue}nR(i,y,a);var A=y.getTextPos();lA(y.text,A.x,A.y,{halign:y.styles.halign,valign:y.styles.valign,maxWidth:Math.ceil(y.width-y.padding("left")-y.padding("right"))},i.getDocument()),t.callCellHooks(i,t.hooks.didDrawCell,y,r,m,a),a.x+=m.width}a.y+=r.height}function nR(i,t,r){var a=t.styles;if(i.getDocument().setFillColor(i.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=dA(a.lineWidth,a.fillColor);n&&i.rect(t.x,r.y,t.width,t.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&i.rect(t.x,r.y,t.width,t.height,"F"),aR(i,t,r,a.lineWidth))}function aR(i,t,r,a){var n,e,p,m;a.top&&(n=r.x,e=r.y,p=r.x+t.width,m=r.y,a.right&&(p+=.5*a.right),a.left&&(n-=.5*a.left),y(a.top,n,e,p,m)),a.bottom&&(n=r.x,e=r.y+t.height,p=r.x+t.width,m=r.y+t.height,a.right&&(p+=.5*a.right),a.left&&(n-=.5*a.left),y(a.bottom,n,e,p,m)),a.left&&(n=r.x,e=r.y,p=r.x,m=r.y+t.height,a.top&&(e-=.5*a.top),a.bottom&&(m+=.5*a.bottom),y(a.left,n,e,p,m)),a.right&&(n=r.x+t.width,e=r.y,p=r.x+t.width,m=r.y+t.height,a.top&&(e-=.5*a.top),a.bottom&&(m+=.5*a.bottom),y(a.right,n,e,p,m));function y(w,A,I,R,k){i.getDocument().setLineWidth(w),i.getDocument().line(A,I,R,k,"S")}}function wA(i,t,r,a){var n=t.settings.margin.bottom,e=t.settings.showFoot;return(e==="everyPage"||e==="lastPage"&&r)&&(n+=t.getFootHeight(t.columns)),i.pageSize().height-a.y-n}function Rm(i,t,r,a,n,e){n===void 0&&(n=[]),e===void 0&&(e=!1),i.applyStyles(i.userStyles),t.settings.showFoot==="everyPage"&&!e&&t.foot.forEach(function(m){return Ad(i,t,m,a,n)}),t.callEndPageHooks(i,a);var p=t.settings.margin;hA(i,t,r,a),SA(i),t.pageNumber++,a.x=p.left,a.y=p.top,r.y=p.top,t.callWillDrawPageHooks(i,a),t.settings.showHead==="everyPage"&&(t.head.forEach(function(m){return Ad(i,t,m,a,n)}),i.applyStyles(i.userStyles))}function SA(i){var t=i.pageNumber();i.setPage(t+1);var r=i.pageNumber();return r===t?(i.addPage(),!0):!1}function sR(i){i.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=t[0],n=gA(this,a),e=bA(this,n);return xA(this,e),this},i.API.lastAutoTable=!1,i.API.autoTableText=function(t,r,a,n){lA(t,r,a,n,this)},i.API.autoTableSetDefaults=function(t){return rp.setDefaults(t,this),this},i.autoTableSetDefaults=function(t,r){rp.setDefaults(t,r)},i.API.autoTableHtmlToJson=function(t,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new rp(this),e=mA(n,t,window,r,!1),p=e.head,m=e.body,y=((a=p[0])===null||a===void 0?void 0:a.map(function(w){return w.content}))||[];return{columns:y,rows:m,data:m}}}var z5;function jm(i,t){var r=gA(i,t),a=bA(i,r);xA(i,a)}try{if(typeof window<"u"&&window){var iw=window,ow=iw.jsPDF||((z5=iw.jspdf)===null||z5===void 0?void 0:z5.jsPDF);ow&&sR(ow)}}catch(i){console.error("Could not apply autoTable plugin",i)}const Gu={CHECK_IN_WINDOW_MINS:60,CHECK_OUT_WINDOW_MINS:120,MIN_WORK_DURATION_MINS:240},AA=i=>{const t=i.getDay();return t===0||t===6},lw=(i,t)=>{const r=i.timeZone||"Asia/Kolkata";let a;try{a=t.toLocaleString("en-US",{timeZone:r})}catch{console.error(`Invalid timezone: ${r}, falling back to UTC`),a=t.toLocaleString("en-US",{timeZone:"UTC"})}const n=new Date(a),[e,p]=i.startTime.split(":").map(Number),[m,y]=i.endTime.split(":").map(Number),w=new Date(n);w.setHours(e,p,0,0);const A=new Date(n);A.setHours(m,y,0,0),A<=w&&A.setDate(A.getDate()+1);const I=new Date(w.getTime()-Gu.CHECK_IN_WINDOW_MINS*60*1e3),R=new Date(A.getTime()+Gu.CHECK_OUT_WINDOW_MINS*60*1e3);return{checkInOpen:I,checkOutClose:R,shiftStart:w,shiftEnd:A,currentTargetTime:n}},CA=(i,t)=>{const r=i.timeZone||"Asia/Kolkata";let a;try{a=t.toLocaleString("en-US",{timeZone:r})}catch{a=t.toLocaleString("en-US",{timeZone:"UTC"})}const n=new Date(a);if(AA(n))return{state:"WEEKEND",message:"Weekend - Enjoy your break!"};const e=new Date(n);e.setDate(e.getDate()-1);const p=lw(i,e);if(n>=p.checkInOpen&&n<=p.checkOutClose)return{state:"ACTIVE",window:p,timeZone:r};const m=lw(i,n);if(n>=m.checkInOpen&&n<=m.checkOutClose)return{state:"ACTIVE",window:m,timeZone:r};if(n<m.checkInOpen){const y=Math.ceil((m.shiftStart.getTime()-n.getTime())/6e4);let w=`Shift starts at ${i.startTime}`;if(y<=Gu.CHECK_IN_WINDOW_MINS)w=`Check-in opens in ${y} minutes`;else if(y>60){const A=Math.floor(y/60);w=`Check-in opens in ${A} hour${A>1?"s":""}`}return{state:"UPCOMING",message:w,timeZone:r}}return{state:"CLOSED",message:"Attendance Closed for the day",timeZone:r}},Oh=({isOpen:i,onClose:t,type:r,title:a,message:n})=>i?h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm animate-fade-in",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full text-center transform transition-all scale-100 animate-scale-up border-t-8 border-transparent",style:{borderColor:r==="success"?"#22c55e":"#ef4444"},children:[h.jsx("div",{className:"flex justify-center mb-4",children:r==="success"?h.jsx("div",{className:"bg-green-100 p-4 rounded-full",children:h.jsx(Pc,{className:"text-5xl text-green-500"})}):h.jsx("div",{className:"bg-red-100 p-4 rounded-full",children:h.jsx(Jm,{className:"text-5xl text-red-500"})})}),h.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:a}),h.jsx("p",{className:"text-gray-600 mb-6 text-sm leading-relaxed",children:n}),h.jsx("button",{onClick:t,className:`w-full py-3 rounded-xl font-semibold text-white shadow-md transition-all transform hover:-translate-y-1 ${r==="success"?"bg-green-500 hover:bg-green-600 shadow-green-200":"bg-red-500 hover:bg-red-600 shadow-red-200"}`,children:r==="success"?"Continue":"Try Again"})]})}):null,iR=({records:i,currentDate:t=new Date})=>{const[r]=le.useState(t),a=k=>{const M=k.getFullYear(),V=k.getMonth();return new Date(M,V+1,0).getDate()},n=k=>{const M=k.getFullYear(),V=k.getMonth();return new Date(M,V,1).getDay()},e=a(r),p=n(r),m=r.toLocaleString("default",{month:"long"}),y=r.getFullYear(),w=le.useMemo(()=>{const k=new Map;return i.forEach(M=>{k.set(M.date,M)}),k},[i]),A=k=>{if(!k)return{};const M=k.toLowerCase();return M==="in"||M==="checked in"||M==="half-day"||M==="half day"?{bg:"bg-yellow-500",text:"text-white"}:M==="present"||M==="on time"?{bg:"bg-green-500",text:"text-white"}:M==="absent"||M.includes("leave")?{bg:"bg-red-500",text:"text-white"}:M==="holiday"?{bg:"bg-blue-500",text:"text-white"}:{bg:"bg-gray-100",text:"text-gray-600"}},I=k=>{const M=`${k.toString().padStart(2,"0")}/${(r.getMonth()+1).toString().padStart(2,"0")}/${y}`,V=w.get(M),q=k===new Date().getDate()&&r.getMonth()===new Date().getMonth()&&r.getFullYear()===new Date().getFullYear(),U=V?A(V.status):null,te=new Date(y,r.getMonth(),k).getDay()===0||new Date(y,r.getMonth(),k).getDay()===6;return{dateStr:M,record:V,isToday:q,statusStyle:U,isWeekend:te}},R=[];for(let k=0;k<p;k++)R.push(h.jsx("div",{className:"h-10"},`empty-${k}`));for(let k=1;k<=e;k++){const{record:M,statusStyle:V,isWeekend:q}=I(k),te=(p+k-1)%7;let W="left-1/2 transform -translate-x-1/2",re="left-1/2 transform -translate-x-1/2";te===0||te===1?(W="left-0 transform translate-x-[-10%]",re="left-5"):(te===5||te===6)&&(W="right-0 transform translate-x-[10%]",re="right-5");let xe="";V&&V.bg?xe=`${V.bg} ${V.text} shadow-sm`:q?xe="bg-blue-500 text-white shadow-sm":xe="text-gray-700 hover:bg-gray-100",R.push(h.jsxs("div",{className:"relative group",children:[h.jsx("div",{className:`
                        h-10 w-10 mx-auto flex items-center justify-center rounded-full text-sm font-bold transition-all duration-200 cursor-default
                        ${xe}
                    `,children:k}),M&&h.jsxs("div",{className:`absolute z-50 bottom-full mb-2 hidden group-hover:block w-32 bg-white rounded-lg shadow-xl border border-gray-100 p-2 animate-fade-in-up ${W}`,children:[h.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-1 uppercase tracking-wider text-center",children:M.date}),h.jsx("div",{className:`text-center font-bold mb-2 ${(()=>{const ve=M.status?.trim().toLowerCase()||"";return ve==="present"||ve==="on time"?"text-green-600":ve==="in"||ve==="checked in"||ve==="half-day"||ve==="half day"?"text-yellow-500":ve==="absent"?"text-red-500":ve==="holiday"?"text-blue-500":ve.includes("leave")?"text-purple-500":"text-gray-700"})()}`,children:(()=>{const ve=M.status?.trim().toLowerCase()||"";return ve==="in"||ve==="checked in"||ve==="half-day"||ve==="half day"?"Half Day":M.status})()}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex justify-between text-xs",children:[h.jsx("span",{className:"text-gray-500",children:"In:"}),h.jsx("span",{className:"font-mono font-medium text-gray-800",children:M.checkInTime||"--:--"})]}),h.jsxs("div",{className:"flex justify-between text-xs",children:[h.jsx("span",{className:"text-gray-500",children:"Out:"}),h.jsx("span",{className:"font-mono font-medium text-gray-800",children:M.checkOutTime||"--:--"})]})]}),h.jsx("div",{className:`absolute top-full border-8 border-transparent border-t-white ${re}`})]})]},k))}return h.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col h-full",children:[h.jsx("div",{className:"p-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between",children:h.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[h.jsx(ux,{className:"text-blue-500"}),m," ",h.jsx("span",{className:"text-gray-400 font-normal",children:y})]})}),h.jsxs("div",{className:"p-5",children:[h.jsx("div",{className:"grid grid-cols-7 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(k=>h.jsx("div",{className:"text-center text-xs font-bold text-gray-400 uppercase tracking-wider",children:k},k))}),h.jsx("div",{className:"grid grid-cols-7 gap-y-2",children:R})]}),h.jsxs("div",{className:"mt-auto p-4 bg-gray-50 border-t border-gray-100 text-xs text-gray-500 flex flex-wrap justify-center gap-3",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500"})," Half Day"]}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Present"]}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"})," Absent/Leave"]}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})," Holiday/Weekend"]})]})]})},oR=(i,t)=>{if(!t)return!1;try{const[r,a,n]=i.split("/"),e=new Date(parseInt(n),parseInt(a)-1,parseInt(r)),[p,m]=t.endTime.split(":").map(Number),y=new Date(e);y.setHours(p,m,0,0);const w=new Date(y.getTime()+Gu.CHECK_OUT_WINDOW_MINS*60*1e3);return new Date>w}catch(r){return console.error("Error checking attendance window:",r),!1}},lR=()=>{const{accounts:i}=Cd(),[t,r]=le.useState(new Date),[a,n]=le.useState(null),[e,p]=le.useState(null),[m,y]=le.useState("LOADING"),[w,A]=le.useState(""),[I,R]=le.useState(!1),[k,M]=le.useState(null),[V,q]=le.useState("00:00:00"),[U,te]=le.useState(!1),[W,re]=le.useState(!1),[xe,ve]=le.useState(""),[De,ke]=le.useState(""),[de,Oe]=le.useState([]),[z,K]=le.useState(!1),[Ae,Ce]=le.useState(0),[Be,Ee]=le.useState([]),[Pe,Ue]=le.useState({isOpen:!1,type:"success",title:"",message:""}),[_e,Le]=le.useState(!1),[X,H]=le.useState(""),[ae,Z]=le.useState(!1),[se,ye]=le.useState([]),[ce,ze]=le.useState(!1),pe=()=>{const Qe=new Date().getHours();return Qe<12?"Good Morning":Qe<18?"Good Afternoon":"Good Evening"};le.useEffect(()=>{(async()=>{if(!i||i.length===0)return;const Rt=i[0].username;try{const er=(await cr.getAllEmployees()).find(nr=>nr.email?.toLowerCase()===Rt.toLowerCase());if(er){if(p(er),er.shiftId){const _r=(await cr.getAllShifts()).find(Ar=>Ar.id===er.shiftId);_r&&n(_r)}const nr=await cr.getTodayAttendance(er.id),Sr=new Date().getDay(),kr=Sr===0||Sr===6;nr&&!nr.checkOutTime&&(nr.status?.trim().toUpperCase()==="IN"||nr.status?.toLowerCase().includes("checked in"))?(R(!0),M(nr),y("ACTIVE")):nr&&nr.status?.trim().toLowerCase()==="holiday"?(y("HOLIDAY"),A("Holiday")):nr&&nr.status&&nr.status.toLowerCase().includes("leave")?y("ON_LEAVE"):nr&&nr.status?.trim().toLowerCase()==="absent"?y("ABSENT"):nr&&nr.checkOutTime?(y("COMPLETED"),M(nr)):kr&&!nr&&y("WEEKEND")}}catch(Ct){console.error("Failed to load profile",Ct)}})()},[i]),le.useEffect(()=>{if(!e)return;(async()=>{const Rt=new Date,Ct=Rt.getMonth()+1,er=Rt.getFullYear(),nr=`01/${Ct.toString().padStart(2,"0")}/${er}`,Sr=`${new Date(er,Ct,0).getDate().toString().padStart(2,"0")}/${Ct.toString().padStart(2,"0")}/${er}`;ve(nr);const _r=`${new Date().getDate().toString().padStart(2,"0")}/${Ct.toString().padStart(2,"0")}/${er}`;ke(_r),await Ve(e.id,nr,Sr);const Ar=await cr.getRegularizationCount(e.id,Ct,er);Ce(Ar);const ra=await cr.getAttendanceHistory(e.id,nr,_r),Nn=`${new Date().getDate().toString().padStart(2,"0")}/${(new Date().getMonth()+1).toString().padStart(2,"0")}/${new Date().getFullYear()}`,xr=ra.filter(an=>an.checkInTime&&!an.checkOutTime&&an.date!==Nn).sort((an,Lr)=>{const[Jn,on,gn]=an.date.split("/").map(Number),[xa,fn,Wr]=Lr.date.split("/").map(Number),Jt=new Date(gn,on-1,Jn),bo=new Date(Wr,fn-1,xa);return Jt.getTime()-bo.getTime()});Ee(xr)})()},[e]);const Ve=async(Qe,Rt,Ct)=>{K(!0);try{const nr=(await cr.getAttendanceHistory(Qe,Rt,Ct)).sort((ur,Sr)=>{const[kr,ar,_r]=ur.date.split("/").map(Number),[Ar,ra,Nn]=Sr.date.split("/").map(Number),Qr=new Date(_r,ar-1,kr),xr=new Date(Nn,ra-1,Ar);return Qr.getTime()-xr.getTime()});Oe(nr)}catch(er){console.error("Failed to load attendance history",er)}finally{K(!1)}},yt=async()=>{!e||!xe||!De||await Ve(e.id,xe,De)},vt=()=>{if(!e||de.length===0)return;const Qe=new en,Rt=Qe.internal.pageSize.getWidth(),Ct=Qe.internal.pageSize.getHeight();Qe.setDrawColor(200,200,200),Qe.setLineWidth(.5),Qe.roundedRect(10,10,Rt-20,Ct-20,3,3,"S"),Qe.setFillColor(41,128,185),Qe.roundedRect(10,10,Rt-20,60,3,3,"F");const er=new Image;er.src="/jm-logo.png",er.onload=()=>{const Sr=(Rt-30)/2;Qe.addImage(er,"PNG",Sr,18,30,20),Qe.setTextColor(255,255,255),Qe.setFontSize(24),Qe.setFont("helvetica","bold"),Qe.text("J&M GROUP INC",Rt/2,48,{align:"center"}),Qe.setFontSize(14),Qe.setFont("helvetica","normal"),Qe.text("Attendance Report",Rt/2,58,{align:"center"}),Qe.setTextColor(0,0,0),Qe.setFontSize(11),Qe.setFont("helvetica","bold"),Qe.text(`Employee: ${e.name}`,20,83),Qe.text(`Period: ${xe} to ${De}`,Rt-20,83,{align:"right"});const kr=de.map(ra=>[ra.date,e.name,ra.checkInTime||"-",ra.checkOutTime||"-",ra.status||"Pending"]);jm(Qe,{startY:93,head:[["Date","Employee","Check In","Check Out","Status"]],body:kr,theme:"grid",headStyles:{fillColor:[41,128,185],textColor:255,fontSize:10,fontStyle:"bold",halign:"center"},bodyStyles:{fontSize:9,halign:"center"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:20,right:20}});const _r=Qe.lastAutoTable?.finalY||150;Qe.setFontSize(9),Qe.setTextColor(128,128,128),Qe.text(" 2025 J&M Group Inc.",Rt/2,_r+20,{align:"center"});const Ar=`Attendance_Report_${e.name}_${xe.replace(/\//g,"-")}_to_${De.replace(/\//g,"-")}.pdf`;Qe.save(Ar)},er.onerror=()=>{Qe.setTextColor(255,255,255),Qe.setFontSize(24),Qe.setFont("helvetica","bold"),Qe.text("J&M GROUP INC",Rt/2,40,{align:"center"}),Qe.setFontSize(14),Qe.setFont("helvetica","normal"),Qe.text("Attendance Report",Rt/2,52,{align:"center"}),Qe.setTextColor(0,0,0),Qe.setFontSize(11),Qe.setFont("helvetica","bold"),Qe.text(`Employee: ${e.name}`,20,75),Qe.text(`Period: ${xe} to ${De}`,Rt-20,75,{align:"right"});const nr=de.map(ar=>[ar.date,e.name,ar.checkInTime||"-",ar.checkOutTime||"-",ar.status||"Pending"]);jm(Qe,{startY:85,head:[["Date","Employee","Check In","Check Out","Status"]],body:nr,theme:"grid",headStyles:{fillColor:[41,128,185],textColor:255,fontSize:10,fontStyle:"bold",halign:"center"},bodyStyles:{fontSize:9,halign:"center"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:20,right:20}});const Sr=Qe.lastAutoTable?.finalY||150;Qe.setFontSize(9),Qe.setTextColor(128,128,128),Qe.text(" 2025 J&M Group Inc.",Rt/2,Sr+20,{align:"center"});const kr=`Attendance_Report_${e.name}_${xe.replace(/\//g,"-")}_to_${De.replace(/\//g,"-")}.pdf`;Qe.save(kr)}},bt=async Qe=>{if(e)try{await cr.requestRegularization(Qe.id);const Rt=new Date,Ct=await cr.getRegularizationCount(e.id,Rt.getMonth()+1,Rt.getFullYear());if(Ce(Ct),xe&&De){await Ve(e.id,xe,De);const nr=(await cr.getAttendanceHistory(e.id,xe,De)).filter(ur=>ur.checkInTime&&!ur.checkOutTime);Ee(nr)}Ue({isOpen:!0,type:"success",title:"Regularization Successful",message:"Your attendance has been regularized successfully."})}catch(Rt){Ue({isOpen:!0,type:"error",title:"Regularization Failed",message:Rt.message||"Failed to process regularization request."})}},Ft=async()=>{if(!(!i||i.length===0)){ze(!0),Z(!0);try{const Qe=await cr.getRegularizationHistory(i[0].username);ye(Qe)}catch(Qe){console.error("Error fetching history:",Qe),Ue({isOpen:!0,type:"error",title:"Error",message:"Failed to fetch regularization history."})}finally{ze(!1)}}},Te=async()=>{if(e)try{const Qe=new Date,Rt=`${Qe.getFullYear()}-${(Qe.getMonth()+1).toString().padStart(2,"0")}-${Qe.getDate().toString().padStart(2,"0")}`;await cr.submitCheckInRegularization({employeeName:e.name,mailID:e.email,date:Rt,manager:e.reportingManager||"Not Assigned",reason:X}),Le(!1),H(""),Ue({isOpen:!0,type:"success",title:"Request Submitted",message:"Your check-in regularization request has been submitted successfully."})}catch(Qe){Ue({isOpen:!0,type:"error",title:"Submission Failed",message:Qe.message||"Failed to submit regularization request."})}};le.useEffect(()=>{const Qe=setInterval(()=>{const Rt=new Date;r(Rt);const Ct=Rt.getDay(),er=Ct===0||Ct===6;if(!(m==="HOLIDAY"||m==="ON_LEAVE"||m==="ABSENT")){if(k&&k.checkOutTime)m!=="COMPLETED"&&y("COMPLETED");else if(er&&!I)m!=="WEEKEND"&&y("WEEKEND");else if(a&&!I){const{state:nr,message:ur}=CA(a,Rt);nr!==m&&(y(nr),A(ur||""))}}if(I&&k?.checkInTime&&k?.date)try{const[nr,ur]=k.checkInTime.split(" "),[Sr,kr]=nr.split(":");let ar=parseInt(Sr);const _r=parseInt(kr);ur==="PM"&&ar<12&&(ar+=12),ur==="AM"&&ar===12&&(ar=0);const[Ar,ra,Nn]=k.date.split("/").map(Number),Qr=new Date(Nn,ra-1,Ar,ar,_r,0,0);let xr=Rt.getTime()-Qr.getTime();xr<0&&(xr=0);const an=Math.floor(xr/36e5),Lr=Math.floor(xr%36e5/6e4),Jn=Math.floor(xr%6e4/1e3);q(`${an.toString().padStart(2,"0")}:${Lr.toString().padStart(2,"0")}:${Jn.toString().padStart(2,"0")}`)}catch(nr){console.error("Error calculating elapsed time:",nr),q("00:00:00")}},1e3);return()=>clearInterval(Qe)},[a,I,k,m]);const Ht=async()=>{if(!(!a||!e||U)){te(!0);try{const Qe=await cr.checkIn(e.id,a.id,e.name,e.place,e.email);M(Qe),R(!0),Ue({isOpen:!0,type:"success",title:"Check-In Successful",message:`You have checked in at ${Qe.checkInTime}.`})}catch(Qe){const Rt=Qe;console.error(Rt),Ue({isOpen:!0,type:"error",title:"Check-In Failed",message:Rt.message||"An unexpected error occurred."})}finally{te(!1)}}},Or=async()=>{if(!(!k||!e||U)){te(!0);try{await cr.checkOut(k.id,k.checkInTime||"",k.date||"",a?.startTime,a?.endTime);const Qe=await cr.getTodayAttendance(e.id);R(!1),M(Qe),q("00:00:00"),y("COMPLETED"),re(!0),Ue({isOpen:!0,type:"success",title:"Shift Completed",message:"You have successfully checked out. Good job!"})}catch(Qe){const Rt=Qe;console.error(Rt),Ue({isOpen:!0,type:"error",title:"Check-Out Failed",message:Rt.message||'Please check that the "WorkingHours" column exists in the SharePoint list.'})}finally{te(!1)}}},Vr=async()=>{if(Ue({...Pe,isOpen:!1}),W&&e){const Qe=await cr.getTodayAttendance(e.id);Qe&&Qe.checkOutTime&&(M(Qe),y("COMPLETED"),R(!1)),re(!1)}if(e){const Qe=new Date,Rt=Qe.getMonth()+1,Ct=Qe.getFullYear(),er=`01/${Rt.toString().padStart(2,"0")}/${Ct}`,ur=`${Qe.getDate().toString().padStart(2,"0")}/${Rt.toString().padStart(2,"0")}/${Ct}`;await Ve(e.id,er,ur)}},Mt=()=>{if(!a)return 0;try{const[Qe,Rt]=a.startTime.split(" "),[Ct,er]=Qe.split(":");let nr=parseInt(Ct);const ur=parseInt(er);Rt==="PM"&&nr<12&&(nr+=12),Rt==="AM"&&nr===12&&(nr=0);const Sr=new Date,kr=new Date(Sr);kr.setHours(nr,ur,0,0);let ar=Sr.getTime()-kr.getTime();return ar<0&&(ar=0),Math.floor(ar/(60*1e3))}catch(Qe){return console.error("Error calculating effective work mins:",Qe),0}},zr=()=>{if(!e)return h.jsx("div",{className:"text-gray-400",children:"Loading Profile..."});if(m==="LOADING")return h.jsxs("div",{className:"flex flex-col items-center animate-pulse",children:[h.jsx("p",{className:"text-gray-400",children:"Loading Shift..."}),!a&&h.jsx("p",{className:"text-xs text-red-300 mt-2",children:"If this persists, verify you have a Shift assigned in Directory."})]});if(m==="WEEKEND")return h.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center text-gray-500",children:[h.jsx(U4,{className:"text-6xl mb-4 text-brand-300"}),h.jsx("h2",{className:"text-2xl font-bold text-gray-700",children:"It's the Weekend!"}),h.jsx("p",{children:"No check-ins required. Enjoy your time off."})]});if(m==="CLOSED")return h.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[h.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:h.jsx(Z_,{className:"text-4xl text-gray-400"})}),h.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Attendance Closed"}),h.jsx("p",{className:"text-gray-500 max-w-md",children:w})]});if(m==="HOLIDAY")return h.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center text-gray-500",children:[h.jsx(fx,{className:"text-6xl mb-4 text-blue-400"}),h.jsx("h2",{className:"text-2xl font-bold text-gray-700",children:"It's a Holiday!"}),h.jsx("p",{className:"text-lg font-medium text-blue-600 mb-2",children:w}),h.jsx("p",{children:"Enjoy your day off."})]});if(m==="ON_LEAVE")return h.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center text-gray-500",children:[h.jsx(S9,{className:"text-6xl mb-4 text-purple-400"}),h.jsx("h2",{className:"text-2xl font-bold text-gray-700",children:"You are on Leave"}),h.jsx("p",{children:"Relax and enjoy your time off."})]});if(m==="ABSENT")return h.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center text-gray-500",children:[h.jsx(E9,{className:"text-6xl mb-4 text-red-400"}),h.jsx("h2",{className:"text-2xl font-bold text-gray-700",children:"Marked as Absent"}),h.jsx("p",{children:"You have been marked absent for today."})]});if(m==="COMPLETED")return h.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[h.jsx("div",{className:"w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mb-6",children:h.jsx($1,{className:"text-4xl text-green-500"})}),h.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Shift Completed"}),h.jsx("p",{className:"text-gray-500 max-w-md",children:"Great job today! You have checked out."}),h.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg w-full max-w-xs",children:[h.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[h.jsx("span",{className:"text-gray-500",children:"Login"}),h.jsx("span",{className:"font-bold text-gray-800",children:k?.checkInTime||"--"})]}),h.jsxs("div",{className:"flex justify-between text-sm",children:[h.jsx("span",{className:"text-gray-500",children:"Logout"}),h.jsx("span",{className:"font-bold text-gray-800",children:k?.checkOutTime||"--"})]})]})]});if(m==="ACTIVE"||m==="UPCOMING"||I){let Qe=!1;if(I)Qe=!0;else if(a){const Rt=new Date,[Ct,er]=a.startTime.split(" "),[nr,ur]=Ct.split(":");let Sr=parseInt(nr);const kr=parseInt(ur);er==="PM"&&Sr<12&&(Sr+=12),er==="AM"&&Sr===12&&(Sr=0);const ar=new Date;ar.setHours(Sr,kr,0,0);const _r=new Date(ar.getTime()-3600*1e3);Rt>=_r&&(Qe=!0)}if(!Qe){const Rt=Gu.CHECK_IN_WINDOW_MINS,Ct=`${Math.floor(Rt/60)} hour`;return h.jsxs("div",{className:"text-center text-gray-500",children:[h.jsx("p",{children:"Attendance is not yet open for your shift."}),h.jsxs("p",{className:"text-sm",children:["Opens ",Ct," before ",a?.startTime]})]})}return h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:`mb-8 px-6 py-2 rounded-full text-sm font-bold tracking-wide transition-all duration-300 ${I?"bg-green-100 text-green-700 shadow-inner":"bg-blue-100 text-blue-700"}`,children:I?" ON DUTY":" READY TO START"}),h.jsxs("button",{onClick:I?Or:Ht,disabled:I&&Mt()<Gu.MIN_WORK_DURATION_MINS,className:`group relative flex items-center justify-center w-64 h-64 rounded-full transition-all duration-500 transform hover:scale-105 active:scale-95 shadow-2xl ${I?"bg-gradient-to-br from-red-500 to-rose-600 shadow-red-200 disabled:from-gray-400 disabled:to-gray-500 disabled:shadow-none disabled:cursor-not-allowed":"bg-gradient-to-br from-brand-600 to-brand-800 shadow-brand-200"}`,children:[!I&&h.jsx("span",{className:"absolute w-full h-full rounded-full opacity-0 group-hover:opacity-20 animate-ping bg-white"}),I&&Mt()>=Gu.MIN_WORK_DURATION_MINS&&h.jsx("span",{className:"absolute w-full h-full rounded-full opacity-0 group-hover:opacity-20 animate-ping bg-white"}),h.jsxs("div",{className:"flex flex-col items-center text-white",children:[h.jsx("div",{className:"text-5xl mb-3 filter drop-shadow-md",children:I?h.jsx(U4,{className:"transform group-hover:rotate-12 transition-transform duration-300"}):h.jsx(h9,{className:"transform group-hover:scale-110 transition-transform duration-300"})}),h.jsx("span",{className:"text-2xl font-bold tracking-tight",children:I?"Check Out":"Check In"}),I&&(()=>{const Rt=Mt();if(Rt<Gu.MIN_WORK_DURATION_MINS){const Ct=Math.ceil(Gu.MIN_WORK_DURATION_MINS-Rt);if(Ct>60){const er=Math.floor(Ct/60),nr=Ct%60;return h.jsxs("span",{className:"text-xs mt-1 text-white/80 italic",children:["Enabled in ",er,"h ",nr,"m"]})}return h.jsxs("span",{className:"text-xs mt-1 text-white/80 italic",children:["Enabled in ",Ct," min",Ct>1?"s":""]})}return null})(),I&&h.jsxs("div",{className:"flex flex-col items-center mt-2",children:[h.jsx("span",{className:"font-mono text-lg opacity-90 font-medium tracking-wider",title:"Working Hours",children:V}),k?.checkInTime&&h.jsxs("span",{className:"text-xs opacity-75 mt-1 font-mono",children:["Login: ",k.checkInTime]})]}),!I&&a&&h.jsxs("span",{className:"mt-2 text-xs opacity-70",children:["Shift: ",a.startTime," - ",a.endTime]})]})]}),!I&&h.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"Check-In available"})]})}return null};return h.jsxs("div",{className:"min-h-full bg-gray-50/50 p-4 md:p-8 relative",children:[h.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-brand-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"}),h.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"}),h.jsxs("div",{className:"relative z-10 max-w-[1600px] mx-auto space-y-8",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end pb-8 border-b border-gray-200",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:[pe(),", ",h.jsx("span",{className:"text-indigo-600",children:e?.name?.split(" ")[0]||i[0]?.name?.split(" ")[0]||"Employee"})]}),h.jsx("p",{className:"text-gray-500 mt-2 font-medium",children:"Welcome back to your dashboard."})]}),h.jsxs("div",{className:"text-right hidden md:block",children:[h.jsx("div",{className:"text-xs font-semibold text-gray-400 uppercase tracking-widest mb-1",children:"Current Time"}),h.jsx("div",{className:"text-3xl font-mono font-bold text-gray-800 tabular-nums tracking-tighter",children:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),h.jsx("div",{className:"text-sm text-indigo-600 font-medium mt-1",children:t.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8 items-stretch",children:[h.jsx("div",{className:"xl:col-span-2 bg-white rounded-2xl shadow-sm border border-gray-200 p-8 flex flex-col justify-center",children:h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center h-full",children:[h.jsx("div",{className:"flex flex-col items-center justify-center min-h-[350px]",children:zr()}),h.jsxs("div",{className:"flex flex-col justify-center h-full border-l border-gray-100 pl-8",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("h3",{className:"font-bold text-lg text-gray-900 flex items-center",children:[h.jsx($1,{className:"mr-3 text-indigo-500"})," Shift Information"]}),h.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[h.jsxs("button",{onClick:()=>Le(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors duration-200",title:"Submit check-in regularization request",children:[h.jsx(Cf,{className:"text-sm"}),"Missed Check-in?"]}),h.jsx("button",{onClick:Ft,className:"text-[11px] font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors mr-1",children:"View Status"})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"p-5 bg-gray-50 rounded-xl border border-gray-100 group hover:border-indigo-100 transition-colors",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider font-semibold",children:"Assigned Shift"}),a&&h.jsx("span",{className:"bg-green-100 text-green-700 text-xs px-2 py-0.5 rounded-full font-bold",children:"Active"})]}),h.jsx("div",{className:"font-bold text-2xl text-gray-900 mb-1",children:a?.name||"Loading / Not Assigned"}),h.jsx("div",{className:"text-indigo-600 font-mono text-lg font-medium bg-indigo-50 inline-block px-3 py-1 rounded",children:a?`${a.startTime} - ${a.endTime}`:"--:--"})]}),h.jsxs("div",{className:"p-5 bg-blue-50/50 rounded-xl border border-blue-100/50",children:[h.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wider mb-3 font-bold",children:"Attendance Guidelines"}),h.jsxs("ul",{className:"text-sm text-gray-600 space-y-3 pl-1",children:[h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-400 mt-2 flex-shrink-0"}),"Check-in is available ",Gu.CHECK_IN_WINDOW_MINS/60," hour",""," before your shift starts."]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-400 mt-2 flex-shrink-0"}),"Attendance window closes ",Gu.CHECK_OUT_WINDOW_MINS/60," hour","s"," after shift end."]})]})]})]})]})]})}),h.jsx("div",{className:"xl:col-span-1 h-full",children:h.jsx(iR,{records:[...de,...k?[k]:[]]})})]}),h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-5",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"font-semibold text-base text-gray-700",children:new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"})}),h.jsxs("div",{className:"flex gap-2 items-center",children:[h.jsx("input",{type:"date",value:xe.split("/").reverse().join("-"),onChange:Qe=>{const[Rt,Ct,er]=Qe.target.value.split("-");ve(`${er}/${Ct}/${Rt}`)},className:"px-2 py-1.5 border border-gray-300 rounded-md text-xs focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),h.jsx("span",{className:"text-gray-400 text-xs",children:"to"}),h.jsx("input",{type:"date",value:De.split("/").reverse().join("-"),onChange:Qe=>{const[Rt,Ct,er]=Qe.target.value.split("-");ke(`${er}/${Ct}/${Rt}`)},className:"px-2 py-1.5 border border-gray-300 rounded-md text-xs focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),h.jsx("button",{onClick:yt,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",title:"Search",children:h.jsx($o,{className:"text-sm"})}),h.jsx("button",{onClick:vt,className:"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",title:"Download PDF Report",disabled:de.length===0,children:h.jsx(c9,{className:"text-sm"})})]})]}),z?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),h.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Loading..."})]}):de.length===0?h.jsxs("div",{className:"text-center py-8",children:[h.jsx(cu,{className:"mx-auto text-3xl text-gray-300 mb-2"}),h.jsx("p",{className:"text-xs text-gray-500",children:"No attendance records found"})]}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[h.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Check-In"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Check-Out"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Hours"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Regularized"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:de.map((Qe,Rt)=>h.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[h.jsx("td",{className:"px-3 py-2 text-xs text-gray-800 font-medium",children:Qe.date}),h.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:Qe.checkInTime||"-"}),h.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:Qe.checkOutTime?Qe.checkOutTime:oR(Qe.date,a)?h.jsx("span",{className:"text-red-500 font-medium",children:"Missed"}):h.jsx("span",{className:"text-gray-400 font-medium",children:"-"})}),h.jsx("td",{className:"px-3 py-2 text-xs text-gray-600 font-mono",children:Qe.workingHours||"-"}),h.jsx("td",{className:"px-3 py-2 text-xs",children:h.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${(()=>{const Ct=Qe.status?.trim().toLowerCase()||"";return Ct==="present"||Ct==="on time"?"bg-green-100 text-green-700":Ct==="half-day"||Ct==="half day"||Ct==="in"||Ct==="checked in"?"bg-yellow-100 text-yellow-700":Ct==="absent"?"bg-red-100 text-red-700":Ct==="holiday"?"bg-blue-100 text-blue-700":Ct.includes("leave")?"bg-purple-100 text-purple-700":Ct==="late"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"})()}`,children:(()=>{const Ct=Qe.status?.trim().toLowerCase()||"";return Ct==="in"||Ct==="checked in"||Ct==="half-day"||Ct==="half day"?"Half Day":Qe.status||"Pending"})()})}),h.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:Qe.regularized?h.jsx("span",{className:"text-blue-600 font-semibold",children:"YES"}):h.jsx("span",{className:"text-gray-400",children:"-"})})]},Qe.id||Rt))})]})})]}),Be.length>0&&h.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-2xl p-6 shadow-sm",children:[h.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start justify-between mb-6 gap-4",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"font-bold text-xl text-gray-900 flex items-center",children:[h.jsx(N0,{className:"mr-3 text-orange-500"})," Self-Regularization"]}),h.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Regularize missed checkouts (up to 3 times per month)"})]}),h.jsxs("div",{className:"bg-white px-5 py-3 rounded-xl border-2 border-orange-200 shadow-sm",children:[h.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Used this month"}),h.jsxs("div",{className:"text-3xl font-bold text-orange-600 mt-1",children:[Ae," / 3"]})]})]}),Ae>=3?h.jsxs("div",{className:"bg-white border-2 border-orange-200 rounded-xl p-8 text-center shadow-sm",children:[h.jsx(N0,{className:"mx-auto text-4xl text-orange-500 mb-4"}),h.jsx("p",{className:"text-gray-700 font-semibold text-lg",children:"You have used all 3 regularizations for this month"})]}):h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Be.slice(0,4).map(Qe=>h.jsx("div",{className:"bg-white border-2 border-orange-200 rounded-xl p-5 hover:border-orange-400 hover:shadow-md transition-all",children:h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Date"}),h.jsx("p",{className:"font-bold text-gray-900 text-lg",children:Qe.date})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check-In"}),h.jsx("p",{className:"font-mono text-gray-700",children:Qe.checkInTime})]})]}),h.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-orange-100",children:[h.jsxs("div",{children:[h.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check-Out"}),h.jsx("p",{className:"font-semibold text-red-600",children:"Missed"})]}),h.jsx("button",{onClick:()=>bt(Qe),className:"px-5 py-2.5 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition-colors shadow-sm hover:shadow-md",children:"Regularize"})]})]})},Qe.id))})]})]}),_e&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-fadeIn",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Check-in Regularization Request"}),h.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded-r-xl shadow-sm",children:h.jsxs("div",{className:"flex items-start",children:[h.jsx("div",{className:"flex-shrink-0 mt-0.5",children:h.jsx(N0,{className:"text-red-500 text-lg"})}),h.jsxs("div",{className:"ml-3",children:[h.jsx("h3",{className:"text-xs font-bold text-red-800 uppercase tracking-wider mb-2",children:"Important Policy Rules"}),h.jsxs("ul",{className:"text-[11px] text-red-700 space-y-2 list-disc ml-4 font-medium leading-relaxed",children:[h.jsx("li",{children:"Regularization Request Should Be Submitted On The Same Day For Missed Check-In"}),h.jsx("li",{children:"Request Should Be Approved Within 1 Day Of Submission. Follow-Up With Your Reporting Manager To Get It Approved"}),h.jsx("li",{children:"Request May Get Rejected Even If Approved By Reporting Manager, If All 3 Regularization Options Already Utilized Or More Than 1 Day On Approval"})]})]})]})}),h.jsxs("div",{className:"space-y-3 mb-6",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Employee Name"}),h.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-gray-800 font-medium",children:e?.name||"N/A"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Mail ID"}),h.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-gray-800 font-medium text-sm",children:e?.email||"N/A"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Date"}),h.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-gray-800 font-medium",children:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Missed Check-in"}),h.jsx("textarea",{value:X,onChange:Qe=>H(Qe.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4,placeholder:"Please explain why you missed the check-in..."})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>{Le(!1),H("")},className:"flex-1 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),h.jsx("button",{onClick:Te,disabled:!X.trim(),className:"flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors duration-200",children:"Submit Request"})]})]})})]}),ae&&h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden border border-gray-100 animate-in zoom-in-95 duration-300",children:[h.jsxs("div",{className:"p-6 bg-gradient-to-r from-indigo-600 to-indigo-700 text-white flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[h.jsx($1,{className:"text-indigo-200"}),"Regularization Status"]}),h.jsx("p",{className:"text-indigo-100 text-sm mt-1",children:"History of your missed check-in requests"})]}),h.jsx("button",{onClick:()=>Z(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors transition-transform active:scale-95",children:h.jsx(Ju,{className:"text-xl"})})]}),h.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto bg-gray-50/50",children:ce?h.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[h.jsx("div",{className:"w-12 h-12 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mb-4"}),h.jsx("p",{className:"text-gray-500 font-medium italic",children:"Fetching your requests..."})]}):se.length===0?h.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border-2 border-dashed border-gray-200",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx($1,{className:"text-2xl text-gray-400"})}),h.jsx("h3",{className:"text-gray-900 font-semibold text-lg",children:"No records found"}),h.jsx("p",{className:"text-gray-500 mt-1",children:"You haven't submitted any regularization requests yet."})]}):h.jsx("div",{className:"space-y-4",children:se.map((Qe,Rt)=>h.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm hover:shadow-md hover:border-indigo-200 transition-all duration-200 group",children:[h.jsxs("div",{className:"flex justify-between items-start mb-3",children:[h.jsxs("div",{children:[h.jsx("div",{className:"flex items-center gap-3 mb-1",children:h.jsx("span",{className:`text-[10px] font-bold uppercase tracking-widest px-2 py-0.5 rounded ${Qe.Status?.toLowerCase()==="approved"?"bg-green-100 text-green-700":Qe.Status?.toLowerCase()==="rejected"?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:Qe.Status||"Pending"})}),h.jsxs("div",{className:"text-lg font-bold text-gray-900 group-hover:text-indigo-700 transition-colors",children:["Regularization for ",new Date(Qe.Date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider mb-1",children:"Submitted On"}),h.jsx("div",{className:"text-xs font-medium text-gray-700",children:new Date(Qe.Created).toLocaleDateString()})]})]}),Qe.ApproverComments&&h.jsxs("div",{className:"mt-4 p-3 bg-blue-50/50 rounded-lg border border-blue-100 text-sm italic text-gray-600",children:[h.jsx("span",{className:"font-bold text-blue-700 not-italic block mb-1",children:"Approver Comments:"}),'"',Qe.ApproverComments,'"']}),h.jsx("div",{className:"mt-4 flex items-center justify-between pt-4 border-t border-gray-100",children:h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Employee Name"}),h.jsx("div",{className:"text-xs font-medium text-gray-900",children:Qe.EmployeeName||Qe.Title})]})})})]},Qe.Id||Rt))})}),h.jsx("div",{className:"p-4 bg-gray-100 border-t border-gray-200 flex justify-end",children:h.jsx("button",{onClick:()=>Z(!1),className:"px-6 py-2 bg-gray-900 text-white font-bold rounded-lg hover:bg-black transition-all active:scale-95 shadow-lg shadow-gray-200",children:"Close"})})]})}),h.jsx(Oh,{isOpen:Pe.isOpen,onClose:Vr,type:Pe.type,title:Pe.title,message:Pe.message})]})},cR=()=>{const i=new Date,t=new Date(i.getFullYear(),i.getMonth(),1).toISOString().split("T")[0],r=i.toISOString().split("T")[0],[a,n]=le.useState(t),[e,p]=le.useState(r),[m,y]=le.useState([]),[w,A]=le.useState([]),[I,R]=le.useState([]),[k,M]=le.useState(!1),[V,q]=le.useState(!1),[U,te]=le.useState(""),[W,re]=le.useState({show:!1,message:""}),xe=z=>{const K=z.getDay();return K===0||K===6},ve=(z,K)=>{const Ae=[];for(let Ce=new Date(z);Ce<=K;Ce.setDate(Ce.getDate()+1))Ae.push(new Date(Ce));return Ae},De=async()=>{M(!0);try{console.log(`[Monthly Attendance] Starting calculation from ${a} to ${e}`);const[z,K,Ae,Ce]=await Promise.all([cr.getAllEmployees(),cr.getAllAttendanceInRange(a,e),cr.getAllLeaveRequests(),cr.getHolidays("USA Holiday List")]);console.log("[Monthly Attendance] Data fetched:",{employees:z.length,attendanceRecords:K.length,leaveRequests:Ae.length,holidays:Ce.length});const Be=z.map(_e=>{const Le=ve(new Date(a),new Date(e));let X=0,H=0,ae=0,Z=0,se=0;return Le.forEach(ye=>{const ce=`${ye.getDate().toString().padStart(2,"0")}/${(ye.getMonth()+1).toString().padStart(2,"0")}/${ye.getFullYear()}`;if(xe(ye))return;const ze=K.find(pe=>(pe.employeeId===_e.id||pe.name===_e.name)&&pe.date===ce);if(ze&&ze.status){const pe=ze.status.toLowerCase();pe==="present"||pe==="on time"?X++:pe==="half-day"||pe==="half day"||pe==="late"?H++:pe.includes("leave")?ae++:pe==="absent"||pe==="in"?Z++:pe==="holiday"&&se++}}),{employeeName:_e.name,totalWorkingDays:X+Z+ae+H,present:X,leave:ae,halfDay:H,absent:Z,holiday:se}}),Ee=K.filter(_e=>{if(!_e.checkInTime||_e.checkOutTime&&_e.checkOutTime!=="-")return!1;const[Le,X,H]=_e.date.split("/"),ae=`${H}-${X.padStart(2,"0")}-${Le.padStart(2,"0")}`;return ae>=a&&ae<=e}),Pe=K.filter(_e=>{if(!(_e.regularized&&(_e.regularized==="YES"||_e.regularized==="Yes")))return!1;const[X,H,ae]=_e.date.split("/"),Z=`${ae}-${H.padStart(2,"0")}-${X.padStart(2,"0")}`;return Z>=a&&Z<=e});A(Ee),R(Pe);const Ue=Be.sort((_e,Le)=>_e.employeeName.localeCompare(Le.employeeName));y(Ue),q(!0),console.log(`[Monthly Attendance] Calculation complete. ${Ue.length} employee summaries generated.`)}catch(z){console.error("[Monthly Attendance] Calculation failed:",z),re({show:!0,message:z instanceof Error?z.message:"An unexpected error occurred while generating the report."})}finally{M(!1)}},ke=m.filter(z=>z.employeeName.toLowerCase().includes(U.toLowerCase())),de=w.filter(z=>(z.name||"").toLowerCase().includes(U.toLowerCase())),Oe=I.filter(z=>(z.name||"").toLowerCase().includes(U.toLowerCase()));return h.jsxs("div",{className:"flex flex-col font-sans text-gray-800 bg-gray-50 min-h-full",children:[h.jsx("div",{className:"bg-white shadow-md border-b border-gray-200 sticky top-0 z-[100]",style:{zIndex:100,backgroundColor:"#ffffff",position:"sticky",top:0},children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-2 bg-blue-100 rounded-lg text-blue-600",children:h.jsx(ly,{className:"text-xl"})}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("h1",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Monthly Attendance"}),h.jsx("span",{className:"bg-gray-100 text-gray-400 text-[10px] px-1.5 py-0.5 rounded-full border border-gray-200",children:"v1.6"})]}),h.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Overview & Analytics"})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"hidden md:flex items-center bg-gray-100 rounded-md px-3 py-2 border border-transparent focus-within:border-blue-500 focus-within:bg-white",children:[h.jsx(cu,{className:"text-gray-400 mr-2 text-sm"}),h.jsx("span",{className:"text-xs font-semibold mr-2 text-gray-500",children:"FROM"}),h.jsx("input",{type:"date",value:a,onChange:z=>n(z.target.value),className:"bg-transparent text-sm font-medium text-gray-700 focus:outline-none"})]}),h.jsxs("div",{className:"hidden md:flex items-center bg-gray-100 rounded-md px-3 py-2 border border-transparent focus-within:border-blue-500 focus-within:bg-white",children:[h.jsx(cu,{className:"text-gray-400 mr-2 text-sm"}),h.jsx("span",{className:"text-xs font-semibold mr-2 text-gray-500",children:"TO"}),h.jsx("input",{type:"date",value:e,onChange:z=>p(z.target.value),className:"bg-transparent text-sm font-medium text-gray-700 focus:outline-none"})]}),h.jsx("button",{onClick:De,disabled:k,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-md text-sm font-semibold shadow-md transition-all active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed",children:k?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-white/30 border-t-white rounded-full"}),h.jsx("span",{children:"Processing..."})]}):h.jsxs(h.Fragment,{children:[h.jsx(u9,{className:"text-xs"}),h.jsx("span",{children:"Get Report"})]})})]})]})}),h.jsxs("main",{className:"flex-1 max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[!V&&!k&&h.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center animate-fade-in-up",children:[h.jsx("div",{className:"bg-white p-6 rounded-full shadow-lg mb-6",children:h.jsx(l9,{className:"text-4xl text-blue-500"})}),h.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Ready to generate report"}),h.jsx("p",{className:"text-gray-500 max-w-md",children:'Select a date range above and click "Get Report" to calculate attendance statistics for all employees.'})]}),(V||k)&&h.jsx(h.Fragment,{children:h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-[600px]",children:[h.jsxs("div",{className:"lg:col-span-9 bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden flex flex-col h-full",children:[h.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ly,{className:"text-blue-500"}),h.jsx("h3",{className:"font-bold text-gray-800",children:"Attendance Summary"})]}),h.jsxs("div",{className:"relative",children:[h.jsx($o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Search Employee...",value:U,onChange:z=>te(z.target.value),className:"pl-9 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-48 transition-shadow"})]})]}),h.jsx("div",{className:"bg-gray-100 border-b border-gray-200",children:h.jsxs("div",{className:"grid grid-cols-12 text-xs font-bold text-gray-500 uppercase tracking-wider py-3 px-2 text-center",children:[h.jsx("div",{className:"col-span-4 text-left pl-4",children:"Employee"}),h.jsx("div",{className:"col-span-1",title:"Working Days",children:"WD"}),h.jsx("div",{className:"col-span-1 text-green-600",title:"Present",children:"P"}),h.jsx("div",{className:"col-span-1 text-blue-600",title:"Leave",children:"L"}),h.jsx("div",{className:"col-span-2 text-orange-500",title:"Half Day",children:"HD"}),h.jsx("div",{className:"col-span-2 text-red-500",title:"Absent",children:"A"}),h.jsx("div",{className:"col-span-1 text-purple-600",title:"Holiday",children:"H"})]})}),h.jsx("div",{className:"flex-1 overflow-y-auto bg-white custom-scrollbar relative",children:k?h.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 z-10 backdrop-blur-sm",children:h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),h.jsx("p",{className:"text-sm font-semibold text-gray-600",children:"Analyzing records..."})]})}):ke.length>0?ke.map((z,K)=>h.jsxs("div",{className:"grid grid-cols-12 py-3 px-2 border-b border-gray-100 hover:bg-blue-50/50 transition-colors items-center group text-center",children:[h.jsx("div",{className:"col-span-4 text-left pl-4",children:h.jsx("div",{className:"font-semibold text-gray-900 text-sm truncate",title:z.employeeName,children:z.employeeName})}),h.jsx("div",{className:"col-span-1 text-sm font-medium text-gray-700",children:z.totalWorkingDays}),h.jsx("div",{className:"col-span-1",children:h.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:z.present})}),h.jsx("div",{className:"col-span-1 text-sm font-medium text-gray-600",children:z.leave}),h.jsx("div",{className:"col-span-2 text-sm font-medium text-gray-600",children:z.halfDay}),h.jsx("div",{className:"col-span-2 text-sm font-medium text-gray-600",children:z.absent}),h.jsx("div",{className:"col-span-1 text-sm font-medium text-gray-600",children:z.holiday})]},K)):h.jsx("div",{className:"p-12 text-center text-gray-400",children:h.jsx("p",{children:"No records found matching your search."})})})]}),h.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-6 h-full",children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden flex flex-col flex-1 animate-fade-in",children:[h.jsxs("div",{className:"px-4 py-4 border-b border-gray-100 bg-red-50/50 flex items-center gap-2",children:[h.jsx("div",{className:"p-1.5 bg-red-100 rounded text-red-600 shrink-0",children:h.jsx(N0,{})}),h.jsx("h3",{className:"font-bold text-gray-800 text-sm truncate",children:"Missed Checkouts"}),h.jsx("span",{className:"ml-auto text-[10px] font-medium bg-red-100 text-red-700 px-2 py-1 rounded-full",children:de.length})]}),h.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:de.length>0?h.jsxs("table",{className:"w-full text-xs text-left",children:[h.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold sticky top-0",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-3 py-2",children:"Employee"}),h.jsx("th",{className:"px-3 py-2",children:"Date"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:de.map((z,K)=>h.jsxs("tr",{className:"hover:bg-red-50/30",children:[h.jsx("td",{className:"px-3 py-2 font-medium text-gray-900 truncate max-w-[100px]",title:z.name,children:z.name}),h.jsx("td",{className:"px-3 py-2 text-gray-600",children:z.date})]},K))})]}):h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 p-4 text-center",children:[h.jsx("div",{className:"text-2xl mb-1 opacity-20",children:""}),h.jsx("p",{className:"text-xs",children:"No missed checkouts found."})]})})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden flex flex-col flex-1 animate-fade-in",children:[h.jsxs("div",{className:"px-4 py-4 border-b border-gray-100 bg-purple-50/50 flex items-center gap-2",children:[h.jsx("div",{className:"p-1.5 bg-purple-100 rounded text-purple-600 shrink-0",children:h.jsx($1,{})}),h.jsx("h3",{className:"font-bold text-gray-800 text-sm truncate",children:"Regularization"}),h.jsx("span",{className:"ml-auto text-[10px] font-medium bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:Oe.length})]}),h.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:Oe.length>0?h.jsxs("table",{className:"w-full text-xs text-left",children:[h.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold sticky top-0",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-3 py-2",children:"Employee"}),h.jsx("th",{className:"px-3 py-2",children:"Date"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:Oe.map((z,K)=>h.jsxs("tr",{className:"hover:bg-purple-50/30",children:[h.jsx("td",{className:"px-3 py-2 font-medium text-gray-900 truncate max-w-[100px]",title:z.name,children:z.name}),h.jsx("td",{className:"px-3 py-2 text-gray-600",children:z.date})]},K))})]}):h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 p-4 text-center",children:[h.jsx("div",{className:"text-2xl mb-1 opacity-20",children:""}),h.jsx("p",{className:"text-xs",children:"No regularizations found."})]})})]})]})]})})]}),W.show&&h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[200] animate-fade-in",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 animate-scale-in",children:[h.jsx("div",{className:"bg-red-50 border-b border-red-100 px-6 py-4 rounded-t-xl",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-red-100 rounded-lg text-red-600",children:h.jsx(N0,{className:"text-xl"})}),h.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Report Generation Failed"})]})}),h.jsxs("div",{className:"p-6",children:[h.jsx("p",{className:"text-gray-700 mb-4",children:W.message}),h.jsx("p",{className:"text-sm text-gray-500",children:"Please check the browser console for detailed error information."})]}),h.jsx("div",{className:"bg-gray-50 px-6 py-4 rounded-b-xl flex justify-end",children:h.jsx("button",{onClick:()=>re({show:!1,message:""}),className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors",children:"Close"})})]})})]})},uR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(new Date),[p,m]=le.useState("All"),[y,w]=le.useState(""),A=["All","Chennai","Hyderabad","Noida","CON","Canada"],I={Chennai:"bg-indigo-500 hover:bg-indigo-600",Hyderabad:"bg-purple-500 hover:bg-purple-600",Noida:"bg-teal-500 hover:bg-teal-600",CON:"bg-orange-500 hover:bg-orange-600",Canada:"bg-red-500 hover:bg-red-600",All:"bg-gray-600 hover:bg-gray-700"},R=async W=>{try{a(!0);const re=W.getDate().toString().padStart(2,"0"),xe=(W.getMonth()+1).toString().padStart(2,"0"),ve=W.getFullYear(),De=`${re}/${xe}/${ve}`,[ke,de]=await Promise.all([cr.getAllEmployees(),cr.getAllAttendanceForDate(De)]),Oe=de.filter(z=>{const K=ke.find(Ae=>Ae.id===z.employeeId||Ae.name===z.name);return K&&!["Information Technology","Accounts","HR"].includes(K.department)}).map(z=>{const K=ke.find(Ae=>Ae.id===z.employeeId||Ae.name===z.name);return{id:z.id,name:z.name||(K?K.name:"Unknown"),place:z.place||(K?K.place:"N/A"),checkInTime:z.checkInTime||"-",checkOutTime:z.checkOutTime||"-",workingHours:z.workingHours||"-",status:z.status||"Present"}});t(Oe)}catch(re){console.error("Failed to fetch attendance data:",re)}finally{a(!1)}};le.useEffect(()=>{R(n)},[n]);const k=W=>{const[re,xe,ve]=W.target.value.split("-").map(Number);e(new Date(re,xe-1,ve))},M=()=>{R(n)},V=i.filter(W=>{const re=p==="All"||W.place?.toLowerCase()===p.toLowerCase(),xe=W.name.toLowerCase().includes(y.toLowerCase());return re&&xe}),q={total:V.length,present:V.filter(W=>W.status==="IN").length,absent:V.filter(W=>W.status==="Absent").length,onLeave:V.filter(W=>W.status.includes("Leave")||W.status.includes("Holiday")).length},U=W=>{const re=W.getFullYear(),xe=(W.getMonth()+1).toString().padStart(2,"0"),ve=W.getDate().toString().padStart(2,"0");return`${re}-${xe}-${ve}`},te=W=>W.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return h.jsxs("div",{className:"h-full flex flex-col p-6 gap-6 overflow-hidden",children:[h.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl shadow-lg p-6 text-white flex-shrink-0",children:h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold mb-2",children:"My Team Attendance"}),h.jsx("p",{className:"text-blue-100 text-sm",children:te(n)})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"relative",children:h.jsx("input",{type:"date",value:U(n),onChange:k,className:"px-4 py-2 rounded-lg bg-white text-gray-800 font-medium focus:outline-none focus:ring-2 focus:ring-blue-300 shadow-md"})}),h.jsx("button",{onClick:M,className:"p-3 bg-white text-blue-600 rounded-lg hover:bg-blue-50 transition-colors shadow-md",title:"Refresh",children:h.jsx(uu,{className:r?"animate-spin":""})})]})]})}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Team Records"}),h.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:q.total})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Available"}),h.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:q.present})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Absent"}),h.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:q.absent})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-yellow-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"On Leave"}),h.jsx("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:q.onLeave})]})]}),h.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-gray-100 flex-shrink-0",children:h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-semibold text-gray-600 mb-3",children:"Filter by Location"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(W=>h.jsx("button",{onClick:()=>m(W),className:`px-4 py-2 rounded-lg font-medium text-white transition-all shadow-sm ${p===W?I[W]+" ring-2 ring-offset-2 ring-gray-400":I[W]+" opacity-60"}`,children:W},W))})]}),h.jsxs("div",{className:"md:w-64",children:[h.jsx("p",{className:"text-sm font-semibold text-gray-600 mb-3",children:"Search Employee"}),h.jsxs("div",{className:"relative",children:[h.jsx($o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Search by name...",value:y,onChange:W=>w(W.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),h.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden flex-1 flex flex-col min-h-0",children:h.jsx("div",{className:"overflow-y-auto flex-1 h-full",children:r?h.jsx("div",{className:"flex items-center justify-center py-20",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-gray-500",children:"Loading attendance data..."})]})}):V.length===0?h.jsxs("div",{className:"text-center py-20 text-gray-400",children:[h.jsx("p",{className:"text-lg font-medium",children:"No records found"}),h.jsx("p",{className:"text-sm mt-2",children:"Try selecting a different date or location"})]}):h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200 sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Employee Name"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Location"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Check In"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Check Out"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Hours"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Status"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:V.map((W,re)=>h.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm ${W.status==="Absent"?"bg-red-100 text-red-600":"bg-indigo-100 text-indigo-600"}`,children:W.name?.charAt(0)||"?"}),h.jsx("span",{className:"font-medium text-gray-800",children:W.name})]})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium",children:W.place})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[W.checkInTime!=="-"&&h.jsx(Cf,{className:"text-green-500 text-sm"}),h.jsx("span",{className:`font-mono text-sm ${W.checkInTime!=="-"?"text-green-600 font-semibold":"text-gray-400"}`,children:W.checkInTime})]})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[W.checkOutTime!=="-"&&h.jsx(Cf,{className:"text-red-500 text-sm"}),h.jsx("span",{className:`font-mono text-sm ${W.checkOutTime!=="-"?"text-red-600 font-semibold":"text-gray-400"}`,children:W.checkOutTime})]})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"font-mono text-sm text-gray-700 font-medium",children:W.workingHours})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold ${["Present","On Time"].includes(W.status)?"bg-green-100 text-green-700":W.status==="Late"?"bg-red-100 text-red-700":["Half-Day","Half Day","In","Checked In"].includes(W.status)?"bg-yellow-100 text-yellow-700":W.status==="Absent"?"bg-red-50 text-red-600":W.status.includes("Leave")?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600"}`,children:[["Present","On Time"].includes(W.status)?h.jsx(Pc,{}):W.status==="Absent"?h.jsx(Jm,{}):null,W.status]})})]},W.id||re))})]})})})]})},hR=({asset:i,isOpen:t,onClose:r})=>{if(!t||!i)return null;const a=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return e}},n=e=>{const p=e.toLowerCase();return p.includes("laptop")?h.jsx(B4,{className:"text-3xl"}):p.includes("desktop")||p.includes("pc")?h.jsx(s9,{className:"text-3xl"}):p.includes("mobile")||p.includes("phone")?h.jsx(v9,{className:"text-3xl"}):p.includes("keyboard")?h.jsx(g9,{className:"text-3xl"}):p.includes("mouse")?h.jsx(b9,{className:"text-3xl"}):p.includes("headphone")||p.includes("headset")?h.jsx(f9,{className:"text-3xl"}):h.jsx(B4,{className:"text-3xl"})};return h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 bg-black bg-opacity-65 backdrop-blur-md",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full border border-gray-100 overflow-hidden transform transition-all duration-300 scale-100",children:[h.jsx("div",{className:"bg-blue-600 text-white p-5 flex items-center justify-between shadow-lg",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-white rounded-xl flex items-center justify-center text-blue-600 shadow-inner",children:n(i.assetType)}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-black leading-none tracking-tight",children:i.assetType}),h.jsx("p",{className:"text-blue-100 text-[11px] uppercase font-black mt-1.5 tracking-widest opacity-90",children:"Asset Category"})]})]})}),h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-xl border border-gray-100 shadow-sm",children:[h.jsx("div",{className:"flex items-center gap-3",children:h.jsxs("div",{children:[h.jsx("p",{className:"text-[11px] text-slate-500 font-black uppercase leading-none mb-1",children:"Assigned To"}),h.jsx("p",{className:"text-base font-black text-slate-900 tracking-tight",children:i.employeeName})]})}),h.jsx("span",{className:`px-3 py-1.5 rounded-lg text-xs font-black uppercase tracking-tight ${i.status?.toLowerCase()==="active"||i.status?.toLowerCase()==="working"?"bg-emerald-100 text-emerald-700 border border-emerald-200":"bg-amber-100 text-amber-700 border border-amber-200"}`,children:i.status||"Active"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.manufacturer&&h.jsxs("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm",children:[h.jsx("label",{className:"text-[11px] uppercase font-black text-gray-400 block pb-1",children:"Brand"}),h.jsx("p",{className:"text-sm font-bold text-gray-800",children:i.manufacturer})]}),i.model&&h.jsxs("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm",children:[h.jsx("label",{className:"text-[11px] uppercase font-black text-gray-400 block pb-1",children:"Model"}),h.jsx("p",{className:"text-sm font-bold text-gray-800",children:i.model})]}),i.purchaseDate&&h.jsxs("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm",children:[h.jsx("label",{className:"text-[11px] uppercase font-black text-gray-400 block pb-1",children:"Purchase Date"}),h.jsx("p",{className:"text-sm font-bold text-gray-800",children:a(i.purchaseDate)})]}),i.assignedDate&&h.jsxs("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm",children:[h.jsx("label",{className:"text-[11px] uppercase font-black text-gray-400 block pb-1",children:"Assigned Date"}),h.jsx("p",{className:"text-sm font-bold text-gray-800",children:a(i.assignedDate)})]}),h.jsxs("div",{className:"col-span-2 space-y-3",children:[i.serialNumber&&h.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:[h.jsx("label",{className:"text-[11px] uppercase font-black text-gray-400 block mb-1.5",children:"Serial Number"}),h.jsx("p",{className:"text-sm font-mono font-bold text-emerald-600 overflow-x-auto whitespace-nowrap scrollbar-hide",children:i.serialNumber})]}),(i.processor||i.ram||i.hdd)&&h.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(hx,{className:"text-sm text-blue-600"}),h.jsx("h3",{className:"text-xs uppercase font-black text-slate-500 tracking-wider",children:"System Specifications"})]}),h.jsxs("div",{className:"space-y-4",children:[i.processor&&h.jsxs("div",{className:"space-y-1 border-b border-slate-100 pb-3",children:[h.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-black",children:"CPU / Processor"}),h.jsx("p",{className:"text-sm font-bold text-slate-800 leading-relaxed",children:i.processor})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.ram&&h.jsxs("div",{className:"space-y-1 border-r border-slate-100 pr-4",children:[h.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-black",children:"RAM / Memory"}),h.jsx("p",{className:"text-sm font-bold text-slate-800",children:i.ram})]}),i.hdd&&h.jsxs("div",{className:"space-y-1",children:[h.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-black",children:"Disk / Storage"}),h.jsx("p",{className:"text-sm font-bold text-slate-800",children:i.hdd})]})]})]})]})]})]})]}),h.jsx("div",{className:"bg-slate-50 p-3 border-t border-slate-100",children:h.jsx("button",{onClick:r,className:"w-full py-2.5 bg-blue-600 text-white text-xs font-black rounded-lg hover:bg-blue-700 transition-colors shadow-lg uppercase tracking-widest",children:"Close Detail View"})})]})})},dR=()=>{const{accounts:i}=Cd(),[t,r]=le.useState(null),[a,n]=le.useState([]),[e,p]=le.useState(null),[m,y]=le.useState(null),[w,A]=le.useState(!1),[I,R]=le.useState(!0);if(le.useEffect(()=>{(async()=>{try{if(i.length===0)return;const U=i[0].username;console.log("Fetching complete employee profile for:",U);const te=await cr.getEmployeeProfileByEmail(U);if(r(te),te?.professionalEmail||te?.email){const W=te.professionalEmail||te.email,re=await cr.getEmployeeAssets(W);n(re)}if(te?.name){const W=await cr.getEmployeeLeaveBalance(te.name);p(W)}}catch(U){console.error("Failed to fetch employee profile",U)}finally{R(!1)}})()},[i]),I)return h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"text-gray-500",children:"Loading profile..."})});if(!t)return h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-gray-500 mb-2",children:"Employee profile not found"}),h.jsx("p",{className:"text-sm text-gray-400",children:"Please contact HR if you believe this is an error."})]})});const k=q=>{if(!q)return"N/A";try{return new Date(q).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return q}},M=q=>{y(q),A(!0)},V=()=>{A(!1),y(null)};return h.jsxs("div",{className:"p-4 max-w-full mx-auto overflow-x-hidden",children:[h.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[h.jsx("div",{className:"h-8 w-1 bg-indigo-600 rounded-full"}),h.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800 tracking-tight",children:"My Profile"})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-all duration-300 group",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-100",children:[h.jsx("div",{className:"w-8 h-8 bg-blue-50 text-blue-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsx("h4",{className:"text-base font-bold text-gray-800",children:"Personal Info"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-blue-500 transition-colors",children:"Full Name"}),h.jsx("p",{className:"text-sm font-semibold text-gray-900 leading-snug",children:t.name})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-blue-500 transition-colors",children:"Employee ID"}),h.jsx("p",{className:"text-sm font-medium text-gray-700 font-mono bg-gray-50 inline-block px-2 py-0.5 rounded border border-gray-100",children:t.employeeId||"N/A"})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-blue-500 transition-colors",children:"Date of Birth"}),h.jsx("p",{className:"text-sm font-medium text-gray-700",children:k(t.dateOfBirth)})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-blue-500 transition-colors",children:"Date of Joining"}),h.jsx("p",{className:"text-sm font-medium text-gray-700",children:k(t.dateOfJoining)})]})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-all duration-300 group",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-100",children:[h.jsx("div",{className:"w-8 h-8 bg-purple-50 text-purple-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsx("h4",{className:"text-base font-bold text-gray-800",children:"Work Info"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-purple-500 transition-colors",children:"Department"}),h.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.department||"N/A"})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-purple-500 transition-colors",children:"Designation"}),h.jsx("p",{className:"text-sm font-medium text-gray-700",children:t.designation||t.role||"N/A"})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-purple-500 transition-colors",children:"Reporting Manager"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold",children:(t.reportingManager||"?").charAt(0)}),h.jsx("p",{className:"text-sm font-medium text-gray-700",children:t.reportingManager||"N/A"})]})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-purple-500 transition-colors",children:"Location"}),h.jsx("p",{className:"text-sm font-medium text-gray-700",children:t.location||"N/A"})]})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-all duration-300 group",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-100",children:[h.jsx("div",{className:"w-8 h-8 bg-green-50 text-green-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsx("h4",{className:"text-base font-bold text-gray-800",children:"Contact Info"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-green-500 transition-colors",children:"Professional Email"}),h.jsx("p",{className:"text-sm font-medium text-indigo-600 break-all hover:underline cursor-pointer",children:t.professionalEmail||t.email||"N/A"})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-green-500 transition-colors",children:"Personal Email"}),h.jsx("p",{className:"text-sm font-medium text-gray-700 break-all",children:t.personalEmail||"N/A"})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-green-500 transition-colors",children:"Mobile"}),h.jsx("p",{className:"text-sm font-medium text-gray-700 font-mono",children:t.contactNumber||"N/A"})]}),h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-green-500 transition-colors",children:"Emergency"}),h.jsx("p",{className:"text-sm font-medium text-red-500",children:t.emergencyContact||"N/A"})]})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-all duration-300 group",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-100",children:[h.jsx("div",{className:"w-8 h-8 bg-orange-50 text-orange-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsx("h4",{className:"text-base font-bold text-gray-800",children:"Address Info"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-orange-500 transition-colors",children:"Current Address"}),h.jsx("p",{className:"text-sm font-medium text-gray-700 leading-relaxed",children:t.currentAddress||"N/A"})]}),h.jsxs("div",{className:"pt-2 border-t border-gray-50 group/item",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-semibold mb-0.5 block group-hover/item:text-orange-500 transition-colors",children:"Permanent Address"}),h.jsx("p",{className:"text-sm font-medium text-gray-500 leading-relaxed italic",children:t.permanentAddress||"Same as current"})]})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-all duration-300 group",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-100",children:[h.jsx("div",{className:"w-8 h-8 bg-cyan-50 text-cyan-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsx("h4",{className:"text-base font-bold text-gray-800",children:"Asset Details"})]}),h.jsx("div",{className:"space-y-3",children:a.length===0?h.jsx("p",{className:"text-sm text-gray-400 italic",children:"No assets assigned"}):a.map(q=>h.jsxs("div",{onClick:()=>M(q),className:"p-3 bg-gradient-to-br from-gray-50 to-white rounded-lg border border-gray-100 hover:border-cyan-300 hover:shadow-lg transition-all duration-300 group/asset cursor-pointer",children:[h.jsx("div",{className:"flex items-start justify-between mb-2",children:h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("span",{className:"text-sm font-bold text-gray-900",children:q.assetType}),q.status&&h.jsx("span",{className:`px-2 py-0.5 text-[9px] font-semibold rounded-full ${q.status.toLowerCase()==="active"?"bg-green-100 text-green-700":q.status.toLowerCase()==="inactive"?"bg-gray-100 text-gray-600":"bg-blue-100 text-blue-700"}`,children:q.status})]}),q.manufacturer&&q.model&&h.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:[q.manufacturer," ",q.model]})]})}),h.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 pt-2 border-t border-gray-100",children:[q.serialNumber&&h.jsxs("div",{children:[h.jsx("label",{className:"text-[8px] uppercase tracking-wider text-gray-400 font-semibold block mb-0.5",children:"Serial Number"}),h.jsx("p",{className:"text-xs font-mono text-gray-700 bg-white px-2 py-0.5 rounded border border-gray-100",children:q.serialNumber})]}),q.purchaseDate&&h.jsxs("div",{children:[h.jsx("label",{className:"text-[8px] uppercase tracking-wider text-gray-400 font-semibold block mb-0.5",children:"Purchase Date"}),h.jsx("p",{className:"text-xs text-gray-600",children:k(q.purchaseDate)})]}),q.assignedDate&&h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:"text-[8px] uppercase tracking-wider text-gray-400 font-semibold block mb-0.5",children:"Assigned Date"}),h.jsx("p",{className:"text-xs text-gray-600",children:k(q.assignedDate)})]})]})]},q.id))})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition-all duration-300 group",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-100",children:[h.jsx("div",{className:"w-8 h-8 bg-emerald-50 text-emerald-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsx("h4",{className:"text-base font-bold text-gray-800",children:"Leave Balance"})]}),h.jsx("div",{className:"space-y-3",children:e?h.jsx("div",{className:"space-y-3",children:h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{className:"p-2 bg-emerald-50/50 border border-emerald-100 rounded-lg",children:[h.jsx("label",{className:"text-[8px] uppercase tracking-wider text-emerald-600 font-black block mb-0.5",children:"Casual Leave (CL)"}),h.jsx("p",{className:"text-base font-black text-emerald-700",children:e.cl})]}),h.jsxs("div",{className:"p-2 bg-blue-50/50 border border-blue-100 rounded-lg",children:[h.jsx("label",{className:"text-[8px] uppercase tracking-wider text-blue-600 font-black block mb-0.5",children:"Earned Leave (EL)"}),h.jsx("p",{className:"text-base font-black text-blue-700",children:e.el})]}),h.jsxs("div",{className:"p-2 bg-indigo-50 border border-indigo-100 rounded-lg col-span-2 shadow-sm",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-indigo-600 font-black",children:"Total Available Balance"}),h.jsx("span",{className:"px-2 py-0.5 bg-indigo-600 text-white text-[9px] font-bold rounded-full",children:"Active"})]}),h.jsx("p",{className:"text-xl font-black text-indigo-700 mt-0.5",children:e.balance})]}),h.jsx("div",{className:"p-2 bg-gray-50 border border-gray-200 rounded-lg col-span-2",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-[9px] uppercase tracking-wider text-gray-400 font-black",children:"Loss of Pay (LOP)"}),h.jsxs("p",{className:"text-sm font-black text-gray-700",children:[e.lop," Days"]})]})})]})}):h.jsx("p",{className:"text-sm text-gray-400 italic",children:"No leave balance data found"})})]})]}),h.jsx(hR,{asset:m,isOpen:w,onClose:V})]})},cw=()=>{const i=kf(),{employee:t}=du(),[r,a]=le.useState([]),[n,e]=le.useState(!0),[p,m]=le.useState(null),[y,w]=le.useState("All"),[A,I]=le.useState(!1),R=le.useCallback(async(U=!0)=>{if(t?.email)try{U&&e(!0);const te=await cr.getLeaveRequests(t.email);a(te),te.length>0&&!p&&m(te[0])}catch(te){console.error("Failed to load leaves",te)}finally{e(!1),I(!1)}},[t?.email,p]),k=()=>{I(!0),R(!1)};le.useEffect(()=>{console.log("Leave Component Mounted"),R()},[R]);const M=r.filter(U=>y==="All"?!0:y==="Pending"?U.status==="Pending"||U.status==="Pending Manager Approval":U.status===y),V=U=>U?new Date(U).toLocaleDateString("en-GB"):"",q=U=>U==="Approved"?h.jsx(Pc,{className:"text-green-600 text-3xl mx-auto"}):U==="Withdrawn"?h.jsx("div",{className:"text-blue-600 text-4xl mx-auto",children:""}):U.includes("Pending")?h.jsx("div",{className:"text-orange-400 text-4xl mx-auto font-serif",children:"?"}):null;return h.jsxs("div",{className:"min-h-full flex flex-col relative -mt-1",children:[h.jsx("div",{className:"absolute top-0 right-0 z-20",children:h.jsxs("button",{onClick:()=>i("/leave/new"),className:"flex items-center gap-2 bg-[#0078d4] hover:bg-[#005a9e] text-white px-5 py-2 rounded-lg shadow-md transition-all font-semibold text-sm",children:[h.jsx(Hy,{className:"text-lg"}),h.jsx("span",{children:"New Request"})]})}),h.jsxs("div",{className:"w-full flex-grow flex flex-col min-h-0",children:[h.jsxs("header",{className:"flex-none flex items-center justify-start mb-6",children:[h.jsx("div",{className:"flex gap-2 bg-white/60 p-1 rounded-full backdrop-blur-sm shadow-sm border border-gray-100",children:["All","Pending","Approved","Declined","Withdrawn"].map(U=>h.jsx("button",{onClick:()=>w(U),className:`px-5 py-1.5 rounded-full font-bold text-xs transition-all duration-200 ${y===U?"bg-[#0078d4] text-white shadow-md":"text-gray-500 hover:bg-white hover:text-[#0078d4]"}`,children:U},U))}),h.jsx("button",{onClick:k,disabled:n||A,className:`ml-3 p-2 rounded-full hover:bg-white/60 text-gray-400 hover:text-[#0078d4] transition-all border border-transparent hover:border-gray-100 shadow-none hover:shadow-sm ${A?"animate-spin":""}`,title:"Refresh List",children:h.jsx(uu,{className:"text-sm"})})]}),h.jsxs("div",{className:"flex-grow grid grid-cols-1 lg:grid-cols-12 gap-6 min-h-0",children:[h.jsx("div",{className:"lg:col-span-9 overflow-y-auto pr-2 custom-scrollbar",children:n?h.jsx("div",{className:"text-center py-10 text-gray-500 font-medium",children:"Loading requests..."}):M.length===0?h.jsx("div",{className:"text-center py-10 text-gray-500 bg-white/40 rounded-xl border border-dashed border-gray-200",children:"No leave requests found."}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 pb-8",children:M.map(U=>h.jsxs("div",{onClick:()=>m(U),className:`bg-white cursor-pointer transition-all duration-200 border relative group flex flex-col hover:shadow-lg @container ${p?.id===U.id?"border-sky-500 ring-2 ring-sky-500/10 scale-[1.02]":"border-gray-200 shadow-sm"}`,children:[h.jsxs("div",{className:"p-4 flex-grow flex flex-col items-center justify-between min-h-[200px] w-full",children:[h.jsx("h3",{className:"font-normal text-gray-900 text-xs @[150px]:text-sm mb-1 text-center truncate w-full px-1",children:U.employeeName}),h.jsxs("div",{className:"text-gray-700 font-normal text-[11px] @[150px]:text-xs flex items-center justify-center gap-1.5 mb-2 w-full px-1",children:[h.jsx("span",{className:"text-sm @[150px]:text-base",children:U.leaveType.includes("Sick")?"":""}),h.jsx("span",{className:"truncate",children:U.leaveType.replace(/|/g,"").trim()})]}),h.jsxs("div",{className:"font-normal text-gray-500 text-[8px] @[140px]:text-[9px] @[170px]:text-[10px] mb-3 bg-gray-50 px-1 py-1.5 rounded-lg border border-gray-100 whitespace-nowrap shadow-sm w-full text-center overflow-hidden",children:[V(U.fromDate)," - ",V(U.toDate)]}),h.jsx("div",{className:"my-2 transition-transform duration-300 group-hover:scale-110",children:q(U.status)}),h.jsx("div",{className:"w-[40%] h-[1px] bg-gray-100 mt-auto mb-1"})]}),h.jsx("div",{className:`w-full h-10 flex items-center justify-center px-2 text-center text-white font-semibold text-[10px] @[150px]:text-xs uppercase tracking-widest ${U.status==="Approved"?"bg-[#00a651]":U.status==="Declined"?"bg-[#ed1c24]":U.status==="Withdrawn"?"bg-[#4b58e4]":"bg-[#ff9c00]"}`,children:U.status})]},U.id))})}),h.jsx("div",{className:"lg:col-span-3 flex flex-col min-h-0",children:h.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm flex flex-col max-h-full overflow-hidden",children:p?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"p-5 border-b border-gray-50 flex-none bg-gray-50/50",children:h.jsxs("h2",{className:"text-sm font-bold text-gray-800 text-center uppercase tracking-widest flex items-center justify-center gap-3",children:[h.jsx("div",{className:"h-[2px] w-4 bg-gray-200 rounded"}),"Request Details",h.jsx("div",{className:"h-[2px] w-4 bg-gray-200 rounded"})]})}),h.jsx("div",{className:"p-5 overflow-y-auto custom-scrollbar flex-grow",children:h.jsxs("div",{className:"space-y-6 text-center",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1.5",children:"Employee Name"}),h.jsx("div",{className:"text-gray-900 font-bold text-base",children:p.employeeName})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"From"}),h.jsx("div",{className:"text-xs font-bold text-gray-800 py-1.5 bg-gray-50 rounded border border-gray-100",children:V(p.fromDate)})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"To"}),h.jsx("div",{className:"text-xs font-bold text-gray-800 py-1.5 bg-gray-50 rounded border border-gray-100",children:V(p.toDate)})]})]}),h.jsxs("div",{className:"inline-flex flex-col items-center",children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Leave Type"}),h.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg border border-blue-100 font-bold text-xs",children:[h.jsx("span",{children:p.leaveType.includes("Sick")?"":""}),h.jsx("span",{children:p.leaveType.replace(/|/g,"").trim()})]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Reason (Detail)"}),h.jsx("div",{className:"text-xs text-gray-600 font-medium leading-relaxed bg-gray-50 p-3 rounded-lg border border-gray-50 italic",children:p.reason||"No details provided."})]}),h.jsx("div",{className:"h-px bg-gray-100 w-full"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1",children:"Status"}),h.jsx("div",{className:`text-xs font-black uppercase ${p.status==="Approved"?"text-emerald-600":p.status==="Pending"?"text-amber-500":"text-gray-500"}`,children:p.status})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1",children:"Approver"}),h.jsx("div",{className:"text-xs font-bold text-gray-800",children:p.manager})]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Manager Comments"}),h.jsx("div",{className:"text-[11px] text-gray-600 bg-emerald-50/30 border border-emerald-100/50 rounded-lg p-3 italic min-h-[50px] flex items-center justify-center",children:p.approvalComments?`"${p.approvalComments}"`:"No comments from manager."})]})]})})]}):h.jsxs("div",{className:"p-10 flex flex-col items-center justify-center text-gray-300 space-y-3 opacity-60",children:[h.jsx("div",{className:"text-5xl",children:""}),h.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",children:"Select a card"})]})})})]})]})]})},uw=()=>{const i=kf(),{employee:t}=du(),[r,a]=le.useState(!1),[n,e]=le.useState({isOpen:!1,type:"success",title:"",message:""}),[p,m]=le.useState({leaveCategory:"Full Day Leave",leaveType:"Sick Leave",startDate:"",endDate:"",detail:""}),y=[{id:"Vacation/Function",label:"Vacation/Function",icon:fx,color:"text-orange-500"},{id:"Sick Leave",label:"Sick Leave",icon:m9,color:"text-rose-500"},{id:"Casual Leave",label:"Casual Leave",icon:C9,color:"text-sky-500"},{id:"Emergency",label:"Emergency",icon:w9,color:"text-amber-500"}],w=()=>{const R=new Date;R.setHours(0,0,0,0);const k=new Date(p.startDate);if(new Date(p.endDate)<k)return e({isOpen:!0,type:"error",title:"Invalid Date Range",message:'The "To" date cannot be earlier than the "From" date.'}),!1;if(p.leaveType==="Vacation/Function"){const V=new Date(R);if(V.setDate(R.getDate()+7),k<V)return e({isOpen:!0,type:"error",title:"Advance Notice Required",message:"Vacation/Function requests must be submitted at least 7 days in advance."}),!1}return!0},A=async R=>{if(R.preventDefault(),!!w())try{a(!0),await cr.submitLeaveRequest({employeeName:t?.name||"Unknown",leaveType:p.leaveType,leaveCategory:p.leaveCategory,comments:p.detail,fromDate:p.startDate,toDate:p.endDate}),e({isOpen:!0,type:"success",title:"Request Submitted",message:`Your ${p.leaveType} request has been successfully sent for approval.`})}catch(k){e({isOpen:!0,type:"error",title:"Submission Failed",message:k.message||"There was an error submitting your request. Please try again."})}finally{a(!1)}},I=()=>{e({...n,isOpen:!1}),n.type==="success"&&i("/leave")};return h.jsxs("div",{className:"h-full bg-[url('https://www.transparenttextures.com/patterns/floral-linen.png')] bg-gray-50 font-sans p-4 md:p-6 overflow-hidden flex flex-col relative",children:[h.jsx("div",{className:"max-w-xl mx-auto w-full flex-1 overflow-y-auto flex flex-col",children:h.jsxs("div",{className:"bg-white border-2 border-sky-500 rounded-3xl p-6 md:p-8 shadow-xl relative",children:[h.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-sky-50 rounded-bl-[100px] -z-0 opacity-50"}),h.jsx("div",{className:"relative z-10",children:h.jsxs("form",{onSubmit:A,className:"space-y-4 md:space-y-6",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-gray-700 text-xs font-black uppercase tracking-widest mb-2 md:mb-3",children:[h.jsx("span",{className:"text-red-500 mr-1",children:"*"})," Leave Duration"]}),h.jsx("div",{className:"flex gap-3 md:gap-4 p-1 bg-gray-50 rounded-xl border border-gray-100",children:["Full Day Leave","Half Day Leave"].map(R=>h.jsx("button",{type:"button",onClick:()=>m({...p,leaveCategory:R}),className:`flex-1 py-2 md:py-2.5 rounded-lg text-xs font-bold transition-all ${p.leaveCategory===R?"bg-sky-600 text-white shadow-md":"text-gray-500 hover:text-sky-600"}`,children:R},R))})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-gray-700 text-xs font-black uppercase tracking-widest mb-2 md:mb-3",children:[h.jsx("span",{className:"text-red-500 mr-1",children:"*"})," Leave Type"]}),h.jsx("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:y.map(R=>h.jsxs("button",{type:"button",onClick:()=>m({...p,leaveType:R.id}),className:`flex items-center gap-2 md:gap-3 p-2 md:p-3 rounded-xl border-2 transition-all group ${p.leaveType===R.id?"border-sky-500 bg-sky-50/50 shadow-sm":"border-gray-100 hover:border-sky-200 hover:bg-white"}`,children:[h.jsx(R.icon,{className:`text-base md:text-lg transition-transform group-hover:scale-110 ${p.leaveType===R.id?R.color:"text-gray-400"}`}),h.jsx("span",{className:`text-[10px] md:text-[11px] font-bold ${p.leaveType===R.id?"text-sky-800":"text-gray-600"}`,children:R.label})]},R.id))}),p.leaveType==="Vacation/Function"&&h.jsxs("p",{className:"mt-2 text-[10px] text-orange-600 font-bold bg-orange-50 p-2 rounded flex items-center gap-2",children:[h.jsx("span",{children:""})," Requires 7 days advance notice from today."]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-3 md:gap-4",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-gray-700 text-xs font-black uppercase tracking-widest mb-1.5 flex items-center gap-1",children:[h.jsx("span",{className:"text-red-500",children:"*"})," From"]}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"date",required:!0,className:"w-full border-2 border-gray-100 rounded-xl p-2 md:p-3 text-xs font-bold text-gray-700 focus:border-sky-500 outline-none transition-colors",value:p.startDate,onChange:R=>m({...p,startDate:R.target.value})}),h.jsx(cu,{className:"absolute right-3 md:right-4 top-[10px] md:top-[14px] text-sky-600 pointer-events-none opacity-50"})]})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-gray-700 text-xs font-black uppercase tracking-widest mb-1.5 flex items-center gap-1",children:[h.jsx("span",{className:"text-red-500",children:"*"})," To"]}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"date",required:!0,className:"w-full border-2 border-gray-100 rounded-xl p-2 md:p-3 text-xs font-bold text-gray-700 focus:border-sky-500 outline-none transition-colors",value:p.endDate,onChange:R=>m({...p,endDate:R.target.value})}),h.jsx(cu,{className:"absolute right-3 md:right-4 top-[10px] md:top-[14px] text-sky-600 pointer-events-none opacity-50"})]})]})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-gray-700 text-xs font-black uppercase tracking-widest mb-2 flex items-center gap-1",children:[h.jsx("span",{className:"text-red-500",children:"*"})," Reason (Detail)"]}),h.jsx("textarea",{required:!0,rows:3,className:"w-full border-2 border-sky-700 rounded-xl p-3 md:p-4 text-xs font-medium focus:ring-2 focus:ring-sky-500 outline-none resize-none bg-sky-50/10 placeholder-gray-400",placeholder:"Please provide details about your leave request...",value:p.detail,onChange:R=>m({...p,detail:R.target.value})})]}),h.jsx("div",{className:"text-center pt-3 md:pt-4 mt-2",children:h.jsx("button",{type:"submit",disabled:r,className:"bg-[#ff7b7b] text-white py-3 px-12 rounded-xl font-black uppercase tracking-[0.2em] hover:bg-[#ff5d5d] transition-all shadow-lg hover:shadow-xl active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed text-xs mx-auto block",children:r?"Submitting...":"Submit Request"})})]})})]})}),h.jsx(Oh,{isOpen:n.isOpen,onClose:I,type:n.type,title:n.title,message:n.message})]})},fR=()=>{const i=kf(),{employee:t}=du(),[r,a]=le.useState([]),[n,e]=le.useState(!0),[p,m]=le.useState(null),[y,w]=le.useState("All"),[A,I]=le.useState(!1),R=le.useCallback(async(U=!0)=>{if(t?.email)try{U&&e(!0);const te=await cr.getPermissionRequests(t.email);a(te),te.length>0&&!p&&m(te[0])}catch(te){console.error("Failed to load permissions",te)}finally{e(!1),I(!1)}},[t?.email,p]),k=()=>{I(!0),R(!1)};le.useEffect(()=>{console.log("Permission Component Mounted"),R()},[R]);const M=r.filter(U=>y==="All"?!0:y==="Pending"?U.status==="Pending"||U.status==="Pending Manager Approval":U.status===y),V=U=>U?new Date(U).toLocaleDateString("en-GB"):"",q=U=>U==="Approved"?h.jsx(Pc,{className:"text-green-600 text-3xl mx-auto"}):U==="Withdrawn"?h.jsx("div",{className:"text-blue-600 text-4xl mx-auto",children:""}):U.includes("Pending")?h.jsx("div",{className:"text-orange-400 text-4xl mx-auto font-serif",children:"?"}):null;return h.jsxs("div",{className:"min-h-full flex flex-col relative -mt-1",children:[h.jsx("div",{className:"absolute top-0 right-0 z-20",children:h.jsxs("button",{onClick:()=>i("/permission/new"),className:"flex items-center gap-2 bg-[#0078d4] hover:bg-[#005a9e] text-white px-5 py-2 rounded-lg shadow-md transition-all font-semibold text-sm",children:[h.jsx(Hy,{className:"text-lg"}),h.jsx("span",{children:"New Request"})]})}),h.jsxs("div",{className:"w-full flex-grow flex flex-col min-h-0",children:[h.jsxs("header",{className:"flex-none flex items-center justify-start mb-6",children:[h.jsx("div",{className:"flex gap-2 bg-white/60 p-1 rounded-full backdrop-blur-sm shadow-sm border border-gray-100",children:["All","Pending","Approved","Declined","Withdrawn"].map(U=>h.jsx("button",{onClick:()=>w(U),className:`px-5 py-1.5 rounded-full font-bold text-xs transition-all duration-200 ${y===U?"bg-[#0078d4] text-white shadow-md":"text-gray-500 hover:bg-white hover:text-[#0078d4]"}`,children:U},U))}),h.jsx("button",{onClick:k,disabled:n||A,className:`ml-3 p-2 rounded-full hover:bg-white/60 text-gray-400 hover:text-[#0078d4] transition-all border border-transparent hover:border-gray-100 shadow-none hover:shadow-sm ${A?"animate-spin":""}`,title:"Refresh List",children:h.jsx(uu,{className:"text-sm"})})]}),h.jsxs("div",{className:"flex-grow grid grid-cols-1 lg:grid-cols-12 gap-6 min-h-0",children:[h.jsx("div",{className:"lg:col-span-9 overflow-y-auto pr-2 custom-scrollbar",children:n?h.jsx("div",{className:"text-center py-10 text-gray-500 font-medium",children:"Loading requests..."}):M.length===0?h.jsx("div",{className:"text-center py-10 text-gray-500 bg-white/40 rounded-xl border border-dashed border-gray-200",children:"No permission requests found."}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 pb-8",children:M.map(U=>h.jsxs("div",{onClick:()=>m(U),className:`bg-white cursor-pointer transition-all duration-200 border relative group flex flex-col hover:shadow-lg @container ${p?.id===U.id?"border-sky-500 ring-2 ring-sky-500/10 scale-[1.02]":"border-gray-200 shadow-sm"}`,children:[h.jsxs("div",{className:"p-4 flex-grow flex flex-col items-center justify-between min-h-[200px] w-full",children:[h.jsx("h3",{className:"font-normal text-gray-900 text-xs @[150px]:text-sm mb-1 text-center truncate w-full px-1",children:U.employeeName}),h.jsxs("div",{className:"text-gray-700 font-normal text-[11px] @[150px]:text-xs flex items-center justify-center gap-1.5 mb-2 w-full px-1",children:[h.jsx("span",{className:"text-sm @[150px]:text-base",children:""}),h.jsxs("span",{className:"truncate",children:[U.hours," hrs"]})]}),h.jsx("div",{className:"font-normal text-gray-500 text-[8px] @[140px]:text-[9px] @[170px]:text-[10px] mb-3 bg-gray-50 px-1 py-1.5 rounded-lg border border-gray-100 whitespace-nowrap shadow-sm w-full text-center overflow-hidden",children:V(U.date)}),h.jsx("div",{className:"my-2 transition-transform duration-300 group-hover:scale-110",children:q(U.status)}),h.jsx("div",{className:"w-[40%] h-[1px] bg-gray-100 mt-auto mb-1"})]}),h.jsx("div",{className:`w-full h-10 flex items-center justify-center px-2 text-center text-white font-semibold text-[10px] @[150px]:text-xs uppercase tracking-widest ${U.status==="Approved"?"bg-[#00a651]":U.status==="Declined"?"bg-[#ed1c24]":U.status==="Withdrawn"?"bg-[#4b58e4]":"bg-[#ff9c00]"}`,children:U.status})]},U.id))})}),h.jsx("div",{className:"lg:col-span-3 flex flex-col min-h-0",children:h.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm flex flex-col max-h-full overflow-hidden",children:p?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"p-5 border-b border-gray-50 flex-none bg-gray-50/50",children:h.jsxs("h2",{className:"text-sm font-bold text-gray-800 text-center uppercase tracking-widest flex items-center justify-center gap-3",children:[h.jsx("div",{className:"h-[2px] w-4 bg-gray-200 rounded"}),"Request Details",h.jsx("div",{className:"h-[2px] w-4 bg-gray-200 rounded"})]})}),h.jsx("div",{className:"p-5 overflow-y-auto custom-scrollbar flex-grow",children:h.jsxs("div",{className:"space-y-6 text-center",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1.5",children:"Employee Name"}),h.jsx("div",{className:"text-gray-900 font-bold text-base",children:p.employeeName})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Date"}),h.jsx("div",{className:"text-xs font-bold text-gray-800 py-1.5 bg-gray-50 rounded border border-gray-100",children:V(p.date)})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Hours"}),h.jsxs("div",{className:"text-xs font-bold text-gray-800 py-1.5 bg-blue-50 rounded border border-blue-100",children:[p.hours," hrs"]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Reason (Detail)"}),h.jsx("div",{className:"text-xs text-gray-600 font-medium leading-relaxed bg-gray-50 p-3 rounded-lg border border-gray-50 italic",children:p.reason||"No details provided."})]}),h.jsx("div",{className:"h-px bg-gray-100 w-full"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1",children:"Status"}),h.jsx("div",{className:`text-xs font-black uppercase ${p.status==="Approved"?"text-emerald-600":p.status==="Pending"?"text-amber-500":"text-gray-500"}`,children:p.status})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1",children:"Approver"}),h.jsx("div",{className:"text-xs font-bold text-gray-800",children:p.manager})]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Manager Comments"}),h.jsx("div",{className:"text-[11px] text-gray-600 bg-emerald-50/30 border border-emerald-100/50 rounded-lg p-3 italic min-h-[50px] flex items-center justify-center",children:p.approvalComments?`"${p.approvalComments}"`:"No comments from manager."})]})]})})]}):h.jsxs("div",{className:"p-10 flex flex-col items-center justify-center text-gray-300 space-y-3 opacity-60",children:[h.jsx("div",{className:"text-5xl",children:""}),h.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",children:"Select a card"})]})})})]})]})]})},pR=()=>{const i=kf(),{employee:t}=du(),[r,a]=le.useState({date:"",hours:"",reason:""}),[n,e]=le.useState(!1),[p,m]=le.useState({isOpen:!1,type:"success",title:"",message:""}),y=async A=>{if(A.preventDefault(),!t?.email)return;const I=parseFloat(r.hours);if(isNaN(I)||I<=0){m({isOpen:!0,type:"error",title:"Invalid Hours",message:"Please enter a valid number of hours (e.g., 1, 1.5, 2)."});return}if(I>2){m({isOpen:!0,type:"error",title:"Hours Exceeded",message:"Maximum permission allowed is 2 hours. More than 2 hours will be considered as half day leave."});return}e(!0);try{await cr.createPermissionRequest({employeeEmail:t.email,employeeName:t.name,permissionType:I>2?"Half Day":"Permission",date:r.date,hours:r.hours,reason:r.reason}),m({isOpen:!0,type:"success",title:"Request Submitted",message:"Your permission request has been successfully submitted for approval."})}catch(R){console.error("Failed to submit permission request",R),m({isOpen:!0,type:"error",title:"Submission Failed",message:"Failed to submit permission request. Please try again or contact support if the issue persists."})}finally{e(!1)}},w=()=>{m({...p,isOpen:!1}),p.type==="success"&&i("/permission")};return h.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-blue-400 p-8",children:[h.jsx("div",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:h.jsx("p",{className:"text-blue-700 font-medium text-center",children:"Note: Maximum Permission Allowed is 2:00 Hours. More than 2 Hours will consider as Halfday."})}),h.jsxs("form",{onSubmit:y,className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-blue-700 font-semibold mb-2",children:"*Date"}),h.jsx("input",{type:"date",required:!0,value:r.date,onChange:A=>a({...r,date:A.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-blue-700 font-semibold mb-2",children:"*Hours"}),h.jsx("input",{type:"number",step:"0.5",min:"0.5",max:"2",required:!0,value:r.hours,onChange:A=>a({...r,hours:A.target.value}),placeholder:"Enter hours (e.g., 1.5)",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-blue-700 font-semibold mb-2",children:"*Reason"}),h.jsx("textarea",{required:!0,rows:6,value:r.reason,onChange:A=>a({...r,reason:A.target.value}),placeholder:"Please provide details about your permission request...",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),h.jsx("div",{className:"flex justify-center pt-4",children:h.jsx("button",{type:"submit",disabled:n,className:"px-12 py-3 bg-red-500 hover:bg-red-600 text-white font-bold text-lg rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md",children:n?"SUBMITTING...":"SUBMIT"})})]})]}),h.jsx(Oh,{isOpen:p.isOpen,onClose:w,type:p.type,title:p.title,message:p.message})]})},mR=(i,t,r,a,n,e,p,m,y,w,A,I,R,k)=>{const M=["January","February","March","April","May","June","July","August","September","October","November","December"],V=new en,q=V.internal.pageSize.getWidth();V.setFontSize(14),V.setFont("helvetica","bold"),V.text("JM TECH TALENT IT SERVICES PRIVATE LIMITED",q/2,15,{align:"center"}),V.setFontSize(9),V.setFont("helvetica","normal"),V.text("CIN No.U72900TN2016PTC111685",q/2,21,{align:"center"}),V.text("Sidco Electronic Complex, T.V.K. Industrial Estate, Guindy, Chennai  600 032",q/2,27,{align:"center"});try{const ve=new Image;ve.src="/jm-logo.png",V.addImage(ve,"PNG",q-35,8,25,20)}catch{console.log("Logo not loaded")}V.setFontSize(12),V.setFont("helvetica","bold"),V.text(`Salary Slip ${M[t]} ${r}`,q/2,35,{align:"center"});const U=[["Employee Name:",i.name],["Designation:",i.designation||i.role],["Department:",i.department||"IT"],["Date of Joining:",i.dateOfJoining||""],["Salary slip for:",`${M[t].substring(0,3)}-${r.toString().substring(2)}`],["E mail:",i.email],["UAN NO:",""]],te=[["Total Workings days","30.00"],["Present for",a.toString()],["LOP",""],["Leave adjusted",""],["Earn leave b/f.",""],["Earn leave c/f.",""],["PF No.",""]];jm(V,{startY:42,body:U,theme:"grid",styles:{fontSize:9,cellPadding:2},columnStyles:{0:{fontStyle:"bold",cellWidth:35},1:{cellWidth:55}},margin:{left:10,right:q/2+5}}),jm(V,{startY:42,body:te,theme:"grid",styles:{fontSize:9,cellPadding:2},columnStyles:{0:{cellWidth:40},1:{cellWidth:45,halign:"right"}},margin:{left:q/2+5,right:10}});const W=Math.max(V.lastAutoTable.finalY,95)+5,re=[[{content:"Particulars",styles:{fontStyle:"bold",halign:"center"}},{content:"Gross Salary (Rs.)",styles:{fontStyle:"bold",halign:"center"}},{content:"Deductions",styles:{fontStyle:"bold",halign:"center"}},{content:"Amount (Rs.)",styles:{fontStyle:"bold",halign:"center"}},{content:"Net Salary (Rs.)",styles:{fontStyle:"bold",halign:"center"}}],["Basic & DA",n.toFixed(2),"Provident Fund",y.toFixed(2),""],["HRA",e.toFixed(2),"E.S.I.","-",""],["Conveyance","-","Loss of Pay","-",""],["Special Allowance",p.toFixed(2),"Professional Tax",w.toFixed(2),""],["Medical Allowance","-","TDS on Salary",A.toFixed(2),""],["Salary Adjustment",m.toFixed(2),"","",""],[{content:"Total",styles:{fontStyle:"bold"}},{content:I.toFixed(2),styles:{fontStyle:"bold"}},{content:"Total",styles:{fontStyle:"bold"}},{content:R.toFixed(2),styles:{fontStyle:"bold"}},""],[{content:"",colSpan:3,styles:{fontStyle:"bold"}},{content:"Total Net Salary",styles:{fontStyle:"bold"}},{content:k.toFixed(2),styles:{fontStyle:"bold",fontSize:11}}]];jm(V,{startY:W,head:[re[0]],body:re.slice(1),theme:"grid",styles:{fontSize:9,cellPadding:2,lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold"},columnStyles:{0:{cellWidth:40},1:{cellWidth:35,halign:"right"},2:{cellWidth:40},3:{cellWidth:35,halign:"right"},4:{cellWidth:40,halign:"right"}},margin:{left:10,right:10}}),V.setFontSize(8),V.setTextColor(100,100,100),V.text("This is a computer-generated document and does not require a signature.",q/2,V.internal.pageSize.getHeight()-10,{align:"center"});const xe=`Payslip_${i.name.replace(/\s+/g,"_")}_${M[t]}_${r}.pdf`;V.save(xe)},gR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(null),[p,m]=le.useState(!1),[y,w]=le.useState(new Date().getMonth()),[A,I]=le.useState(new Date().getFullYear()),[R,k]=le.useState(0),[M,V]=le.useState(!1),[q,U]=le.useState(5e3),[te,W]=le.useState(2e3),[re,xe]=le.useState(1e3),[ve,De]=le.useState(0),[ke,de]=le.useState(1800),[Oe,z]=le.useState(200),[K,Ae]=le.useState(0),[Ce,Be]=le.useState(0),[Ee,Pe]=le.useState(0),[Ue,_e]=le.useState(0),Le=["January","February","March","April","May","June","July","August","September","October","November","December"],X=[2024,2025,2026];le.useEffect(()=>{(async()=>{try{const se=await cr.getAllEmployees();t(se)}catch(se){console.error("Error fetching employees:",se)}finally{a(!1)}})()},[]),le.useEffect(()=>{const Z=Number(q)+Number(te)+Number(re)+Number(ve),se=Number(ke)+Number(Oe)+Number(K);Be(Z),Pe(se),_e(Z-se)},[q,te,re,ve,ke,Oe,K]),le.useEffect(()=>{if(!n)return;p&&(async()=>{V(!0);try{const se=new Date(A,y,1),ye=new Date(A,y+1,0),ce=se.toISOString().split("T")[0],ze=ye.toISOString().split("T")[0],Ve=(await cr.getAttendanceHistory(n.email,ce,ze)).filter(yt=>yt.status!=="Absent").length;k(Ve)}catch(se){console.error("Error calculating attendance:",se),k(0)}finally{V(!1)}})()},[n,y,A,p]);const H=Z=>{e(Z),m(!0)},ae=()=>{n&&mR(n,y,A,R,q,te,re,ve,ke,Oe,K,Ce,Ee,Ue)};return r?h.jsx("div",{className:"flex items-center justify-center h-screen",children:h.jsx(oy,{className:"animate-spin text-4xl text-blue-600"})}):h.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[h.jsx("div",{className:"bg-green-100 p-3 rounded-xl",children:h.jsx(mS,{className:"text-2xl text-green-600"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Payroll Management"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Generate payslips and manage employee salaries"})]})]}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:h.jsxs("table",{className:"w-full text-left",children:[h.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Employee"}),h.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"ID"}),h.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Department"}),h.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase text-right",children:"Action"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-50",children:i.map(Z=>h.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-xs",children:Z.name.charAt(0)}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900",children:Z.name}),h.jsx("p",{className:"text-xs text-gray-500",children:Z.email})]})]})}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:Z.employeeId||"-"}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:h.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs font-medium text-gray-600",children:Z.department||"General"})}),h.jsx("td",{className:"px-6 py-4 text-right",children:h.jsxs("button",{onClick:()=>H(Z),className:"inline-flex items-center gap-2 px-3 py-1.5 text-xs font-medium text-green-700 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors",children:[h.jsx(r9,{})," Generate Slip"]})})]},Z.id))})]})}),p&&n&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[h.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Generate Payslip"}),h.jsxs("p",{className:"text-sm text-gray-500",children:["for ",h.jsx("span",{className:"font-semibold text-blue-600",children:n.name})]})]}),h.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:h.jsx(Ju,{className:"text-xl"})})]}),h.jsxs("div",{className:"p-6 space-y-8",children:[h.jsxs("div",{className:"flex flex-wrap gap-4 items-end bg-gray-50 p-4 rounded-xl border border-gray-100",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Month"}),h.jsx("select",{value:y,onChange:Z=>w(Number(Z.target.value)),className:"px-3 py-2 border rounded-lg text-sm bg-white",children:Le.map((Z,se)=>h.jsx("option",{value:se,children:Z},se))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Year"}),h.jsx("select",{value:A,onChange:Z=>I(Number(Z.target.value)),className:"px-3 py-2 border rounded-lg text-sm bg-white",children:X.map(Z=>h.jsx("option",{value:Z,children:Z},Z))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Days Payable"}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"number",value:R,onChange:Z=>k(Number(Z.target.value)),className:"px-3 py-2 border rounded-lg text-sm w-32 pl-8 font-bold text-gray-800"}),h.jsx("div",{className:"absolute left-2.5 top-2.5 text-gray-400 text-xs",children:""}),M&&h.jsx("div",{className:"absolute right-2 top-2",children:h.jsx(oy,{className:"animate-spin text-blue-500"})})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-bold text-green-700 uppercase tracking-wider mb-4 border-b border-green-100 pb-2",children:"Earnings"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-sm text-gray-600",children:"Basic Salary"}),h.jsx("input",{type:"number",value:q,onChange:Z=>U(Number(Z.target.value)),className:"w-32 px-2 py-1 border rounded text-right"})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-sm text-gray-600",children:"HRA"}),h.jsx("input",{type:"number",value:te,onChange:Z=>W(Number(Z.target.value)),className:"w-32 px-2 py-1 border rounded text-right"})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-sm text-gray-600",children:"Special Allowance"}),h.jsx("input",{type:"number",value:re,onChange:Z=>xe(Number(Z.target.value)),className:"w-32 px-2 py-1 border rounded text-right"})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-sm text-gray-600",children:"Bonus / Incentives"}),h.jsx("input",{type:"number",value:ve,onChange:Z=>De(Number(Z.target.value)),className:"w-32 px-2 py-1 border rounded text-right"})]}),h.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100 font-bold text-gray-900",children:[h.jsx("span",{children:"Gross Earnings"}),h.jsx("span",{children:Ce.toFixed(2)})]})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-bold text-red-700 uppercase tracking-wider mb-4 border-b border-red-100 pb-2",children:"Deductions"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-sm text-gray-600",children:"Provident Fund (PF)"}),h.jsx("input",{type:"number",value:ke,onChange:Z=>de(Number(Z.target.value)),className:"w-32 px-2 py-1 border rounded text-right"})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-sm text-gray-600",children:"Professional Tax"}),h.jsx("input",{type:"number",value:Oe,onChange:Z=>z(Number(Z.target.value)),className:"w-32 px-2 py-1 border rounded text-right"})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{className:"text-sm text-gray-600",children:"TDS (Tax)"}),h.jsx("input",{type:"number",value:K,onChange:Z=>Ae(Number(Z.target.value)),className:"w-32 px-2 py-1 border rounded text-right"})]}),h.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100 font-bold text-gray-900",children:[h.jsx("span",{children:"Total Deductions"}),h.jsx("span",{children:Ee.toFixed(2)})]})]})]})]}),h.jsxs("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 rounded-xl p-6 text-white flex justify-between items-center shadow-lg",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Net Payable Amount"}),h.jsxs("h2",{className:"text-3xl font-bold",children:["",Ue.toFixed(2)]})]}),h.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-6 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg font-bold shadow-green-900/20 shadow-lg transition-transform hover:scale-105 active:scale-95",children:[h.jsx(dx,{})," Download PDF"]})]})]})]})})]})},NA=[{value:"Pacific/Midway",label:"(UTC-11:00) Midway Island, Samoa"},{value:"Pacific/Honolulu",label:"(UTC-10:00) Hawaii"},{value:"America/Anchorage",label:"(UTC-09:00) Alaska"},{value:"America/Los_Angeles",label:"(UTC-08:00) Pacific Time (US & Canada)"},{value:"America/Tijuana",label:"(UTC-08:00) Tijuana, Baja California"},{value:"America/Denver",label:"(UTC-07:00) Mountain Time (US & Canada)"},{value:"America/Chihuahua",label:"(UTC-07:00) Chihuahua, La Paz"},{value:"America/Phoenix",label:"(UTC-07:00) Arizona"},{value:"America/Chicago",label:"(UTC-06:00) Central Time (US & Canada)"},{value:"America/Regina",label:"(UTC-06:00) Saskatchewan"},{value:"America/Mexico_City",label:"(UTC-06:00) Guadalajara, Mexico City"},{value:"America/New_York",label:"(UTC-05:00) Eastern Time (US & Canada)"},{value:"America/Bogota",label:"(UTC-05:00) Bogota, Lima, Quito"},{value:"America/Caracas",label:"(UTC-04:00) Caracas"},{value:"America/Halifax",label:"(UTC-04:00) Atlantic Time (Canada)"},{value:"America/Manaus",label:"(UTC-04:00) Manaus"},{value:"America/Santiago",label:"(UTC-04:00) Santiago"},{value:"America/St_Johns",label:"(UTC-03:30) Newfoundland"},{value:"America/Sao_Paulo",label:"(UTC-03:00) Brasilia"},{value:"America/Argentina/Buenos_Aires",label:"(UTC-03:00) Buenos Aires, Georgetown"},{value:"America/Godthab",label:"(UTC-03:00) Greenland"},{value:"Atlantic/South_Georgia",label:"(UTC-02:00) Mid-Atlantic"},{value:"Atlantic/Azores",label:"(UTC-01:00) Azores"},{value:"Atlantic/Cape_Verde",label:"(UTC-01:00) Cape Verde Is."},{value:"UTC",label:"(UTC+00:00) Coordinated Universal Time"},{value:"Europe/London",label:"(UTC+00:00) London, Edinburgh, Dublin"},{value:"Europe/Lisbon",label:"(UTC+00:00) Lisbon"},{value:"Africa/Casablanca",label:"(UTC+00:00) Casablanca, Monrovia"},{value:"Europe/Belgrade",label:"(UTC+01:00) Belgrade, Bratislava, Budapest"},{value:"Europe/Paris",label:"(UTC+01:00) Paris, Madrid, Copenhagen"},{value:"Europe/Rome",label:"(UTC+01:00) Rome"},{value:"Europe/Berlin",label:"(UTC+01:00) Berlin, Bern, Stockholm, Vienna"},{value:"Europe/Amsterdam",label:"(UTC+01:00) Amsterdam, Berlin, Rome"},{value:"Africa/Lagos",label:"(UTC+01:00) West Central Africa"},{value:"Europe/Bucharest",label:"(UTC+02:00) Bucharest"},{value:"Africa/Cairo",label:"(UTC+02:00) Cairo"},{value:"Europe/Helsinki",label:"(UTC+02:00) Helsinki, Kyiv, Riga"},{value:"Europe/Istanbul",label:"(UTC+03:00) Istanbul"},{value:"Asia/Jerusalem",label:"(UTC+02:00) Jerusalem"},{value:"Africa/Johannesburg",label:"(UTC+02:00) Harare, Pretoria"},{value:"Asia/Kuwait",label:"(UTC+03:00) Kuwait, Riyadh"},{value:"Europe/Moscow",label:"(UTC+03:00) Moscow, St. Petersburg"},{value:"Africa/Nairobi",label:"(UTC+03:00) Nairobi"},{value:"Asia/Baghdad",label:"(UTC+03:00) Baghdad"},{value:"Asia/Tehran",label:"(UTC+03:30) Tehran"},{value:"Asia/Dubai",label:"(UTC+04:00) Abu Dhabi, Muscat"},{value:"Asia/Baku",label:"(UTC+04:00) Baku"},{value:"Asia/Kabul",label:"(UTC+04:30) Kabul"},{value:"Asia/Yekaterinburg",label:"(UTC+05:00) Ekaterinburg"},{value:"Asia/Karachi",label:"(UTC+05:00) Islamabad, Karachi"},{value:"Asia/Kolkata",label:"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi"},{value:"Asia/Kathmandu",label:"(UTC+05:45) Kathmandu"},{value:"Asia/Dhaka",label:"(UTC+06:00) Dhaka"},{value:"Asia/Almaty",label:"(UTC+06:00) Almaty, Novosibirsk"},{value:"Asia/Rangoon",label:"(UTC+06:30) Yangon (Rangoon)"},{value:"Asia/Bangkok",label:"(UTC+07:00) Bangkok, Hanoi, Jakarta"},{value:"Asia/Krasnoyarsk",label:"(UTC+07:00) Krasnoyarsk"},{value:"Asia/Hong_Kong",label:"(UTC+08:00) Beijing, Chongqing, Hong Kong"},{value:"Asia/Kuala_Lumpur",label:"(UTC+08:00) Kuala Lumpur, Singapore"},{value:"Asia/Taipei",label:"(UTC+08:00) Taipei"},{value:"Australia/Perth",label:"(UTC+08:00) Perth"},{value:"Asia/Irkutsk",label:"(UTC+08:00) Irkutsk, Ulaan Bataar"},{value:"Asia/Tokyo",label:"(UTC+09:00) Osaka, Sapporo, Tokyo"},{value:"Asia/Seoul",label:"(UTC+09:00) Seoul"},{value:"Asia/Yakutsk",label:"(UTC+09:00) Yakutsk"},{value:"Australia/Adelaide",label:"(UTC+09:30) Adelaide"},{value:"Australia/Darwin",label:"(UTC+09:30) Darwin"},{value:"Australia/Brisbane",label:"(UTC+10:00) Brisbane"},{value:"Australia/Sydney",label:"(UTC+10:00) Canberra, Melbourne, Sydney"},{value:"Pacific/Guam",label:"(UTC+10:00) Guam, Port Moresby"},{value:"Australia/Hobart",label:"(UTC+10:00) Hobart"},{value:"Asia/Vladivostok",label:"(UTC+10:00) Vladivostok"},{value:"Pacific/Noumea",label:"(UTC+11:00) Solomon Is., New Caledonia"},{value:"Pacific/Auckland",label:"(UTC+12:00) Auckland, Wellington"},{value:"Pacific/Fiji",label:"(UTC+12:00) Fiji, Kamchatka, Marshall Is."},{value:"Pacific/Tongatapu",label:"(UTC+13:00) Nuku'alofa"}],TA=i=>{const t=NA.find(r=>r.value===i);return t?t.label:i},yR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState([]),[n,e]=le.useState({}),[p,m]=le.useState(!0),[y,w]=le.useState(new Date),[A,I]=le.useState(null),[R,k]=le.useState(""),{permissionLevel:M,employee:V}=du(),{instance:q}=Cd(),[U,te]=le.useState(!1),[W,re]=le.useState(null),[xe,ve]=le.useState(null),[De,ke]=le.useState(null),[de,Oe]=le.useState(null),[z,K]=le.useState(null),[Ae,Ce]=le.useState({name:"",role:"",department:"",email:"",shiftId:"",place:"",padding:"",permissionLevel:"Employee"}),[Be,Ee]=le.useState({name:"",role:"",department:"",email:"",shiftId:"",place:"",permissionLevel:"Employee"}),[Pe,Ue]=le.useState([]),_e=pe=>Ue(Ve=>[...Ve,`${new Date().toISOString().split("T")[1].slice(0,8)}: ${pe}`]),Le=(pe,Ve="success")=>{K({message:pe,type:Ve}),setTimeout(()=>K(null),4e3)},X=le.useCallback(async()=>{try{m(!0),I(null),_e("Starting fetch...");const pe=await cr.getAllEmployees();t(M==="HR"?pe.filter(yt=>yt.permissionLevel!=="Admin"):pe);const Ve=await cr.getAllShifts();if(a(Ve),pe.length>0){const yt=pe.map(Ft=>cr.getTodayAttendance(Ft.id).catch(()=>null)),vt=await Promise.all(yt),bt={};pe.forEach((Ft,Te)=>{bt[Ft.id]=vt[Te]}),e(bt)}_e("Fetch complete.")}catch(pe){console.error(pe),I(pe instanceof Error?pe.message:"Unknown error")}finally{m(!1)}},[M]);le.useEffect(()=>{X();const pe=setInterval(()=>w(new Date),6e4);return()=>clearInterval(pe)},[X]);const H=async pe=>{pe.preventDefault();try{m(!0);const Ve=await cr.addEmployee({...Ae,avatarUrl:""});t(yt=>[...yt,Ve]),te(!1),Le("Employee added successfully!")}catch(Ve){const yt=Ve instanceof Error?Ve.message:"Unknown error";Le(`Failed to add: ${yt}`,"error")}finally{m(!1)}},ae=async pe=>{if(pe.preventDefault(),!!W)try{m(!0),await cr.updateEmployee(W,Be),t(Ve=>Ve.map(yt=>yt.id===W?{...yt,...Be}:yt)),re(null),Le("Employee updated successfully!")}catch(Ve){const yt=Ve instanceof Error?Ve.message:"Unknown error";Le(`Update failed: ${yt}`,"error")}finally{m(!1)}},Z=async()=>{if(xe)try{m(!0),await cr.deleteEmployee(xe.id),t(pe=>pe.filter(Ve=>Ve.id!==xe.id)),ve(null),Le("Employee removed successfully")}catch(pe){const Ve=pe instanceof Error?pe.message:"Unknown error";Le(`Delete failed: ${Ve}`,"error")}finally{m(!1)}},se=async()=>{if(De)try{m(!0),await cr.disableEmployee(De.id),t(pe=>pe.map(Ve=>Ve.id===De.id?{...Ve,accountStatus:"Disabled"}:Ve)),ke(null),Le("Employee disabled successfully")}catch(pe){const Ve=pe instanceof Error?pe.message:"Unknown error";Le(`Disable failed: ${Ve}`,"error")}finally{m(!1)}},ye=async()=>{if(de)try{m(!0),await cr.enableEmployee(de.id),t(pe=>pe.map(Ve=>Ve.id===de.id?{...Ve,accountStatus:"Active"}:Ve)),Oe(null),Le("Employee enabled successfully")}catch(pe){const Ve=pe instanceof Error?pe.message:"Unknown error";Le(`Enable failed: ${Ve}`,"error")}finally{m(!1)}},ce=pe=>{if(M==="HR"){if(pe.email===V?.email){Le("Contact Admin to make changes to your own profile.","error");return}if(pe.department==="HR"){Le("Contact Admin to make changes to HR profiles.","error");return}}re(pe.id),Ee({name:pe.name,role:pe.role||"",department:pe.department||"",email:pe.email||"",shiftId:pe.shiftId||"",place:pe.place||"",permissionLevel:pe.permissionLevel||"Employee"})},ze=pe=>r.find(Ve=>Ve.id===pe);if(A){const pe=A.includes("InteractionRequired")||A.includes("No active account");return h.jsxs("div",{className:"p-12 text-center",children:[h.jsxs("div",{className:"bg-red-50 text-red-700 p-6 rounded-xl inline-block max-w-2xl text-left border border-red-100 shadow-sm",children:[h.jsx("h3",{className:"font-bold text-lg mb-2",children:"Error Loading Directory"}),h.jsx("p",{className:"font-mono text-sm mb-4",children:A}),h.jsxs("div",{className:"border-t border-red-200 pt-3",children:[h.jsx("p",{className:"font-bold text-xs uppercase mb-1",children:"Debug History:"}),Pe.map((Ve,yt)=>h.jsx("div",{className:"text-xs opacity-75",children:Ve},yt))]})]}),h.jsx("div",{className:"mt-8 flex gap-4 justify-center",children:pe?h.jsx("button",{onClick:()=>q.acquireTokenPopup({scopes:["https://jmtechtalent.sharepoint.com/.default"]}).then(X),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold shadow-lg shadow-indigo-100",children:"Reconnect"}):h.jsx("button",{onClick:X,className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-bold",children:"Retry"})})]})}return p&&i.length===0?h.jsxs("div",{className:"p-12 text-center flex flex-col items-center",children:[h.jsx("div",{className:"w-12 h-12 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mb-6"}),h.jsxs("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg text-xs font-mono w-full max-w-md text-left shadow-xl h-48 overflow-y-auto",children:[h.jsx("p",{className:"text-white border-b border-gray-800 pb-1 mb-2",children:"System Initializing..."}),Pe.map((pe,Ve)=>h.jsx("div",{children:pe},Ve))]})]}):h.jsxs("div",{className:"p-6 max-w-7xl mx-auto min-h-screen",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-6",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Employee Directory"}),h.jsx("p",{className:"text-gray-500 mt-1",children:"Manage personnel and monitor live attendance status."})]}),h.jsxs("div",{className:"flex gap-4 w-full md:w-auto",children:[h.jsxs("div",{className:"relative flex-1 md:w-80",children:[h.jsx($o,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Filter by name or role...",className:"w-full pl-11 pr-4 py-2.5 border border-gray-200 rounded-xl focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all shadow-sm",value:R,onChange:pe=>k(pe.target.value)})]}),h.jsx("button",{onClick:X,className:"p-2.5 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-xl transition-all shadow-sm",title:"Refresh Data",children:h.jsx(Cf,{})}),h.jsxs("button",{onClick:()=>te(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-xl shadow-lg shadow-indigo-200 flex items-center gap-2 font-semibold transition-all shrink-0",children:[h.jsx(ip,{})," ",h.jsx("span",{className:"hidden sm:inline",children:"Add Employee"})]})]})]}),h.jsx("div",{className:"grid grid-cols-1 gap-4",children:i.filter(pe=>pe.name.toLowerCase().includes(R.toLowerCase())||pe.role.toLowerCase().includes(R.toLowerCase())).sort((pe,Ve)=>pe.accountStatus!=="Disabled"&&Ve.accountStatus==="Disabled"?-1:pe.accountStatus==="Disabled"&&Ve.accountStatus!=="Disabled"?1:pe.name.localeCompare(Ve.name)).map(pe=>{const Ve=ze(pe.shiftId),yt=n[pe.id],vt=yt&&!yt.checkOutTime,{state:bt}=Ve?CA(Ve,y):{state:"OFF"};return h.jsx("div",{className:"bg-white rounded-2xl p-5 border border-gray-100 shadow-sm hover:shadow-md transition-all group",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 items-center",children:[h.jsxs("div",{className:"md:col-span-4 flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-600 shrink-0 group-hover:bg-indigo-600 group-hover:text-white transition-colors",children:h.jsx(Hy,{size:28})}),h.jsxs("div",{className:"min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("h3",{className:`font-bold truncate ${pe.accountStatus==="Disabled"?"text-gray-400 line-through":"text-gray-900"}`,children:pe.name}),h.jsx("button",{onClick:()=>ce(pe),className:"text-gray-400 hover:text-indigo-600 p-1",children:h.jsx(Nf,{size:14})}),pe.accountStatus==="Disabled"?h.jsx("button",{onClick:()=>Oe(pe),className:"text-gray-400 hover:text-green-600 p-1",title:"Enable User",children:h.jsx(Pc,{size:12})}):h.jsx("button",{onClick:()=>ke(pe),className:"text-gray-400 hover:text-orange-600 p-1",title:"Disable User",children:h.jsx(P4,{size:12})}),M==="Admin"&&h.jsx("button",{onClick:()=>ve(pe),className:"text-gray-400 hover:text-red-600 p-1",children:h.jsx(Sd,{size:12})})]}),h.jsxs("p",{className:"text-sm text-gray-500 truncate font-medium",children:[pe.role,"  ",pe.department]})]})]}),h.jsxs("div",{className:"md:col-span-4 flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400 shrink-0",children:h.jsx(Cf,{})}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Shift Schedule"}),Ve?h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("p",{className:"font-bold text-gray-800 text-sm",children:[Ve.name," ",h.jsxs("span",{className:"font-normal text-gray-500 ml-1",children:["(",Ve.startTime," - ",Ve.endTime,")"]})]}),h.jsx("span",{className:"text-[10px] text-indigo-500 font-bold uppercase tracking-tight",children:TA(Ve.timeZone||"UTC")})]}):h.jsx("p",{className:"text-gray-400 italic text-sm",children:"Not Assigned"})]})]}),h.jsxs("div",{className:"md:col-span-2 flex items-center gap-2",children:[h.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${vt?"bg-green-500 animate-pulse":"bg-gray-200"}`}),h.jsx("p",{className:`text-sm font-bold ${vt?"text-green-700":"text-gray-400"}`,children:vt?"ON DUTY":"OFF DUTY"})]}),h.jsx("div",{className:"md:col-span-2 flex justify-end",children:h.jsx("div",{className:`px-4 py-1.5 rounded-full text-[10px] font-extrabold tracking-tighter uppercase flex items-center gap-1.5 ${bt==="ACTIVE"?"bg-green-50 text-green-600 border border-green-100":"bg-gray-50 text-gray-400 border border-gray-100"}`,children:bt==="ACTIVE"?h.jsxs(h.Fragment,{children:[h.jsx(Pc,{size:10})," Active Now"]}):h.jsxs(h.Fragment,{children:[h.jsx(Jm,{size:10})," ",bt]})})})]})},pe.id)})}),U&&h.jsx("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in slide-in-from-bottom-4",children:[h.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-100 flex justify-between items-center",children:[h.jsx("h3",{className:"font-extrabold text-gray-900",children:"New Employee Profile"}),h.jsx("button",{onClick:()=>te(!1),className:"text-gray-400 hover:text-gray-900 transition-colors",children:h.jsx(Ju,{})})]}),h.jsxs("form",{onSubmit:H,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Full Name"}),h.jsx("input",{type:"text",required:!0,className:"input-style",value:Ae.name,onChange:pe=>Ce({...Ae,name:pe.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Work Email"}),h.jsx("input",{type:"email",required:!0,className:"input-style",value:Ae.email,onChange:pe=>Ce({...Ae,email:pe.target.value})})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Role"}),h.jsx("input",{type:"text",required:!0,className:"input-style",value:Ae.role,onChange:pe=>Ce({...Ae,role:pe.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Dept"}),h.jsx("input",{type:"text",required:!0,className:"input-style",value:Ae.department,onChange:pe=>Ce({...Ae,department:pe.target.value})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Work Location"}),h.jsx("input",{type:"text",className:"input-style",value:Ae.place,onChange:pe=>Ce({...Ae,place:pe.target.value}),placeholder:"e.g. Chennai, Remote, etc."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Shift Assignment"}),h.jsxs("select",{className:"input-style bg-white",value:Ae.shiftId,onChange:pe=>Ce({...Ae,shiftId:pe.target.value}),children:[h.jsx("option",{value:"",children:"Choose a shift..."}),r.map(pe=>h.jsxs("option",{value:pe.id,children:[pe.name," (",pe.startTime,"-",pe.endTime,")"]},pe.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Permission Level"}),h.jsxs("select",{className:"input-style bg-white",value:Ae.permissionLevel,onChange:pe=>Ce({...Ae,permissionLevel:pe.target.value}),children:[h.jsx("option",{value:"Employee",children:"Employee"}),h.jsx("option",{value:"Manager",children:"Manager"}),h.jsx("option",{value:"HR",children:"HR"}),M==="Admin"&&h.jsx("option",{value:"Admin",children:"Admin"}),h.jsx("option",{value:"Accounts",children:"Accounts"})]})]}),h.jsxs("div",{className:"flex gap-3 pt-6",children:[h.jsx("button",{type:"button",onClick:()=>te(!1),className:"flex-1 py-3 text-sm font-bold text-gray-500 hover:bg-gray-50 rounded-xl transition-colors",children:"Cancel"}),h.jsx("button",{type:"submit",className:"flex-1 py-3 text-sm font-bold bg-indigo-600 text-white rounded-xl shadow-lg shadow-indigo-100 hover:bg-indigo-700 transition-all",children:"Create Profile"})]})]})]})}),W&&h.jsx("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in slide-in-from-bottom-4",children:[h.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-100 flex justify-between items-center",children:[h.jsx("h3",{className:"font-extrabold text-gray-900",children:"Update Employee"}),h.jsx("button",{onClick:()=>re(null),className:"text-gray-400 hover:text-gray-900 transition-colors",children:h.jsx(Ju,{})})]}),h.jsxs("form",{onSubmit:ae,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Full Name"}),h.jsx("input",{type:"text",required:!0,className:"input-style",value:Be.name,onChange:pe=>Ee({...Be,name:pe.target.value})})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Role"}),h.jsx("input",{type:"text",required:!0,className:"input-style",value:Be.role,onChange:pe=>Ee({...Be,role:pe.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Dept"}),h.jsx("input",{type:"text",required:!0,className:"input-style",value:Be.department,onChange:pe=>Ee({...Be,department:pe.target.value})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Work Location"}),h.jsx("input",{type:"text",className:"input-style",value:Be.place,onChange:pe=>Ee({...Be,place:pe.target.value}),placeholder:"e.g. Chennai, Remote, etc."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Shift"}),h.jsxs("select",{className:"input-style bg-white",value:Be.shiftId,onChange:pe=>Ee({...Be,shiftId:pe.target.value}),children:[h.jsx("option",{value:"",children:"Select Shift"}),r.map(pe=>h.jsxs("option",{value:pe.id,children:[pe.name," (",pe.startTime,"-",pe.endTime,")"]},pe.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label-style",children:"Permission Level"}),h.jsxs("select",{className:"input-style bg-white",value:Be.permissionLevel,onChange:pe=>Ee({...Be,permissionLevel:pe.target.value}),children:[h.jsx("option",{value:"Employee",children:"Employee"}),h.jsx("option",{value:"Manager",children:"Manager"}),h.jsx("option",{value:"HR",children:"HR"}),M==="Admin"&&h.jsx("option",{value:"Admin",children:"Admin"}),h.jsx("option",{value:"Accounts",children:"Accounts"})]})]}),h.jsxs("div",{className:"flex gap-3 pt-6",children:[h.jsx("button",{type:"button",onClick:()=>re(null),className:"flex-1 py-3 text-sm font-bold text-gray-500 hover:bg-gray-50 rounded-xl",children:"Cancel"}),h.jsx("button",{type:"submit",className:"flex-1 py-3 text-sm font-bold bg-indigo-600 text-white rounded-xl shadow-lg hover:bg-indigo-700 transition-all",children:"Save Changes"})]})]})]})}),xe&&h.jsx("div",{className:"fixed inset-0 bg-gray-900/40 flex items-center justify-center z-50",children:h.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-sm w-full text-center shadow-2xl",children:[h.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(Sd,{size:24})}),h.jsx("h4",{className:"text-xl font-bold mb-2",children:"Confirm Removal"}),h.jsxs("p",{className:"text-gray-500 text-sm mb-8",children:["Are you sure you want to remove ",h.jsx("span",{className:"font-bold text-gray-900",children:xe.name}),"?"]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>ve(null),className:"flex-1 py-2 font-bold text-gray-400 hover:text-gray-600",children:"Cancel"}),h.jsx("button",{onClick:Z,className:"flex-1 py-2 bg-red-600 text-white rounded-lg font-bold shadow-lg shadow-red-100",children:"Delete"})]})]})}),De&&h.jsx("div",{className:"fixed inset-0 bg-gray-900/40 flex items-center justify-center z-50",children:h.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-sm w-full text-center shadow-2xl",children:[h.jsx("div",{className:"w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(P4,{size:24})}),h.jsx("h4",{className:"text-xl font-bold mb-2",children:"Disable Account"}),h.jsxs("p",{className:"text-gray-500 text-sm mb-6",children:["Are you sure you want to disable access for ",h.jsx("span",{className:"font-bold text-gray-900",children:De.name}),"?"]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>ke(null),className:"flex-1 py-2 font-bold text-gray-400 hover:text-gray-600",children:"Cancel"}),h.jsx("button",{onClick:se,className:"flex-1 py-2 bg-orange-600 text-white rounded-lg font-bold shadow-lg shadow-orange-100 hover:bg-orange-700",children:"Disable"})]})]})}),de&&h.jsx("div",{className:"fixed inset-0 bg-gray-900/40 flex items-center justify-center z-50",children:h.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-sm w-full text-center shadow-2xl",children:[h.jsx("div",{className:"w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(Pc,{size:24})}),h.jsx("h4",{className:"text-xl font-bold mb-2",children:"Enable Account"}),h.jsxs("p",{className:"text-gray-500 text-sm mb-6",children:["Are you sure you want to enable access for ",h.jsx("span",{className:"font-bold text-gray-900",children:de.name}),"?"]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>Oe(null),className:"flex-1 py-2 font-bold text-gray-400 hover:text-gray-600",children:"Cancel"}),h.jsx("button",{onClick:ye,className:"flex-1 py-2 bg-green-600 text-white rounded-lg font-bold shadow-lg shadow-green-100 hover:bg-green-700",children:"Enable"})]})]})}),z&&h.jsxs("div",{className:`fixed bottom-8 right-8 z-[100] px-6 py-4 rounded-2xl shadow-2xl border flex items-center gap-4 transition-all animate-bounce-in ${z.type==="success"?"bg-white border-green-100 text-green-800":z.type==="error"?"bg-white border-red-100 text-red-800":"bg-white border-indigo-100 text-indigo-800"}`,children:[h.jsx("div",{className:`text-xl ${z.type==="success"?"text-green-500":z.type==="error"?"text-red-500":"text-indigo-500"}`,children:z.type==="success"?h.jsx(Pc,{}):z.type==="error"?h.jsx(i9,{}):h.jsx(Pc,{})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest opacity-40",children:z.type}),h.jsx("p",{className:"font-bold text-sm tracking-tight",children:z.message})]})]}),h.jsx("style",{children:`
                .label-style { font-size: 11px; font-weight: 800; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; display: block; }
                .input-style { width: 100%; padding: 10px 14px; border: 1px solid #e2e8f0; border-radius: 12px; font-size: 14px; outline: none; transition: border-color 0.2s, box-shadow 0.2s; }
                .input-style:focus { border-color: #6366f1; box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.08); }
            `})]})},vR=()=>{const[i,t]=le.useState(!0),[r,a]=le.useState({usa:[],canada:[],apac:[]});le.useEffect(()=>{(async()=>{t(!0);try{const[p,m,y]=await Promise.all([cr.getUSAHolidays(),cr.getCanadaHolidays(),cr.getAPACHolidays()]);console.log("USA Data:",p),console.log("Canada Data:",m),console.log("APAC Data:",y);const w=A=>!A||!Array.isArray(A)?[]:A.filter(k=>k.date!=null).map(k=>{const M=k.date,V=new Date(M);return{date:V.toLocaleDateString("en-GB",{day:"numeric",month:"long"}),day:V.toLocaleDateString("en-US",{weekday:"long"}),event:k.title,rawDate:V}}).sort((k,M)=>k.rawDate.getTime()-M.rawDate.getTime());a({usa:w(p),canada:w(m),apac:w(y)})}catch(p){console.error("Failed to fetch holidays",p)}finally{t(!1)}})()},[]);const n=(e,p,m)=>h.jsxs("div",{className:"bg-white rounded-2xl border-2 border-blue-400 p-6 shadow-lg flex flex-col h-full",children:[h.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[h.jsx("img",{src:p,alt:e,className:"w-16 h-16 object-contain"}),h.jsx("h2",{className:"text-xl font-semibold text-blue-700",children:e})]}),h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b-2 border-blue-200",children:[h.jsx("th",{className:"text-left py-2 px-2 text-sm font-semibold text-blue-700",children:"Date"}),h.jsx("th",{className:"text-left py-2 px-2 text-sm font-semibold text-blue-700",children:"Day"}),h.jsx("th",{className:"text-left py-2 px-2 text-sm font-semibold text-blue-700",children:"Event"})]})}),h.jsx("tbody",{children:i?h.jsx("tr",{children:h.jsx("td",{colSpan:3,className:"py-8 text-center text-sm text-gray-500",children:h.jsx("span",{className:"inline-block animate-pulse",children:"Loading holidays..."})})}):m.length>0?m.map((y,w)=>h.jsxs("tr",{className:"border-b border-gray-100 last:border-0 hover:bg-blue-50 transition-colors",children:[h.jsx("td",{className:"py-3 px-2 text-sm text-gray-700",children:y.date}),h.jsx("td",{className:"py-3 px-2 text-sm text-gray-700",children:y.day}),h.jsx("td",{className:"py-3 px-2 text-sm text-gray-700",children:y.event})]},w)):h.jsx("tr",{children:h.jsx("td",{colSpan:3,className:"py-8 text-center text-sm text-gray-400 italic",children:"No holidays found for this region."})})})]})]});return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h1",{className:"text-4xl font-bold text-blue-700 mb-4",children:new Date().getFullYear()}),h.jsx("p",{className:"text-blue-700 font-medium",children:"Below is a list of our company's paid holidays during which our offices will be closed for observance."})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n("U.S.A Shift Holiday","/usa-map.png",r.usa),n("Canada Shift Holiday","/canada-map.png",r.canada),n("APAC Shift Holiday","/apac-map.png",r.apac)]})]})},bR=({isOpen:i,onClose:t,onConfirm:r,title:a,message:n})=>i?h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm animate-fade-in",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full text-center transform transition-all scale-100 animate-scale-up border-t-8 border-gray-400",children:[h.jsx("div",{className:"flex justify-center mb-4",children:h.jsx("div",{className:"bg-gray-100 p-4 rounded-full",children:h.jsx(A9,{className:"text-5xl text-gray-500"})})}),h.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:a}),h.jsx("p",{className:"text-gray-600 mb-6 text-sm leading-relaxed",children:n}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:t,className:"flex-1 py-3 rounded-xl font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 transition-colors",children:"Cancel"}),h.jsx("button",{onClick:r,className:"flex-1 py-3 rounded-xl font-semibold text-white bg-red-500 hover:bg-red-600 shadow-md shadow-red-200 transition-all transform hover:-translate-y-1",children:"Yes, Delete"})]})]})}):null,xR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(""),[p,m]=le.useState({isOpen:!1,type:"success",title:"",message:""}),[y,w]=le.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[A,I]=le.useState({name:"",startTime:"",endTime:"",timeZone:"Asia/Kolkata"});le.useEffect(()=>{k()},[]);const R=(U,te,W)=>{m({isOpen:!0,type:U,title:te,message:W})},k=async()=>{try{a(!0);const U=await cr.getAllShifts();t(U)}catch(U){e("Failed to load shifts"),console.error(U)}finally{a(!1)}},M=async U=>{U.preventDefault();try{await cr.addShift(A),I({name:"",startTime:"",endTime:"",timeZone:"Asia/Kolkata"}),k(),R("success","Success!","Shift has been added successfully.")}catch(te){R("error","Error","Failed to add shift: "+te.message)}},V=U=>{w({isOpen:!0,title:"Delete Shift?",message:"Are you sure you want to permanently remove this shift definition?",onConfirm:()=>q(U)})},q=async U=>{w(te=>({...te,isOpen:!1}));try{await cr.deleteShift(U),k(),R("success","Deleted","Shift has been removed successfully.")}catch(te){R("error","Error","Failed to delete shift: "+te.message)}};return h.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[h.jsx(Oh,{isOpen:p.isOpen,onClose:()=>m(U=>({...U,isOpen:!1})),type:p.type,title:p.title,message:p.message}),h.jsx(bR,{isOpen:y.isOpen,onClose:()=>w(U=>({...U,isOpen:!1})),onConfirm:y.onConfirm,title:y.title,message:y.message}),h.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-8 flex items-center gap-2",children:[h.jsx(hx,{})," Settings"]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-700 border-b pb-2",children:"Shift Management"}),h.jsxs("form",{onSubmit:M,className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8 bg-gray-50 p-4 rounded-lg",children:[h.jsxs("div",{className:"md:col-span-2",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Shift Name"}),h.jsx("input",{type:"text",required:!0,placeholder:"e.g. Morning Shift",className:"w-full p-2 border rounded",value:A.name,onChange:U=>I({...A,name:U.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Start (24h)"}),h.jsx("input",{type:"time",required:!0,className:"w-full p-2 border rounded",value:A.startTime,onChange:U=>I({...A,startTime:U.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"End (24h)"}),h.jsx("input",{type:"time",required:!0,className:"w-full p-2 border rounded",value:A.endTime,onChange:U=>I({...A,endTime:U.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Time Zone"}),h.jsx("select",{className:"w-full p-2 border rounded",value:A.timeZone,onChange:U=>I({...A,timeZone:U.target.value}),children:NA.map(U=>h.jsx("option",{value:U.value,children:U.label},U.value))})]}),h.jsx("div",{className:"md:col-span-5 flex justify-end",children:h.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition",children:[h.jsx(ip,{})," Add Shift"]})})]}),r?h.jsx("p",{className:"text-gray-500 text-center py-4",children:"Loading shifts..."}):n?h.jsx("p",{className:"text-red-500 text-center",children:n}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"text-gray-500 text-sm border-b",children:[h.jsx("th",{className:"p-3 font-medium",children:"Name"}),h.jsx("th",{className:"p-3 font-medium",children:"Timings"}),h.jsx("th",{className:"p-3 font-medium",children:"Time Zone"}),h.jsx("th",{className:"p-3 font-medium text-right",children:"Actions"})]})}),h.jsxs("tbody",{children:[i.map(U=>h.jsxs("tr",{className:"border-b last:border-0 hover:bg-gray-50",children:[h.jsx("td",{className:"p-3 font-medium",children:U.name}),h.jsxs("td",{className:"p-3",children:[U.startTime," - ",U.endTime]}),h.jsx("td",{className:"p-3 text-gray-600 font-mono text-sm",children:TA(U.timeZone||"Asia/Kolkata")}),h.jsx("td",{className:"p-3 text-right",children:h.jsx("button",{onClick:()=>V(U.id),className:"text-red-500 hover:text-red-700 p-2",title:"Delete Shift",children:h.jsx(Sd,{})})})]},U.id)),i.length===0&&h.jsx("tr",{children:h.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-400",children:"No shifts defined yet."})})]})]})})]})]})},wR=()=>{const i=kf(),{employee:t}=du(),r=t?.permissionLevel?.toLowerCase()==="admin";console.log("Current User Permission:",t?.permissionLevel,"Is Admin:",r);const a=[{title:"Today's Attendance",icon:pS,path:"/reports/todays-attendance",color:"bg-indigo-500",description:"View real-time attendance for all employees",restricted:!1},{title:"Filter Records",icon:$o,path:"/reports/filter-by-name",color:"bg-blue-500",description:"Search and filter attendance records",restricted:!1},{title:"Update Leave Balance",icon:Q_,path:"/reports/update-leave-balance",color:"bg-green-500",description:"Manage employee leave quotas"},{title:"Update Employees Leave",icon:_9,path:"/reports/update-employee-leave",color:"bg-orange-500",description:"Adjust leave records for employees"},{title:"Employee Leave Calendar",icon:n9,path:"/reports/employee-leave-calendar",color:"bg-purple-500",description:"View leave schedule in calendar view"},{title:"Download Attendance Report",icon:dx,path:"/reports/download-report",color:"bg-teal-500",description:"Export attendance data to Excel/CSV"},{title:"Leave Report",icon:o9,path:"/reports/leave-report",color:"bg-red-500",description:"Detailed analysis of employee leaves"},{title:"Permission Report",icon:px,path:"/reports/permission-report",color:"bg-yellow-600",description:"Track employee permissions and exceptions"},{title:"Previous Month Report",icon:$1,path:"/reports/previous-month",color:"bg-gray-600",description:"View archive of past month data"},{title:"Employees Events",icon:cu,path:"/reports/employee-events",color:"bg-indigo-600",description:"Manage employee birthdays and work anniversaries",restricted:!0},{title:"Upcoming Leaves",icon:cu,path:"/reports/upcoming-leaves",color:"bg-orange-500",description:"Manage projected leave schedules",restricted:!0},{title:"Employee Database",icon:ly,path:"/reports/employee-db",color:"bg-emerald-600",description:"Complete directory of all employees across locations",restricted:!0}],n=a.filter(e=>!e.restricted||r);return console.log("All Cards:",a),console.log("Visible Cards:",n),h.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[h.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-4 shrink-0",children:"Reports Dashboard"}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 overflow-y-auto pr-2 pb-2",children:n.map((e,p)=>h.jsxs("div",{onClick:()=>i(e.path),className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 cursor-pointer hover:shadow-md transition-all duration-200 group flex flex-col",children:[h.jsx("div",{className:"flex items-start justify-between mb-3",children:h.jsx("div",{className:`${e.color} w-10 h-10 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200`,children:h.jsx(e.icon,{className:"text-white text-lg"})})}),h.jsx("h3",{className:"text-base font-bold text-gray-800 mb-1 group-hover:text-blue-600 transition-colors line-clamp-1",children:e.title}),h.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:e.description})]},p))})]})},SR=()=>{const{employee:i,permissionLevel:t}=du(),[r,a]=le.useState("Regularization"),[n,e]=le.useState(!0),[p,m]=le.useState([]),[y,w]=le.useState(""),[A,I]=le.useState(!1),[R,k]=le.useState(null),[M,V]=le.useState("Approved"),[q,U]=le.useState(""),[te,W]=le.useState(!1),re=z=>{if(!z||z==="N/A")return"-";const K=String(z);try{if(K.includes("T")){const Ae=new Date(K);if(!isNaN(Ae.getTime())){const Ce=Ae.getDate().toString().padStart(2,"0"),Be=(Ae.getMonth()+1).toString().padStart(2,"0"),Ee=Ae.getFullYear();return`${Ce}/${Be}/${Ee}`}}if(K.includes("-")){const Ae=K.split("T")[0].split("-");if(Ae.length===3)return`${Ae[2]}/${Ae[1]}/${Ae[0]}`}return K}catch{return K}},xe=i?.email||"",ve=vo.useCallback(async()=>{e(!0);try{let z=[];r==="Regularization"?z=await cr.getPendingRegularizations(xe,t==="Admin"):r==="Leave"?z=(await cr.getAllLeaveRequests()).filter(Ae=>(Ae.status?.toLowerCase()==="pending"||Ae.status?.toLowerCase().includes("pending"))&&xe&&Ae.manager?.toLowerCase()===xe.toLowerCase()):z=(await cr.getAllPermissionRequests()).filter(Ae=>(Ae.status?.toLowerCase()==="pending"||Ae.status?.toLowerCase().includes("pending"))&&xe&&Ae.manager?.toLowerCase()===xe.toLowerCase()),m(z)}catch(z){console.error("Error fetching requests:",z),$u.error("Failed to load pending requests")}finally{e(!1)}},[r,xe,t]);le.useEffect(()=>{ve()},[ve]);const De=(z,K)=>{k(z),V(K),U(""),I(!0)},ke=async()=>{if(R){W(!0);try{await cr.updateApprovalStatus(r,String(R.Id||R.id||""),M,q),$u.success(`${r} request ${M.toLowerCase()} successfully`),I(!1),ve()}catch(z){const K=z instanceof Error?z.message:"Failed to update request status";console.error("Error processing request:",z),$u.error(`Error: ${K}`)}finally{W(!1)}}},de=p.filter(z=>(z.EmployeeName||z.employeeName||z.Title||"").toLowerCase().includes(y.toLowerCase())),Oe=z=>{switch(z){case"Regularization":return h.jsx(Cf,{});case"Leave":return h.jsx(ux,{});case"Permission":return h.jsx(px,{})}};return h.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Unified Approvals"}),h.jsx("p",{className:"text-gray-500 text-sm",children:"Review and manage employee requests across all categories."})]}),h.jsxs("div",{className:"relative w-full md:w-80",children:[h.jsx($o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Search by employee name...",className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all",value:y,onChange:z=>w(z.target.value)})]})]}),h.jsx("div",{className:"flex p-1 bg-gray-200/50 rounded-xl w-fit",children:["Regularization","Leave","Permission"].map(z=>h.jsxs("button",{onClick:()=>a(z),className:`flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-bold transition-all ${r===z?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700 hover:bg-white/50"}`,children:[Oe(z),z==="Regularization"?"Missed Check-ins":z==="Permission"?"Permissions":"Leaves"]},z))}),h.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 min-h-[400px]",children:n?h.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[h.jsx("div",{className:"w-12 h-12 border-4 border-indigo-100 border-t-indigo-600 rounded-full animate-spin mb-4"}),h.jsxs("p",{className:"text-gray-500 font-medium italic",children:["Scanning for pending ",r.toLowerCase()," requested..."]})]}):de.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[h.jsx("div",{className:"w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mb-4",children:h.jsx(Pc,{className:"text-4xl text-green-200"})}),h.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"All Caught Up!"}),h.jsxs("p",{className:"text-gray-500 max-w-sm mt-2",children:["No pending ",r.toLowerCase()," requests found for your review."]})]}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left",children:[h.jsx("thead",{className:"bg-gray-50/50 border-b border-gray-100",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Employee"}),h.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Manager"}),h.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Status"}),h.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Detail"}),h.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Date/Duration"}),h.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:de.map((z,K)=>h.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center font-bold text-indigo-700",children:(z.EmployeeName||z.employeeName||z.Title||"E")[0]}),h.jsxs("div",{children:[h.jsx("div",{className:"font-bold text-gray-900",children:z.EmployeeName||z.employeeName||z.Title}),h.jsx("div",{className:"text-xs text-gray-500",children:z.MailID||z.email||"Employee"})]})]})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-xs text-gray-500 italic",children:typeof z.manager=="object"?String(z.manager?.Title||"N/A"):String(z.manager||"N/A")}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsx("span",{className:"px-2 py-1 bg-orange-50 text-orange-600 text-[10px] font-bold rounded uppercase tracking-wider border border-orange-100",children:z.Status||z.status||"Pending"})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:h.jsxs("div",{className:"max-w-[150px] truncate",title:z.reason||z.Detail,children:[h.jsx("span",{className:"font-medium",children:r==="Regularization"?"Missed Check-in":z.leaveType||z.permissionType||"-"}),h.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:z.reason||z.Detail||"-"})]})}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[h.jsx("div",{className:"text-sm font-medium text-gray-900",children:re(r==="Regularization"?z.Date||z.date:z.fromDate||z.From||z.date)}),h.jsx("div",{className:"text-[10px] text-gray-400 italic",children:r==="Leave"?`${re(z.toDate||z.To)}`:z.leaveDuration||z.hours||"-"})]}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[h.jsx("div",{className:"text-sm font-medium text-gray-900",children:r==="Leave"?`${re(z.fromDate)} to ${re(z.toDate)}`:re(z.date||z.Date)}),h.jsx("div",{className:"text-[10px] text-gray-500 italic",children:r==="Regularization"?"Full Day":r==="Permission"?`${z.hours} hours`:z.leaveDuration})]}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:h.jsxs("div",{className:"flex justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>De(z,"Approved"),className:"p-2 text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors border border-green-100",title:"Approve",children:h.jsx(Cv,{})}),h.jsx("button",{onClick:()=>De(z,"Rejected"),className:"p-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors border border-red-100",title:"Reject",children:h.jsx(Ju,{})})]})})]},z.Id||z.id||K))})]})})}),A&&h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden border border-gray-100 animate-in zoom-in-95 duration-300",children:[h.jsxs("div",{className:`p-6 text-white ${M==="Approved"?"bg-green-600":"bg-red-600"}`,children:[h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[M==="Approved"?h.jsx(Pc,{}):h.jsx(Jm,{}),M," Request"]}),h.jsxs("p",{className:"text-white/80 text-sm mt-1",children:["Reviewing ",r.toLowerCase()," for ",R?.EmployeeName||R?.employeeName||R?.Title]})]}),h.jsx("div",{className:"p-6 space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Approver Comments"}),h.jsx("textarea",{value:q,onChange:z=>U(z.target.value),placeholder:`Enter reason for ${M.toLowerCase()}...`,className:"w-full p-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all resize-none h-32"})]})}),h.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-100 flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 text-gray-600 font-bold hover:bg-gray-100 rounded-lg transition-all",children:"Cancel"}),h.jsxs("button",{onClick:ke,disabled:te,className:`px-6 py-2 text-white font-bold rounded-lg transition-all active:scale-95 flex items-center gap-2 ${M==="Approved"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} disabled:opacity-50`,children:[te?h.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):M==="Approved"?h.jsx(Cv,{}):h.jsx(Ju,{}),"Confirm ",M]})]})]})})]})},AR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(new Date),[p,m]=le.useState("All"),[y,w]=le.useState(""),[A,I]=le.useState(null),[R,k]=le.useState(null),[M,V]=le.useState(null),[q,U]=le.useState(!1),[te,W]=le.useState({isOpen:!1,type:"success",title:"",message:""}),re=(_e,Le,X="success")=>{W({isOpen:!0,type:X,title:_e,message:Le})},{permissionLevel:xe}=du(),ve=["All","Chennai","Hyderabad","Noida","CON","Canada"],De={Chennai:"bg-indigo-500 hover:bg-indigo-600",Hyderabad:"bg-purple-500 hover:bg-purple-600",Noida:"bg-teal-500 hover:bg-teal-600",CON:"bg-orange-500 hover:bg-orange-600",Canada:"bg-red-500 hover:bg-red-600",All:"bg-gray-600 hover:bg-gray-700"},ke=async _e=>{try{a(!0);const Le=_e.getDate().toString().padStart(2,"0"),X=(_e.getMonth()+1).toString().padStart(2,"0"),H=_e.getFullYear(),ae=`${Le}/${X}/${H}`,[Z,se]=await Promise.all([cr.getAllEmployees(),cr.getAllAttendanceForDate(ae)]),ye=se.map(ce=>{const ze=Z.find(pe=>pe.id===ce.employeeId||pe.name===ce.name);return{id:ce.id,name:ce.name||(ze?ze.name:"Unknown"),place:ce.place||(ze?ze.place:"N/A"),department:ze?ze.department:"N/A",checkInTime:ce.checkInTime||"-",checkOutTime:ce.checkOutTime||"-",workingHours:ce.workingHours||"-",status:ce.status||"Present"}});t(ye)}catch(Le){console.error("Failed to fetch attendance data:",Le)}finally{a(!1)}};le.useEffect(()=>{ke(n)},[n]);const de=_e=>{const[Le,X,H]=_e.target.value.split("-").map(Number);e(new Date(Le,X-1,H))},Oe=()=>{ke(n)},z=_e=>{k(_e)},K=_e=>{const[Le,X,H]=n.toLocaleDateString("en-GB").split("/"),ae=`${Le}/${X}/${H}`;I({..._e,date:_e.date||ae})},Ae=async()=>{if(R){V(R.id);try{await cr.deleteAttendanceRecord(R.id),t(_e=>_e.filter(Le=>Le.id!==R.id)),k(null),re("Success","Attendance record deleted successfully","success")}catch(_e){console.error("Failed to delete record",_e),re("Delete Failed","Failed to delete record. Please try again.","error")}finally{V(null)}}},Ce=async()=>{if(A){U(!0);try{await cr.updateAttendanceRecord(A.id,{CheckInTime:A.checkInTime,CheckOutTime:A.checkOutTime,Status:A.status,WorkingHours:A.workingHours}),t(_e=>_e.map(Le=>Le.id===A.id?{...Le,checkInTime:A.checkInTime,checkOutTime:A.checkOutTime,status:A.status,workingHours:A.workingHours}:Le)),I(null),re("Success","Attendance record updated successfully","success")}catch(_e){console.error("Failed to update record",_e),re("Update Failed","Failed to update record. Please try again.","error")}finally{U(!1)}}},Be=i.filter(_e=>{const Le=p==="All"||_e.place?.toLowerCase()===p.toLowerCase(),X=_e.name.toLowerCase().includes(y.toLowerCase());return Le&&X}),Ee={total:Be.length,present:Be.filter(_e=>_e.status==="IN").length,absent:Be.filter(_e=>_e.status==="Absent").length,onLeave:Be.filter(_e=>_e.status.includes("Leave")||_e.status.includes("Holiday")).length},Pe=_e=>{const Le=_e.getFullYear(),X=(_e.getMonth()+1).toString().padStart(2,"0"),H=_e.getDate().toString().padStart(2,"0");return`${Le}-${X}-${H}`},Ue=_e=>_e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return h.jsxs("div",{className:"h-full flex flex-col p-6 gap-6 overflow-hidden",children:[R&&h.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:h.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all scale-100",children:h.jsxs("div",{className:"p-6 text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(Sd,{className:"text-red-500 text-2xl"})}),h.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Delete Attendance?"}),h.jsxs("p",{className:"text-gray-500 mb-6",children:["Are you sure you want to delete the attendance record for ",h.jsx("span",{className:"font-bold text-gray-800",children:R.name}),"? This action cannot be undone."]}),h.jsxs("div",{className:"flex gap-3 justify-center",children:[h.jsx("button",{onClick:()=>k(null),className:"px-5 py-2.5 text-gray-700 font-medium hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"}),h.jsx("button",{onClick:Ae,disabled:!!M,className:"px-5 py-2.5 bg-red-600 text-white font-bold rounded-lg hover:bg-red-700 transition-colors shadow-sm flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:M?"Deleting...":"Delete Record"})]})]})})}),A&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[h.jsxs("div",{className:"bg-indigo-600 px-6 py-4 flex items-center justify-between",children:[h.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[h.jsx(Nf,{})," Edit Attendance"]}),h.jsx("button",{onClick:()=>I(null),className:"text-white/80 hover:text-white transition-colors",children:h.jsx(Ju,{})})]}),h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg border border-indigo-100 mb-2",children:[h.jsx("p",{className:"text-xs text-indigo-500 font-bold uppercase tracking-wider",children:"Employee"}),h.jsx("p",{className:"text-indigo-900 font-medium text-lg",children:A.name})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Check In"}),h.jsx("input",{type:"text",value:A.checkInTime,onChange:_e=>{const Le=_e.target.value,X=cr.calculateDuration(A.date||n.toLocaleDateString("en-GB"),Le,A.checkOutTime);I({...A,checkInTime:Le,workingHours:X})},className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none font-mono"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Check Out"}),h.jsx("input",{type:"text",value:A.checkOutTime,onChange:_e=>{const Le=_e.target.value,X=cr.calculateDuration(A.date||n.toLocaleDateString("en-GB"),A.checkInTime,Le);I({...A,checkOutTime:Le,workingHours:X})},className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none font-mono"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Working Hours"}),h.jsx("input",{type:"text",value:A.workingHours,onChange:_e=>I({...A,workingHours:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none font-mono",placeholder:"HH:MM"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Status"}),h.jsxs("select",{value:A.status,onChange:_e=>I({...A,status:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none",children:[h.jsx("option",{value:"Present",children:"Present"}),h.jsx("option",{value:"Absent",children:"Absent"}),h.jsx("option",{value:"Leave",children:"Leave"}),h.jsx("option",{value:"Half Day",children:"Half Day"}),h.jsx("option",{value:"Late",children:"Late"}),h.jsx("option",{value:"On Time",children:"On Time"}),xe==="Admin"&&h.jsx("option",{value:"Holiday",children:"Holiday"})]})]})]}),h.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>I(null),className:"px-4 py-2 text-gray-600 font-medium hover:bg-gray-100 rounded-lg transition-colors text-sm",children:"Cancel"}),h.jsx("button",{onClick:Ce,disabled:q,className:"px-4 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors shadow-sm text-sm flex items-center gap-2 disabled:opacity-50",children:q?"Saving...":h.jsxs(h.Fragment,{children:[h.jsx(yp,{})," Save Changes"]})})]})]})}),h.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl shadow-lg p-6 text-white flex-shrink-0",children:h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Today's Attendance Report"}),h.jsx("p",{className:"text-blue-100 text-sm",children:Ue(n)})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"relative",children:h.jsx("input",{type:"date",value:Pe(n),onChange:de,className:"px-4 py-2 rounded-lg bg-white text-gray-800 font-medium focus:outline-none focus:ring-2 focus:ring-blue-300 shadow-md"})}),h.jsx("button",{onClick:Oe,className:"p-3 bg-white text-blue-600 rounded-lg hover:bg-blue-50 transition-colors shadow-md",title:"Refresh",children:h.jsx(uu,{className:r?"animate-spin":""})})]})]})}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Records"}),h.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:Ee.total})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Available"}),h.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:Ee.present})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Absent"}),h.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:Ee.absent})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-yellow-500",children:[h.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"On Leave"}),h.jsx("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:Ee.onLeave})]})]}),h.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-gray-100 flex-shrink-0",children:h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-semibold text-gray-600 mb-3",children:"Filter by Location"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map(_e=>h.jsx("button",{onClick:()=>m(_e),className:`px-4 py-2 rounded-lg font-medium text-white transition-all shadow-sm ${p===_e?De[_e]+" ring-2 ring-offset-2 ring-gray-400":De[_e]+" opacity-60"}`,children:_e},_e))})]}),h.jsxs("div",{className:"md:w-64",children:[h.jsx("p",{className:"text-sm font-semibold text-gray-600 mb-3",children:"Search Employee"}),h.jsxs("div",{className:"relative",children:[h.jsx($o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Search by name...",value:y,onChange:_e=>w(_e.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})}),h.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden flex-1 flex flex-col min-h-0",children:h.jsx("div",{className:"overflow-y-auto flex-1 h-full",children:r?h.jsx("div",{className:"flex items-center justify-center py-20",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-gray-500",children:"Loading attendance data..."})]})}):Be.length===0?h.jsxs("div",{className:"text-center py-20 text-gray-400",children:[h.jsx("p",{className:"text-lg font-medium",children:"No records found"}),h.jsx("p",{className:"text-sm mt-2",children:"Try selecting a different date or location"})]}):h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200 sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Employee Name"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Department"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Location"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Check In"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Check Out"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Hours"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Status"}),xe==="Admin"&&h.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:Be.map((_e,Le)=>h.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm ${_e.status==="Absent"?"bg-red-100 text-red-600":"bg-indigo-100 text-indigo-600"}`,children:_e.name?.charAt(0)||"?"}),h.jsx("span",{className:"font-medium text-gray-800",children:_e.name})]})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"text-sm text-gray-700",children:_e.department})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium",children:_e.place})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[_e.checkInTime!=="-"&&h.jsx(Cf,{className:"text-green-500 text-sm"}),h.jsx("span",{className:`font-mono text-sm ${_e.checkInTime!=="-"?"text-green-600 font-semibold":"text-gray-400"}`,children:_e.checkInTime})]})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[_e.checkOutTime!=="-"&&h.jsx(Cf,{className:"text-red-500 text-sm"}),h.jsx("span",{className:`font-mono text-sm ${_e.checkOutTime!=="-"?"text-red-600 font-semibold":"text-gray-400"}`,children:_e.checkOutTime})]})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"font-mono text-sm text-gray-700 font-medium",children:_e.workingHours})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold ${["Present","On Time"].includes(_e.status)?"bg-green-100 text-green-700":_e.status==="Late"?"bg-red-100 text-red-700":["Half-Day","Half Day","In","Checked In"].includes(_e.status)?"bg-yellow-100 text-yellow-700":_e.status==="Absent"?"bg-red-50 text-red-600":_e.status.includes("Leave")?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600"}`,children:[["Present","On Time"].includes(_e.status)?h.jsx(Pc,{}):_e.status==="Absent"?h.jsx(Jm,{}):null,_e.status]})}),xe==="Admin"&&h.jsx("td",{className:"px-6 py-4 text-right",children:(_e.checkInTime!=="-"||_e.status!=="Absent")&&h.jsxs("div",{className:"flex items-center justify-end gap-2",children:[h.jsx("button",{onClick:()=>K(_e),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:h.jsx(Nf,{size:14})}),_e.checkInTime!=="-"&&h.jsx("button",{onClick:()=>z(_e),className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",disabled:M===_e.id,children:M===_e.id?h.jsx("div",{className:"w-3.5 h-3.5 border-2 border-red-500/30 border-t-red-500 rounded-full animate-spin"}):h.jsx(Sd,{size:14})})]})})]},_e.id||Le))})]})})}),h.jsx(Oh,{isOpen:te.isOpen,type:te.type,title:te.title,message:te.message,onClose:()=>W({...te,isOpen:!1})})]})},CR=()=>{const[i,t]=le.useState(""),[r,a]=le.useState(""),[n,e]=le.useState(""),[p,m]=le.useState([]),[y,w]=le.useState(!1),[A,I]=le.useState(null);le.useEffect(()=>{const q=new Date,U=new Date(q.getFullYear(),q.getMonth(),1),te=new Date(q.getFullYear(),q.getMonth()+1,0);a(U.toISOString().split("T")[0]),e(te.toISOString().split("T")[0])},[]);const R=async()=>{if(!(!r||!n)){w(!0),I(null);try{const q=await cr.getAllAttendanceInRange(r,n);m(q)}catch(q){console.error("Error fetching attendance:",q),I("Failed to fetch attendance records. Please try again.")}finally{w(!1)}}};le.useEffect(()=>{r&&n&&R()},[r,n]);const k=q=>{if(!q)return new Date(0);const U=q.split("/");return U.length!==3?new Date(0):new Date(Number(U[2]),Number(U[1])-1,Number(U[0]))},M=p.filter(q=>q.name?.toLowerCase().includes(i.toLowerCase())||!1).sort((q,U)=>k(q.date).getTime()-k(U.date).getTime()),V=()=>{if(M.length===0)return;const U=[["Date","Employee Name","Check In","Check Out","Status","Working Hours"].join(","),...M.map(xe=>[xe.date,`"${xe.name||""}"`,xe.checkInTime||"",xe.checkOutTime||"",xe.status||"",xe.workingHours||""].join(","))].join(`
`),te=new Blob([U],{type:"text/csv;charset=utf-8;"}),W=document.createElement("a"),re=URL.createObjectURL(te);W.setAttribute("href",re),W.setAttribute("download","attendance_report.csv"),W.style.visibility="hidden",document.body.appendChild(W),W.click(),document.body.removeChild(W)};return h.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Filter Records"}),h.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Search and filter attendance records by employee name and date range."})]}),h.jsxs("div",{className:"bg-blue-50 px-4 py-2 rounded-lg border border-blue-100 text-blue-700 text-sm font-medium",children:["Total Records: ",M.length]})]}),h.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 items-end",children:[h.jsxs("div",{className:"md:col-span-4",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search by Employee Name"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx($o,{className:"text-gray-400"})}),h.jsx("input",{type:"text",value:i,onChange:q=>t(q.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter name..."})]})]}),h.jsxs("div",{className:"md:col-span-3",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(cu,{className:"text-gray-400"})}),h.jsx("input",{type:"date",value:r,onChange:q=>a(q.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-colors"})]})]}),h.jsxs("div",{className:"md:col-span-3",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(cu,{className:"text-gray-400"})}),h.jsx("input",{type:"date",value:n,onChange:q=>e(q.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-colors"})]})]}),h.jsxs("div",{className:"md:col-span-2 flex space-x-2",children:[h.jsx("button",{onClick:R,disabled:y,className:"flex-1 flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 transition-colors shadow-sm",title:"Refresh Data",children:y?h.jsx(oy,{className:"animate-spin"}):"Refresh"}),h.jsx("button",{onClick:V,disabled:y||M.length===0,className:"flex-1 flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 transition-colors shadow-sm",title:"Download Excel",children:h.jsx(Ym,{className:"text-lg"})})]})]})}),A&&h.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg flex items-center",children:[h.jsx(N0,{className:"text-red-500 mr-3"}),h.jsx("p",{className:"text-red-700",children:A})]}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),h.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee Name"}),h.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check In"}),h.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check Out"}),h.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),h.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Working Hours"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y?h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:h.jsxs("div",{className:"flex flex-col items-center justify-center",children:[h.jsx(oy,{className:"animate-spin text-3xl text-blue-500 mb-3"}),h.jsx("p",{children:"Loading attendance records..."})]})})}):M.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No records found matching your criteria."})}):M.map(q=>h.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:q.date}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold mr-3",children:q.name?q.name.charAt(0).toUpperCase():"?"}),q.name]})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:q.checkInTime||"-"}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:q.checkOutTime||"-"}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                                                ${q.status==="Present"?"bg-green-100 text-green-800":q.status==="Absent"?"bg-red-100 text-red-800":q.status==="Late"?"bg-yellow-100 text-yellow-800":q.status==="Half Day"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:q.status})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono",children:q.workingHours||"-"})]},q.id))})]})})})]})},NR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(""),[p,m]=le.useState(null),[y,w]=le.useState(!1),[A,I]=le.useState(""),[R,k]=le.useState({isOpen:!1,type:"success",title:"",message:""});le.useEffect(()=>{M()},[]);const M=async()=>{a(!0);try{const re=[...await cr.getAllLeaveBalances()].sort((xe,ve)=>xe.empName.localeCompare(ve.empName));t(re)}catch(W){console.error("Failed to fetch leave balances",W)}finally{a(!1)}},V=W=>{m({...W})},q=async()=>{if(p){w(!0);try{await cr.updateLeaveBalance(p.id,{cl:p.cl,el:p.el,balance:p.balance,lop:p.lop}),I(`Updated balance for ${p.empName} successfully!`),m(null),await M(),setTimeout(()=>I(""),3e3)}catch{k({isOpen:!0,type:"error",title:"Update Failed",message:"Failed to update leave balance. Please try again."})}finally{w(!1)}}},U=async W=>{if(window.confirm(`Are you sure you want to delete the leave balance record for ${W.empName}?`)){a(!0);try{await cr.deleteLeaveBalance(W.id),I(`Deleted record for ${W.empName} successfully!`),await M(),setTimeout(()=>I(""),3e3)}catch{k({isOpen:!0,type:"error",title:"Delete Failed",message:"Failed to delete leave balance record."})}finally{a(!1)}}},te=i.filter(W=>W.empName.toLowerCase().includes(n.toLowerCase()));return h.jsxs("div",{className:"flex flex-col h-full",children:[h.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-20 bg-slate-50 pb-3 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Update Leave Balance"}),h.jsx("div",{className:"flex gap-2",children:h.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-600 hover:bg-gray-50 transition-all shadow-sm",children:[h.jsx(uu,{className:r?"animate-spin":""}),"Refresh"]})})]}),A&&h.jsx("div",{className:"bg-emerald-50 border-l-4 border-emerald-500 p-4 rounded-r-lg shadow-sm animate-slideIn",children:h.jsxs("p",{className:"text-emerald-700 text-sm flex items-center gap-2",children:[h.jsx("span",{className:"w-5 h-5 bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px]",children:""}),A]})}),h.jsx("div",{className:"flex-1 flex items-start justify-center overflow-hidden",children:h.jsxs("div",{className:"w-full max-w-6xl flex flex-col",style:{height:"100%"},children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden flex flex-col flex-1",children:[h.jsx("div",{className:"p-3 border-b border-gray-100 bg-gray-50 flex items-center gap-3 flex-shrink-0",children:h.jsxs("div",{className:"relative flex-1 max-w-md",children:[h.jsx($o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs"}),h.jsx("input",{type:"text",placeholder:"Search employee name...",value:n,onChange:W=>e(W.target.value),className:"w-full pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all font-medium"})]})}),h.jsx("div",{className:"flex-1 overflow-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:h.jsxs("tr",{className:"bg-gray-50 border-b border-gray-100",children:[h.jsx("th",{className:"px-4 py-2 text-[10px] font-bold text-gray-800 uppercase tracking-widest",children:"Employee Name"}),h.jsx("th",{className:"px-4 py-2 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-center",children:"CL"}),h.jsx("th",{className:"px-4 py-2 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-center",children:"EL"}),h.jsx("th",{className:"px-4 py-2 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-center",children:"Balance"}),h.jsx("th",{className:"px-4 py-2 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-center",children:"LOP"}),h.jsx("th",{className:"px-4 py-2 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-right",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-50",children:r?Array(5).fill(0).map((W,re)=>h.jsxs("tr",{className:"animate-pulse",children:[h.jsx("td",{className:"px-4 py-2",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/2"})}),h.jsx("td",{className:"px-4 py-2",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-10 mx-auto"})}),h.jsx("td",{className:"px-4 py-2",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-10 mx-auto"})}),h.jsx("td",{className:"px-4 py-2",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-10 mx-auto"})}),h.jsx("td",{className:"px-4 py-2",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-10 mx-auto"})}),h.jsx("td",{className:"px-4 py-2",children:h.jsx("div",{className:"h-8 bg-gray-100 rounded w-20 ml-auto"})})]},re)):te.length>0?te.map(W=>h.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors group",children:[h.jsx("td",{className:"px-4 py-2",children:h.jsx("span",{className:"text-xs text-gray-700",children:W.empName})}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-[11px]",children:W.cl})}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-[11px]",children:W.el})}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-600 rounded text-[11px]",children:W.balance})}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:"px-2 py-0.5 bg-rose-50 text-rose-500 rounded text-[11px]",children:W.lop})}),h.jsx("td",{className:"px-4 py-2 text-right",children:h.jsxs("div",{className:"flex justify-end gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>V(W),className:"p-1.5 bg-blue-600 text-white rounded shadow hover:bg-blue-700 transition-all",title:"Edit",children:h.jsx(Nf,{className:"text-sm"})}),h.jsx("button",{onClick:()=>U(W),className:"p-1.5 bg-rose-600 text-white rounded shadow hover:bg-rose-700 transition-all",title:"Delete",children:h.jsx(Sd,{className:"text-sm"})})]})})]},W.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-gray-400 font-medium",children:"No leave balance records found."})})})]})})]}),p&&h.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black bg-opacity-65 backdrop-blur-sm",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden animate-scaleIn",children:[h.jsxs("div",{className:"bg-blue-600 p-4 text-white flex items-center justify-between",children:[h.jsx("h3",{className:"font-black text-lg",children:"Update Balance"}),h.jsx("button",{onClick:()=>m(null),className:"text-white hover:text-blue-100 transition-colors",children:h.jsx(Ju,{className:"text-xl"})})]}),h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsx("div",{className:"flex items-center gap-3 mb-2 pb-2 border-b border-gray-100",children:h.jsx("span",{className:"font-black text-gray-800 text-lg uppercase tracking-tight",children:p.empName})}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Casual Leave (CL)"}),h.jsx("input",{type:"number",step:"0.25",value:p.cl,onChange:W=>{const re=parseFloat(W.target.value)||0;m({...p,cl:re,balance:re+p.el})},className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Earned Leave (EL)"}),h.jsx("input",{type:"number",step:"0.25",value:p.el,onChange:W=>{const re=parseFloat(W.target.value)||0;m({...p,el:re,balance:p.cl+re})},className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Total Balance"}),h.jsx("input",{type:"number",step:"0.25",value:p.balance,readOnly:!0,className:"w-full px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg text-sm font-black text-blue-700 outline-none cursor-not-allowed shadow-inner"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"LOP Days"}),h.jsx("input",{type:"number",step:"0.25",value:p.lop,onChange:W=>m({...p,lop:parseFloat(W.target.value)||0}),className:"w-full px-3 py-2 bg-rose-50 border border-rose-100 rounded-lg text-sm font-black text-rose-600 focus:ring-2 focus:ring-rose-500 outline-none"})]})]})]}),h.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-100 flex gap-3",children:[h.jsx("button",{onClick:()=>m(null),className:"flex-1 py-2.5 text-xs font-black text-gray-500 uppercase tracking-widest hover:bg-gray-100 rounded-lg transition-all",children:"Cancel"}),h.jsxs("button",{onClick:q,disabled:y,className:"flex-1 py-2.5 bg-blue-600 text-white text-xs font-black uppercase tracking-widest rounded-lg shadow-lg hover:bg-blue-700 transition-all flex items-center justify-center gap-2 disabled:opacity-50",children:[y?h.jsx(uu,{className:"animate-spin"}):h.jsx(yp,{}),y?"Saving...":"Save Changes"]})]})]})})]})}),h.jsx(Oh,{isOpen:R.isOpen,type:R.type,title:R.title,message:R.message,onClose:()=>k({...R,isOpen:!1})})]})},TR=()=>{const{permissionLevel:i}=du(),t=i==="Admin",[r,a]=le.useState([]),[n,e]=le.useState(""),[p,m]=le.useState(""),[y,w]=le.useState(""),[A,I]=le.useState(new Date().toISOString().split("T")[0]),[R,k]=le.useState(""),[M,V]=le.useState(""),[q,U]=le.useState("Absent"),[te,W]=le.useState("00:00"),[re,xe]=le.useState("00:00"),[ve,De]=le.useState(!1),[ke,de]=le.useState(""),[Oe,z]=le.useState({isOpen:!1,type:"success",title:"",message:""}),K=(Be,Ee,Pe="success")=>{z({isOpen:!0,type:Pe,title:Be,message:Ee})};le.useEffect(()=>{(async()=>{try{const Ee=await cr.getAllEmployees();a(Ee.sort((Pe,Ue)=>Pe.name.localeCompare(Ue.name)))}catch(Ee){console.error("Failed to fetch employees for dropdown",Ee)}})()},[]);const Ae=Be=>{const Ee=Be.target.value;e(Ee);const Pe=r.find(Ue=>Ue.name===Ee);Pe?(m(Pe.id),w(Pe.email||Pe.professionalEmail||""),k(Pe.place||Pe.location||""),V(Pe.shiftId||"")):(m(""),w(""),k(""),V(""))},Ce=async()=>{if(!n||!y||!A||!R){K("Validation Error","Please fill in all required fields.","error");return}De(!0);try{await cr.createAttendanceRecord({name:n,employeeId:p,email:y,date:A,place:R,shiftId:M,status:q,checkInTime:te,checkOutTime:re}),de(`Attendance record created for ${n} successfully!`),e(""),m(""),w(""),k(""),V(""),U("Absent"),W("00:00"),xe("00:00"),I(new Date().toISOString().split("T")[0]),setTimeout(()=>de(""),3e3),K("Success",`Attendance record created for ${n} successfully!`,"success")}catch(Be){K("Creation Failed","Failed to create attendance record. Please try again.","error"),console.error(Be)}finally{De(!1)}};return h.jsxs("div",{className:"space-y-6",children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Update Employees Leave"}),ke&&h.jsx("div",{className:"bg-emerald-50 border-l-4 border-emerald-500 p-4 rounded-r-lg shadow-sm animate-slideIn",children:h.jsxs("p",{className:"text-emerald-700 text-sm flex items-center gap-2",children:[h.jsx("span",{className:"w-5 h-5 bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px]",children:""}),ke]})}),h.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-100 shadow-sm",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsxs("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:[h.jsx("span",{className:"text-red-500",children:"*"})," Staff Name"]}),h.jsxs("select",{value:n,onChange:Ae,className:"w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",children:[h.jsx("option",{value:"",children:"Select Employee"}),r.map(Be=>h.jsx("option",{value:Be.name,children:Be.name},Be.id))]})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:[h.jsx("span",{className:"text-red-500",children:"*"})," Staff Mail"]}),h.jsx("input",{type:"email",value:y,onChange:Be=>w(Be.target.value),disabled:!t,className:`w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all ${t?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`,placeholder:"Enter email address"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:[h.jsx("span",{className:"text-red-500",children:"*"})," Date"]}),h.jsx("input",{type:"date",value:A,onChange:Be=>I(Be.target.value),className:"w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:"Employee ID"}),h.jsx("input",{type:"text",value:p,onChange:Be=>m(Be.target.value),disabled:!t,className:`w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all ${t?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`,placeholder:"Employee ID"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:"Place"}),h.jsx("input",{type:"text",value:R,onChange:Be=>k(Be.target.value),disabled:!t,className:`w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all ${t?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`,placeholder:"Enter location"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:"Shift ID"}),h.jsx("input",{type:"text",value:M,onChange:Be=>V(Be.target.value),disabled:!t,className:`w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all ${t?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`,placeholder:"Enter Shift ID"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:"Status"}),h.jsxs("select",{value:q,onChange:Be=>U(Be.target.value),className:"w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",children:[h.jsx("option",{value:"Absent",children:"Absent"}),h.jsx("option",{value:"Leave",children:"Leave"}),t&&h.jsx("option",{value:"Present",children:"Present"}),t&&h.jsx("option",{value:"Holiday",children:"Holiday"})]})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:"Check-In Time"}),h.jsx("input",{type:"time",value:te,onChange:Be=>W(Be.target.value),disabled:!t,className:`w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all ${t?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider flex items-center gap-1",children:"Check-Out Time"}),h.jsx("input",{type:"time",value:re,onChange:Be=>xe(Be.target.value),disabled:!t,className:`w-full px-4 py-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all ${t?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`})]})]}),h.jsx("div",{className:"mt-6 flex justify-end",children:h.jsxs("button",{onClick:Ce,disabled:ve,className:"px-6 py-2.5 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[ve?h.jsx(uu,{className:"animate-spin"}):h.jsx(yp,{}),ve?"Submitting...":"Submit Attendance"]})})]}),h.jsx(Oh,{isOpen:Oe.isOpen,type:Oe.type,title:Oe.title,message:Oe.message,onClose:()=>z({...Oe,isOpen:!1})})]})},ER=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(""),[n,e]=le.useState(new Date().getFullYear()),[p,m]=le.useState([]),[y,w]=le.useState(!1),[A,I]=le.useState(!0),R=[2025,2026,2027],k=["January","February","March","April","May","June","July","August","September","October","November","December"],M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];le.useEffect(()=>{(async()=>{try{I(!0);const ve=(await cr.getAllEmployees()).sort((De,ke)=>De.name.localeCompare(ke.name));t(ve),ve.length>0&&a(ve[0].id)}catch(xe){console.error("Failed to load employees",xe)}finally{I(!1)}})()},[]);const V=vo.useCallback(async()=>{const re=i.find(xe=>xe.id===r);if(re)try{w(!0);const xe=await cr.getEmployeeAttendanceForYear(re.id,re.name,n);m(xe)}catch(xe){console.error("Failed to fetch year attendance",xe)}finally{w(!1)}},[i,r,n]);le.useEffect(()=>{r&&i.length>0&&V()},[r,n,V,i.length]);const q=(re,xe,ve)=>{const De=`${re.toString().padStart(2,"0")}/${(xe+1).toString().padStart(2,"0")}/${ve}`,ke=p.filter(Oe=>Oe.date===De);if(ke.length===0){const Oe=new Date(ve,xe,re);return AA(Oe),"bg-gray-50 text-gray-300"}const de=ke[0].status.toLowerCase();return de==="in"||de==="present"||de.includes("time")?"bg-green-500 text-white shadow-[0_0_10px_rgba(34,197,94,0.4)]":de.includes("half")?"bg-orange-500 text-white shadow-[0_0_10px_rgba(249,115,22,0.4)]":de.includes("holiday")?"bg-blue-600 text-white shadow-[0_0_10px_rgba(37,99,235,0.4)]":de.includes("absent")?"bg-red-500 text-white shadow-[0_0_10px_rgba(239,68,68,0.4)]":de.includes("leave")?"bg-purple-500 text-white shadow-[0_0_10px_rgba(168,85,247,0.4)]":"bg-indigo-500 text-white"},U=(re,xe)=>new Date(re,xe+1,0).getDate(),te=(re,xe)=>new Date(re,xe,1).getDay(),W=re=>{const xe=U(n,re),ve=te(n,re),De=[];for(let Oe=0;Oe<ve;Oe++)De.push(h.jsx("div",{className:"h-5 w-5"},`empty-${re}-${Oe}`));for(let Oe=1;Oe<=xe;Oe++){const z=q(Oe,re,n);De.push(h.jsx("div",{className:`h-5 w-5 flex items-center justify-center rounded-full text-[10px] font-bold transition-all duration-200 hover:scale-110 cursor-default ${z}`,title:p.find(K=>K.date===`${Oe.toString().padStart(2,"0")}/${(re+1).toString().padStart(2,"0")}/${n}`)?.status||"No Record",children:Oe},`${re}-${Oe}`))}const ke=ve+xe,de=42;for(let Oe=ke;Oe<de;Oe++)De.push(h.jsx("div",{className:"h-5 w-5"},`empty-end-${re}-${Oe}`));return h.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-xl shadow-lg p-2 border border-white/20 hover:shadow-xl transition-all duration-300 group",children:[h.jsx("h3",{className:"text-center font-bold text-gray-800 mb-2 group-hover:text-indigo-600 transition-colors uppercase tracking-wide text-xs",children:k[re]}),h.jsx("div",{className:"grid grid-cols-7 gap-1 text-center mb-1",children:M.map(Oe=>h.jsx("div",{className:"text-[9px] font-bold text-gray-400 uppercase",children:Oe},Oe))}),h.jsx("div",{className:"grid grid-cols-7 gap-1",children:De})]},re)};return h.jsxs("div",{className:"flex-1 flex flex-col h-full bg-gradient-to-br from-indigo-50 via-purple-50 to-blue-50 overflow-hidden",children:[h.jsx("div",{className:"shrink-0 bg-white/70 backdrop-blur-sm border-b border-gray-200 px-4 py-1",children:h.jsxs("div",{className:"flex items-center justify-between max-w-[1800px] mx-auto",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-8 h-8 bg-gradient-to-tr from-indigo-600 to-purple-600 rounded-lg flex items-center justify-center",children:h.jsx(cu,{className:"text-white text-sm"})}),h.jsx("h1",{className:"text-lg font-bold text-gray-800",children:"Employee Leave Calendar"})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-indigo-500 text-sm",children:h.jsx(gS,{})}),h.jsx("select",{value:r,onChange:re=>a(re.target.value),className:"pl-8 pr-3 py-1.5 text-sm bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-200 focus:border-indigo-400 outline-none",disabled:A,children:A?h.jsx("option",{children:"Loading..."}):i.map(re=>h.jsx("option",{value:re.id,children:re.name},re.id))})]}),h.jsx("div",{className:"flex bg-white border border-gray-200 rounded-lg p-0.5",children:R.map(re=>h.jsx("button",{onClick:()=>e(re),className:`px-3 py-1 rounded text-sm font-semibold transition-all ${n===re?"bg-indigo-600 text-white":"text-gray-600 hover:text-indigo-600"}`,children:re},re))}),h.jsx("button",{onClick:V,className:"p-1.5 bg-white border border-gray-200 text-indigo-600 rounded-lg hover:bg-gray-50 transition-all",title:"Refresh",children:h.jsx(uu,{className:`text-sm ${y?"animate-spin":""}`})})]})]})}),h.jsx("div",{className:"flex-1 min-h-0 flex items-center justify-center p-1 overflow-hidden",children:h.jsx("div",{className:"grid grid-cols-4 gap-3 max-w-[1600px] w-full mx-auto",children:k.map((re,xe)=>W(xe))})}),h.jsx("div",{className:"shrink-0 bg-white/70 backdrop-blur-sm border-t border-gray-200 px-4 py-1",children:h.jsxs("div",{className:"flex flex-wrap justify-center gap-3 max-w-[1800px] mx-auto",children:[h.jsx(P1,{color:"bg-green-500",label:"Present",count:p.filter(re=>["in","present"].includes(re.status.toLowerCase())).length}),h.jsx(P1,{color:"bg-red-500",label:"Absent",count:p.filter(re=>re.status.toLowerCase().includes("absent")).length}),h.jsx(P1,{color:"bg-orange-500",label:"Halfday",count:p.filter(re=>re.status.toLowerCase().includes("half")).length}),h.jsx(P1,{color:"bg-blue-600",label:"Holiday",count:p.filter(re=>re.status.toLowerCase().includes("holiday")).length}),h.jsx(P1,{color:"bg-purple-500",label:"Leave",count:p.filter(re=>re.status.toLowerCase().includes("leave")).length}),h.jsx(P1,{color:"bg-gray-200 border border-gray-300",label:"No Record",text:"text-gray-500"})]})})]})},P1=({color:i,label:t,count:r,text:a})=>h.jsxs("div",{className:"flex items-center gap-3 group cursor-help",children:[h.jsx("div",{className:`w-4 h-4 rounded-full ${i} shadow-lg transition-transform group-hover:scale-125`}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:`text-[10px] uppercase font-black tracking-widest ${a||"text-gray-700"}`,children:t}),r!==void 0&&h.jsxs("span",{className:"text-xs font-bold text-gray-400",children:[r," Days"]})]})]});function F2(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var m2={exports:{}},R2={exports:{}};var kR=R2.exports,hw;function _R(){return hw||(hw=1,(function(i){var t={version:"1.15.0"};t[437]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[620]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[737]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[850]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[852]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[857]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[861]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[865]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[866]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[874]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[895]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[932]=(function(){var r=[],a={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(a[n[0][e]]=0+e,r[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)n[129][e].charCodeAt(0)!==65533&&(a[n[129][e]]=33024+e,r[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)n[130][e].charCodeAt(0)!==65533&&(a[n[130][e]]=33280+e,r[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)n[131][e].charCodeAt(0)!==65533&&(a[n[131][e]]=33536+e,r[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)n[132][e].charCodeAt(0)!==65533&&(a[n[132][e]]=33792+e,r[33792+e]=n[132][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)n[135][e].charCodeAt(0)!==65533&&(a[n[135][e]]=34560+e,r[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)n[136][e].charCodeAt(0)!==65533&&(a[n[136][e]]=34816+e,r[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)n[137][e].charCodeAt(0)!==65533&&(a[n[137][e]]=35072+e,r[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)n[138][e].charCodeAt(0)!==65533&&(a[n[138][e]]=35328+e,r[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)n[139][e].charCodeAt(0)!==65533&&(a[n[139][e]]=35584+e,r[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)n[140][e].charCodeAt(0)!==65533&&(a[n[140][e]]=35840+e,r[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)n[141][e].charCodeAt(0)!==65533&&(a[n[141][e]]=36096+e,r[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)n[142][e].charCodeAt(0)!==65533&&(a[n[142][e]]=36352+e,r[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)n[143][e].charCodeAt(0)!==65533&&(a[n[143][e]]=36608+e,r[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)n[144][e].charCodeAt(0)!==65533&&(a[n[144][e]]=36864+e,r[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)n[145][e].charCodeAt(0)!==65533&&(a[n[145][e]]=37120+e,r[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)n[146][e].charCodeAt(0)!==65533&&(a[n[146][e]]=37376+e,r[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)n[147][e].charCodeAt(0)!==65533&&(a[n[147][e]]=37632+e,r[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)n[148][e].charCodeAt(0)!==65533&&(a[n[148][e]]=37888+e,r[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)n[149][e].charCodeAt(0)!==65533&&(a[n[149][e]]=38144+e,r[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)n[150][e].charCodeAt(0)!==65533&&(a[n[150][e]]=38400+e,r[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)n[151][e].charCodeAt(0)!==65533&&(a[n[151][e]]=38656+e,r[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)n[152][e].charCodeAt(0)!==65533&&(a[n[152][e]]=38912+e,r[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)n[153][e].charCodeAt(0)!==65533&&(a[n[153][e]]=39168+e,r[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)n[154][e].charCodeAt(0)!==65533&&(a[n[154][e]]=39424+e,r[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)n[155][e].charCodeAt(0)!==65533&&(a[n[155][e]]=39680+e,r[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)n[156][e].charCodeAt(0)!==65533&&(a[n[156][e]]=39936+e,r[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)n[157][e].charCodeAt(0)!==65533&&(a[n[157][e]]=40192+e,r[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)n[158][e].charCodeAt(0)!==65533&&(a[n[158][e]]=40448+e,r[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)n[159][e].charCodeAt(0)!==65533&&(a[n[159][e]]=40704+e,r[40704+e]=n[159][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(a[n[224][e]]=57344+e,r[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(a[n[225][e]]=57600+e,r[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(a[n[226][e]]=57856+e,r[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(a[n[227][e]]=58112+e,r[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(a[n[228][e]]=58368+e,r[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(a[n[229][e]]=58624+e,r[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(a[n[230][e]]=58880+e,r[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(a[n[231][e]]=59136+e,r[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(a[n[232][e]]=59392+e,r[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(a[n[233][e]]=59648+e,r[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(a[n[234][e]]=59904+e,r[59904+e]=n[234][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(a[n[237][e]]=60672+e,r[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(a[n[238][e]]=60928+e,r[60928+e]=n[238][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)n[250][e].charCodeAt(0)!==65533&&(a[n[250][e]]=64e3+e,r[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)n[251][e].charCodeAt(0)!==65533&&(a[n[251][e]]=64256+e,r[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)n[252][e].charCodeAt(0)!==65533&&(a[n[252][e]]=64512+e,r[64512+e]=n[252][e]);return{enc:a,dec:r}})(),t[936]=(function(){var r=[],a={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(a[n[0][e]]=0+e,r[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)n[129][e].charCodeAt(0)!==65533&&(a[n[129][e]]=33024+e,r[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)n[130][e].charCodeAt(0)!==65533&&(a[n[130][e]]=33280+e,r[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)n[131][e].charCodeAt(0)!==65533&&(a[n[131][e]]=33536+e,r[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)n[132][e].charCodeAt(0)!==65533&&(a[n[132][e]]=33792+e,r[33792+e]=n[132][e]);for(n[133]="".split(""),e=0;e!=n[133].length;++e)n[133][e].charCodeAt(0)!==65533&&(a[n[133][e]]=34048+e,r[34048+e]=n[133][e]);for(n[134]="".split(""),e=0;e!=n[134].length;++e)n[134][e].charCodeAt(0)!==65533&&(a[n[134][e]]=34304+e,r[34304+e]=n[134][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)n[135][e].charCodeAt(0)!==65533&&(a[n[135][e]]=34560+e,r[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)n[136][e].charCodeAt(0)!==65533&&(a[n[136][e]]=34816+e,r[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)n[137][e].charCodeAt(0)!==65533&&(a[n[137][e]]=35072+e,r[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)n[138][e].charCodeAt(0)!==65533&&(a[n[138][e]]=35328+e,r[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)n[139][e].charCodeAt(0)!==65533&&(a[n[139][e]]=35584+e,r[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)n[140][e].charCodeAt(0)!==65533&&(a[n[140][e]]=35840+e,r[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)n[141][e].charCodeAt(0)!==65533&&(a[n[141][e]]=36096+e,r[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)n[142][e].charCodeAt(0)!==65533&&(a[n[142][e]]=36352+e,r[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)n[143][e].charCodeAt(0)!==65533&&(a[n[143][e]]=36608+e,r[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)n[144][e].charCodeAt(0)!==65533&&(a[n[144][e]]=36864+e,r[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)n[145][e].charCodeAt(0)!==65533&&(a[n[145][e]]=37120+e,r[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)n[146][e].charCodeAt(0)!==65533&&(a[n[146][e]]=37376+e,r[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)n[147][e].charCodeAt(0)!==65533&&(a[n[147][e]]=37632+e,r[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)n[148][e].charCodeAt(0)!==65533&&(a[n[148][e]]=37888+e,r[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)n[149][e].charCodeAt(0)!==65533&&(a[n[149][e]]=38144+e,r[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)n[150][e].charCodeAt(0)!==65533&&(a[n[150][e]]=38400+e,r[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)n[151][e].charCodeAt(0)!==65533&&(a[n[151][e]]=38656+e,r[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)n[152][e].charCodeAt(0)!==65533&&(a[n[152][e]]=38912+e,r[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)n[153][e].charCodeAt(0)!==65533&&(a[n[153][e]]=39168+e,r[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)n[154][e].charCodeAt(0)!==65533&&(a[n[154][e]]=39424+e,r[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)n[155][e].charCodeAt(0)!==65533&&(a[n[155][e]]=39680+e,r[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)n[156][e].charCodeAt(0)!==65533&&(a[n[156][e]]=39936+e,r[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)n[157][e].charCodeAt(0)!==65533&&(a[n[157][e]]=40192+e,r[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)n[158][e].charCodeAt(0)!==65533&&(a[n[158][e]]=40448+e,r[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)n[159][e].charCodeAt(0)!==65533&&(a[n[159][e]]=40704+e,r[40704+e]=n[159][e]);for(n[160]="".split(""),e=0;e!=n[160].length;++e)n[160][e].charCodeAt(0)!==65533&&(a[n[160][e]]=40960+e,r[40960+e]=n[160][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(a[n[161][e]]=41216+e,r[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(a[n[162][e]]=41472+e,r[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(a[n[163][e]]=41728+e,r[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(a[n[164][e]]=41984+e,r[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(a[n[165][e]]=42240+e,r[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(a[n[166][e]]=42496+e,r[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(a[n[167][e]]=42752+e,r[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(a[n[168][e]]=43008+e,r[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(a[n[169][e]]=43264+e,r[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)n[170][e].charCodeAt(0)!==65533&&(a[n[170][e]]=43520+e,r[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)n[171][e].charCodeAt(0)!==65533&&(a[n[171][e]]=43776+e,r[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)n[172][e].charCodeAt(0)!==65533&&(a[n[172][e]]=44032+e,r[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)n[173][e].charCodeAt(0)!==65533&&(a[n[173][e]]=44288+e,r[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)n[174][e].charCodeAt(0)!==65533&&(a[n[174][e]]=44544+e,r[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)n[175][e].charCodeAt(0)!==65533&&(a[n[175][e]]=44800+e,r[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(a[n[176][e]]=45056+e,r[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(a[n[177][e]]=45312+e,r[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(a[n[178][e]]=45568+e,r[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(a[n[179][e]]=45824+e,r[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(a[n[180][e]]=46080+e,r[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(a[n[181][e]]=46336+e,r[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(a[n[182][e]]=46592+e,r[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(a[n[183][e]]=46848+e,r[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(a[n[184][e]]=47104+e,r[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(a[n[185][e]]=47360+e,r[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(a[n[186][e]]=47616+e,r[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(a[n[187][e]]=47872+e,r[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(a[n[188][e]]=48128+e,r[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(a[n[189][e]]=48384+e,r[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(a[n[190][e]]=48640+e,r[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(a[n[191][e]]=48896+e,r[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(a[n[192][e]]=49152+e,r[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(a[n[193][e]]=49408+e,r[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(a[n[194][e]]=49664+e,r[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(a[n[195][e]]=49920+e,r[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(a[n[196][e]]=50176+e,r[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(a[n[197][e]]=50432+e,r[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(a[n[198][e]]=50688+e,r[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)n[199][e].charCodeAt(0)!==65533&&(a[n[199][e]]=50944+e,r[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)n[200][e].charCodeAt(0)!==65533&&(a[n[200][e]]=51200+e,r[51200+e]=n[200][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)n[201][e].charCodeAt(0)!==65533&&(a[n[201][e]]=51456+e,r[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(a[n[202][e]]=51712+e,r[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(a[n[203][e]]=51968+e,r[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(a[n[204][e]]=52224+e,r[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(a[n[205][e]]=52480+e,r[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(a[n[206][e]]=52736+e,r[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(a[n[207][e]]=52992+e,r[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(a[n[208][e]]=53248+e,r[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(a[n[209][e]]=53504+e,r[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(a[n[210][e]]=53760+e,r[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(a[n[211][e]]=54016+e,r[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(a[n[212][e]]=54272+e,r[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(a[n[213][e]]=54528+e,r[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(a[n[214][e]]=54784+e,r[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(a[n[215][e]]=55040+e,r[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(a[n[216][e]]=55296+e,r[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(a[n[217][e]]=55552+e,r[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(a[n[218][e]]=55808+e,r[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(a[n[219][e]]=56064+e,r[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(a[n[220][e]]=56320+e,r[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(a[n[221][e]]=56576+e,r[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(a[n[222][e]]=56832+e,r[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(a[n[223][e]]=57088+e,r[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(a[n[224][e]]=57344+e,r[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(a[n[225][e]]=57600+e,r[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(a[n[226][e]]=57856+e,r[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(a[n[227][e]]=58112+e,r[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(a[n[228][e]]=58368+e,r[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(a[n[229][e]]=58624+e,r[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(a[n[230][e]]=58880+e,r[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(a[n[231][e]]=59136+e,r[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(a[n[232][e]]=59392+e,r[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(a[n[233][e]]=59648+e,r[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(a[n[234][e]]=59904+e,r[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(a[n[235][e]]=60160+e,r[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(a[n[236][e]]=60416+e,r[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(a[n[237][e]]=60672+e,r[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(a[n[238][e]]=60928+e,r[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(a[n[239][e]]=61184+e,r[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(a[n[240][e]]=61440+e,r[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(a[n[241][e]]=61696+e,r[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(a[n[242][e]]=61952+e,r[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(a[n[243][e]]=62208+e,r[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(a[n[244][e]]=62464+e,r[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(a[n[245][e]]=62720+e,r[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(a[n[246][e]]=62976+e,r[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(a[n[247][e]]=63232+e,r[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)n[248][e].charCodeAt(0)!==65533&&(a[n[248][e]]=63488+e,r[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)n[249][e].charCodeAt(0)!==65533&&(a[n[249][e]]=63744+e,r[63744+e]=n[249][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)n[250][e].charCodeAt(0)!==65533&&(a[n[250][e]]=64e3+e,r[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)n[251][e].charCodeAt(0)!==65533&&(a[n[251][e]]=64256+e,r[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)n[252][e].charCodeAt(0)!==65533&&(a[n[252][e]]=64512+e,r[64512+e]=n[252][e]);for(n[253]="".split(""),e=0;e!=n[253].length;++e)n[253][e].charCodeAt(0)!==65533&&(a[n[253][e]]=64768+e,r[64768+e]=n[253][e]);for(n[254]="".split(""),e=0;e!=n[254].length;++e)n[254][e].charCodeAt(0)!==65533&&(a[n[254][e]]=65024+e,r[65024+e]=n[254][e]);return{enc:a,dec:r}})(),t[949]=(function(){var r=[],a={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(a[n[0][e]]=0+e,r[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)n[129][e].charCodeAt(0)!==65533&&(a[n[129][e]]=33024+e,r[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)n[130][e].charCodeAt(0)!==65533&&(a[n[130][e]]=33280+e,r[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)n[131][e].charCodeAt(0)!==65533&&(a[n[131][e]]=33536+e,r[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)n[132][e].charCodeAt(0)!==65533&&(a[n[132][e]]=33792+e,r[33792+e]=n[132][e]);for(n[133]="".split(""),e=0;e!=n[133].length;++e)n[133][e].charCodeAt(0)!==65533&&(a[n[133][e]]=34048+e,r[34048+e]=n[133][e]);for(n[134]="".split(""),e=0;e!=n[134].length;++e)n[134][e].charCodeAt(0)!==65533&&(a[n[134][e]]=34304+e,r[34304+e]=n[134][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)n[135][e].charCodeAt(0)!==65533&&(a[n[135][e]]=34560+e,r[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)n[136][e].charCodeAt(0)!==65533&&(a[n[136][e]]=34816+e,r[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)n[137][e].charCodeAt(0)!==65533&&(a[n[137][e]]=35072+e,r[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)n[138][e].charCodeAt(0)!==65533&&(a[n[138][e]]=35328+e,r[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)n[139][e].charCodeAt(0)!==65533&&(a[n[139][e]]=35584+e,r[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)n[140][e].charCodeAt(0)!==65533&&(a[n[140][e]]=35840+e,r[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)n[141][e].charCodeAt(0)!==65533&&(a[n[141][e]]=36096+e,r[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)n[142][e].charCodeAt(0)!==65533&&(a[n[142][e]]=36352+e,r[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)n[143][e].charCodeAt(0)!==65533&&(a[n[143][e]]=36608+e,r[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)n[144][e].charCodeAt(0)!==65533&&(a[n[144][e]]=36864+e,r[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)n[145][e].charCodeAt(0)!==65533&&(a[n[145][e]]=37120+e,r[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)n[146][e].charCodeAt(0)!==65533&&(a[n[146][e]]=37376+e,r[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)n[147][e].charCodeAt(0)!==65533&&(a[n[147][e]]=37632+e,r[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)n[148][e].charCodeAt(0)!==65533&&(a[n[148][e]]=37888+e,r[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)n[149][e].charCodeAt(0)!==65533&&(a[n[149][e]]=38144+e,r[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)n[150][e].charCodeAt(0)!==65533&&(a[n[150][e]]=38400+e,r[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)n[151][e].charCodeAt(0)!==65533&&(a[n[151][e]]=38656+e,r[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)n[152][e].charCodeAt(0)!==65533&&(a[n[152][e]]=38912+e,r[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)n[153][e].charCodeAt(0)!==65533&&(a[n[153][e]]=39168+e,r[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)n[154][e].charCodeAt(0)!==65533&&(a[n[154][e]]=39424+e,r[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)n[155][e].charCodeAt(0)!==65533&&(a[n[155][e]]=39680+e,r[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)n[156][e].charCodeAt(0)!==65533&&(a[n[156][e]]=39936+e,r[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)n[157][e].charCodeAt(0)!==65533&&(a[n[157][e]]=40192+e,r[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)n[158][e].charCodeAt(0)!==65533&&(a[n[158][e]]=40448+e,r[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)n[159][e].charCodeAt(0)!==65533&&(a[n[159][e]]=40704+e,r[40704+e]=n[159][e]);for(n[160]="".split(""),e=0;e!=n[160].length;++e)n[160][e].charCodeAt(0)!==65533&&(a[n[160][e]]=40960+e,r[40960+e]=n[160][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(a[n[161][e]]=41216+e,r[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(a[n[162][e]]=41472+e,r[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(a[n[163][e]]=41728+e,r[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(a[n[164][e]]=41984+e,r[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(a[n[165][e]]=42240+e,r[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(a[n[166][e]]=42496+e,r[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(a[n[167][e]]=42752+e,r[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(a[n[168][e]]=43008+e,r[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(a[n[169][e]]=43264+e,r[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)n[170][e].charCodeAt(0)!==65533&&(a[n[170][e]]=43520+e,r[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)n[171][e].charCodeAt(0)!==65533&&(a[n[171][e]]=43776+e,r[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)n[172][e].charCodeAt(0)!==65533&&(a[n[172][e]]=44032+e,r[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)n[173][e].charCodeAt(0)!==65533&&(a[n[173][e]]=44288+e,r[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)n[174][e].charCodeAt(0)!==65533&&(a[n[174][e]]=44544+e,r[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)n[175][e].charCodeAt(0)!==65533&&(a[n[175][e]]=44800+e,r[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(a[n[176][e]]=45056+e,r[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(a[n[177][e]]=45312+e,r[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(a[n[178][e]]=45568+e,r[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(a[n[179][e]]=45824+e,r[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(a[n[180][e]]=46080+e,r[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(a[n[181][e]]=46336+e,r[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(a[n[182][e]]=46592+e,r[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(a[n[183][e]]=46848+e,r[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(a[n[184][e]]=47104+e,r[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(a[n[185][e]]=47360+e,r[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(a[n[186][e]]=47616+e,r[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(a[n[187][e]]=47872+e,r[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(a[n[188][e]]=48128+e,r[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(a[n[189][e]]=48384+e,r[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(a[n[190][e]]=48640+e,r[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(a[n[191][e]]=48896+e,r[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(a[n[192][e]]=49152+e,r[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(a[n[193][e]]=49408+e,r[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(a[n[194][e]]=49664+e,r[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(a[n[195][e]]=49920+e,r[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(a[n[196][e]]=50176+e,r[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(a[n[197][e]]=50432+e,r[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(a[n[198][e]]=50688+e,r[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)n[199][e].charCodeAt(0)!==65533&&(a[n[199][e]]=50944+e,r[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)n[200][e].charCodeAt(0)!==65533&&(a[n[200][e]]=51200+e,r[51200+e]=n[200][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(a[n[202][e]]=51712+e,r[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(a[n[203][e]]=51968+e,r[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(a[n[204][e]]=52224+e,r[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(a[n[205][e]]=52480+e,r[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(a[n[206][e]]=52736+e,r[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(a[n[207][e]]=52992+e,r[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(a[n[208][e]]=53248+e,r[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(a[n[209][e]]=53504+e,r[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(a[n[210][e]]=53760+e,r[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(a[n[211][e]]=54016+e,r[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(a[n[212][e]]=54272+e,r[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(a[n[213][e]]=54528+e,r[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(a[n[214][e]]=54784+e,r[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(a[n[215][e]]=55040+e,r[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(a[n[216][e]]=55296+e,r[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(a[n[217][e]]=55552+e,r[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(a[n[218][e]]=55808+e,r[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(a[n[219][e]]=56064+e,r[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(a[n[220][e]]=56320+e,r[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(a[n[221][e]]=56576+e,r[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(a[n[222][e]]=56832+e,r[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(a[n[223][e]]=57088+e,r[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(a[n[224][e]]=57344+e,r[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(a[n[225][e]]=57600+e,r[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(a[n[226][e]]=57856+e,r[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(a[n[227][e]]=58112+e,r[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(a[n[228][e]]=58368+e,r[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(a[n[229][e]]=58624+e,r[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(a[n[230][e]]=58880+e,r[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(a[n[231][e]]=59136+e,r[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(a[n[232][e]]=59392+e,r[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(a[n[233][e]]=59648+e,r[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(a[n[234][e]]=59904+e,r[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(a[n[235][e]]=60160+e,r[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(a[n[236][e]]=60416+e,r[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(a[n[237][e]]=60672+e,r[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(a[n[238][e]]=60928+e,r[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(a[n[239][e]]=61184+e,r[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(a[n[240][e]]=61440+e,r[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(a[n[241][e]]=61696+e,r[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(a[n[242][e]]=61952+e,r[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(a[n[243][e]]=62208+e,r[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(a[n[244][e]]=62464+e,r[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(a[n[245][e]]=62720+e,r[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(a[n[246][e]]=62976+e,r[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(a[n[247][e]]=63232+e,r[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)n[248][e].charCodeAt(0)!==65533&&(a[n[248][e]]=63488+e,r[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)n[249][e].charCodeAt(0)!==65533&&(a[n[249][e]]=63744+e,r[63744+e]=n[249][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)n[250][e].charCodeAt(0)!==65533&&(a[n[250][e]]=64e3+e,r[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)n[251][e].charCodeAt(0)!==65533&&(a[n[251][e]]=64256+e,r[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)n[252][e].charCodeAt(0)!==65533&&(a[n[252][e]]=64512+e,r[64512+e]=n[252][e]);for(n[253]="".split(""),e=0;e!=n[253].length;++e)n[253][e].charCodeAt(0)!==65533&&(a[n[253][e]]=64768+e,r[64768+e]=n[253][e]);return{enc:a,dec:r}})(),t[950]=(function(){var r=[],a={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(a[n[0][e]]=0+e,r[0+e]=n[0][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(a[n[161][e]]=41216+e,r[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(a[n[162][e]]=41472+e,r[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(a[n[163][e]]=41728+e,r[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(a[n[164][e]]=41984+e,r[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(a[n[165][e]]=42240+e,r[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(a[n[166][e]]=42496+e,r[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(a[n[167][e]]=42752+e,r[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(a[n[168][e]]=43008+e,r[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(a[n[169][e]]=43264+e,r[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)n[170][e].charCodeAt(0)!==65533&&(a[n[170][e]]=43520+e,r[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)n[171][e].charCodeAt(0)!==65533&&(a[n[171][e]]=43776+e,r[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)n[172][e].charCodeAt(0)!==65533&&(a[n[172][e]]=44032+e,r[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)n[173][e].charCodeAt(0)!==65533&&(a[n[173][e]]=44288+e,r[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)n[174][e].charCodeAt(0)!==65533&&(a[n[174][e]]=44544+e,r[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)n[175][e].charCodeAt(0)!==65533&&(a[n[175][e]]=44800+e,r[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(a[n[176][e]]=45056+e,r[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(a[n[177][e]]=45312+e,r[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(a[n[178][e]]=45568+e,r[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(a[n[179][e]]=45824+e,r[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(a[n[180][e]]=46080+e,r[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(a[n[181][e]]=46336+e,r[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(a[n[182][e]]=46592+e,r[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(a[n[183][e]]=46848+e,r[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(a[n[184][e]]=47104+e,r[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(a[n[185][e]]=47360+e,r[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(a[n[186][e]]=47616+e,r[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(a[n[187][e]]=47872+e,r[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(a[n[188][e]]=48128+e,r[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(a[n[189][e]]=48384+e,r[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(a[n[190][e]]=48640+e,r[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(a[n[191][e]]=48896+e,r[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(a[n[192][e]]=49152+e,r[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(a[n[193][e]]=49408+e,r[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(a[n[194][e]]=49664+e,r[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(a[n[195][e]]=49920+e,r[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(a[n[196][e]]=50176+e,r[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(a[n[197][e]]=50432+e,r[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(a[n[198][e]]=50688+e,r[50688+e]=n[198][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)n[201][e].charCodeAt(0)!==65533&&(a[n[201][e]]=51456+e,r[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(a[n[202][e]]=51712+e,r[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(a[n[203][e]]=51968+e,r[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(a[n[204][e]]=52224+e,r[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(a[n[205][e]]=52480+e,r[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(a[n[206][e]]=52736+e,r[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(a[n[207][e]]=52992+e,r[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(a[n[208][e]]=53248+e,r[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(a[n[209][e]]=53504+e,r[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(a[n[210][e]]=53760+e,r[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(a[n[211][e]]=54016+e,r[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(a[n[212][e]]=54272+e,r[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(a[n[213][e]]=54528+e,r[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(a[n[214][e]]=54784+e,r[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(a[n[215][e]]=55040+e,r[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(a[n[216][e]]=55296+e,r[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(a[n[217][e]]=55552+e,r[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(a[n[218][e]]=55808+e,r[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(a[n[219][e]]=56064+e,r[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(a[n[220][e]]=56320+e,r[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(a[n[221][e]]=56576+e,r[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(a[n[222][e]]=56832+e,r[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(a[n[223][e]]=57088+e,r[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(a[n[224][e]]=57344+e,r[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(a[n[225][e]]=57600+e,r[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(a[n[226][e]]=57856+e,r[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(a[n[227][e]]=58112+e,r[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(a[n[228][e]]=58368+e,r[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(a[n[229][e]]=58624+e,r[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(a[n[230][e]]=58880+e,r[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(a[n[231][e]]=59136+e,r[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(a[n[232][e]]=59392+e,r[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(a[n[233][e]]=59648+e,r[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(a[n[234][e]]=59904+e,r[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(a[n[235][e]]=60160+e,r[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(a[n[236][e]]=60416+e,r[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(a[n[237][e]]=60672+e,r[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(a[n[238][e]]=60928+e,r[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(a[n[239][e]]=61184+e,r[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(a[n[240][e]]=61440+e,r[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(a[n[241][e]]=61696+e,r[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(a[n[242][e]]=61952+e,r[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(a[n[243][e]]=62208+e,r[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(a[n[244][e]]=62464+e,r[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(a[n[245][e]]=62720+e,r[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(a[n[246][e]]=62976+e,r[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(a[n[247][e]]=63232+e,r[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)n[248][e].charCodeAt(0)!==65533&&(a[n[248][e]]=63488+e,r[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)n[249][e].charCodeAt(0)!==65533&&(a[n[249][e]]=63744+e,r[63744+e]=n[249][e]);return{enc:a,dec:r}})(),t[1250]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1251]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1252]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1253]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1254]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1255]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1256]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1257]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1258]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[1e4]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[10006]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[10007]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[10008]=(function(){var r=[],a={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(a[n[0][e]]=0+e,r[0+e]=n[0][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(a[n[161][e]]=41216+e,r[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(a[n[162][e]]=41472+e,r[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(a[n[163][e]]=41728+e,r[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(a[n[164][e]]=41984+e,r[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(a[n[165][e]]=42240+e,r[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(a[n[166][e]]=42496+e,r[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(a[n[167][e]]=42752+e,r[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(a[n[168][e]]=43008+e,r[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(a[n[169][e]]=43264+e,r[43264+e]=n[169][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(a[n[176][e]]=45056+e,r[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(a[n[177][e]]=45312+e,r[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(a[n[178][e]]=45568+e,r[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(a[n[179][e]]=45824+e,r[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(a[n[180][e]]=46080+e,r[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(a[n[181][e]]=46336+e,r[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(a[n[182][e]]=46592+e,r[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(a[n[183][e]]=46848+e,r[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(a[n[184][e]]=47104+e,r[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(a[n[185][e]]=47360+e,r[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(a[n[186][e]]=47616+e,r[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(a[n[187][e]]=47872+e,r[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(a[n[188][e]]=48128+e,r[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(a[n[189][e]]=48384+e,r[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(a[n[190][e]]=48640+e,r[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(a[n[191][e]]=48896+e,r[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(a[n[192][e]]=49152+e,r[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(a[n[193][e]]=49408+e,r[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(a[n[194][e]]=49664+e,r[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(a[n[195][e]]=49920+e,r[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(a[n[196][e]]=50176+e,r[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(a[n[197][e]]=50432+e,r[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(a[n[198][e]]=50688+e,r[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)n[199][e].charCodeAt(0)!==65533&&(a[n[199][e]]=50944+e,r[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)n[200][e].charCodeAt(0)!==65533&&(a[n[200][e]]=51200+e,r[51200+e]=n[200][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)n[201][e].charCodeAt(0)!==65533&&(a[n[201][e]]=51456+e,r[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(a[n[202][e]]=51712+e,r[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(a[n[203][e]]=51968+e,r[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(a[n[204][e]]=52224+e,r[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(a[n[205][e]]=52480+e,r[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(a[n[206][e]]=52736+e,r[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(a[n[207][e]]=52992+e,r[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(a[n[208][e]]=53248+e,r[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(a[n[209][e]]=53504+e,r[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(a[n[210][e]]=53760+e,r[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(a[n[211][e]]=54016+e,r[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(a[n[212][e]]=54272+e,r[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(a[n[213][e]]=54528+e,r[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(a[n[214][e]]=54784+e,r[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(a[n[215][e]]=55040+e,r[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(a[n[216][e]]=55296+e,r[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(a[n[217][e]]=55552+e,r[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(a[n[218][e]]=55808+e,r[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(a[n[219][e]]=56064+e,r[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(a[n[220][e]]=56320+e,r[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(a[n[221][e]]=56576+e,r[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(a[n[222][e]]=56832+e,r[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(a[n[223][e]]=57088+e,r[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(a[n[224][e]]=57344+e,r[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(a[n[225][e]]=57600+e,r[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(a[n[226][e]]=57856+e,r[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(a[n[227][e]]=58112+e,r[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(a[n[228][e]]=58368+e,r[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(a[n[229][e]]=58624+e,r[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(a[n[230][e]]=58880+e,r[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(a[n[231][e]]=59136+e,r[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(a[n[232][e]]=59392+e,r[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(a[n[233][e]]=59648+e,r[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(a[n[234][e]]=59904+e,r[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(a[n[235][e]]=60160+e,r[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(a[n[236][e]]=60416+e,r[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(a[n[237][e]]=60672+e,r[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(a[n[238][e]]=60928+e,r[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(a[n[239][e]]=61184+e,r[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(a[n[240][e]]=61440+e,r[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(a[n[241][e]]=61696+e,r[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(a[n[242][e]]=61952+e,r[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(a[n[243][e]]=62208+e,r[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(a[n[244][e]]=62464+e,r[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(a[n[245][e]]=62720+e,r[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(a[n[246][e]]=62976+e,r[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(a[n[247][e]]=63232+e,r[63232+e]=n[247][e]);return{enc:a,dec:r}})(),t[10029]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[10079]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[10081]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),t[28591]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],n={},e=0;e!=r.length;++e)r.charCodeAt(e)!==65533&&(n[r.charAt(e)]=e),a[e]=r.charAt(e);return{enc:n,dec:a}})(),i.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(i.exports=t);(function(r,a){if(typeof t>"u")if(typeof F2<"u"){var n=t;i.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?i.exports=a(n):r.cptable=a(n)}else throw new Error("cptable not found");else t=a(t)})(kR,function(r){var a={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},n=[874,1250,1251,1252,1253,1254,1255,1256,1e4],e=[932,936,949,950],p=[65001],m={},y={},w={},A={},I=function(Le){return String.fromCharCode(Le)},R=function(Le){return Le.charCodeAt(0)},k=typeof Buffer<"u",M=function(){};if(k){var V=!Buffer.from;if(!V)try{Buffer.from("foo","utf8")}catch{V=!0}M=V?function(_e,Le){return Le?new Buffer(_e,Le):new Buffer(_e)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(_e){return new Buffer(_e)});var q=1024,U=Buffer.allocUnsafe(q),te=function(Le){for(var X=Buffer.allocUnsafe(65536),H=0;H<65536;++H)X[H]=0;for(var ae=Object.keys(Le),Z=ae.length,se=0,ye=ae[se];se<Z;++se)(ye=ae[se])&&(X[ye.charCodeAt(0)]=Le[ye]);return X},W=function(Le){var X=te(r[Le].enc);return function(ae,Z){var se=ae.length,ye,ce=0,ze=0,pe=0,Ve=0;if(typeof ae=="string")for(ye=Buffer.allocUnsafe(se),ce=0;ce<se;++ce)ye[ce]=X[ae.charCodeAt(ce)];else if(Buffer.isBuffer(ae)){for(ye=Buffer.allocUnsafe(2*se),ze=0,ce=0;ce<se;++ce)pe=ae[ce],pe<128?ye[ze++]=X[pe]:pe<224?(ye[ze++]=X[((pe&31)<<6)+(ae[ce+1]&63)],++ce):pe<240?(ye[ze++]=X[((pe&15)<<12)+((ae[ce+1]&63)<<6)+(ae[ce+2]&63)],ce+=2):(Ve=((pe&7)<<18)+((ae[ce+1]&63)<<12)+((ae[ce+2]&63)<<6)+(ae[ce+3]&63),ce+=3,Ve<65536?ye[ze++]=X[Ve]:(Ve-=65536,ye[ze++]=X[55296+(Ve>>10&1023)],ye[ze++]=X[56320+(Ve&1023)]));ye=ye.slice(0,ze)}else for(ye=Buffer.allocUnsafe(se),ce=0;ce<se;++ce)ye[ce]=X[ae[ce].charCodeAt(0)];return!Z||Z==="buf"?ye:Z!=="arr"?ye.toString("binary"):[].slice.call(ye)}},re=function(Le){var X=r[Le].dec,H=Buffer.allocUnsafe(131072),ae=0,Z="";for(ae=0;ae<X.length;++ae)if(Z=X[ae]){var se=Z.charCodeAt(0);H[2*ae]=se&255,H[2*ae+1]=se>>8}return function(ce){var ze=ce.length,pe=0,Ve=0;if(2*ze>q&&(q=2*ze,U=Buffer.allocUnsafe(q)),Buffer.isBuffer(ce))for(pe=0;pe<ze;pe++)Ve=2*ce[pe],U[2*pe]=H[Ve],U[2*pe+1]=H[Ve+1];else if(typeof ce=="string")for(pe=0;pe<ze;pe++)Ve=2*ce.charCodeAt(pe),U[2*pe]=H[Ve],U[2*pe+1]=H[Ve+1];else for(pe=0;pe<ze;pe++)Ve=2*ce[pe],U[2*pe]=H[Ve],U[2*pe+1]=H[Ve+1];return U.slice(0,2*ze).toString("ucs2")}},xe=function(Le){for(var X=r[Le].enc,H=Buffer.allocUnsafe(131072),ae=0;ae<131072;++ae)H[ae]=0;for(var Z=Object.keys(X),se=0,ye=Z[se];se<Z.length;++se)if(ye=Z[se]){var ce=ye.charCodeAt(0);H[2*ce]=X[ye]&255,H[2*ce+1]=X[ye]>>8}return function(pe,Ve){var yt=pe.length,vt=Buffer.allocUnsafe(2*yt),bt=0,Ft=0,Te=0,Ht=0,Or=0;if(typeof pe=="string"){for(bt=Ht=0;bt<yt;++bt)Ft=pe.charCodeAt(bt)*2,vt[Ht++]=H[Ft+1]||H[Ft],H[Ft+1]>0&&(vt[Ht++]=H[Ft]);vt=vt.slice(0,Ht)}else if(Buffer.isBuffer(pe)){for(bt=Ht=0;bt<yt;++bt)Or=pe[bt],Or<128?Ft=Or:Or<224?(Ft=((Or&31)<<6)+(pe[bt+1]&63),++bt):Or<240?(Ft=((Or&15)<<12)+((pe[bt+1]&63)<<6)+(pe[bt+2]&63),bt+=2):(Ft=((Or&7)<<18)+((pe[bt+1]&63)<<12)+((pe[bt+2]&63)<<6)+(pe[bt+3]&63),bt+=3),Ft<65536?(Ft*=2,vt[Ht++]=H[Ft+1]||H[Ft],H[Ft+1]>0&&(vt[Ht++]=H[Ft])):(Te=Ft-65536,Ft=2*(55296+(Te>>10&1023)),vt[Ht++]=H[Ft+1]||H[Ft],H[Ft+1]>0&&(vt[Ht++]=H[Ft]),Ft=2*(56320+(Te&1023)),vt[Ht++]=H[Ft+1]||H[Ft],H[Ft+1]>0&&(vt[Ht++]=H[Ft]));vt=vt.slice(0,Ht)}else for(bt=Ht=0;bt<yt;bt++)Ft=pe[bt].charCodeAt(0)*2,vt[Ht++]=H[Ft+1]||H[Ft],H[Ft+1]>0&&(vt[Ht++]=H[Ft]);return!Ve||Ve==="buf"?vt:Ve!=="arr"?vt.toString("binary"):[].slice.call(vt)}},ve=function(Le){var X=r[Le].dec,H=Buffer.allocUnsafe(131072),ae=0,Z,se=0,ye=0,ce=0;for(ce=0;ce<65536;++ce)H[2*ce]=255,H[2*ce+1]=253;for(ae=0;ae<X.length;++ae)(Z=X[ae])&&(se=Z.charCodeAt(0),ye=2*ae,H[ye]=se&255,H[ye+1]=se>>8);return function(pe){var Ve=pe.length,yt=Buffer.allocUnsafe(2*Ve),vt=0,bt=0,Ft=0;if(Buffer.isBuffer(pe))for(vt=0;vt<Ve;vt++)bt=2*pe[vt],H[bt]===255&&H[bt+1]===253&&(bt=2*((pe[vt]<<8)+pe[vt+1]),++vt),yt[Ft++]=H[bt],yt[Ft++]=H[bt+1];else if(typeof pe=="string")for(vt=0;vt<Ve;vt++)bt=2*pe.charCodeAt(vt),H[bt]===255&&H[bt+1]===253&&(bt=2*((pe.charCodeAt(vt)<<8)+pe.charCodeAt(vt+1)),++vt),yt[Ft++]=H[bt],yt[Ft++]=H[bt+1];else for(vt=0;vt<Ve;vt++)bt=2*pe[vt],H[bt]===255&&H[bt+1]===253&&(bt=2*((pe[vt]<<8)+pe[vt+1]),++vt),yt[Ft++]=H[bt],yt[Ft++]=H[bt+1];return yt.slice(0,Ft).toString("ucs2")}};m[65001]=function _e(Le){if(typeof Le=="string")return _e(Le.split("").map(R));var X=Le.length,H=0,ae=0;4*X>q&&(q=4*X,U=Buffer.allocUnsafe(q));var Z=0;X>=3&&Le[0]==239&&Le[1]==187&&Le[2]==191&&(Z=3);for(var se=1,ye=0,ce=0;Z<X;Z+=se)se=1,ce=Le[Z],ce<128?H=ce:ce<224?(H=(ce&31)*64+(Le[Z+1]&63),se=2):ce<240?(H=((ce&15)<<12)+(Le[Z+1]&63)*64+(Le[Z+2]&63),se=3):(H=(ce&7)*262144+((Le[Z+1]&63)<<12)+(Le[Z+2]&63)*64+(Le[Z+3]&63),se=4),H<65536?(U[ye++]=H&255,U[ye++]=H>>8):(H-=65536,ae=55296+(H>>10&1023),H=56320+(H&1023),U[ye++]=ae&255,U[ye++]=ae>>>8,U[ye++]=H&255,U[ye++]=H>>>8&255);return U.slice(0,ye).toString("ucs2")},y[65001]=function(Le,X){if(k&&Buffer.isBuffer(Le))return!X||X==="buf"?Le:X!=="arr"?Le.toString("binary"):[].slice.call(Le);var H=Le.length,ae=0,Z=0,se=0,ye=typeof Le=="string";4*H>q&&(q=4*H,U=Buffer.allocUnsafe(q));for(var ce=0;ce<H;++ce)ae=ye?Le.charCodeAt(ce):Le[ce].charCodeAt(0),ae<=127?U[se++]=ae:ae<=2047?(U[se++]=192+(ae>>6),U[se++]=128+(ae&63)):ae>=55296&&ae<=57343?(ae-=55296,++ce,Z=(ye?Le.charCodeAt(ce):Le[ce].charCodeAt(0))-56320+(ae<<10),U[se++]=240+(Z>>>18&7),U[se++]=144+(Z>>>12&63),U[se++]=128+(Z>>>6&63),U[se++]=128+(Z&63)):(U[se++]=224+(ae>>12),U[se++]=128+(ae>>6&63),U[se++]=128+(ae&63));return!X||X==="buf"?U.slice(0,se):X!=="arr"?U.slice(0,se).toString("binary"):[].slice.call(U,0,se)}}var De=function(){if(k){if(w[n[0]])return;var Le=0,X=0;for(Le=0;Le<n.length;++Le)X=n[Le],r[X]&&(w[X]=re(X),A[X]=W(X));for(Le=0;Le<e.length;++Le)X=e[Le],r[X]&&(w[X]=ve(X),A[X]=xe(X));for(Le=0;Le<p.length;++Le)X=p[Le],m[X]&&(w[X]=m[X]),y[X]&&(A[X]=y[X])}},ke=function(_e,Le){return""},de=function(Le){delete w[Le],delete A[Le]},Oe=function(){if(k){if(!w[n[0]])return;n.forEach(de),e.forEach(de),p.forEach(de)}Ce=ke,Be=0},z={encache:De,decache:Oe,sbcs:n,dbcs:e};De();var K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",Ce=ke,Be=0,Ee=function _e(Le,X,H){if(Le===Be&&Ce)return Ce(X,H);if(A[Le])return Ce=A[Be=Le],Ce(X,H);k&&Buffer.isBuffer(X)&&(X=X.toString("utf8"));var ae=X.length,Z=k?Buffer.allocUnsafe(4*ae):[],se=0,ye=0,ce=0,ze=0,pe=r[Le],Ve,yt="",vt=typeof X=="string";if(pe&&(Ve=pe.enc))for(ye=0;ye<ae;++ye,++ce)se=Ve[vt?X.charAt(ye):X[ye]],se>255?(Z[ce]=se>>8,Z[++ce]=se&255):Z[ce]=se&255;else if(yt=a[Le])switch(yt){case"utf8":if(k&&vt){Z=M(X,yt),ce=Z.length;break}for(ye=0;ye<ae;++ye,++ce)se=vt?X.charCodeAt(ye):X[ye].charCodeAt(0),se<=127?Z[ce]=se:se<=2047?(Z[ce]=192+(se>>6),Z[++ce]=128+(se&63)):se>=55296&&se<=57343?(se-=55296,ze=(vt?X.charCodeAt(++ye):X[++ye].charCodeAt(0))-56320+(se<<10),Z[ce]=240+(ze>>>18&7),Z[++ce]=144+(ze>>>12&63),Z[++ce]=128+(ze>>>6&63),Z[++ce]=128+(ze&63)):(Z[ce]=224+(se>>12),Z[++ce]=128+(se>>6&63),Z[++ce]=128+(se&63));break;case"ascii":if(k&&typeof X=="string"){Z=M(X,yt),ce=Z.length;break}for(ye=0;ye<ae;++ye,++ce)if(se=vt?X.charCodeAt(ye):X[ye].charCodeAt(0),se<=127)Z[ce]=se;else throw new Error("bad ascii "+se);break;case"utf16le":if(k&&typeof X=="string"){Z=M(X,yt),ce=Z.length;break}for(ye=0;ye<ae;++ye)se=vt?X.charCodeAt(ye):X[ye].charCodeAt(0),Z[ce++]=se&255,Z[ce++]=se>>8;break;case"utf16be":for(ye=0;ye<ae;++ye)se=vt?X.charCodeAt(ye):X[ye].charCodeAt(0),Z[ce++]=se>>8,Z[ce++]=se&255;break;case"utf32le":for(ye=0;ye<ae;++ye)se=vt?X.charCodeAt(ye):X[ye].charCodeAt(0),se>=55296&&se<=57343&&(se=65536+(se-55296<<10)+(X[++ye].charCodeAt(0)-56320)),Z[ce++]=se&255,se>>=8,Z[ce++]=se&255,se>>=8,Z[ce++]=se&255,se>>=8,Z[ce++]=se&255;break;case"utf32be":for(ye=0;ye<ae;++ye)se=vt?X.charCodeAt(ye):X[ye].charCodeAt(0),se>=55296&&se<=57343&&(se=65536+(se-55296<<10)+(X[++ye].charCodeAt(0)-56320)),Z[ce+3]=se&255,se>>=8,Z[ce+2]=se&255,se>>=8,Z[ce+1]=se&255,se>>=8,Z[ce]=se&255,ce+=4;break;case"utf7":for(ye=0;ye<ae;ye++){var bt=vt?X.charAt(ye):X[ye].charAt(0);if(bt==="+"){Z[ce++]=43,Z[ce++]=45;continue}if(Ae.indexOf(bt)>-1){Z[ce++]=bt.charCodeAt(0);continue}var Ft=_e(1201,bt);Z[ce++]=43,Z[ce++]=K.charCodeAt(Ft[0]>>2),Z[ce++]=K.charCodeAt(((Ft[0]&3)<<4)+((Ft[1]||0)>>4)),Z[ce++]=K.charCodeAt(((Ft[1]&15)<<2)+((Ft[2]||0)>>6)),Z[ce++]=45}break;default:throw new Error("Unsupported magic: "+Le+" "+a[Le])}else throw new Error("Unrecognized CP: "+Le);return Z=Z.slice(0,ce),k?!H||H==="buf"?Z:H!=="arr"?Z.toString("binary"):[].slice.call(Z):H=="str"?Z.map(I).join(""):Z},Pe=function _e(Le,X){var H;if(H=w[Le])return H(X);if(typeof X=="string")return _e(Le,X.split("").map(R));var ae=X.length,Z=new Array(ae),se="",ye=0,ce=0,ze=1,pe=0,Ve=0,yt=r[Le],vt,bt="";if(yt&&(vt=yt.dec))for(ce=0;ce<ae;ce+=ze){if(ze=2,se=vt[(X[ce]<<8)+X[ce+1]],se||(ze=1,se=vt[X[ce]]),!se)throw new Error("Unrecognized code: "+X[ce]+" "+X[ce+ze-1]+" "+ce+" "+ze+" "+vt[X[ce]]);Z[pe++]=se}else if(bt=a[Le])switch(bt){case"utf8":for(ae>=3&&X[0]==239&&X[1]==187&&X[2]==191&&(ce=3);ce<ae;ce+=ze)ze=1,X[ce]<128?ye=X[ce]:X[ce]<224?(ye=(X[ce]&31)*64+(X[ce+1]&63),ze=2):X[ce]<240?(ye=((X[ce]&15)<<12)+(X[ce+1]&63)*64+(X[ce+2]&63),ze=3):(ye=(X[ce]&7)*262144+((X[ce+1]&63)<<12)+(X[ce+2]&63)*64+(X[ce+3]&63),ze=4),ye<65536||(ye-=65536,Ve=55296+(ye>>10&1023),ye=56320+(ye&1023),Z[pe++]=String.fromCharCode(Ve)),Z[pe++]=String.fromCharCode(ye);break;case"ascii":if(k&&Buffer.isBuffer(X))return X.toString(bt);for(ce=0;ce<ae;ce++)Z[ce]=String.fromCharCode(X[ce]);pe=ae;break;case"utf16le":if(ae>=2&&X[0]==255&&X[1]==254&&(ce=2),k&&Buffer.isBuffer(X))return X.toString(bt);for(ze=2;ce+1<ae;ce+=ze)Z[pe++]=String.fromCharCode((X[ce+1]<<8)+X[ce]);break;case"utf16be":for(ae>=2&&X[0]==254&&X[1]==255&&(ce=2),ze=2;ce+1<ae;ce+=ze)Z[pe++]=String.fromCharCode((X[ce]<<8)+X[ce+1]);break;case"utf32le":for(ae>=4&&X[0]==255&&X[1]==254&&X[2]===0&&X[3]===0&&(ce=4),ze=4;ce<ae;ce+=ze)ye=(X[ce+3]<<24)+(X[ce+2]<<16)+(X[ce+1]<<8)+X[ce],ye>65535?(ye-=65536,Z[pe++]=String.fromCharCode(55296+(ye>>10&1023)),Z[pe++]=String.fromCharCode(56320+(ye&1023))):Z[pe++]=String.fromCharCode(ye);break;case"utf32be":for(ae>=4&&X[3]==255&&X[2]==254&&X[1]===0&&X[0]===0&&(ce=4),ze=4;ce<ae;ce+=ze)ye=(X[ce]<<24)+(X[ce+1]<<16)+(X[ce+2]<<8)+X[ce+3],ye>65535?(ye-=65536,Z[pe++]=String.fromCharCode(55296+(ye>>10&1023)),Z[pe++]=String.fromCharCode(56320+(ye&1023))):Z[pe++]=String.fromCharCode(ye);break;case"utf7":for(ae>=4&&X[0]==43&&X[1]==47&&X[2]==118&&(ae>=5&&X[3]==56&&X[4]==45?ce=5:(X[3]==56||X[3]==57||X[3]==43||X[3]==47)&&(ce=4));ce<ae;ce+=ze){if(X[ce]!==43){ze=1,Z[pe++]=String.fromCharCode(X[ce]);continue}if(ze=1,X[ce+1]===45){ze=2,Z[pe++]="+";continue}for(;String.fromCharCode(X[ce+ze]).match(/[A-Za-z0-9+\/]/);)ze++;var Ft=0;X[ce+ze]===45&&(++ze,Ft=1);for(var Te=[],Ht="",Or=0,Vr=0,Mt=0,zr=0,Qe=0,Rt=0,Ct=0,er=1;er<ze-Ft&&(zr=K.indexOf(String.fromCharCode(X[ce+er++])),Qe=K.indexOf(String.fromCharCode(X[ce+er++])),Or=zr<<2|Qe>>4,Te.push(Or),Rt=K.indexOf(String.fromCharCode(X[ce+er++])),!(Rt===-1||(Vr=(Qe&15)<<4|Rt>>2,Te.push(Vr),Ct=K.indexOf(String.fromCharCode(X[ce+er++])),Ct===-1)));)Mt=(Rt&3)<<6|Ct,Ct<64&&Te.push(Mt);for(Ht=_e(1201,Te),er=0;er<Ht.length;++er)Z[pe++]=Ht.charAt(er)}break;default:throw new Error("Unsupported magic: "+Le+" "+a[Le])}else throw new Error("Unrecognized CP: "+Le);return Z.slice(0,pe).join("")},Ue=function(Le){return!!(r[Le]||a[Le])};return r.utils={decode:Pe,encode:Ee,hascp:Ue,magic:a,cache:z},r})})(R2)),R2.exports}const IR={},DR=Object.freeze(Object.defineProperty({__proto__:null,default:IR},Symbol.toStringTag,{value:"Module"})),$5=_A(DR);var dw;function FR(){return dw||(dw=1,(function(i,t){var r={};function a(n){n.version="0.18.5",n.style_version="1.2.0";var e,p=1200,m=1252;typeof cptable<"u"?e=cptable:typeof F2<"u"&&(e=_R());var y=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],w={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},A=function(s){y.indexOf(s)!=-1&&(m=w[0]=s)},I=function(s){A(p=s)};function R(){I(1200),A(1252)}function k(s){for(var c=[],u=0,d=s.length;u<d;++u)c[u]=s.charCodeAt(u);return c}function M(s){for(var c=[],u=0;u<s.length>>1;++u)c[u]=String.fromCharCode(s.charCodeAt(2*u+1)+(s.charCodeAt(2*u)<<8));return c.join("")}var V=function(s){var c=s.charCodeAt(0),u=s.charCodeAt(1);return c==255&&u==254?(function(d){for(var g=[],x=0;x<d.length>>1;++x)g[x]=String.fromCharCode(d.charCodeAt(2*x)+(d.charCodeAt(2*x+1)<<8));return g.join("")})(s.slice(2)):c==254&&u==255?M(s.slice(2)):c==65279?s.slice(1):s},q=function(s){return String.fromCharCode(s)},U=function(s){return String.fromCharCode(s)};e!==void 0&&(I=function(s){A(p=s)},V=function(s){return s.charCodeAt(0)===255&&s.charCodeAt(1)===254?e.utils.decode(1200,k(s.slice(2))):s},q=function(s){return p===1200?String.fromCharCode(s):e.utils.decode(p,[255&s,s>>8])[0]},U=function(s){return e.utils.decode(m,[s])[0]});var te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function W(s){for(var c,u,d,g,x,b="",S=0,N=0,T=0;T<s.length;)g=(c=s.charCodeAt(T++))>>2,x=(3&c)<<4|(u=s.charCodeAt(T++))>>4,S=(15&u)<<2|(d=s.charCodeAt(T++))>>6,N=63&d,isNaN(u)?S=N=64:isNaN(d)&&(N=64),b+=te.charAt(g)+te.charAt(x)+te.charAt(S)+te.charAt(N);return b}function re(s){var c,u,d,g,x,b,S="";s=s.replace(/[^\w\+\/\=]/g,"");for(var N=0;N<s.length;)c=te.indexOf(s.charAt(N++))<<2|(g=te.indexOf(s.charAt(N++)))>>4,S+=String.fromCharCode(c),u=(15&g)<<4|(x=te.indexOf(s.charAt(N++)))>>2,x!==64&&(S+=String.fromCharCode(u)),d=(3&x)<<6|(b=te.indexOf(s.charAt(N++))),b!==64&&(S+=String.fromCharCode(d));return S}var xe=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,ve=(function(){if(typeof Buffer>"u")return function(){};var s=!Buffer.from;if(!s)try{Buffer.from("foo","utf8")}catch{s=!0}return s?function(c,u){return u?new Buffer(c,u):new Buffer(c)}:Buffer.from.bind(Buffer)})();function De(s){return xe?Buffer.alloc?Buffer.alloc(s):new Buffer(s):new(typeof Uint8Array<"u"?Uint8Array:Array)(s)}function ke(s){return xe?Buffer.allocUnsafe?Buffer.allocUnsafe(s):new Buffer(s):new(typeof Uint8Array<"u"?Uint8Array:Array)(s)}var de=function(s){return xe?ve(s,"binary"):s.split("").map(function(c){return 255&c.charCodeAt(0)})};function Oe(s){if(typeof ArrayBuffer>"u")return de(s);for(var c=new ArrayBuffer(s.length),u=new Uint8Array(c),d=0;d!=s.length;++d)u[d]=255&s.charCodeAt(d);return c}function z(s){if(Array.isArray(s))return s.map(function(d){return String.fromCharCode(d)}).join("");for(var c=[],u=0;u<s.length;++u)c[u]=String.fromCharCode(s[u]);return c.join("")}function K(s){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(s instanceof ArrayBuffer)return K(new Uint8Array(s));for(var c=new Array(s.length),u=0;u<s.length;++u)c[u]=s[u];return c}var Ae=xe?function(s){return Buffer.concat(s.map(function(c){return Buffer.isBuffer(c)?c:ve(c)}))}:function(s){if(typeof Uint8Array>"u")return[].concat.apply([],s.map(function(x){return Array.isArray(x)?x:[].slice.call(x)}));for(var u=0,c=0,u=0;u<s.length;++u)c+=s[u].length;for(var d,g=new Uint8Array(c),c=u=0;u<s.length;c+=d,++u)if(d=s[u].length,s[u]instanceof Uint8Array)g.set(s[u],c);else{if(typeof s[u]=="string")throw"wtf";g.set(new Uint8Array(s[u]),c)}return g},Ce=/\u0000/g,Be=/[\u0001-\u0006]/g;function Ee(s){for(var c="",u=s.length-1;0<=u;)c+=s.charAt(u--);return c}function Pe(s,c){return s=""+s,c<=s.length?s:na("0",c-s.length)+s}function Ue(s,c){return s=""+s,c<=s.length?s:na(" ",c-s.length)+s}function _e(s,c){return s=""+s,c<=s.length?s:s+na(" ",c-s.length)}var Le=Math.pow(2,32);function X(g,c){if(Le<g||g<-Le)return u=g,d=c,u=""+Math.round(u),d<=u.length?u:na("0",d-u.length)+u;var u,d,g=Math.round(g);return(c=c)<=(g=""+(g=g)).length?g:na("0",c-g.length)+g}function H(s,c){return c=c||0,s.length>=7+c&&(32|s.charCodeAt(c))==103&&(32|s.charCodeAt(c+1))==101&&(32|s.charCodeAt(c+2))==110&&(32|s.charCodeAt(c+3))==101&&(32|s.charCodeAt(c+4))==114&&(32|s.charCodeAt(c+5))==97&&(32|s.charCodeAt(c+6))==108}var ae=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Z=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],se={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ye={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ce={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ze(s,c,u){for(var d=s<0?-1:1,g=s*d,x=0,b=1,S=0,N=1,T=0,F=0,O=Math.floor(g);T<c&&(S=(O=Math.floor(g))*b+x,F=O*T+N,!(g-O<5e-8));)g=1/(g-O),x=b,b=S,N=T,T=F;return c<F&&(S=c<T?(F=N,x):(F=T,b)),u?(u=Math.floor(d*S/F),[u,d*S-u*F,F]):[0,d*S,F]}function pe(S,c,u){if(2958465<S||S<0)return null;var d=0|S,g=Math.floor(86400*(S-d)),x=0,b=[],S={D:d,T:g,u:86400*(S-d)-g,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(S.u)<1e-6&&(S.u=0),c&&c.date1904&&(d+=1462),.9999<S.u&&(S.u=0,++g==86400&&(S.T=g=0,++d,++S.D)),d===60?(b=u?[1317,10,29]:[1900,2,29],x=3):d===0?(b=u?[1317,8,29]:[1900,1,0],x=6):(60<d&&--d,(c=new Date(1900,0,1)).setDate(c.getDate()+d-1),b=[c.getFullYear(),c.getMonth()+1,c.getDate()],x=c.getDay(),d<60&&(x=(x+6)%7),u&&(x=(function(N,T){return T[0]-=581,T=N.getDay(),N<60&&(T=(T+6)%7),T})(c,b))),S.y=b[0],S.m=b[1],S.d=b[2],S.S=g%60,g=Math.floor(g/60),S.M=g%60,g=Math.floor(g/60),S.H=g,S.q=x,S}var Ve=new Date(1899,11,31,0,0,0),yt=Ve.getTime(),vt=new Date(1900,2,1,0,0,0);function bt(s,c){var u=s.getTime();return c?u-=1262304e5:vt<=s&&(u+=864e5),(u-(yt+6e4*(s.getTimezoneOffset()-Ve.getTimezoneOffset())))/864e5}function Ft(s){return s.indexOf(".")==-1?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Te(s){var c,u,d,g=Math.floor(Math.log(Math.abs(s))*Math.LOG10E),x=-4<=g&&g<=-1?s.toPrecision(10+g):Math.abs(g)<=9?(u=(c=s)<0?12:11,(d=Ft(c.toFixed(12))).length<=u||(d=c.toPrecision(10)).length<=u?d:c.toExponential(5)):g===10?s.toFixed(10).substr(0,12):(x=Ft((s=s).toFixed(11))).length>(s<0?12:11)||x==="0"||x==="-0"?s.toPrecision(6):x;return Ft((x=x.toUpperCase()).indexOf("E")==-1?x:x.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function Ht(s,c){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(0|s)===s?s.toString(10):Te(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return xr(14,bt(s,c&&c.date1904),c)}throw new Error("unsupported value in General format: "+s)}function Or(s){if(s.length<=3)return s;for(var c=s.length%3,u=s.substr(0,c);c!=s.length;c+=3)u+=(0<u.length?",":"")+s.substr(c,3);return u}var Vr=/%/g,Mt=/# (\?+)( ?)\/( ?)(\d+)/,zr=/^#*0*\.([0#]+)/,Qe=/\).*[0#]/,Rt=/\(###\) ###\\?-####/;function Ct(s){for(var c,u="",d=0;d!=s.length;++d)switch(c=s.charCodeAt(d)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(c)}return u}function er(s,c){return c=Math.pow(10,c),""+Math.round(s*c)/c}function nr(d,c){var u=d-Math.floor(d),d=Math.pow(10,c);return c<(""+Math.round(u*d)).length?0:Math.round(u*d)}function ur(s,c,u){if(s.charCodeAt(0)===40&&!c.match(Qe)){var d=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?ur("n",d,u):"("+ur("n",d,-u)+")"}if(c.charCodeAt(c.length-1)===44)return(function(J,ue,be){for(var we=ue.length-1;ue.charCodeAt(we-1)===44;)--we;return kr(J,ue.substr(0,we),be/Math.pow(10,3*(ue.length-we)))})(s,c,u);if(c.indexOf("%")!==-1)return S=s,T=u,N=(F=c).replace(Vr,""),F=F.length-N.length,kr(S,N,T*Math.pow(10,2*F))+na("%",F);var g;if(c.indexOf("E")!==-1)return(function J(ue,be){var we,$e=ue.indexOf("E")-ue.indexOf(".")-1;if(ue.match(/^#+0.0E\+0$/)){if(be==0)return"0.0E+0";if(be<0)return"-"+J(ue,-be);var et=ue.indexOf(".");et===-1&&(et=ue.indexOf("E"));var Xe=Math.floor(Math.log(be)*Math.LOG10E)%et;if(Xe<0&&(Xe+=et),(we=(be/Math.pow(10,Xe)).toPrecision(1+$e+(et+Xe)%et)).indexOf("e")===-1){var lt=Math.floor(Math.log(be)*Math.LOG10E);for(we.indexOf(".")===-1?we=we.charAt(0)+"."+we.substr(1)+"E+"+(lt-we.length+Xe):we+="E+"+(lt-Xe);we.substr(0,2)==="0.";)we=(we=we.charAt(0)+we.substr(2,et)+"."+we.substr(2+et)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");we=we.replace(/\+-/,"-")}we=we.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(_t,Dt,ft,qt){return Dt+ft+qt.substr(0,(et+Xe)%et)+"."+qt.substr(Xe)+"E"})}else we=be.toExponential($e);return ue.match(/E\+00$/)&&we.match(/e[+-]\d$/)&&(we=we.substr(0,we.length-1)+"0"+we.charAt(we.length-1)),(we=ue.match(/E\-/)&&we.match(/e\+/)?we.replace(/e\+/,"e"):we).replace("e","E")})(c,u);if(c.charCodeAt(0)===36)return"$"+ur(s,c.substr(c.charAt(1)==" "?2:1),u);var x,b,S,N,T,F,O,L=Math.abs(u),B=u<0?"-":"";if(c.match(/^00+$/))return B+X(L,c.length);if(c.match(/^[#?]+$/))return(g=(g=X(u,0))==="0"?"":g).length>c.length?g:Ct(c.substr(0,c.length-g.length))+g;if(x=c.match(Mt))return O=x,S=L,N=B,T=parseInt(O[4],10),F=Math.round(S*T),S=Math.floor(F/T),N+(S===0?"":""+S)+" "+((F-=S*T)==0?na(" ",O[1].length+1+O[4].length):Ue(F,O[1].length)+O[2]+"/"+O[3]+Pe(T,O[4].length));if(c.match(/^#+0+$/))return B+X(L,c.length-c.indexOf("0"));if(x=c.match(zr))return g=er(u,x[1].length).replace(/^([^\.]+)$/,"$1."+Ct(x[1])).replace(/\.$/,"."+Ct(x[1])).replace(/\.(\d*)$/,function(J,ue){return"."+ue+na("0",Ct(x[1]).length-ue.length)}),c.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),x=c.match(/^(0*)\.(#*)$/))return B+er(L,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=c.match(/^#{1,3},##0(\.?)$/))return B+Or(X(L,0));if(x=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+ur(s,c,-u):Or(""+(Math.floor(u)+(O=u,(ee=x[1].length)<(""+Math.round((O-Math.floor(O))*Math.pow(10,ee))).length?1:0)))+"."+Pe(nr(u,x[1].length),x[1].length);if(x=c.match(/^#,#*,#0/))return ur(s,c.replace(/^#,#*,/,""),u);if(x=c.match(/^([0#]+)(\\?-([0#]+))+$/))return g=Ee(ur(s,c.replace(/[\\-]/g,""),u)),b=0,Ee(Ee(c.replace(/\\/g,"")).replace(/[0#]/g,function(J){return b<g.length?g.charAt(b++):J==="0"?"0":""}));if(c.match(Rt))return"("+(g=ur(s,"##########",u)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var ee="";if(x=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(x[4].length,7),G=ze(L,Math.pow(10,b)-1,!1),g=B,(ee=kr("n",x[1],G[1])).charAt(ee.length-1)==" "&&(ee=ee.substr(0,ee.length-1)+"0"),g+=ee+x[2]+"/"+x[3],(ee=_e(G[2],b)).length<x[4].length&&(ee=Ct(x[4].substr(x[4].length-ee.length))+ee),g+=ee;if(x=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(x[1].length,x[4].length),7),B+((G=ze(L,Math.pow(10,b)-1,!0))[0]||(G[1]?"":"0"))+" "+(G[1]?Ue(G[1],b)+x[2]+"/"+x[3]+_e(G[2],b):na(" ",2*b+1+x[2].length+x[3].length));if(x=c.match(/^[#0?]+$/))return g=X(u,0),c.length<=g.length?g:Ct(c.substr(0,c.length-g.length))+g;if(x=c.match(/^([#0?]+)\.([#0]+)$/)){g=""+u.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),b=g.indexOf(".");var G=c.indexOf(".")-b,he=c.length-g.length-G;return Ct(c.substr(0,G)+g+c.substr(c.length-he))}if(x=c.match(/^00,000\.([#0]*0)$/))return b=nr(u,x[1].length),u<0?"-"+ur(s,c,-u):Or((he=u)<2147483647&&-2147483648<he?""+(0<=he?0|he:he-1|0):""+Math.floor(he)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(J){return"00,"+(J.length<3?Pe(0,3-J.length):"")+J})+"."+Pe(b,x[1].length);switch(c){case"###,##0.00":return ur(s,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var ne=Or(X(L,0));return ne!=="0"?B+ne:"";case"###,###.00":return ur(s,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return ur(s,"#,##0.00",u).replace(/^0\./,".")}throw new Error("unsupported format |"+c+"|")}function Sr(s,c,u){if(s.charCodeAt(0)===40&&!c.match(Qe)){var d=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?Sr("n",d,u):"("+Sr("n",d,-u)+")"}if(c.charCodeAt(c.length-1)===44)return(function(G,he,ne){for(var J=he.length-1;he.charCodeAt(J-1)===44;)--J;return kr(G,he.substr(0,J),ne/Math.pow(10,3*(he.length-J)))})(s,c,u);if(c.indexOf("%")!==-1)return g=s,b=u,d=(x=c).replace(Vr,""),x=x.length-d.length,kr(g,d,b*Math.pow(10,2*x))+na("%",x);var g,x,b,S;if(c.indexOf("E")!==-1)return(function G(he,ne){var J,ue=he.indexOf("E")-he.indexOf(".")-1;if(he.match(/^#+0.0E\+0$/)){if(ne==0)return"0.0E+0";if(ne<0)return"-"+G(he,-ne);var be=he.indexOf(".");be===-1&&(be=he.indexOf("E"));var we,$e=Math.floor(Math.log(ne)*Math.LOG10E)%be;$e<0&&($e+=be),(J=(ne/Math.pow(10,$e)).toPrecision(1+ue+(be+$e)%be)).match(/[Ee]/)||(we=Math.floor(Math.log(ne)*Math.LOG10E),J.indexOf(".")===-1?J=J.charAt(0)+"."+J.substr(1)+"E+"+(we-J.length+$e):J+="E+"+(we-$e),J=J.replace(/\+-/,"-")),J=J.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(et,Xe,lt,_t){return Xe+lt+_t.substr(0,(be+$e)%be)+"."+_t.substr($e)+"E"})}else J=ne.toExponential(ue);return he.match(/E\+00$/)&&J.match(/e[+-]\d$/)&&(J=J.substr(0,J.length-1)+"0"+J.charAt(J.length-1)),(J=he.match(/E\-/)&&J.match(/e\+/)?J.replace(/e\+/,"e"):J).replace("e","E")})(c,u);if(c.charCodeAt(0)===36)return"$"+Sr(s,c.substr(c.charAt(1)==" "?2:1),u);var N,T,F=Math.abs(u),O=u<0?"-":"";if(c.match(/^00+$/))return O+Pe(F,c.length);if(c.match(/^[#?]+$/))return(S=u===0?"":""+u).length>c.length?S:Ct(c.substr(0,c.length-S.length))+S;if(N=c.match(Mt))return O+((L=F)===0?"":""+L)+na(" ",(L=N)[1].length+2+L[4].length);if(c.match(/^#+0+$/))return O+Pe(F,c.length-c.indexOf("0"));if(N=c.match(zr))return S=(S=(""+u).replace(/^([^\.]+)$/,"$1."+Ct(N[1])).replace(/\.$/,"."+Ct(N[1]))).replace(/\.(\d*)$/,function(G,he){return"."+he+na("0",Ct(N[1]).length-he.length)}),c.indexOf("0.")!==-1?S:S.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),N=c.match(/^(0*)\.(#*)$/))return O+(""+F).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,N[1].length?"0.":".");if(N=c.match(/^#{1,3},##0(\.?)$/))return O+Or(""+F);if(N=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+Sr(s,c,-u):Or(""+u)+"."+na("0",N[1].length);if(N=c.match(/^#,#*,#0/))return Sr(s,c.replace(/^#,#*,/,""),u);if(N=c.match(/^([0#]+)(\\?-([0#]+))+$/))return S=Ee(Sr(s,c.replace(/[\\-]/g,""),u)),T=0,Ee(Ee(c.replace(/\\/g,"")).replace(/[0#]/g,function(G){return T<S.length?S.charAt(T++):G==="0"?"0":""}));if(c.match(Rt))return"("+(S=Sr(s,"##########",u)).substr(0,3)+") "+S.substr(3,3)+"-"+S.substr(6);var L="";if(N=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(N[4].length,7),B=ze(F,Math.pow(10,T)-1,!1),S=O,(L=kr("n",N[1],B[1])).charAt(L.length-1)==" "&&(L=L.substr(0,L.length-1)+"0"),S+=L+N[2]+"/"+N[3],(L=_e(B[2],T)).length<N[4].length&&(L=Ct(N[4].substr(N[4].length-L.length))+L),S+=L;if(N=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(Math.max(N[1].length,N[4].length),7),O+((B=ze(F,Math.pow(10,T)-1,!0))[0]||(B[1]?"":"0"))+" "+(B[1]?Ue(B[1],T)+N[2]+"/"+N[3]+_e(B[2],T):na(" ",2*T+1+N[2].length+N[3].length));if(N=c.match(/^[#0?]+$/))return S=""+u,c.length<=S.length?S:Ct(c.substr(0,c.length-S.length))+S;if(N=c.match(/^([#0]+)\.([#0]+)$/)){S=""+u.toFixed(Math.min(N[2].length,10)).replace(/([^0])0+$/,"$1"),T=S.indexOf(".");var L=c.indexOf(".")-T,B=c.length-S.length-L;return Ct(c.substr(0,L)+S+c.substr(c.length-B))}if(N=c.match(/^00,000\.([#0]*0)$/))return u<0?"-"+Sr(s,c,-u):Or(""+u).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(G){return"00,"+(G.length<3?Pe(0,3-G.length):"")+G})+"."+Pe(0,N[1].length);switch(c){case"###,###":case"##,###":case"#,###":var ee=Or(""+F);return ee!=="0"?O+ee:"";default:if(c.match(/\.[0#?]*$/))return Sr(s,c.slice(0,c.lastIndexOf(".")),u)+Ct(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}function kr(s,c,u){return((0|u)===u?Sr:ur)(s,c,u)}var ar=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _r(s){for(var c=0,u="",d="";c<s.length;)switch(u=s.charAt(c)){case"G":H(s,c)&&(c+=6),c++;break;case'"':for(;s.charCodeAt(++c)!==34&&c<s.length;);++c;break;case"\\":case"_":c+=2;break;case"@":++c;break;case"B":case"b":if(s.charAt(c+1)==="1"||s.charAt(c+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(s.substr(c,3).toUpperCase()==="A/P"||s.substr(c,5).toUpperCase()==="AM/PM"||s.substr(c,5).toUpperCase()==="/")return!0;++c;break;case"[":for(d=u;s.charAt(c++)!=="]"&&c<s.length;)d+=s.charAt(c);if(d.match(ar))return!0;break;case".":case"0":case"#":for(;c<s.length&&(-1<"0#?.,E+-%".indexOf(u=s.charAt(++c))||u=="\\"&&s.charAt(c+1)=="-"&&-1<"0#".indexOf(s.charAt(c+2))););break;case"?":for(;s.charAt(++c)===u;);break;case"*":++c,s.charAt(c)!=" "&&s.charAt(c)!="*"||++c;break;case"(":case")":++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;c<s.length&&-1<"0123456789".indexOf(s.charAt(++c)););break;default:++c}return!1}function Ar(s,c,u,d){for(var g,x,b,S=[],N="",T=0,F="",O="t",L="H";T<s.length;)switch(F=s.charAt(T)){case"G":if(!H(s,T))throw new Error("unrecognized character "+F+" in "+s);S[S.length]={t:"G",v:"General"},T+=7;break;case'"':for(N="";(b=s.charCodeAt(++T))!==34&&T<s.length;)N+=String.fromCharCode(b);S[S.length]={t:"t",v:N},++T;break;case"\\":var B=s.charAt(++T),ee=B==="("||B===")"?B:"t";S[S.length]={t:ee,v:B},++T;break;case"_":S[S.length]={t:"t",v:" "},T+=2;break;case"@":S[S.length]={t:"T",v:c},++T;break;case"B":case"b":if(s.charAt(T+1)==="1"||s.charAt(T+1)==="2"){if(g==null&&(g=pe(c,u,s.charAt(T+1)==="2"))==null)return"";S[S.length]={t:"X",v:s.substr(T,2)},O=F,T+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":F=F.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(c<0||g==null&&(g=pe(c,u))==null)return"";for(N=F;++T<s.length&&s.charAt(T).toLowerCase()===F;)N+=F;(F=F==="m"&&O.toLowerCase()==="h"?"M":F)==="h"&&(F=L),S[S.length]={t:F,v:N},O=F;break;case"A":case"a":case"":if(B={t:F,v:F},g==null&&(g=pe(c,u)),s.substr(T,3).toUpperCase()==="A/P"?(g!=null&&(B.v=12<=g.H?"P":"A"),B.t="T",L="h",T+=3):s.substr(T,5).toUpperCase()==="AM/PM"?(g!=null&&(B.v=12<=g.H?"PM":"AM"),B.t="T",T+=5,L="h"):s.substr(T,5).toUpperCase()==="/"?(g!=null&&(B.v=12<=g.H?"":""),B.t="T",T+=5,L="h"):(B.t="t",++T),g==null&&B.t==="T")return"";S[S.length]=B,O=F;break;case"[":for(N=F;s.charAt(T++)!=="]"&&T<s.length;)N+=s.charAt(T);if(N.slice(-1)!=="]")throw'unterminated "[" block: |'+N+"|";if(N.match(ar)){if(g==null&&(g=pe(c,u))==null)return"";S[S.length]={t:"Z",v:N.toLowerCase()},O=N.charAt(1)}else-1<N.indexOf("$")&&(N=(N.match(/\$([^-\[\]]*)/)||[])[1]||"$",_r(s)||(S[S.length]={t:"t",v:N}));break;case".":if(g!=null){for(N=F;++T<s.length&&(F=s.charAt(T))==="0";)N+=F;S[S.length]={t:"s",v:N};break}case"0":case"#":for(N=F;++T<s.length&&-1<"0#?.,E+-%".indexOf(F=s.charAt(T));)N+=F;S[S.length]={t:"n",v:N};break;case"?":for(N=F;s.charAt(++T)===F;)N+=F;S[S.length]={t:F,v:N},O=F;break;case"*":++T,s.charAt(T)!=" "&&s.charAt(T)!="*"||++T;break;case"(":case")":S[S.length]={t:d===1?"t":F,v:F},++T;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(N=F;T<s.length&&-1<"0123456789".indexOf(s.charAt(++T));)N+=s.charAt(T);S[S.length]={t:"D",v:N};break;case" ":S[S.length]={t:F,v:F},++T;break;case"$":S[S.length]={t:"t",v:"$"},++T;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(F)===-1)throw new Error("unrecognized character "+F+" in "+s);S[S.length]={t:"t",v:F},++T}var G,he=0,ne=0;for(T=S.length-1,O="t";0<=T;--T)switch(S[T].t){case"h":case"H":S[T].t=L,O="h",he<1&&(he=1);break;case"s":(G=S[T].v.match(/\.0+$/))&&(ne=Math.max(ne,G[0].length-1)),he<3&&(he=3);case"d":case"y":case"M":case"e":O=S[T].t;break;case"m":O==="s"&&(S[T].t="M",he<2&&(he=2));break;case"X":break;case"Z":(he=(he=he<1&&S[T].v.match(/[Hh]/)?1:he)<2&&S[T].v.match(/[Mm]/)?2:he)<3&&S[T].v.match(/[Ss]/)&&(he=3)}switch(he){case 0:break;case 1:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M),60<=g.M&&(g.M=0,++g.H);break;case 2:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M)}var J,ue="";for(T=0;T<S.length;++T)switch(S[T].t){case"t":case"T":case" ":case"D":break;case"X":S[T].v="",S[T].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":S[T].v=(function(_t,Dt,ft,qt){var hr,lr="",Zt=0,tr=0,Kt=ft.y,Bt=0;switch(_t){case 98:Kt=ft.y+543;case 121:switch(Dt.length){case 1:case 2:hr=Kt%100,Bt=2;break;default:hr=Kt%1e4,Bt=4}break;case 109:switch(Dt.length){case 1:case 2:hr=ft.m,Bt=Dt.length;break;case 3:return Z[ft.m-1][1];case 5:return Z[ft.m-1][0];default:return Z[ft.m-1][2]}break;case 100:switch(Dt.length){case 1:case 2:hr=ft.d,Bt=Dt.length;break;case 3:return ae[ft.q][0];default:return ae[ft.q][1]}break;case 104:switch(Dt.length){case 1:case 2:hr=1+(ft.H+11)%12,Bt=Dt.length;break;default:throw"bad hour format: "+Dt}break;case 72:switch(Dt.length){case 1:case 2:hr=ft.H,Bt=Dt.length;break;default:throw"bad hour format: "+Dt}break;case 77:switch(Dt.length){case 1:case 2:hr=ft.M,Bt=Dt.length;break;default:throw"bad minute format: "+Dt}break;case 115:if(Dt!="s"&&Dt!="ss"&&Dt!=".0"&&Dt!=".00"&&Dt!=".000")throw"bad second format: "+Dt;return ft.u!==0||Dt!="s"&&Dt!="ss"?(60*(tr=2<=qt?qt===3?1e3:100:qt===1?10:1)<=(Zt=Math.round(tr*(ft.S+ft.u)))&&(Zt=0),Dt==="s"?Zt===0?"0":""+Zt/tr:(lr=Pe(Zt,2+qt),Dt==="ss"?lr.substr(0,2):"."+lr.substr(2,Dt.length-1))):Pe(ft.S,Dt.length);case 90:switch(Dt){case"[h]":case"[hh]":hr=24*ft.D+ft.H;break;case"[m]":case"[mm]":hr=60*(24*ft.D+ft.H)+ft.M;break;case"[s]":case"[ss]":hr=60*(60*(24*ft.D+ft.H)+ft.M)+Math.round(ft.S+ft.u);break;default:throw"bad abstime format: "+Dt}Bt=Dt.length===3?1:2;break;case 101:hr=Kt,Bt=1}return 0<Bt?Pe(hr,Bt):""})(S[T].t.charCodeAt(0),S[T].v,g,ne),S[T].t="t";break;case"n":case"?":for(J=T+1;S[J]!=null&&((F=S[J].t)==="?"||F==="D"||(F===" "||F==="t")&&S[J+1]!=null&&(S[J+1].t==="?"||S[J+1].t==="t"&&S[J+1].v==="/")||S[T].t==="("&&(F===" "||F==="n"||F===")")||F==="t"&&(S[J].v==="/"||S[J].v===" "&&S[J+1]!=null&&S[J+1].t=="?"));)S[T].v+=S[J].v,S[J]={v:"",t:";"},++J;ue+=S[T].v,T=J-1;break;case"G":S[T].t="t",S[T].v=Ht(c,u)}var be,we,$e="";if(0<ue.length){ue.charCodeAt(0)==40?(be=c<0&&ue.charCodeAt(0)===45?-c:c,we=kr("n",ue,be)):(we=kr("n",ue,be=c<0&&1<d?-c:c),be<0&&S[0]&&S[0].t=="t"&&(we=we.substr(1),S[0].v="-"+S[0].v)),J=we.length-1;for(var et=S.length,T=0;T<S.length;++T)if(S[T]!=null&&S[T].t!="t"&&-1<S[T].v.indexOf(".")){et=T;break}var Xe=S.length;if(et===S.length&&we.indexOf("E")===-1){for(T=S.length-1;0<=T;--T)S[T]!=null&&"n?".indexOf(S[T].t)!==-1&&(J>=S[T].v.length-1?(J-=S[T].v.length,S[T].v=we.substr(J+1,S[T].v.length)):J<0?S[T].v="":(S[T].v=we.substr(0,J+1),J=-1),S[T].t="t",Xe=T);0<=J&&Xe<S.length&&(S[Xe].v=we.substr(0,J+1)+S[Xe].v)}else if(et!==S.length&&we.indexOf("E")===-1){for(J=we.indexOf(".")-1,T=et;0<=T;--T)if(S[T]!=null&&"n?".indexOf(S[T].t)!==-1){for(x=-1<S[T].v.indexOf(".")&&T===et?S[T].v.indexOf(".")-1:S[T].v.length-1,$e=S[T].v.substr(x+1);0<=x;--x)0<=J&&(S[T].v.charAt(x)==="0"||S[T].v.charAt(x)==="#")&&($e=we.charAt(J--)+$e);S[T].v=$e,S[T].t="t",Xe=T}for(0<=J&&Xe<S.length&&(S[Xe].v=we.substr(0,J+1)+S[Xe].v),J=we.indexOf(".")+1,T=et;T<S.length;++T)if(S[T]!=null&&("n?(".indexOf(S[T].t)!==-1||T===et)){for(x=-1<S[T].v.indexOf(".")&&T===et?S[T].v.indexOf(".")+1:0,$e=S[T].v.substr(0,x);x<S[T].v.length;++x)J<we.length&&($e+=we.charAt(J++));S[T].v=$e,S[T].t="t",Xe=T}}}for(T=0;T<S.length;++T)S[T]!=null&&-1<"n?".indexOf(S[T].t)&&(be=1<d&&c<0&&0<T&&S[T-1].v==="-"?-c:c,S[T].v=kr(S[T].t,S[T].v,be),S[T].t="t");var lt="";for(T=0;T!==S.length;++T)S[T]!=null&&(lt+=S[T].v);return lt}var ra=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nn(s,c){if(c!=null){var u=parseFloat(c[2]);switch(c[1]){case"=":if(s==u)return 1;break;case">":if(u<s)return 1;break;case"<":if(s<u)return 1;break;case"<>":if(s!=u)return 1;break;case">=":if(u<=s)return 1;break;case"<=":if(s<=u)return 1}}}function Qr(s,c){var u=(function(b){for(var S=[],N=!1,T=0,F=0;T<b.length;++T)switch(b.charCodeAt(T)){case 34:N=!N;break;case 95:case 42:case 92:++T;break;case 59:S[S.length]=b.substr(F,T-F),F=T+1}if(S[S.length]=b.substr(F),N===!0)throw new Error("Format |"+b+"| unterminated string ");return S})(s),d=u.length,g=u[d-1].indexOf("@");if(d<4&&-1<g&&--d,4<u.length)throw new Error("cannot find right format for |"+u.join("|")+"|");if(typeof c!="number")return[4,u.length===4||-1<g?u[u.length-1]:"@"];switch(u.length){case 1:u=-1<g?["General","General","General",u[0]]:[u[0],u[0],u[0],"@"];break;case 2:u=-1<g?[u[0],u[0],u[0],u[1]]:[u[0],u[1],u[0],"@"];break;case 3:u=-1<g?[u[0],u[1],u[0],u[2]]:[u[0],u[1],u[2],"@"]}var x=0<c?u[0]:c<0?u[1]:u[2];return u[0].indexOf("[")===-1&&u[1].indexOf("[")===-1?[d,x]:u[0].match(/\[[=<>]/)==null&&u[1].match(/\[[=<>]/)==null?[d,x]:(s=u[0].match(ra),x=u[1].match(ra),Nn(c,s)?[d,u[0]]:Nn(c,x)?[d,u[1]]:[d,u[s!=null&&x!=null?2:1]])}function xr(s,c,u){u==null&&(u={});var d="";switch(typeof s){case"string":d=s=="m/d/yy"&&u.dateNF?u.dateNF:s;break;case"number":(d=(d=s==14&&u.dateNF?u.dateNF:(u.table!=null?u.table:se)[s])==null?u.table&&u.table[ye[s]]||se[ye[s]]:d)==null&&(d=ce[s]||"General")}if(H(d,0))return Ht(c,u);var g=Qr(d,c=c instanceof Date?bt(c,u.date1904):c);if(H(g[1]))return Ht(c,u);if(c===!0)c="TRUE";else if(c===!1)c="FALSE";else if(c===""||c==null)return"";return Ar(g[1],c,u,g[0])}function an(s,c){if(typeof c!="number"){c=+c||-1;for(var u=0;u<392;++u)if(se[u]!=null){if(se[u]==s){c=u;break}}else c<0&&(c=u);c<0&&(c=391)}return se[c]=s,c}function Lr(s){for(var c=0;c!=392;++c)s[c]!==void 0&&an(s[c],c)}function Jn(){var s;(s=s||{})[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"/ "hh""mm""ss" "',se=s}var on={format:xr,load:an,_table:se,load_table:Lr,parse_date_code:pe,is_date:_r,get_table:function(){return on._table=se}},gn={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},xa=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,fn,Wr=(function(){var s={};s.version="1.2.0";var c=(function(){for(var J=0,ue=new Array(256),be=0;be!=256;++be)J=1&(J=1&(J=1&(J=1&(J=1&(J=1&(J=1&(J=1&(J=be)?-306674912^J>>>1:J>>>1)?-306674912^J>>>1:J>>>1)?-306674912^J>>>1:J>>>1)?-306674912^J>>>1:J>>>1)?-306674912^J>>>1:J>>>1)?-306674912^J>>>1:J>>>1)?-306674912^J>>>1:J>>>1)?-306674912^J>>>1:J>>>1,ue[be]=J;return typeof Int32Array<"u"?new Int32Array(ue):ue})(),u=(function(J){for(var ue=0,be=0,$e=0,we=new(typeof Int32Array<"u"?Int32Array:Array)(4096),$e=0;$e!=256;++$e)we[$e]=J[$e];for($e=0;$e!=256;++$e)for(be=J[$e],ue=256+$e;ue<4096;ue+=256)be=we[ue]=be>>>8^J[255&be];var et=[];for($e=1;$e!=16;++$e)et[$e-1]=typeof Int32Array<"u"?we.subarray(256*$e,256*$e+256):we.slice(256*$e,256*$e+256);return et})(c),d=u[0],g=u[1],x=u[2],b=u[3],S=u[4],N=u[5],T=u[6],F=u[7],O=u[8],L=u[9],B=u[10],ee=u[11],G=u[12],he=u[13],ne=u[14];return s.table=c,s.bstr=function(J,ue){for(var be=-1^ue,we=0,$e=J.length;we<$e;)be=be>>>8^c[255&(be^J.charCodeAt(we++))];return~be},s.buf=function(J,ue){for(var be=-1^ue,we=J.length-15,$e=0;$e<we;)be=ne[J[$e++]^255&be]^he[J[$e++]^be>>8&255]^G[J[$e++]^be>>16&255]^ee[J[$e++]^be>>>24]^B[J[$e++]]^L[J[$e++]]^O[J[$e++]]^F[J[$e++]]^T[J[$e++]]^N[J[$e++]]^S[J[$e++]]^b[J[$e++]]^x[J[$e++]]^g[J[$e++]]^d[J[$e++]]^c[J[$e++]];for(we+=15;$e<we;)be=be>>>8^c[255&(be^J[$e++])];return~be},s.str=function(J,ue){for(var be,we=-1^ue,$e=0,et=J.length,Xe=0;$e<et;)we=(Xe=J.charCodeAt($e++))<128?we>>>8^c[255&(we^Xe)]:Xe<2048?(we=we>>>8^c[255&(we^(192|Xe>>6&31))])>>>8^c[255&(we^(128|63&Xe))]:55296<=Xe&&Xe<57344?(Xe=64+(1023&Xe),be=1023&J.charCodeAt($e++),(we=(we=(we=we>>>8^c[255&(we^(240|Xe>>8&7))])>>>8^c[255&(we^(128|Xe>>2&63))])>>>8^c[255&(we^(128|be>>6&15|(3&Xe)<<4))])>>>8^c[255&(we^(128|63&be))]):(we=(we=we>>>8^c[255&(we^(224|Xe>>12&15))])>>>8^c[255&(we^(128|Xe>>6&63))])>>>8^c[255&(we^(128|63&Xe))];return~we},s})(),Jt=(function(){var s,c={};function u(Ie){if(Ie.charAt(Ie.length-1)=="/")return Ie.slice(0,-1).indexOf("/")===-1?Ie:u(Ie.slice(0,-1));var pt=Ie.lastIndexOf("/");return pt===-1?Ie:Ie.slice(0,pt+1)}function d(Ie){if(Ie.charAt(Ie.length-1)=="/")return d(Ie.slice(0,-1));var pt=Ie.lastIndexOf("/");return pt===-1?Ie:Ie.slice(pt+1)}function g(Ie){Ra(Ie,0);for(var pt,qe={};Ie.l<=Ie.length-4;){var dt=Ie.read_shift(2),He=Ie.read_shift(2),zt=Ie.l+He,ct={};dt===21589&&(1&(pt=Ie.read_shift(1))&&(ct.mtime=Ie.read_shift(4)),5<He&&(2&pt&&(ct.atime=Ie.read_shift(4)),4&pt&&(ct.ctime=Ie.read_shift(4))),ct.mtime&&(ct.mt=new Date(1e3*ct.mtime))),Ie.l=zt,qe[dt]=ct}return qe}function x(){return s=s||$5}function b(Ie,pt){if(Ie[0]==80&&Ie[1]==75)return la(Ie,pt);if((32|Ie[0])==109&&(32|Ie[1])==105)return(function(Wt,Ur){if(J(Wt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var fr=Ur&&Ur.root||"",Yt=(xe&&Buffer.isBuffer(Wt)?Wt.toString("binary"):J(Wt)).split(`\r
`),Xr=0,Br="";for(Xr=0;Xr<Yt.length;++Xr)if(Br=Yt[Xr],/^Content-Location:/i.test(Br)&&(Br=Br.slice(Br.indexOf("file")),fr=fr||Br.slice(0,Br.lastIndexOf("/")+1),Br.slice(0,fr.length)!=fr))for(;0<fr.length&&(fr=(fr=fr.slice(0,fr.length-1)).slice(0,fr.lastIndexOf("/")+1),Br.slice(0,fr.length)!=fr););if(Wt=(Yt[1]||"").match(/boundary="(.*?)"/),!Wt)throw new Error("MAD cannot find boundary");var Wa="--"+(Wt[1]||""),un={FileIndex:[],FullPaths:[]};N(un);var Tn,Dr=0;for(Xr=0;Xr<Yt.length;++Xr){var Kn=Yt[Xr];Kn!==Wa&&Kn!==Wa+"--"||(Dr++&&(function(Bn,o,l){for(var f,v="",E="",D="",Q=0;Q<10;++Q){var me=o[Q];if(!me||me.match(/^\s*$/))break;var Me=me.match(/^(.*?):\s*([^\s].*)$/);if(Me)switch(Me[1].toLowerCase()){case"content-location":v=Me[2].trim();break;case"content-type":D=Me[2].trim();break;case"content-transfer-encoding":E=Me[2].trim()}}switch(++Q,E.toLowerCase()){case"base64":f=de(re(o.slice(Q).join("")));break;case"quoted-printable":f=(function(at){for(var St=[],Tt=0;Tt<at.length;++Tt){for(var ut=at[Tt];Tt<=at.length&&ut.charAt(ut.length-1)=="=";)ut=ut.slice(0,ut.length-1)+at[++Tt];St.push(ut)}for(var mt=0;mt<St.length;++mt)St[mt]=St[mt].replace(/[=][0-9A-Fa-f]{2}/g,function(Fr){return String.fromCharCode(parseInt(Fr.slice(1),16))});return de(St.join(`\r
`))})(o.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+E)}l=ac(Bn,v.slice(l.length),f,{unsafe:!0}),D&&(l.ctype=D)})(un,Yt.slice(Tn,Xr),fr),Tn=Xr)}return un})(Ie,pt);if(Ie.length<512)throw new Error("CFB file size "+Ie.length+" < 512");var qe,dt,He,zt=3,ct=512,rr=0,gt=[],it=Ie.slice(0,512);Ra(it,0);var Nt=(function(Wt){if(Wt[Wt.l]==80&&Wt[Wt.l+1]==75)return[0,0];Wt.chk(ee,"Header Signature: "),Wt.l+=16;var Ur=Wt.read_shift(2,"u");return[Wt.read_shift(2,"u"),Ur]})(it);switch(zt=Nt[0]){case 3:ct=512;break;case 4:ct=4096;break;case 0:if(Nt[1]==0)return la(Ie,pt);default:throw new Error("Major Version: Expected 3 or 4 saw "+zt)}ct!==512&&Ra(it=Ie.slice(0,ct),28);var Vt=Ie.slice(0,ct);(function(Wt,Ur){var fr=9;switch(Wt.l+=2,fr=Wt.read_shift(2)){case 9:if(Ur!=3)throw new Error("Sector Shift: Expected 9 saw "+fr);break;case 12:if(Ur!=4)throw new Error("Sector Shift: Expected 12 saw "+fr);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+fr)}Wt.chk("0600","Mini Sector Shift: "),Wt.chk("000000000000","Reserved: ")})(it,zt);var Pr=it.read_shift(4,"i");if(zt===3&&Pr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pr);it.l+=4,dt=it.read_shift(4,"i"),it.l+=4,it.chk("00100000","Mini Stream Cutoff Size: "),He=it.read_shift(4,"i"),qe=it.read_shift(4,"i"),Rr=it.read_shift(4,"i"),rr=it.read_shift(4,"i");for(var vr,gr=0;gr<109&&!((vr=it.read_shift(4,"i"))<0);++gr)gt[gr]=vr;var or=(function(Wt,Ur){for(var fr=Math.ceil(Wt.length/Ur)-1,Yt=[],Xr=1;Xr<fr;++Xr)Yt[Xr-1]=Wt.slice(Xr*Ur,(Xr+1)*Ur);return Yt[fr-1]=Wt.slice(fr*Ur),Yt})(Ie,ct);(function Wt(Ur,fr,Yt,Xr,Br){var Wa=B;if(Ur===B){if(fr!==0)throw new Error("DIFAT chain shorter than expected")}else if(Ur!==-1){var un=Yt[Ur],Tn=(Xr>>>2)-1;if(un){for(var Dr=0;Dr<Tn&&(Wa=On(un,4*Dr))!==B;++Dr)Br.push(Wa);Wt(On(un,Xr-4),fr-1,Yt,Xr,Br)}}})(Rr,rr,or,ct,gt);var br=(function(Wt,Ur,fr,Yt){var Xr=Wt.length,Br=[],Wa=[],un=[],Tn=[],Dr=Yt-1,Kn=0,Bn=0,o=0,l=0;for(Kn=0;Kn<Xr;++Kn)if(un=[],Xr<=(o=Kn+Ur)&&(o-=Xr),!Wa[o]){Tn=[];var f=[];for(Bn=o;0<=Bn;){f[Bn]=!0,Wa[Bn]=!0,un[un.length]=Bn,Tn.push(Wt[Bn]);var v=fr[Math.floor(4*Bn/Yt)];if(Yt<4+(l=4*Bn&Dr))throw new Error("FAT boundary crossed: "+Bn+" 4 "+Yt);if(!Wt[v]||(Bn=On(Wt[v],l),f[Bn]))break}Br[o]={nodes:un,data:Ll([Tn])}}return Br})(or,dt,gt,ct);br[dt].name="!Directory",0<qe&&He!==B&&(br[He].name="!MiniFAT"),br[gt[0]].name="!FAT",br.fat_addrs=gt,br.ssz=ct;var Pr=[],Rr=[],rr=[];return(function(Wt,Ur,fr,Yt,Xr,Br,Wa){for(var un,Tn=0,Dr=fr.length?2:0,Kn=Wt[dt].data,Bn=0,o=0;Bn<Kn.length;Bn+=128){var l=Kn.slice(Bn,Bn+128);Ra(l,64),o=l.read_shift(2),un=yu(l,0,o-Dr),fr.push(un);var f={name:un,type:l.read_shift(1),color:l.read_shift(1),L:l.read_shift(4,"i"),R:l.read_shift(4,"i"),C:l.read_shift(4,"i"),clsid:l.read_shift(16),state:l.read_shift(4,"i"),start:0,size:0};l.read_shift(2)+l.read_shift(2)+l.read_shift(2)+l.read_shift(2)!==0&&(f.ct=S(l,l.l-8)),l.read_shift(2)+l.read_shift(2)+l.read_shift(2)+l.read_shift(2)!==0&&(f.mt=S(l,l.l-8)),f.start=l.read_shift(4,"i"),f.size=l.read_shift(4,"i"),f.size<0&&f.start<0&&(f.size=f.type=0,f.start=B,f.name=""),f.type===5?(Tn=f.start,0<Yt&&Tn!==B&&(Wt[Tn].name="!StreamData")):4096<=f.size?(f.storage="fat",Wt[f.start]===void 0&&(Wt[f.start]=(function(v,E,D,Q,me){var Me=[],at=[];me=me||[];var St=Q-1,Tt=0,ut=0;for(Tt=E;0<=Tt;){me[Tt]=!0,Me[Me.length]=Tt,at.push(v[Tt]);var mt=D[Math.floor(4*Tt/Q)];if(Q<4+(ut=4*Tt&St))throw new Error("FAT boundary crossed: "+Tt+" 4 "+Q);if(!v[mt])break;Tt=On(v[mt],ut)}return{nodes:Me,data:Ll([at])}})(Ur,f.start,Wt.fat_addrs,Wt.ssz)),Wt[f.start].name=f.name,f.content=Wt[f.start].data.slice(0,f.size)):(f.storage="minifat",f.size<0?f.size=0:Tn!==B&&f.start!==B&&Wt[Tn]&&(f.content=(function(v,E,D){for(var Q=v.start,me=v.size,Me=[],at=Q;D&&0<me&&0<=at;)Me.push(E.slice(at*L,at*L+L)),me-=L,at=On(D,4*at);return Me.length===0?xt(0):Ae(Me).slice(0,v.size)})(f,Wt[Tn].data,(Wt[Wa]||{}).data))),f.content&&Ra(f.content,0),Xr[un]=f,Br.push(f)}})(br,or,Pr,qe,{},Rr,He),(function(Wt,Ur,fr){for(var Yt=0,Xr=0,Br=0,Wa=0,un=0,Tn=fr.length,Dr=[],Kn=[];Yt<Tn;++Yt)Dr[Yt]=Kn[Yt]=Yt,Ur[Yt]=fr[Yt];for(;un<Kn.length;++un)Yt=Kn[un],Xr=Wt[Yt].L,Br=Wt[Yt].R,Wa=Wt[Yt].C,Dr[Yt]===Yt&&(Xr!==-1&&Dr[Xr]!==Xr&&(Dr[Yt]=Dr[Xr]),Br!==-1&&Dr[Br]!==Br&&(Dr[Yt]=Dr[Br])),Wa!==-1&&(Dr[Wa]=Yt),Xr!==-1&&Yt!=Dr[Yt]&&(Dr[Xr]=Dr[Yt],Kn.lastIndexOf(Xr)<un&&Kn.push(Xr)),Br!==-1&&Yt!=Dr[Yt]&&(Dr[Br]=Dr[Yt],Kn.lastIndexOf(Br)<un&&Kn.push(Br));for(Yt=1;Yt<Tn;++Yt)Dr[Yt]===Yt&&(Br!==-1&&Dr[Br]!==Br?Dr[Yt]=Dr[Br]:Xr!==-1&&Dr[Xr]!==Xr&&(Dr[Yt]=Dr[Xr]));for(Yt=1;Yt<Tn;++Yt)if(Wt[Yt].type!==0){if((un=Yt)!=Dr[un])for(;un=Dr[un],Ur[Yt]=Ur[un]+"/"+Ur[Yt],un!==0&&Dr[un]!==-1&&un!=Dr[un];);Dr[Yt]=-1}for(Ur[0]+="/",Yt=1;Yt<Tn;++Yt)Wt[Yt].type!==2&&(Ur[Yt]+="/")})(Rr,rr,Pr),Pr.shift(),rr={FileIndex:Rr,FullPaths:rr},pt&&pt.raw&&(rr.raw={header:Vt,sectors:or}),rr}function S(Ie,pt){return new Date(1e3*($r(Ie,pt+4)/1e7*Math.pow(2,32)+$r(Ie,pt)/1e7-11644473600))}function N(Ie,dt){var qe=dt||{},dt=qe.root||"Root Entry";if(Ie.FullPaths||(Ie.FullPaths=[]),Ie.FileIndex||(Ie.FileIndex=[]),Ie.FullPaths.length!==Ie.FileIndex.length)throw new Error("inconsistent CFB structure");Ie.FullPaths.length===0&&(Ie.FullPaths[0]=dt+"/",Ie.FileIndex[0]={name:dt,type:5}),qe.CLSID&&(Ie.FileIndex[0].clsid=qe.CLSID),dt=Ie,qe="Sh33tJ5",Jt.find(dt,"/"+qe)||((Ie=xt(4))[0]=55,Ie[1]=Ie[3]=50,Ie[2]=54,dt.FileIndex.push({name:qe,type:2,content:Ie,size:4,L:69,R:69,C:69}),dt.FullPaths.push(dt.FullPaths[0]+qe),T(dt))}function T(Ie,pt){N(Ie);for(var qe=!1,dt=!1,He=Ie.FullPaths.length-1;0<=He;--He){var zt=Ie.FileIndex[He];switch(zt.type){case 0:dt?qe=!0:(Ie.FileIndex.pop(),Ie.FullPaths.pop());break;case 1:case 2:case 5:dt=!0,isNaN(zt.R*zt.L*zt.C)&&(qe=!0),-1<zt.R&&-1<zt.L&&zt.R==zt.L&&(qe=!0);break;default:qe=!0}}if(qe||pt){for(var ct=new Date(1987,1,19),gt=0,it=Object.create?Object.create(null):{},Nt=[],He=0;He<Ie.FullPaths.length;++He)it[Ie.FullPaths[He]]=!0,Ie.FileIndex[He].type!==0&&Nt.push([Ie.FullPaths[He],Ie.FileIndex[He]]);for(He=0;He<Nt.length;++He){var Vt=u(Nt[He][0]);(dt=it[Vt])||(Nt.push([Vt,{name:d(Vt).replace("/",""),type:1,clsid:he,ct,mt:ct,content:null}]),it[Vt]=!0)}for(Nt.sort(function(or,br){return(function(Pr,Rr){for(var rr,Wt=Pr.split("/"),Ur=Rr.split("/"),fr=0,Yt=Math.min(Wt.length,Ur.length);fr<Yt;++fr){if(rr=Wt[fr].length-Ur[fr].length)return rr;if(Wt[fr]!=Ur[fr])return Wt[fr]<Ur[fr]?-1:1}return Wt.length-Ur.length})(or[0],br[0])}),Ie.FullPaths=[],Ie.FileIndex=[],He=0;He<Nt.length;++He)Ie.FullPaths[He]=Nt[He][0],Ie.FileIndex[He]=Nt[He][1];for(He=0;He<Nt.length;++He){var vr=Ie.FileIndex[He],gr=Ie.FullPaths[He];if(vr.name=d(gr).replace("/",""),vr.L=vr.R=vr.C=-(vr.color=1),vr.size=vr.content?vr.content.length:0,vr.start=0,vr.clsid=vr.clsid||he,He===0)vr.C=1<Nt.length?1:-1,vr.size=0,vr.type=5;else if(gr.slice(-1)=="/"){for(gt=He+1;gt<Nt.length&&u(Ie.FullPaths[gt])!=gr;++gt);for(vr.C=gt>=Nt.length?-1:gt,gt=He+1;gt<Nt.length&&u(Ie.FullPaths[gt])!=u(gr);++gt);vr.R=gt>=Nt.length?-1:gt,vr.type=1}else u(Ie.FullPaths[He+1]||"")==u(gr)&&(vr.R=He+1),vr.type=2}}}function F(Ie,pt){var qe=pt||{};if(qe.fileType=="mad")return(function(gr,or){for(var br=or||{},Pr=br.boundary||"SheetJS",Rr=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(Pr="------="+Pr).slice(2)+'"',"","",""],rr=gr.FullPaths[0],Wt=rr,Ur=gr.FileIndex[0],fr=1;fr<gr.FullPaths.length;++fr)if(Wt=gr.FullPaths[fr].slice(rr.length),(Ur=gr.FileIndex[fr]).size&&Ur.content&&Wt!="Sh33tJ5"){Wt=Wt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Dr){return"_x"+Dr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Dr){return"_u"+Dr.charCodeAt(0).toString(16)+"_"});for(var Yt=Ur.content,Xr=xe&&Buffer.isBuffer(Yt)?Yt.toString("binary"):J(Yt),Br=0,Wa=Math.min(1024,Xr.length),un=0,Tn=0;Tn<=Wa;++Tn)32<=(un=Xr.charCodeAt(Tn))&&un<128&&++Br;Yt=4*Wa/5<=Br,Rr.push(Pr),Rr.push("Content-Location: "+(br.root||"file:///C:/SheetJS/")+Wt),Rr.push("Content-Transfer-Encoding: "+(Yt?"quoted-printable":"base64")),Rr.push("Content-Type: "+(function(o,Kn){if(o.ctype)return o.ctype;var Bn=o.name||"",o=Bn.match(/\.([^\.]+)$/);return o&&ki[o[1]]||Kn&&(o=(Bn=Kn).match(/[\.\\]([^\.\\])+$/))&&ki[o[1]]?ki[o[1]]:"application/octet-stream"})(Ur,Wt)),Rr.push(""),Rr.push((Yt?function(Dr){Dr=Dr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(D){return D=D.charCodeAt(0).toString(16).toUpperCase(),"="+(D.length==1?"0"+D:D)}),(Dr=Dr.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(Dr="=0D"+Dr.slice(1)),Dr=Dr.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var Kn=[],Bn=Dr.split(`\r
`),o=0;o<Bn.length;++o){var l=Bn[o];if(l.length!=0)for(var f=0;f<l.length;){var v=76,E=l.slice(f,f+v);E.charAt(v-1)=="="?v--:E.charAt(v-2)=="="?v-=2:E.charAt(v-3)=="="&&(v-=3),E=l.slice(f,f+v),(f+=v)<l.length&&(E+="="),Kn.push(E)}else Kn.push("")}return Kn.join(`\r
`)}:function(Dr){for(var Kn=W(Dr),Bn=[],o=0;o<Kn.length;o+=76)Bn.push(Kn.slice(o,o+76));return Bn.join(`\r
`)+`\r
`})(Xr))}return Rr.push(Pr+`--\r
`),Rr.join(`\r
`)})(Ie,qe);if(T(Ie),qe.fileType==="zip")return(function(gr,br){var br=br||{},Pr=[],Rr=[],rr=xt(1),Wt=br.compression?8:0,Ur=0,fr=0,Yt=0,Xr=0,Br=0,Wa=gr.FullPaths[0],un=Wa,Tn=gr.FileIndex[0],Dr=[],Kn=0;for(fr=1;fr<gr.FullPaths.length;++fr)if(un=gr.FullPaths[fr].slice(Wa.length),(Tn=gr.FileIndex[fr]).size&&Tn.content&&un!="Sh33tJ5"){var Bn=Xr,o=xt(un.length);for(Yt=0;Yt<un.length;++Yt)o.write_shift(1,127&un.charCodeAt(Yt));o=o.slice(0,o.l),Dr[Br]=Wr.buf(Tn.content,0);var l=Tn.content;Wt==8&&(l=(function(f){return O?O.deflateRawSync(f):dr(f)})(l)),(rr=xt(30)).write_shift(4,67324752),rr.write_shift(2,20),rr.write_shift(2,Ur),rr.write_shift(2,Wt),Tn.mt?(function(f,v){var E=(v=typeof v=="string"?new Date(v):v).getHours();E=(E=E<<6|v.getMinutes())<<5|v.getSeconds()>>>1,f.write_shift(2,E),E=(E=(E=v.getFullYear()-1980)<<4|v.getMonth()+1)<<5|v.getDate(),f.write_shift(2,E)})(rr,Tn.mt):rr.write_shift(4,0),rr.write_shift(-4,Dr[Br]),rr.write_shift(4,l.length),rr.write_shift(4,Tn.content.length),rr.write_shift(2,o.length),rr.write_shift(2,0),Xr+=rr.length,Pr.push(rr),Xr+=o.length,Pr.push(o),Xr+=l.length,Pr.push(l),(rr=xt(46)).write_shift(4,33639248),rr.write_shift(2,0),rr.write_shift(2,20),rr.write_shift(2,Ur),rr.write_shift(2,Wt),rr.write_shift(4,0),rr.write_shift(-4,Dr[Br]),rr.write_shift(4,l.length),rr.write_shift(4,Tn.content.length),rr.write_shift(2,o.length),rr.write_shift(2,0),rr.write_shift(2,0),rr.write_shift(2,0),rr.write_shift(2,0),rr.write_shift(4,0),rr.write_shift(4,Bn),Kn+=rr.l,Rr.push(rr),Kn+=o.length,Rr.push(o),++Br}return(rr=xt(22)).write_shift(4,101010256),rr.write_shift(2,0),rr.write_shift(2,0),rr.write_shift(2,Br),rr.write_shift(2,Br),rr.write_shift(4,Kn),rr.write_shift(4,Xr),rr.write_shift(2,0),Ae([Ae(Pr),Ae(Rr),rr])})(Ie,qe);for(var dt=(function(gr){for(var or=0,br=0,Pr=0;Pr<gr.FileIndex.length;++Pr){var Rr=gr.FileIndex[Pr];Rr.content&&0<(Rr=Rr.content.length)&&(Rr<4096?or+=Rr+63>>6:br+=Rr+511>>9)}for(var rr=gr.FullPaths.length+3>>2,Wt=or+127>>7,Ur=(or+7>>3)+br+rr+Wt,fr=Ur+127>>7,Yt=fr<=109?0:Math.ceil((fr-109)/127);fr<Ur+fr+Yt+127>>7;)Yt=++fr<=109?0:Math.ceil((fr-109)/127);return rr=[1,Yt,fr,Wt,rr,br,or,0],gr.FileIndex[0].size=or<<6,rr[7]=(gr.FileIndex[0].start=rr[0]+rr[1]+rr[2]+rr[3]+rr[4]+rr[5])+(rr[6]+7>>3),rr})(Ie),He=xt(dt[7]<<9),ct=0,zt=0,ct=0;ct<8;++ct)He.write_shift(1,G[ct]);for(ct=0;ct<8;++ct)He.write_shift(2,0);for(He.write_shift(2,62),He.write_shift(2,3),He.write_shift(2,65534),He.write_shift(2,9),He.write_shift(2,6),ct=0;ct<3;++ct)He.write_shift(2,0);for(He.write_shift(4,0),He.write_shift(4,dt[2]),He.write_shift(4,dt[0]+dt[1]+dt[2]+dt[3]-1),He.write_shift(4,0),He.write_shift(4,4096),He.write_shift(4,dt[3]?dt[0]+dt[1]+dt[2]-1:B),He.write_shift(4,dt[3]),He.write_shift(-4,dt[1]?dt[0]-1:B),He.write_shift(4,dt[1]),ct=0;ct<109;++ct)He.write_shift(-4,ct<dt[2]?dt[1]+ct:-1);if(dt[1])for(zt=0;zt<dt[1];++zt){for(;ct<236+127*zt;++ct)He.write_shift(-4,ct<dt[2]?dt[1]+ct:-1);He.write_shift(-4,zt===dt[1]-1?B:zt+1)}function gt(gr){for(zt+=gr;ct<zt-1;++ct)He.write_shift(-4,ct+1);gr&&(++ct,He.write_shift(-4,B))}for(zt=ct=0,zt+=dt[1];ct<zt;++ct)He.write_shift(-4,ne.DIFSECT);for(zt+=dt[2];ct<zt;++ct)He.write_shift(-4,ne.FATSECT);gt(dt[3]),gt(dt[4]);for(var it=0,Nt=0,Vt=Ie.FileIndex[0];it<Ie.FileIndex.length;++it)(Vt=Ie.FileIndex[it]).content&&((Nt=Vt.content.length)<4096||(Vt.start=zt,gt(Nt+511>>9)));for(gt(dt[6]+7>>3);511&He.l;)He.write_shift(-4,ne.ENDOFCHAIN);for(it=zt=ct=0;it<Ie.FileIndex.length;++it)(Vt=Ie.FileIndex[it]).content&&(!(Nt=Vt.content.length)||4096<=Nt||(Vt.start=zt,gt(Nt+63>>6)));for(;511&He.l;)He.write_shift(-4,ne.ENDOFCHAIN);for(ct=0;ct<dt[4]<<2;++ct){var vr=Ie.FullPaths[ct];if(vr&&vr.length!==0){if(Vt=Ie.FileIndex[ct],ct===0&&(Vt.start=Vt.size?Vt.start-1:B),vr=ct===0&&qe.root||Vt.name,Nt=2*(vr.length+1),He.write_shift(64,vr,"utf16le"),He.write_shift(2,Nt),He.write_shift(1,Vt.type),He.write_shift(1,Vt.color),He.write_shift(-4,Vt.L),He.write_shift(-4,Vt.R),He.write_shift(-4,Vt.C),Vt.clsid)He.write_shift(16,Vt.clsid,"hex");else for(it=0;it<4;++it)He.write_shift(4,0);He.write_shift(4,Vt.state||0),He.write_shift(4,0),He.write_shift(4,0),He.write_shift(4,0),He.write_shift(4,0),He.write_shift(4,Vt.start),He.write_shift(4,Vt.size),He.write_shift(4,0)}else{for(it=0;it<17;++it)He.write_shift(4,0);for(it=0;it<3;++it)He.write_shift(4,-1);for(it=0;it<12;++it)He.write_shift(4,0)}}for(ct=1;ct<Ie.FileIndex.length;++ct)if(4096<=(Vt=Ie.FileIndex[ct]).size)if(He.l=Vt.start+1<<9,xe&&Buffer.isBuffer(Vt.content))Vt.content.copy(He,He.l,0,Vt.size),He.l+=Vt.size+511&-512;else{for(it=0;it<Vt.size;++it)He.write_shift(1,Vt.content[it]);for(;511&it;++it)He.write_shift(1,0)}for(ct=1;ct<Ie.FileIndex.length;++ct)if(0<(Vt=Ie.FileIndex[ct]).size&&Vt.size<4096)if(xe&&Buffer.isBuffer(Vt.content))Vt.content.copy(He,He.l,0,Vt.size),He.l+=Vt.size+63&-64;else{for(it=0;it<Vt.size;++it)He.write_shift(1,Vt.content[it]);for(;63&it;++it)He.write_shift(1,0)}if(xe)He.l=He.length;else for(;He.l<He.length;)He.write_shift(1,0);return He}c.version="1.2.1";var O,L=64,B=-2,ee="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(Ie){for(var pt=new Array(Ie.length),qe=0;qe<Ie.length;++qe)pt[qe]=String.fromCharCode(Ie[qe]);return pt.join("")}for(var ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],be=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$e,et=typeof Uint8Array<"u",Xe=et?new Uint8Array(256):[],lt=0;lt<256;++lt)Xe[lt]=255&(($e=139536&(($e=lt)<<1|$e<<11)|558144&($e<<5|$e<<15))>>16|$e>>8|$e);function _t(Ie,dt){var qe=7&dt,dt=dt>>>3;return(Ie[dt]|(qe<=5?0:Ie[1+dt]<<8))>>>qe&7}function Dt(Ie,dt){var qe=7&dt,dt=dt>>>3;return(Ie[dt]|(qe<=3?0:Ie[1+dt]<<8))>>>qe&31}function ft(Ie,dt){var qe=7&dt,dt=dt>>>3;return(Ie[dt]|(qe<=1?0:Ie[1+dt]<<8))>>>qe&127}function qt(Ie,ct,qe){var dt=7&ct,He=ct>>>3,zt=(1<<qe)-1,ct=Ie[He]>>>dt;return qe<8-dt?ct&zt:(ct|=Ie[1+He]<<8-dt,qe<16-dt?ct&zt:(ct|=Ie[2+He]<<16-dt,qe<24-dt?ct&zt:(ct|=Ie[3+He]<<24-dt)&zt))}function hr(Ie,pt,qe){var dt=7&pt,He=pt>>>3;return dt<=5?Ie[He]|=(7&qe)<<dt:(Ie[He]|=qe<<dt&255,Ie[1+He]=(7&qe)>>8-dt),pt+3}function lr(Ie,pt,qe){var dt=pt>>>3;return qe<<=7&pt,Ie[dt]|=255&qe,qe>>>=8,Ie[1+dt]=qe,pt+8}function Zt(Ie,pt,qe){var dt=pt>>>3;return qe<<=7&pt,Ie[dt]|=255&qe,qe>>>=8,Ie[1+dt]=255&qe,Ie[2+dt]=qe>>>8,pt+16}function tr(Ie,pt){var qe=Ie.length,dt=pt<2*qe?2*qe:pt+5,He=0;if(pt<=qe)return Ie;if(xe){var zt=ke(dt);if(Ie.copy)Ie.copy(zt);else for(;He<Ie.length;++He)zt[He]=Ie[He];return zt}if(et){var ct=new Uint8Array(dt);if(ct.set)ct.set(Ie);else for(;He<qe;++He)ct[He]=Ie[He];return ct}return Ie.length=dt,Ie}function Kt(Ie){for(var pt=new Array(Ie),qe=0;qe<Ie;++qe)pt[qe]=0;return pt}function Bt(Ie,pt,qe){for(var dt,He=1,Nt=0,zt=0,ct=0,gt=Ie.length,it=et?new Uint16Array(32):Kt(32),Nt=0;Nt<32;++Nt)it[Nt]=0;for(Nt=gt;Nt<qe;++Nt)Ie[Nt]=0;gt=Ie.length;var Vt=et?new Uint16Array(gt):Kt(gt);for(Nt=0;Nt<gt;++Nt)it[dt=Ie[Nt]]++,He<dt&&(He=dt),Vt[Nt]=0;for(it[0]=0,Nt=1;Nt<=He;++Nt)it[Nt+16]=ct=ct+it[Nt-1]<<1;for(Nt=0;Nt<gt;++Nt)(ct=Ie[Nt])!=0&&(Vt[Nt]=it[ct+16]++);var vr,gr,or,br;for(Nt=0;Nt<gt;++Nt)if((vr=Ie[Nt])!=0)for(gr=Vt[Nt],or=He,br=void 0,br=Xe[255&gr],ct=(or<=8?br>>>8-or:(br=br<<8|Xe[gr>>8&255],or<=16?br>>>16-or:(br=br<<8|Xe[gr>>16&255])>>>24-or))>>He-vr,zt=(1<<He+4-vr)-1;0<=zt;--zt)pt[ct|zt<<vr]=15&vr|Nt<<4;return He}var mr=et?new Uint16Array(512):Kt(512),Nr=et?new Uint16Array(32):Kt(32);if(!et){for(var Gr=0;Gr<512;++Gr)mr[Gr]=0;for(Gr=0;Gr<32;++Gr)Nr[Gr]=0}(function(){for(var Ie=[],pt=0;pt<32;pt++)Ie.push(5);Bt(Ie,Nr,32);for(var qe=[],pt=0;pt<=143;pt++)qe.push(8);for(;pt<=255;pt++)qe.push(9);for(;pt<=279;pt++)qe.push(7);for(;pt<=287;pt++)qe.push(8);Bt(qe,mr,288)})();var Mn=(function(){for(var Ie=et?new Uint8Array(32768):[],pt=0,qe=0;pt<we.length-1;++pt)for(;qe<we[pt+1];++qe)Ie[qe]=pt;for(;qe<32768;++qe)Ie[qe]=29;for(var dt=et?new Uint8Array(259):[],pt=0,qe=0;pt<be.length-1;++pt)for(;qe<be[pt+1];++qe)dt[qe]=pt;return function(He,zt){return(He.length<8?function(ct,gt){for(var it=0;it<ct.length;){var Nt=Math.min(65535,ct.length-it),Vt=it+Nt==ct.length;for(gt.write_shift(1,+Vt),gt.write_shift(2,Nt),gt.write_shift(2,65535&~Nt);0<Nt--;)gt[gt.l++]=ct[it++]}return gt.l}:function(ct,gt){for(var it=0,Nt=0,Vt=et?new Uint16Array(32768):[];Nt<ct.length;){var vr=Math.min(65535,ct.length-Nt);if(vr<10){for(7&(it=hr(gt,it,+(Nt+vr==ct.length)))&&(it+=8-(7&it)),gt.l=it/8|0,gt.write_shift(2,vr),gt.write_shift(2,65535&~vr);0<vr--;)gt[gt.l++]=ct[Nt++];it=8*gt.l}else{it=hr(gt,it,+(Nt+vr==ct.length)+2);for(var gr=0;0<vr--;){var or=ct[Nt],gr=32767&(gr<<5^or),br=-1,Pr=0;if((br=Vt[gr])&&(Nt<(br|=-32768&Nt)&&(br-=32768),br<Nt))for(;ct[br+Pr]==ct[Nt+Pr]&&Pr<250;)++Pr;if(2<Pr){(or=dt[Pr])<=22?it=lr(gt,it,Xe[or+1]>>1)-1:(lr(gt,it,3),lr(gt,it+=5,Xe[or-23]>>5),it+=3);var Rr=or<8?0:or-4>>2;0<Rr&&(Zt(gt,it,Pr-be[or]),it+=Rr),or=Ie[Nt-br],it=lr(gt,it,Xe[or]>>3),it-=3;var rr=or<4?0:or-2>>1;0<rr&&(Zt(gt,it,Nt-br-we[or]),it+=rr);for(var Wt=0;Wt<Pr;++Wt)Vt[gr]=32767&Nt,gr=32767&(gr<<5^ct[Nt]),++Nt;vr-=Pr-1}else or<=143?or+=48:(Rr=((Rr=1)&Rr)<<(7&(rr=it)),gt[rr>>>3]|=Rr,it=rr+1),it=lr(gt,it,Xe[or]),Vt[gr]=32767&Nt,++Nt}it=lr(gt,it,0)-1}}return gt.l=(it+7)/8|0,gt.l})(He,zt)}})();function dr(qe){var pt=xt(50+Math.floor(1.1*qe.length)),qe=Mn(qe,pt);return pt.slice(0,qe)}var Gt=et?new Uint16Array(32768):Kt(32768),bn=et?new Uint16Array(32768):Kt(32768),Qn=et?new Uint16Array(128):Kt(128),$n=1,Sa=1;function Ls(Ie,pt){if(Ie[0]==3&&!(3&Ie[1]))return[De(pt),2];for(var qe=0,dt=0,He=ke(pt||1<<18),zt=0,ct=He.length>>>0,gt=0,it=0;(1&dt)==0;)if(dt=_t(Ie,qe),qe+=3,dt>>>1!=0)for(it=dt>>1==1?(gt=9,5):(qe=(function(Pr,Rr){var rr,Wt,Ur,fr=Dt(Pr,Rr)+257,Yt=Dt(Pr,Rr+=5)+1,Xr=(Ur=7&(Wt=Rr+=5),4+(((rr=Pr)[Wt=Wt>>>3]|(Ur<=4?0:rr[1+Wt]<<8))>>>Ur&15));Rr+=4;for(var Br=0,Wa=et?new Uint8Array(19):Kt(19),un=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Tn=1,Dr=et?new Uint8Array(8):Kt(8),Kn=et?new Uint8Array(8):Kt(8),Bn=Wa.length,o=0;o<Xr;++o)Wa[ue[o]]=Br=_t(Pr,Rr),Tn<Br&&(Tn=Br),Dr[Br]++,Rr+=3;var l=0;for(Dr[0]=0,o=1;o<=Tn;++o)Kn[o]=l=l+Dr[o-1]<<1;for(o=0;o<Bn;++o)(l=Wa[o])!=0&&(un[o]=Kn[l]++);for(var f,o=0;o<Bn;++o)if((f=Wa[o])!=0){l=Xe[un[o]]>>8-f;for(var v=(1<<7-f)-1;0<=v;--v)Qn[l|v<<f]=7&f|o<<3}for(var E,D,Q,me=[],Tn=1;me.length<fr+Yt;)switch(Rr+=7&(l=Qn[ft(Pr,Rr)]),l>>>=3){case 16:for(Br=3+(Q=void 0,Q=7&(D=Rr),((E=Pr)[D=D>>>3]|(Q<=6?0:E[1+D]<<8))>>>Q&3),Rr+=2,l=me[me.length-1];0<Br--;)me.push(l);break;case 17:for(Br=3+_t(Pr,Rr),Rr+=3;0<Br--;)me.push(0);break;case 18:for(Br=11+ft(Pr,Rr),Rr+=7;0<Br--;)me.push(0);break;default:me.push(l),Tn<l&&(Tn=l)}var Me=me.slice(0,fr),at=me.slice(fr);for(o=fr;o<286;++o)Me[o]=0;for(o=Yt;o<30;++o)at[o]=0;return $n=Bt(Me,Gt,286),Sa=Bt(at,bn,30),Rr})(Ie,qe),gt=$n,Sa);;){!pt&&ct<zt+32767&&(ct=(He=tr(He,zt+32767)).length);var Nt=qt(Ie,qe,gt),Vt=(dt>>>1==1?mr:Gt)[Nt];if(qe+=15&Vt,((Vt>>>=4)>>>8&255)==0)He[zt++]=Vt;else{if(Vt==256)break;var vr=(Vt-=257)<8?0:Vt-4>>2;5<vr&&(vr=0);var gr=zt+be[Vt];0<vr&&(gr+=qt(Ie,qe,vr),qe+=vr),Nt=qt(Ie,qe,it),qe+=15&(Vt=(dt>>>1==1?Nr:bn)[Nt]);var Nt=(Vt>>>=4)<4?0:Vt-2>>1,or=we[Vt];for(0<Nt&&(or+=qt(Ie,qe,Nt),qe+=Nt),!pt&&ct<gr&&(ct=(He=tr(He,gr+100)).length);zt<gr;)He[zt]=He[zt-or],++zt}}else{7&qe&&(qe+=8-(7&qe));var br=Ie[qe>>>3]|Ie[1+(qe>>>3)]<<8;if(qe+=32,0<br)for(!pt&&ct<zt+br&&(ct=(He=tr(He,zt+br)).length);0<br--;)He[zt++]=Ie[qe>>>3],qe+=8}return pt?[He,qe+7>>>3]:[He.slice(0,zt),qe+7>>>3]}function We(Ie,pt){return pt=Ls(Ie.slice(Ie.l||0),pt),Ie.l+=pt[1],pt[0]}function Aa(Ie,pt){if(!Ie)throw new Error(pt);typeof console<"u"&&console.error(pt)}function la(Ie,pt){var qe=Ie;Ra(qe,0);var dt={FileIndex:[],FullPaths:[]};N(dt,{root:pt.root});for(var He=qe.length-4;(qe[He]!=80||qe[He+1]!=75||qe[He+2]!=5||qe[He+3]!=6)&&0<=He;)--He;qe.l=He+4,qe.l+=4;var zt=qe.read_shift(2);for(qe.l+=6,pt=qe.read_shift(4),qe.l=pt,He=0;He<zt;++He){qe.l+=20;var ct=qe.read_shift(4),gt=qe.read_shift(4),it=qe.read_shift(2),Nt=qe.read_shift(2),Vt=qe.read_shift(2);qe.l+=8;var vr=qe.read_shift(4),gr=g(qe.slice(qe.l+it,qe.l+it+Nt));qe.l+=it+Nt+Vt,Vt=qe.l,qe.l=vr+4,(function(or,br,Pr,Rr,rr){or.l+=2;var Wt=or.read_shift(2),Ur=or.read_shift(2),fr=(function(E){var o=65535&E.read_shift(2),l=65535&E.read_shift(2),f=new Date,v=31&l,E=15&(l>>>=5);return l>>>=4,f.setMilliseconds(0),f.setFullYear(1980+l),f.setMonth(E-1),f.setDate(v),E=31&o,v=63&(o>>>=5),o>>>=6,f.setHours(o),f.setMinutes(v),f.setSeconds(E<<1),f})(or);if(8257&Wt)throw new Error("Unsupported ZIP encryption");or.read_shift(4);for(var Yt,Xr=or.read_shift(4),Br=or.read_shift(4),Wa=or.read_shift(2),un=or.read_shift(2),Tn="",Dr=0;Dr<Wa;++Dr)Tn+=String.fromCharCode(or[or.l++]);un&&(((Yt=g(or.slice(or.l,or.l+un)))[21589]||{}).mt&&(fr=Yt[21589].mt),((rr||{})[21589]||{}).mt&&(fr=rr[21589].mt)),or.l+=un;var Kn=or.slice(or.l,or.l+Xr);switch(Ur){case 8:Kn=(function(Bn,f){if(!O)return We(Bn,f);var l=new O.InflateRaw,f=l._processChunk(Bn.slice(Bn.l),l._finishFlushFlag);return Bn.l+=l.bytesRead,f})(or,Br);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ur)}un=!1,8&Wt&&(or.read_shift(4)==134695760&&(or.read_shift(4),un=!0),Xr=or.read_shift(4),Br=or.read_shift(4)),Xr!=br&&Aa(un,"Bad compressed size: "+br+" != "+Xr),Br!=Pr&&Aa(un,"Bad uncompressed size: "+Pr+" != "+Br),ac(Rr,Tn,Kn,{unsafe:!0,mt:fr})})(qe,ct,gt,dt,gr),qe.l=Vt}return dt}var ki={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ac(Ie,pt,qe,dt){var He=dt&&dt.unsafe;He||N(Ie);var zt,ct=!He&&Jt.find(Ie,pt);return ct||(zt=Ie.FullPaths[0],zt=pt.slice(0,zt.length)==zt?pt:(zt.slice(-1)!="/"&&(zt+="/"),(zt+pt).replace("//","/")),ct={name:d(pt),type:2},Ie.FileIndex.push(ct),Ie.FullPaths.push(zt),He||Jt.utils.cfb_gc(Ie)),ct.content=qe,ct.size=qe?qe.length:0,dt&&(dt.CLSID&&(ct.clsid=dt.CLSID),dt.mt&&(ct.mt=dt.mt),dt.ct&&(ct.ct=dt.ct)),ct}return c.find=function(Ie,pt){var qe=Ie.FullPaths.map(function(it){return it.toUpperCase()}),dt=qe.map(function(it){var Nt=it.split("/");return Nt[Nt.length-(it.slice(-1)=="/"?2:1)]}),He=!1;pt.charCodeAt(0)===47?(He=!0,pt=qe[0].slice(0,-1)+pt):He=pt.indexOf("/")!==-1;var gt=pt.toUpperCase(),zt=(He===!0?qe:dt).indexOf(gt);if(zt!==-1)return Ie.FileIndex[zt];var ct=!gt.match(Be),gt=gt.replace(Ce,"");for(ct&&(gt=gt.replace(Be,"!")),zt=0;zt<qe.length;++zt)if((ct?qe[zt].replace(Be,"!"):qe[zt]).replace(Ce,"")==gt||(ct?dt[zt].replace(Be,"!"):dt[zt]).replace(Ce,"")==gt)return Ie.FileIndex[zt];return null},c.read=function(Ie,pt){var qe,dt,He=pt&&pt.type;switch(He||xe&&Buffer.isBuffer(Ie)&&(He="buffer"),He||"base64"){case"file":return qe=Ie,dt=pt,x(),b(s.readFileSync(qe),dt);case"base64":return b(de(re(Ie)),pt);case"binary":return b(de(Ie),pt)}return b(Ie,pt)},c.parse=b,c.write=function(Ie,pt){var qe=F(Ie,pt);switch(pt&&pt.type||"buffer"){case"file":return x(),s.writeFileSync(pt.filename,qe),qe;case"binary":return typeof qe=="string"?qe:J(qe);case"base64":return W(typeof qe=="string"?qe:J(qe));case"buffer":if(xe)return Buffer.isBuffer(qe)?qe:ve(qe);case"array":return typeof qe=="string"?de(qe):qe}return qe},c.writeFile=function(Ie,pt,qe){x(),qe=F(Ie,qe),s.writeFileSync(pt,qe)},c.utils={cfb_new:function(Ie){var pt={};return N(pt,Ie),pt},cfb_add:ac,cfb_del:function(Ie,pt){N(Ie);var qe=Jt.find(Ie,pt);if(qe){for(var dt=0;dt<Ie.FileIndex.length;++dt)if(Ie.FileIndex[dt]==qe)return Ie.FileIndex.splice(dt,1),Ie.FullPaths.splice(dt,1),!0}return!1},cfb_mov:function(Ie,pt,qe){N(Ie);var dt=Jt.find(Ie,pt);if(dt){for(var He=0;He<Ie.FileIndex.length;++He)if(Ie.FileIndex[He]==dt)return Ie.FileIndex[He].name=d(qe),Ie.FullPaths[He]=qe,!0}return!1},cfb_gc:function(Ie){T(Ie,!0)},ReadShift:Ja,CheckField:Ml,prep_blob:Ra,bconcat:Ae,use_zlib:function(Ie){try{var pt=new Ie.InflateRaw;if(pt._processChunk(new Uint8Array([3,0]),pt._finishFlushFlag),!pt.bytesRead)throw new Error("zlib does not expose bytesRead");O=Ie}catch(qe){console.error("cannot use native zlib: "+(qe.message||qe))}},_deflateRaw:dr,_inflateRaw:We,consts:ne},c})();if(typeof F2<"u")try{fn=$5}catch{}function bo(s){return typeof s=="string"?Oe(s):Array.isArray(s)?(function(c){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(c)})(s):s}function Vs(s,c,u){if(fn!==void 0&&fn.writeFileSync)return u?fn.writeFileSync(s,c,u):fn.writeFileSync(s,c);if(typeof Deno<"u"){if(u&&typeof c=="string")switch(u){case"utf8":c=new TextEncoder(u).encode(c);break;case"binary":c=Oe(c);break;default:throw new Error("Unsupported encoding "+u)}return Deno.writeFileSync(s,c)}var d=u=="utf8"?xi(c):c;if(typeof IE_SaveFile<"u")return IE_SaveFile(d,s);if(typeof Blob<"u"){if(d=new Blob([bo(d)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(d,s);if(typeof saveAs<"u")return saveAs(d,s);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var g=URL.createObjectURL(d);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),chrome.downloads.download({url:g,filename:s,saveAs:!0});if(d=document.createElement("a"),d.download!=null)return d.download=s,d.href=g,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),g}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var x=File(s);return x.open("w"),x.encoding="binary",Array.isArray(c)&&(c=z(c)),x.write(c),x.close(),c}catch(b){if(!b.message||!b.message.match(/onstruct/))throw b}throw new Error("cannot save file "+s)}function fa(s){for(var c=Object.keys(s),u=[],d=0;d<c.length;++d)Object.prototype.hasOwnProperty.call(s,c[d])&&u.push(c[d]);return u}function xo(s,c){for(var u=[],d=fa(s),g=0;g!==d.length;++g)u[s[d[g]][c]]==null&&(u[s[d[g]][c]]=d[g]);return u}function Yr(s){for(var c=[],u=fa(s),d=0;d!==u.length;++d)c[s[u[d]]]=u[d];return c}function qo(s){for(var c=[],u=fa(s),d=0;d!==u.length;++d)c[s[u[d]]]=parseInt(u[d],10);return c}var wo=new Date(1899,11,30,0,0,0);function pa(s,c){var u=s.getTime();return(u-(wo.getTime()+6e4*(s.getTimezoneOffset()-wo.getTimezoneOffset())))/864e5}var Ri=new Date,as=wo.getTime()+6e4*(Ri.getTimezoneOffset()-wo.getTimezoneOffset()),Ps=Ri.getTimezoneOffset();function Ms(s){var c=new Date;return c.setTime(24*s*60*60*1e3+as),c.getTimezoneOffset()!==Ps&&c.setTime(c.getTime()+6e4*(c.getTimezoneOffset()-Ps)),c}var pl=new Date("2017-02-19T19:06:09.000Z"),ji=isNaN(pl.getFullYear())?new Date("2/19/17"):pl,Fa=ji.getFullYear()==2017;function vn(s,c){var u=new Date(s);return Fa?(0<c?u.setTime(u.getTime()+60*u.getTimezoneOffset()*1e3):c<0&&u.setTime(u.getTime()-60*u.getTimezoneOffset()*1e3),u):s instanceof Date?s:ji.getFullYear()==1917&&!isNaN(u.getFullYear())?(c=u.getFullYear(),-1<s.indexOf(""+c)||u.setFullYear(u.getFullYear()+100),u):(u=s.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0),u=-1<s.indexOf("Z")?new Date(u.getTime()-60*u.getTimezoneOffset()*1e3):u)}function Cs(s,c){if(xe&&Buffer.isBuffer(s)){if(c){if(s[0]==255&&s[1]==254)return xi(s.slice(2).toString("utf16le"));if(s[1]==254&&s[2]==255)return xi(M(s.slice(2).toString("binary")))}return s.toString("binary")}if(typeof TextDecoder<"u")try{if(c){if(s[0]==255&&s[1]==254)return xi(new TextDecoder("utf-16le").decode(s.slice(2)));if(s[0]==254&&s[1]==255)return xi(new TextDecoder("utf-16be").decode(s.slice(2)))}var u={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(s)&&(s=new Uint8Array(s)),new TextDecoder("latin1").decode(s).replace(/[]/g,function(x){return u[x]||x})}catch{}for(var d=[],g=0;g!=s.length;++g)d.push(String.fromCharCode(s[g]));return d.join("")}function jn(s){if(typeof JSON<"u"&&!Array.isArray(s))return JSON.parse(JSON.stringify(s));if(typeof s!="object"||s==null)return s;if(s instanceof Date)return new Date(s.getTime());var c,u={};for(c in s)Object.prototype.hasOwnProperty.call(s,c)&&(u[c]=jn(s[c]));return u}function na(s,c){for(var u="";u.length<c;)u+=s;return u}function bi(d){var c=Number(d);if(!isNaN(c))return isFinite(c)?c:NaN;if(!/\d/.test(d))return c;var u=1,d=d.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return u*=100,""});return isNaN(c=Number(d))?(d=d.replace(/[(](.*)[)]/,function(g,x){return u=-u,x}),isNaN(c=Number(d))?c:c/u):c/u}var ml=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oi(s){var c=new Date(s),u=new Date(NaN),d=c.getYear(),g=c.getMonth(),x=c.getDate();if(isNaN(x))return u;var b=s.toLowerCase();if(b.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(b=b.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&ml.indexOf(b)==-1)return u}else if(b.match(/[a-z]/))return u;return d<0||8099<d||(!(0<g||1<x)||d==101)&&s.match(/[^-0-9:,\/\\]/)?u:c}var uc,gl=(uc="abacaba".split(/(:?b)/i).length==5,function(s,c,u){if(uc||typeof c=="string")return s.split(c);for(var d=s.split(c),g=[d[0]],x=1;x<d.length;++x)g.push(u),g.push(d[x]);return g});function Go(s){return s?s.content&&s.type?Cs(s.content,!0):s.data?V(s.data):s.asNodeBuffer&&xe?V(s.asNodeBuffer().toString("binary")):s.asBinary?V(s.asBinary()):s._data&&s._data.getContent?V(Cs(Array.prototype.slice.call(s._data.getContent(),0))):null:null}function $c(s){if(!s)return null;if(s.data)return k(s.data);if(s.asNodeBuffer&&xe)return s.asNodeBuffer();if(s._data&&s._data.getContent){var c=s._data.getContent();return typeof c=="string"?k(c):Array.prototype.slice.call(c)}return s.content&&s.type?s.content:null}function Us(s,c){for(var u=s.FullPaths||fa(s.files),d=c.toLowerCase().replace(/[\/]/g,"\\"),g=d.replace(/\\/g,"/"),x=0;x<u.length;++x){var b=u[x].replace(/^Root Entry[\/]/,"").toLowerCase();if(d==b||g==b)return s.files?s.files[u[x]]:s.FileIndex[x]}return null}function ys(s,c){if(s=Us(s,c),s==null)throw new Error("Cannot find file "+c+" in zip");return s}function ss(s,c,u){if(!u)return((u=ys(s,c))&&u.name.slice(-4)===".bin"?$c:Go)(u);if(!c)return null;try{return ss(s,c)}catch{return null}}function Ya(s,c,u){if(!u)return Go(ys(s,c));if(!c)return null;try{return Ya(s,c)}catch{return null}}function Vo(s){for(var c=s.FullPaths||fa(s.files),u=[],d=0;d<c.length;++d)c[d].slice(-1)!="/"&&u.push(c[d].replace(/^Root Entry[\/]/,""));return u.sort()}function mn(s,c,u){if(s.FullPaths){if(typeof u=="string"){var d=(xe?ve:function(g){for(var x=[],b=0,S=g.length+250,N=De(g.length+255),T=0;T<g.length;++T){var F,O=g.charCodeAt(T);O<128?N[b++]=O:O<2048?(N[b++]=192|O>>6&31,N[b++]=128|63&O):55296<=O&&O<57344?(O=64+(1023&O),F=1023&g.charCodeAt(++T),N[b++]=240|O>>8&7,N[b++]=128|O>>2&63,N[b++]=128|F>>6&15|(3&O)<<4,N[b++]=128|63&F):(N[b++]=224|O>>12&15,N[b++]=128|O>>6&63,N[b++]=128|63&O),S<b&&(x.push(N.slice(0,b)),b=0,N=De(65535),S=65530)}return x.push(N.slice(0,b)),Ae(x)})(u);return Jt.utils.cfb_add(s,c,d)}Jt.utils.cfb_add(s,c,u)}else s.file(c,u)}function fu(){return Jt.utils.cfb_new()}function eh(s,c){switch(c.type){case"base64":return Jt.read(s,{type:"base64"});case"binary":return Jt.read(s,{type:"binary"});case"buffer":case"array":return Jt.read(s,{type:"buffer"})}throw new Error("Unrecognized type "+c.type)}function hc(s,c){if(s.charAt(0)=="/")return s.slice(1);var u=c.split("/");c.slice(-1)!="/"&&u.pop();for(var d=s.split("/");d.length!==0;){var g=d.shift();g===".."?u.pop():g!=="."&&u.push(g)}return u.join("/")}var is=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,So=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,e0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,os=is.match(e0)?e0:/<[^>]*>/g,yl=/<\w*:/,ma=/<(\/?)\w+:/;function ln(s,c,u){for(var d={},g=0,x=0;g!==s.length&&(x=s.charCodeAt(g))!==32&&x!==10&&x!==13;++g);if(c||(d[0]=s.slice(0,g)),g===s.length)return d;var b,S,N,T=s.match(So),F=0,O=0,L="",B="";if(T)for(O=0;O!=T.length;++O){for(B=T[O],x=0;x!=B.length&&B.charCodeAt(x)!==61;++x);for(L=B.slice(0,x).trim();B.charCodeAt(x+1)==32;)++x;for(S=(g=B.charCodeAt(x+1))==34||g==39?1:0,b=B.slice(x+1+S,B.length-S),F=0;F!=L.length&&L.charCodeAt(F)!==58;++F);F===L.length?(d[L=0<L.indexOf("_")?L.slice(0,L.indexOf("_")):L]=b,d[L.toLowerCase()]=b):d[N=(F===5&&L.slice(0,5)==="xmlns"?"xmlns":"")+L.slice(F+1)]&&L.slice(F-3,F)=="ext"||(d[N]=b,d[N.toLowerCase()]=b)}return d}function Zs(s){return s.replace(ma,"<$1")}var dc,th,Li={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bs=Yr(Li),cn=(dc=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,th=/_x([\da-fA-F]{4})_/gi,function s(c){var u=c+"",d=u.indexOf("<![CDATA[");return d==-1?u.replace(dc,function(g,x){return Li[g]||String.fromCharCode(parseInt(x,-1<g.indexOf("x")?16:10))||g}).replace(th,function(g,x){return String.fromCharCode(parseInt(x,16))}):(c=u.indexOf("]]>"),s(u.slice(0,d))+u.slice(d+9,c)+s(u.slice(c+3)))}),qc=/[&<>'"]/g,Td=/[\u0000-\u0008\u000b-\u001f]/g;function aa(s){return(s+"").replace(qc,function(c){return Bs[c]}).replace(Td,function(c){return"_x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Pi(s){return aa(s).replace(/ /g,"_x0020_")}var rh=/[\u0000-\u001f]/g;function pu(s){return(s+"").replace(qc,function(c){return Bs[c]}).replace(/\n/g,"<br/>").replace(rh,function(c){return"&#x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+";"})}var Wo,Gc=(Wo=/&#(\d+);/g,function(s){return s.replace(Wo,Ed)});function Ed(s,c){return String.fromCharCode(parseInt(c,10))}function Ea(s){switch(s){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mu(s){for(var c,u,d,g,x="",b=0,S=0;b<s.length;)(c=s.charCodeAt(b++))<128?x+=String.fromCharCode(c):(u=s.charCodeAt(b++),191<c&&c<224?(S=(31&c)<<6,S|=63&u,x+=String.fromCharCode(S)):(d=s.charCodeAt(b++),c<240?x+=String.fromCharCode((15&c)<<12|(63&u)<<6|63&d):(g=((7&c)<<18|(63&u)<<12|(63&d)<<6|63&(S=s.charCodeAt(b++)))-65536,x+=String.fromCharCode(55296+(g>>>10&1023)),x+=String.fromCharCode(56320+(1023&g)))));return x}function nh(s){for(var c,u,d=De(2*s.length),g=1,x=0,b=0,S=0;S<s.length;S+=g)g=1,(u=s.charCodeAt(S))<128?c=u:u<224?(c=64*(31&u)+(63&s.charCodeAt(S+1)),g=2):u<240?(c=4096*(15&u)+64*(63&s.charCodeAt(S+1))+(63&s.charCodeAt(S+2)),g=3):(g=4,c=262144*(7&u)+4096*(63&s.charCodeAt(S+1))+64*(63&s.charCodeAt(S+2))+(63&s.charCodeAt(S+3)),b=55296+((c-=65536)>>>10&1023),c=56320+(1023&c)),b!==0&&(d[x++]=255&b,d[x++]=b>>>8,b=0),d[x++]=c%256,d[x++]=c>>>8;return d.slice(0,x).toString("ucs2")}function Lh(s){return ve(s,"binary").toString("utf8")}var Mi,ao,Ko,su="foo bar baz",Xn=xe&&(Lh(su)==mu(su)?Lh:nh(su)==mu(su)&&nh)||mu,xi=xe?function(s){return ve(s,"utf8").toString("binary")}:function(s){for(var c,u=[],d=0,g=0;d<s.length;)switch(!0){case(g=s.charCodeAt(d++))<128:u.push(String.fromCharCode(g));break;case g<2048:u.push(String.fromCharCode(192+(g>>6))),u.push(String.fromCharCode(128+(63&g)));break;case(55296<=g&&g<57344):g-=55296,c=s.charCodeAt(d++)-56320+(g<<10),u.push(String.fromCharCode(240+(c>>18&7))),u.push(String.fromCharCode(144+(c>>12&63))),u.push(String.fromCharCode(128+(c>>6&63))),u.push(String.fromCharCode(128+(63&c)));break;default:u.push(String.fromCharCode(224+(g>>12))),u.push(String.fromCharCode(128+(g>>6&63))),u.push(String.fromCharCode(128+(63&g)))}return u.join("")},tn=(Mi={},function(s,c){var u=s+"|"+(c||"");return Mi[u]||(Mi[u]=new RegExp("<(?:\\w+:)?"+s+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+s+">",c||""))}),Ph=(ao=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(s){return[new RegExp("&"+s[0]+";","ig"),s[1]]}),function(s){for(var c=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<ao.length;++u)c=c.replace(ao[u][0],ao[u][1]);return c}),Mh=(Ko={},function(s){return Ko[s]!==void 0?Ko[s]:Ko[s]=new RegExp("<(?:vt:)?"+s+">([\\s\\S]*?)</(?:vt:)?"+s+">","g")}),kd=/<\/?(?:vt:)?variant>/g,Ao=/<(?:vt:)([^>]*)>([\s\S]*)</;function ii(d,c){var u=ln(d),d=d.match(Mh(u.baseType))||[],g=[];if(d.length==u.size)return d.forEach(function(x){x=x.replace(kd,"").match(Ao),x&&g.push({v:Xn(x[2]),t:x[1]})}),g;if(c.WTF)throw new Error("unexpected vector length "+d.length+" != "+u.size);return g}var ah=/(^\s|\s$|\n)/;function vs(s,c){return"<"+s+(c.match(ah)?' xml:space="preserve"':"")+">"+c+"</"+s+">"}function wi(s){return fa(s).map(function(c){return" "+c+'="'+s[c]+'"'}).join("")}function Xt(s,c,u){return"<"+s+(u!=null?wi(u):"")+(c!=null?(c.match(ah)?' xml:space="preserve"':"")+">"+c+"</"+s:"/")+">"}function Yo(s,c){try{return s.toISOString().replace(/\.\d*/,"")}catch(u){if(c)throw u}return""}function sh(s){if(xe&&Buffer.isBuffer(s))return s.toString("utf8");if(typeof s=="string")return s;if(typeof Uint8Array<"u"&&s instanceof Uint8Array)return Xn(z(K(s)));throw new Error("Bad input format: expected Buffer or string")}var Ui=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,ls={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Jo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],wa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function vl(s){for(var c=[],u=0;u<s[0].length;++u)if(s[0][u])for(var d=0,g=s[0][u].length;d<g;d+=10240)c.push.apply(c,s[0][u].slice(d,d+10240));return c}function Co(s,c,u){for(var d=[],g=c;g<u;g+=2)d.push(String.fromCharCode(Cr(s,g)));return d.join("").replace(Ce,"")}function Fl(s,c,u){for(var d=[],g=c;g<c+u;++g)d.push(("0"+s[g].toString(16)).slice(-2));return d.join("")}function gu(s,c,u){for(var d=[],g=c;g<u;g++)d.push(String.fromCharCode(wr(s,g)));return d.join("")}function Vc(s,c){var u=$r(s,c);return 0<u?fc(s,c+4,c+4+u-1):""}function Rl(s,c){var u=$r(s,c);return 0<u?fc(s,c+4,c+4+u-1):""}function jl(s,c){var u=2*$r(s,c);return 0<u?fc(s,c+4,c+4+u-1):""}function Wc(s,c){var u=$r(s,c);return 0<u?yu(s,c+4,c+4+u):""}function ih(s,c){var u=$r(s,c);return 0<u?fc(s,c+4,c+4+u):""}function Ol(s,c){for(var u=1-2*(s[c+7]>>>7),d=((127&s[c+7])<<4)+(s[c+6]>>>4&15),g=15&s[c+6],x=5;0<=x;--x)g=256*g+s[c+x];return d==2047?g==0?1/0*u:NaN:(d==0?d=-1022:(d-=1023,g+=Math.pow(2,52)),u*Math.pow(2,d-52)*g)}var Ll=xe?function(s){return 0<s[0].length&&Buffer.isBuffer(s[0][0])?Buffer.concat(s[0].map(function(c){return Buffer.isBuffer(c)?c:ve(c)})):vl(s)}:vl,yu=xe?function(s,c,u){return Buffer.isBuffer(s)?s.toString("utf16le",c,u).replace(Ce,""):Co(s,c,u)}:Co,Pl=xe?function(s,c,u){return Buffer.isBuffer(s)?s.toString("hex",c,c+u):Fl(s,c,u)}:Fl,fc=xe?function(s,c,u){return Buffer.isBuffer(s)?s.toString("utf8",c,u):gu(s,c,u)}:gu,j=Vc,ie=Rl,je=jl,Ge=Wc,tt=ih,Et=Ol,Ut=function(s){return Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array};xe&&(j=function(s,c){if(!Buffer.isBuffer(s))return Vc(s,c);var u=s.readUInt32LE(c);return 0<u?s.toString("utf8",c+4,c+4+u-1):""},ie=function(s,c){if(!Buffer.isBuffer(s))return Rl(s,c);var u=s.readUInt32LE(c);return 0<u?s.toString("utf8",c+4,c+4+u-1):""},je=function(s,c){if(!Buffer.isBuffer(s))return jl(s,c);var u=2*s.readUInt32LE(c);return s.toString("utf16le",c+4,c+4+u-1)},Ge=function(s,c){if(!Buffer.isBuffer(s))return Wc(s,c);var u=s.readUInt32LE(c);return s.toString("utf16le",c+4,c+4+u)},tt=function(s,c){if(!Buffer.isBuffer(s))return ih(s,c);var u=s.readUInt32LE(c);return s.toString("utf8",c+4,c+4+u)},Et=function(s,c){return Buffer.isBuffer(s)?s.readDoubleLE(c):Ol(s,c)},Ut=function(s){return Buffer.isBuffer(s)||Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array}),e!==void 0&&(yu=function(s,c,u){return e.utils.decode(1200,s.slice(c,u)).replace(Ce,"")},fc=function(s,c,u){return e.utils.decode(65001,s.slice(c,u))},j=function(s,c){var u=$r(s,c);return 0<u?e.utils.decode(m,s.slice(c+4,c+4+u-1)):""},ie=function(s,c){var u=$r(s,c);return 0<u?e.utils.decode(p,s.slice(c+4,c+4+u-1)):""},je=function(s,c){var u=2*$r(s,c);return 0<u?e.utils.decode(1200,s.slice(c+4,c+4+u-1)):""},Ge=function(s,c){var u=$r(s,c);return 0<u?e.utils.decode(1200,s.slice(c+4,c+4+u)):""},tt=function(s,c){var u=$r(s,c);return 0<u?e.utils.decode(65001,s.slice(c+4,c+4+u)):""});var wr=function(s,c){return s[c]},Cr=function(s,c){return 256*s[c+1]+s[c]},yn=function(s,c){return c=256*s[c+1]+s[c],c<32768?c:-1*(65535-c+1)},$r=function(s,c){return s[c+3]*(1<<24)+(s[c+2]<<16)+(s[c+1]<<8)+s[c]},On=function(s,c){return s[c+3]<<24|s[c+2]<<16|s[c+1]<<8|s[c]},bs=function(s,c){return s[c]<<24|s[c+1]<<16|s[c+2]<<8|s[c+3]};function Ja(s,c){var u,d,g,x,b,S,N="",T=[];switch(c){case"dbcs":if(S=this.l,xe&&Buffer.isBuffer(this))N=this.slice(this.l,this.l+2*s).toString("utf16le");else for(b=0;b<s;++b)N+=String.fromCharCode(Cr(this,S)),S+=2;s*=2;break;case"utf8":N=fc(this,this.l,this.l+s);break;case"utf16le":s*=2,N=yu(this,this.l,this.l+s);break;case"wstr":if(e===void 0)return Ja.call(this,s,"dbcs");N=e.utils.decode(p,this.slice(this.l,this.l+2*s)),s*=2;break;case"lpstr-ansi":N=j(this,this.l),s=4+$r(this,this.l);break;case"lpstr-cp":N=ie(this,this.l),s=4+$r(this,this.l);break;case"lpwstr":N=je(this,this.l),s=4+2*$r(this,this.l);break;case"lpp4":s=4+$r(this,this.l),N=Ge(this,this.l),2&s&&(s+=2);break;case"8lpp4":s=4+$r(this,this.l),N=tt(this,this.l),3&s&&(s+=4-(3&s));break;case"cstr":for(s=0,N="";(g=wr(this,this.l+s++))!==0;)T.push(q(g));N=T.join("");break;case"_wstr":for(s=0,N="";(g=Cr(this,this.l+s))!==0;)T.push(q(g)),s+=2;s+=2,N=T.join("");break;case"dbcs-cont":for(N="",S=this.l,b=0;b<s;++b){if(this.lens&&this.lens.indexOf(S)!==-1)return g=wr(this,S),this.l=S+1,x=Ja.call(this,s-b,g?"dbcs-cont":"sbcs-cont"),T.join("")+x;T.push(q(Cr(this,S))),S+=2}N=T.join(""),s*=2;break;case"cpstr":if(e!==void 0){N=e.utils.decode(p,this.slice(this.l,this.l+s));break}case"sbcs-cont":for(N="",S=this.l,b=0;b!=s;++b){if(this.lens&&this.lens.indexOf(S)!==-1)return g=wr(this,S),this.l=S+1,x=Ja.call(this,s-b,g?"dbcs-cont":"sbcs-cont"),T.join("")+x;T.push(q(wr(this,S))),S+=1}N=T.join("");break;default:switch(s){case 1:return u=wr(this,this.l),this.l++,u;case 2:return u=(c==="i"?yn:Cr)(this,this.l),this.l+=2,u;case 4:case-4:return c==="i"||(128&this[this.l+3])==0?(u=(0<s?On:bs)(this,this.l),this.l+=4,u):(d=$r(this,this.l),this.l+=4,d);case 8:case-8:if(c==="f")return d=s==8?Et(this,this.l):Et([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,d;s=8;case 16:N=Pl(this,this.l,s)}}return this.l+=s,N}var Ba=function(s,c,u){s[u]=255&c,s[u+1]=c>>>8&255,s[u+2]=c>>>16&255,s[u+3]=c>>>24&255},ei=function(s,c,u){s[u]=255&c,s[u+1]=c>>8&255,s[u+2]=c>>16&255,s[u+3]=c>>24&255},Ws=function(s,c,u){s[u]=255&c,s[u+1]=c>>>8&255};function Si(s,c,u){var d=0,g=0;if(u==="dbcs"){for(g=0;g!=c.length;++g)Ws(this,c.charCodeAt(g),this.l+2*g);d=2*c.length}else if(u==="sbcs"){if(e!==void 0&&m==874)for(g=0;g!=c.length;++g){var x=e.utils.encode(m,c.charAt(g));this[this.l+g]=x[0]}else for(c=c.replace(/[^\x00-\x7F]/g,"_"),g=0;g!=c.length;++g)this[this.l+g]=255&c.charCodeAt(g);d=c.length}else{if(u==="hex"){for(;g<s;++g)this[this.l++]=parseInt(c.slice(2*g,2*g+2),16)||0;return this}if(u==="utf16le"){for(var b=Math.min(this.l+s,this.length),g=0;g<Math.min(c.length,s);++g){var S=c.charCodeAt(g);this[this.l++]=255&S,this[this.l++]=S>>8}for(;this.l<b;)this[this.l++]=0;return this}switch(s){case 1:d=1,this[this.l]=255&c;break;case 2:d=2,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c;break;case 3:d=3,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c,c>>>=8,this[this.l+2]=255&c;break;case 4:d=4,Ba(this,c,this.l);break;case 8:if(d=8,u==="f"){(function(N,T,F){var O=(T<0||1/T==-1/0?1:0)<<7,L=0,B=0,ee=O?-T:T;isFinite(ee)?ee==0?L=B=0:(L=Math.floor(Math.log(ee)/Math.LN2),B=ee*Math.pow(2,52-L),L<=-1023&&(!isFinite(B)||B<Math.pow(2,52))?L=-1022:(B-=Math.pow(2,52),L+=1023)):(L=2047,B=isNaN(T)?26985:0);for(var G=0;G<=5;++G,B/=256)N[F+G]=255&B;N[F+6]=(15&L)<<4|15&B,N[F+7]=L>>4|O})(this,c,this.l);break}case 16:break;case-4:d=4,ei(this,c,this.l)}}return this.l+=d,this}function Ml(s,c){var u=Pl(this,this.l,s.length>>1);if(u!==s)throw new Error(c+"Expected "+s+" saw "+u);this.l+=s.length>>1}function Ra(s,c){s.l=c,s.read_shift=Ja,s.chk=Ml,s.write_shift=Si}function cs(s,c){s.l+=c}function xt(s){return s=De(s),Ra(s,0),s}function so(s,c,u){if(s){Ra(s,s.l||0);for(var d,g=s.length,x=0;s.l<g;){128&(x=s.read_shift(1))&&(x=(127&x)+((127&s.read_shift(1))<<7));for(var b,S=ad[x]||ad[65535],N=127&(b=s.read_shift(1)),T=1;T<4&&128&b;++T)N+=(127&(b=s.read_shift(1)))<<7*T;d=s.l+N;var F=S.f&&S.f(s,N,u);if(s.l=d,c(F,S,x))return}}}function xs(){function s(b){return Ra(b=xt(b),0),b}function c(){x&&(x.length>x.l&&((x=x.slice(0,x.l)).l=x.length),0<x.length&&d.push(x),x=null)}function u(b){return x&&b<x.length-x.l?x:(c(),x=s(Math.max(b+1,g)))}var d=[],g=xe?256:2048,x=s(g);return{next:u,push:function(b){c(),(x=b).l==null&&(x.l=x.length),u(g)},end:function(){return c(),Ae(d)},_bufs:d}}function jt(s,c,u,d){var g=+c;if(!isNaN(g)){c=1+(128<=g?1:0)+1,128<=(d=d||ad[g].p||(u||[]).length||0)&&++c,16384<=d&&++c,2097152<=d&&++c;var x=s.next(c);g<=127?x.write_shift(1,g):(x.write_shift(1,128+(127&g)),x.write_shift(1,g>>7));for(var b=0;b!=4;++b){if(!(128<=d)){x.write_shift(1,d);break}x.write_shift(1,128+(127&d)),d>>=7}0<d&&Ut(u)&&s.push(u)}}function bl(s,c,u){var d=jn(s);if(c.s?(d.cRel&&(d.c+=c.s.c),d.rRel&&(d.r+=c.s.r)):(d.cRel&&(d.c+=c.c),d.rRel&&(d.r+=c.r)),!u||u.biff<12){for(;256<=d.c;)d.c-=256;for(;65536<=d.r;)d.r-=65536}return d}function Ul(s,c,u){return s=jn(s),s.s=bl(s.s,c.s,u),s.e=bl(s.e,c.s,u),s}function Ns(s,c){if(s.cRel&&s.c<0)for(s=jn(s);s.c<0;)s.c+=8<c?16384:256;if(s.rRel&&s.r<0)for(s=jn(s);s.r<0;)s.r+=8<c?1048576:5<c?65536:16384;var u=sn(s);return s.cRel||s.cRel==null||(u=u.replace(/^([A-Z])/,"$$$1")),u=!s.rRel&&s.rRel!=null?u.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):u}function Bl(s,c){return s.s.r!=0||s.s.rRel||s.e.r!=(12<=c.biff?1048575:8<=c.biff?65536:16384)||s.e.rRel?s.s.c!=0||s.s.cRel||s.e.c!=(12<=c.biff?16383:255)||s.e.cRel?Ns(s.s,c.biff)+":"+Ns(s.e,c.biff):(s.s.rRel?"":"$")+ja(s.s.r)+":"+(s.e.rRel?"":"$")+ja(s.e.r):(s.s.cRel?"":"$")+Ln(s.s.c)+":"+(s.e.cRel?"":"$")+Ln(s.e.c)}function Hl(s){return parseInt(s.replace(/\$(\d+)$/,"$1"),10)-1}function ja(s){return""+(s+1)}function Qo(s){for(var c=s.replace(/^\$([A-Z])/,"$1"),u=0,d=0;d!==c.length;++d)u=26*u+c.charCodeAt(d)-64;return u-1}function Ln(s){if(s<0)throw new Error("invalid column "+s);var c="";for(++s;s;s=Math.floor((s-1)/26))c=String.fromCharCode((s-1)%26+65)+c;return c}function ga(s){for(var c=0,u=0,d=0;d<s.length;++d){var g=s.charCodeAt(d);48<=g&&g<=57?c=10*c+(g-48):65<=g&&g<=90&&(u=26*u+(g-64))}return{c:u-1,r:c-1}}function sn(s){for(var c=s.c+1,u="";c;c=(c-1)/26|0)u=String.fromCharCode((c-1)%26+65)+u;return u+(s.r+1)}function ti(s){var c=s.indexOf(":");return c==-1?{s:ga(s),e:ga(s)}:{s:ga(s.slice(0,c)),e:ga(s.slice(c+1))}}function rn(s,c){return c===void 0||typeof c=="number"?rn(s.s,s.e):(s=typeof s!="string"?sn(s):s)==(c=typeof c!="string"?sn(c):c)?s:s+":"+c}function wn(s){for(var c={s:{c:0,r:0},e:{c:0,r:0}},x=0,u=0,d=0,g=s.length,x=0;u<g&&!((d=s.charCodeAt(u)-64)<1||26<d);++u)x=26*x+d;for(c.s.c=--x,x=0;u<g&&!((d=s.charCodeAt(u)-48)<0||9<d);++u)x=10*x+d;if(c.s.r=--x,u===g||d!=10)return c.e.c=c.s.c,c.e.r=c.s.r,c;for(++u,x=0;u!=g&&!((d=s.charCodeAt(u)-64)<1||26<d);++u)x=26*x+d;for(c.e.c=--x,x=0;u!=g&&!((d=s.charCodeAt(u)-48)<0||9<d);++u)x=10*x+d;return c.e.r=--x,c}function pc(s,c){var u=s.t=="d"&&c instanceof Date;if(s.z!=null)try{return s.w=xr(s.z,u?pa(c):c)}catch{}try{return s.w=xr((s.XF||{}).numFmtId||(u?14:0),u?pa(c):c)}catch{return""+c}}function io(s,c,u){return s==null||s.t==null||s.t=="z"?"":s.w!==void 0?s.w:(s.t=="d"&&!s.z&&u&&u.dateNF&&(s.z=u.dateNF),s.t=="e"?Zi[s.v]||s.v:pc(s,c??s.v))}function oi(s,d){var u=d&&d.sheet?d.sheet:"Sheet1",d={};return d[u]=s,{SheetNames:[u],Sheets:d}}function mc(s,c,u){var d=u||{},g=s?Array.isArray(s):d.dense,x=s||(g?[]:{}),b=0,S=0;x&&d.origin!=null&&(typeof d.origin=="number"?b=d.origin:(b=(N=typeof d.origin=="string"?ga(d.origin):d.origin).r,S=N.c),x["!ref"]||(x["!ref"]="A1:A1"));var N,T={s:{c:1e7,r:1e7},e:{c:0,r:0}};x["!ref"]&&(N=wn(x["!ref"]),T.s.c=N.s.c,T.s.r=N.s.r,T.e.c=Math.max(T.e.c,N.e.c),T.e.r=Math.max(T.e.r,N.e.r),b==-1&&(T.e.r=b=N.e.r+1));for(var F=0;F!=c.length;++F)if(c[F]){if(!Array.isArray(c[F]))throw new Error("aoa_to_sheet expects an array of arrays");for(var O=0;O!=c[F].length;++O)if(c[F][O]!==void 0){var L={v:c[F][O]},B=b+F,ee=S+O;if(T.s.r>B&&(T.s.r=B),T.s.c>ee&&(T.s.c=ee),T.e.r<B&&(T.e.r=B),T.e.c<ee&&(T.e.c=ee),!c[F][O]||typeof c[F][O]!="object"||Array.isArray(c[F][O])||c[F][O]instanceof Date)if(Array.isArray(L.v)&&(L.f=c[F][O][1],L.v=L.v[0]),L.v===null)if(L.f)L.t="n";else if(d.nullError)L.t="e",L.v=0;else{if(!d.sheetStubs)continue;L.t="z"}else typeof L.v=="number"?L.t="n":typeof L.v=="boolean"?L.t="b":L.v instanceof Date?(L.z=d.dateNF||se[14],d.cellDates?(L.t="d",L.w=xr(L.z,pa(L.v))):(L.t="n",L.v=pa(L.v),L.w=xr(L.z,L.v))):L.t="s";else L=c[F][O];g?(x[B]||(x[B]=[]),x[B][ee]&&x[B][ee].z&&(L.z=x[B][ee].z),x[B][ee]=L):(x[B=sn({c:ee,r:B})]&&x[B].z&&(L.z=x[B].z),x[B]=L)}}return T.s.c<1e7&&(x["!ref"]=rn(T)),x}function ri(s,c){return mc(null,s,c)}function Qa(s,c){return(c=c||xt(4)).write_shift(4,s),c}function Xa(s){var c=s.read_shift(4);return c===0?"":s.read_shift(c,"dbcs")}function Oa(s,c){var u=!1;return c==null&&(u=!0,c=xt(4+2*s.length)),c.write_shift(4,s.length),0<s.length&&c.write_shift(0,s,"dbcs"),u?c.slice(0,c.l):c}function xl(s,c){var u,d=s.l,g=s.read_shift(1),b=Xa(s),x=[],b={t:b,h:b};if((1&g)!=0){for(var S=s.read_shift(4),N=0;N!=S;++N)x.push({ich:(u=s).read_shift(2),ifnt:u.read_shift(2)});b.r=x}else b.r=[{ich:0,ifnt:0}];return s.l=d+c,b}var oh=xl;function lh(s,c){var u,d=!1;return c==null&&(d=!0,c=xt(23+4*s.t.length)),c.write_shift(1,1),Oa(s.t,c),c.write_shift(4,1),u={ich:0,ifnt:0},(s=(s=c)||xt(4)).write_shift(2,u.ich||0),s.write_shift(2,u.ifnt||0),d?c.slice(0,c.l):c}function ca(s){var c=s.read_shift(4),u=s.read_shift(2);return u+=s.read_shift(1)<<16,s.l++,{c,iStyleRef:u}}function zl(s,c){return(c=c??xt(8)).write_shift(-4,s.c),c.write_shift(3,s.iStyleRef||s.s),c.write_shift(1,0),c}function Bi(s){var c=s.read_shift(2);return c+=s.read_shift(1)<<16,s.l++,{c:-1,iStyleRef:c}}function Hi(s,c){return(c=c??xt(4)).write_shift(3,s.iStyleRef||s.s),c.write_shift(1,0),c}var Ai=Xa,$l=Oa;function Kc(s){var c=s.read_shift(4);return c===0||c===4294967295?"":s.read_shift(c,"dbcs")}function gc(s,c){var u=!1;return c==null&&(u=!0,c=xt(127)),c.write_shift(4,0<s.length?s.length:4294967295),0<s.length&&c.write_shift(0,s,"dbcs"),u?c.slice(0,c.l):c}var yc=Xa,wl=Kc,Xo=gc;function vc(s){var c=s.slice(s.l,s.l+4),u=1&c[0],d=2&c[0];return s.l+=4,c=d==0?Et([0,0,0,0,252&c[0],c[1],c[2],c[3]],0):On(c,0)>>2,u?c/100:c}function oo(s,c){c==null&&(c=xt(4));var u=0,d=0,g=100*s;if(s==(0|s)&&-536870912<=s&&s<1<<29?d=1:g==(0|g)&&-536870912<=g&&g<1<<29&&(u=d=1),!d)throw new Error("unsupported RkNumber "+s);c.write_shift(-4,((u?g:s)<<2)+(u+2))}function ql(s){var c={s:{},e:{}};return c.s.r=s.read_shift(4),c.e.r=s.read_shift(4),c.s.c=s.read_shift(4),c.e.c=s.read_shift(4),c}var Ts=ql,Ci=function(s,c){return(c=c||xt(16)).write_shift(4,s.s.r),c.write_shift(4,s.e.r),c.write_shift(4,s.s.c),c.write_shift(4,s.e.c),c};function Sn(s){if(s.length-s.l<8)throw"XLS Xnum Buffer underflow";return s.read_shift(8,"f")}function Un(s,c){return(c||xt(8)).write_shift(8,s,"f")}function Ca(s,c){if(c=c||xt(8),!s||s.auto)return c.write_shift(4,0),c.write_shift(4,0),c;s.index!=null?(c.write_shift(1,2),c.write_shift(1,s.index)):s.theme!=null?(c.write_shift(1,6),c.write_shift(1,s.theme)):(c.write_shift(1,5),c.write_shift(1,0));var u=s.tint||0;return 0<u?u*=32767:u<0&&(u*=32768),c.write_shift(2,u),s.rgb&&s.theme==null?(typeof(s=s.rgb||"FFFFFF")=="number"&&(s=("000000"+s.toString(16)).slice(-6)),c.write_shift(1,parseInt(s.slice(0,2),16)),c.write_shift(1,parseInt(s.slice(2,4),16)),c.write_shift(1,parseInt(s.slice(4,6),16)),c.write_shift(1,255)):(c.write_shift(2,0),c.write_shift(1,0),c.write_shift(1,0)),c}function Es(s,c){var u=s.read_shift(4);switch(u){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[s.read_shift(4)]||""}if(400<u)throw new Error("Unsupported Clipboard: "+u.toString(16));return s.l-=4,s.read_shift(0,c==1?"lpstr":"lpwstr")}var Zo=2,us=3,Yc=12,ch=81,If=[80,ch],_d={1:{n:"CodePage",t:Zo},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:us},5:{n:"LineCount",t:us},6:{n:"ParagraphCount",t:us},7:{n:"SlideCount",t:us},8:{n:"NoteCount",t:us},9:{n:"HiddenCount",t:us},10:{n:"MultimediaClipCount",t:us},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:us},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:us,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Id={1:{n:"CodePage",t:Zo},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:us},15:{n:"WordCount",t:us},16:{n:"CharCount",t:us},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:us},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Df={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Ff=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],vu=jn([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(s){return[s>>16&255,s>>8&255,255&s]})),Zi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},No={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},bu={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},zi={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bc(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Uh(s,c){var u,d=(function(N){for(var T=[],F=fa(N),O=0;O!==F.length;++O)T[N[F[O]]]==null&&(T[N[F[O]]]=[]),T[N[F[O]]].push(F[O]);return T})(bu),g=[];g[g.length]=is,g[g.length]=Xt("Types",null,{xmlns:ls.CT,"xmlns:xsd":ls.xsd,"xmlns:xsi":ls.xsi}),g=g.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(N){return Xt("Default",null,{Extension:N[0],ContentType:N[1]})}));function x(N){s[N]&&0<s[N].length&&(u=s[N][0],g[g.length]=Xt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:zi[N][c.bookType]||zi[N].xlsx}))}function b(N){(s[N]||[]).forEach(function(T){g[g.length]=Xt("Override",null,{PartName:(T[0]=="/"?"":"/")+T,ContentType:zi[N][c.bookType]||zi[N].xlsx})})}function S(N){(s[N]||[]).forEach(function(T){g[g.length]=Xt("Override",null,{PartName:(T[0]=="/"?"":"/")+T,ContentType:d[N][0]})})}return x("workbooks"),b("sheets"),b("charts"),S("themes"),["strs","styles"].forEach(x),["coreprops","extprops","custprops"].forEach(S),S("vba"),S("comments"),S("threadedcomments"),S("drawings"),b("metadata"),S("people"),2<g.length&&(g[g.length]="</Types>",g[1]=g[1].replace("/>",">")),g.join("")}var Cn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xc(s){var c=s.lastIndexOf("/");return s.slice(0,c+1)+"_rels/"+s.slice(c+1)+".rels"}function Jc(s,c){var u={"!id":{}};if(!s)return u;c.charAt(0)!=="/"&&(c="/"+c);var d={};return(s.match(os)||[]).forEach(function(g){var x,b=ln(g);b[0]==="<Relationship"&&((x={}).Type=b.Type,x.Target=b.Target,x.Id=b.Id,b.TargetMode&&(x.TargetMode=b.TargetMode),g=b.TargetMode==="External"?b.Target:hc(b.Target,c),u[g]=x,d[b.Id]=x)}),u["!id"]=d,u}function lo(s){var c=[is,Xt("Relationships",null,{xmlns:ls.RELS})];return fa(s["!id"]).forEach(function(u){c[c.length]=Xt("Relationship",null,s["!id"][u])}),2<c.length&&(c[c.length]="</Relationships>",c[1]=c[1].replace("/>",">")),c.join("")}function sa(s,c,u,d,g,x){if(g=g||{},s["!id"]||(s["!id"]={}),s["!idx"]||(s["!idx"]=1),c<0)for(c=s["!idx"];s["!id"]["rId"+c];++c);if(s["!idx"]=c+1,g.Id="rId"+c,g.Type=d,g.Target=u,-1<[Cn.HLINK,Cn.XPATH,Cn.XMISS].indexOf(g.Type)&&(g.TargetMode="External"),s["!id"][g.Id])throw new Error("Cannot rewrite rId "+c);return s["!id"][g.Id]=g,s[("/"+g.Target).replace("//","/")]=g,c}var $i="application/vnd.oasis.opendocument.spreadsheet";function li(s,c,u){return['  <rdf:Description rdf:about="'+s+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(u||"odf")+"#"+c+`"/>
`,`  </rdf:Description>
`].join("")}function Bh(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+n.version+"</meta:generator></office:meta></office:document-meta>"}var La=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Dd=(function(){for(var s=new Array(La.length),c=0;c<La.length;++c){var u=La[c],u="(?:"+u[0].slice(0,u[0].indexOf(":"))+":)"+u[0].slice(u[0].indexOf(":")+1);s[c]=new RegExp("<"+u+"[^>]*>([\\s\\S]*?)</"+u+">")}return s})();function To(s){var c={};s=Xn(s);for(var u=0;u<La.length;++u){var d=La[u],g=s.match(Dd[u]);g!=null&&0<g.length&&(c[d[1]]=cn(g[1])),d[2]==="date"&&c[d[1]]&&(c[d[1]]=vn(c[d[1]]))}return c}function xu(s,c,u,d,g){g[s]==null&&c!=null&&c!==""&&(c=aa(g[s]=c),d[d.length]=u?Xt(s,c,u):vs(s,c))}function wu(s,c){var u=c||{},d=[is,Xt("cp:coreProperties",null,{"xmlns:cp":ls.CORE_PROPS,"xmlns:dc":ls.dc,"xmlns:dcterms":ls.dcterms,"xmlns:dcmitype":ls.dcmitype,"xmlns:xsi":ls.xsi})],g={};if(!s&&!u.Props)return d.join("");s&&(s.CreatedDate!=null&&xu("dcterms:created",typeof s.CreatedDate=="string"?s.CreatedDate:Yo(s.CreatedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},d,g),s.ModifiedDate!=null&&xu("dcterms:modified",typeof s.ModifiedDate=="string"?s.ModifiedDate:Yo(s.ModifiedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},d,g));for(var x=0;x!=La.length;++x){var b=La[x],S=u.Props&&u.Props[b[1]]!=null?u.Props[b[1]]:s?s[b[1]]:null;S===!0?S="1":S===!1?S="0":typeof S=="number"&&(S=String(S)),S!=null&&xu(b[0],S,null,d,g)}return 2<d.length&&(d[d.length]="</cp:coreProperties>",d[1]=d[1].replace("/>",">")),d.join("")}var co=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],uh=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Hh(s,c,u,d){var g=[];if(typeof s=="string")g=ii(s,d);else for(var x=0;x<s.length;++x)g=g.concat(s[x].map(function(F){return{v:F}}));var b,S=typeof c=="string"?ii(c,d).map(function(F){return F.v}):c,N=0;if(0<S.length)for(var T=0;T!==g.length;T+=2){switch(b=+g[T+1].v,g[T].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":u.Worksheets=b,u.SheetNames=S.slice(N,N+b);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":u.NamedRanges=b,u.DefinedNames=S.slice(N,N+b);break;case"Charts":case"Diagramme":u.Chartsheets=b,u.ChartNames=S.slice(N,N+b)}N+=b}}function Su(s){var c=[],u=Xt;return(s=s||{}).Application="SheetJS",c[c.length]=is,c[c.length]=Xt("Properties",null,{xmlns:ls.EXT_PROPS,"xmlns:vt":ls.vt}),co.forEach(function(d){if(s[d[1]]!==void 0){var g;switch(d[2]){case"string":g=aa(String(s[d[1]]));break;case"bool":g=s[d[1]]?"true":"false"}g!==void 0&&(c[c.length]=u(d[0],g))}}),c[c.length]=u("HeadingPairs",u("vt:vector",u("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+u("vt:variant",u("vt:i4",String(s.Worksheets))),{size:2,baseType:"variant"})),c[c.length]=u("TitlesOfParts",u("vt:vector",s.SheetNames.map(function(d){return"<vt:lpstr>"+aa(d)+"</vt:lpstr>"}).join(""),{size:s.Worksheets,baseType:"lpstr"})),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var Fd=/<[^>]+>[^<]*/g;function Eo(s){var c=[is,Xt("Properties",null,{xmlns:ls.CUST_PROPS,"xmlns:vt":ls.vt})];if(!s)return c.join("");var u=1;return fa(s).forEach(function(d){++u,c[c.length]=Xt("property",(function(g,x){switch(typeof g){case"string":var b=Xt("vt:lpwstr",aa(g));return b=b.replace(/&quot;/g,"_x0022_");case"number":return Xt((0|g)==g?"vt:i4":"vt:r8",aa(String(g)));case"boolean":return Xt("vt:bool",g?"true":"false")}if(g instanceof Date)return Xt("vt:filetime",Yo(g));throw new Error("Unable to serialize "+g)})(s[d]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:u,name:aa(d)})}),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var Au,wc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function hh(u){var c=u.read_shift(4),u=u.read_shift(4);return new Date(1e3*(u/1e7*Math.pow(2,32)+c/1e7-11644473600)).toISOString().replace(/\.000/,"")}function dh(s,c,u){var d=s.l,g=s.read_shift(0,"lpstr-cp");if(u)for(;s.l-d&3;)++s.l;return g}function ko(s,c,u){var d=s.read_shift(0,"lpwstr");return d}function _o(s,c,u){return c===31?ko(s):dh(s,0,u)}function Sc(s,c,u){return _o(s,c,u===!1?0:4)}function el(s){for(var c,u,d,g=s.read_shift(4),x=[],b=0;b<g/2;++b)x.push((d=u=void 0,u=(c=s).l,d=zh(c,ch),c[c.l]==0&&c[c.l+1]==0&&c.l-u&2&&(c.l+=2),[d,zh(c,us)]));return x}function Io(s,c){for(var u=s.read_shift(4),d={},g=0;g!=u;++g){var x=s.read_shift(4),b=s.read_shift(4);d[x]=s.read_shift(b,c===1200?"utf16le":"utf8").replace(Ce,"").replace(Be,"!"),c===1200&&b%2&&(s.l+=2)}return 3&s.l&&(s.l=s.l>>3<<2),d}function uo(s){var c=s.read_shift(4),u=s.slice(s.l,s.l+c);return s.l+=c,0<(3&c)&&(s.l+=4-(3&c)&3),u}function zh(s,c,u){var d,g,x=s.read_shift(2),b=u||{};if(s.l+=2,c!==Yc&&x!==c&&If.indexOf(c)===-1&&((65534&c)!=4126||(65534&x)!=4126))throw new Error("Expected type "+c+" saw "+x);switch(c===Yc?x:c){case 2:return d=s.read_shift(2,"i"),b.raw||(s.l+=2),d;case 3:return d=s.read_shift(4,"i");case 11:return s.read_shift(4)!==0;case 19:return d=s.read_shift(4);case 30:return dh(s,0,4).replace(Ce,"");case 31:return ko(s);case 64:return hh(s);case 65:return uo(s);case 71:return(g={}).Size=(d=s).read_shift(4),d.l+=g.Size+3-(g.Size-1)%4,g;case 80:return Sc(s,x,!b.raw).replace(Ce,"");case 81:return(function(S,N){if(!N)throw new Error("VtUnalignedString must have positive length");return _o(S,N,0)})(s,x).replace(Ce,"");case 4108:return el(s);case 4126:case 4127:return(x==4127?function(S){for(var N=S.read_shift(4),T=[],F=0;F!=N;++F){var O=S.l;T[F]=S.read_shift(0,"lpwstr").replace(Ce,""),S.l-O&2&&(S.l+=2)}return T}:function(S){for(var N=S.read_shift(4),T=[],F=0;F!=N;++F)T[F]=S.read_shift(0,"lpstr-cp").replace(Ce,"");return T})(s);default:throw new Error("TypedPropertyValue unrecognized type "+c+" "+x)}}function Rd(s,c){var u,d,g,x=xt(4),b=xt(4);switch(x.write_shift(4,s==80?31:s),s){case 3:b.write_shift(-4,c);break;case 5:(b=xt(8)).write_shift(8,c,"f");break;case 11:b.write_shift(4,c?1:0);break;case 64:d=(typeof(u=c)=="string"?new Date(Date.parse(u)):u).getTime()/1e3+11644473600,g=d%Math.pow(2,32),u=(d-g)/Math.pow(2,32),u*=1e7,0<(d=(g*=1e7)/Math.pow(2,32)|0)&&(g%=Math.pow(2,32),u+=d),(d=xt(8)).write_shift(4,g),d.write_shift(4,u),b=d;break;case 31:case 80:for((b=xt(4+2*(c.length+1)+(c.length%2?0:2))).write_shift(4,c.length+1),b.write_shift(0,c,"dbcs");b.l!=b.length;)b.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+c)}return Ae([x,b])}function $h(s,c){for(var u=s.l,d=s.read_shift(4),g=s.read_shift(4),x=[],T=0,b=0,S=-1,N={},T=0;T!=g;++T){var F=s.read_shift(4),O=s.read_shift(4);x[T]=[F,O+u]}x.sort(function(ne,J){return ne[1]-J[1]});var L={};for(T=0;T!=g;++T){if(s.l!==x[T][1]){var B=!0;if(0<T&&c)switch(c[x[T-1][0]].t){case 2:s.l+2===x[T][1]&&(s.l+=2,B=!1);break;case 80:case 4108:s.l<=x[T][1]&&(s.l=x[T][1],B=!1)}if((!c||T==0)&&s.l<=x[T][1]&&(B=!1,s.l=x[T][1]),B)throw new Error("Read Error: Expected address "+x[T][1]+" at "+s.l+" :"+T)}if(c){var ee=c[x[T][0]];if(L[ee.n]=zh(s,ee.t,{raw:!0}),ee.p==="version"&&(L[ee.n]=String(L[ee.n]>>16)+"."+("0000"+String(65535&L[ee.n])).slice(-4)),ee.n=="CodePage")switch(L[ee.n]){case 0:L[ee.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:I(b=L[ee.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+L[ee.n])}}else if(x[T][0]===1)b=L.CodePage=zh(s,Zo),I(b),S!==-1&&(he=s.l,s.l=x[S][1],N=Io(s,b),s.l=he);else if(x[T][0]===0)b!==0?N=Io(s,b):(S=T,s.l=x[T+1][1]);else{var G,he=N[x[T][0]];switch(s[s.l]){case 65:s.l+=4,G=uo(s);break;case 30:case 31:s.l+=4,G=Sc(s,s[s.l-4]).replace(/\u0000+$/,"");break;case 3:s.l+=4,G=s.read_shift(4,"i");break;case 19:s.l+=4,G=s.read_shift(4);break;case 5:s.l+=4,G=s.read_shift(8,"f");break;case 11:s.l+=4,G=_n(s,4);break;case 64:s.l+=4,G=vn(hh(s));break;default:throw new Error("unparsed value: "+s[s.l])}L[he]=G}}return s.l=u+d,L}var Rf=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ci(s,c,u){var d,g,x,b,S=xt(8),N=[],T=[],F=8,O=0,L=xt(8),B=xt(8);if(L.write_shift(4,2),L.write_shift(4,1200),B.write_shift(4,1),T.push(L),N.push(B),F+=8+L.length,!c){(B=xt(8)).write_shift(4,0),N.unshift(B);var ee=[xt(4)];for(ee[0].write_shift(4,s.length),O=0;O<s.length;++O){var G=s[O][0];for((L=xt(8+2*(G.length+1)+(G.length%2?0:2))).write_shift(4,O+2),L.write_shift(4,G.length+1),L.write_shift(0,G,"dbcs");L.l!=L.length;)L.write_shift(1,0);ee.push(L)}L=Ae(ee),T.unshift(L),F+=8+L.length}for(O=0;O<s.length;++O)c&&!c[s[O][0]]||-1<Rf.indexOf(s[O][0])||-1<uh.indexOf(s[O][0])||s[O][1]!=null&&(x=s[O][1],d=0,L=c?((b=u[d=+c[s[O][0]]]).p=="version"&&typeof x=="string"&&(x=(+(g=x.split("."))[0]<<16)+(+g[1]||0)),Rd(b.t,x)):((b=(function(ne){switch(typeof ne){case"boolean":return 11;case"number":return(0|ne)==ne?3:5;case"string":return 31;case"object":if(ne instanceof Date)return 64}return-1})(x))==-1&&(b=31,x=String(x)),Rd(b,x)),T.push(L),(B=xt(8)).write_shift(4,c?d:2+O),N.push(B),F+=8+L.length);for(var he=8*(T.length+1),O=0;O<T.length;++O)N[O].write_shift(4,he),he+=T[O].length;return S.write_shift(4,F),S.write_shift(4,T.length),Ae([S].concat(N).concat(T))}function Ha(s,c,u){var d=s.content;if(!d)return{};Ra(d,0);var g,x=0;d.chk("feff","Byte Order: "),d.read_shift(2);var b=d.read_shift(4),S=d.read_shift(16);if(S!==Jt.utils.consts.HEADER_CLSID&&S!==u)throw new Error("Bad PropertySet CLSID "+S);if((s=d.read_shift(4))!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(u=d.read_shift(16),S=d.read_shift(4),s===1&&S!==d.l)throw new Error("Length mismatch: "+S+" !== "+d.l);s===2&&(g=d.read_shift(16),x=d.read_shift(4));var N,T,F=$h(d,c),O={SystemIdentifier:b};for(N in F)O[N]=F[N];if(O.FMTID=u,s===1)return O;if(x-d.l==2&&(d.l+=2),d.l!==x)throw new Error("Length mismatch 2: "+d.l+" !== "+x);try{T=$h(d,null)}catch{}for(N in T)O[N]=T[N];return O.FMTID=[u,g],O}function Gn(s,c,u,d,g,x){var b=xt(g?68:48),S=[b];return b.write_shift(2,65534),b.write_shift(2,0),b.write_shift(4,842412599),b.write_shift(16,Jt.utils.consts.HEADER_CLSID,"hex"),b.write_shift(4,g?2:1),b.write_shift(16,c,"hex"),b.write_shift(4,g?68:48),d=ci(s,u,d),S.push(d),g&&(g=ci(g,null,null),b.write_shift(16,x,"hex"),b.write_shift(4,68+d.length),S.push(g)),Ae(S)}function ks(s,c){return s.read_shift(c),null}function _n(s,c){return s.read_shift(c)===1}function Za(s,c){return(c=c||xt(2)).write_shift(2,+!!s),c}function Pa(s){return s.read_shift(2,"u")}function ho(s,c){return(c=c||xt(2)).write_shift(2,s),c}function Gl(s,c){return(function(u,d,g){for(var x=[],b=u.l+d;u.l<b;)x.push(g(u,b-u.l));if(b!==u.l)throw new Error("Slurp error");return x})(s,c,Pa)}function ui(s,c,u){return(u=u||xt(2)).write_shift(1,c=="e"?+s:+!!s),u.write_shift(1,c=="e"?1:0),u}function Sl(s,c,u){var d=s.read_shift(u&&12<=u.biff?2:1),g="sbcs-cont",x=p;return u&&8<=u.biff&&(p=1200),u&&u.biff!=8?u.biff==12&&(g="wstr"):s.read_shift(1)&&(g="dbcs-cont"),2<=u.biff&&u.biff<=5&&(g="cpstr"),g=d?s.read_shift(d,g):"",p=x,g}function Ac(s,c,u){if(u){if(2<=u.biff&&u.biff<=5)return s.read_shift(c,"cpstr");if(12<=u.biff)return s.read_shift(c,"dbcs-cont")}return s.read_shift(1)===0?s.read_shift(c,"sbcs-cont"):s.read_shift(c,"dbcs-cont")}function Vl(s,c,u){var d=s.read_shift(u&&u.biff==2?1:2);return d===0?(s.l++,""):Ac(s,d,u)}function Wl(s,c,u){if(5<u.biff)return Vl(s,0,u);var d=s.read_shift(1);return d===0?(s.l++,""):s.read_shift(d,u.biff<=4||!s.lens?"cpstr":"sbcs-cont")}function Cc(s,c,u){return(u=u||xt(3+2*s.length)).write_shift(2,s.length),u.write_shift(1,1),u.write_shift(31,s,"utf16le"),u}function Kl(s){var c,u,d,g,x=s.read_shift(16);switch(x){case"e0c9ea79f9bace118c8200aa004ba90b":return u=(c=s).read_shift(4),d=c.l,g=!1,24<u&&(c.l+=u-24,c.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(g=!0),c.l=d),u=c.read_shift((g?u-24:u)>>1,"utf16le").replace(Ce,""),g&&(c.l+=24),u;case"0303000000000000c000000000000046":return(function(b){for(var S=b.read_shift(2),N="";0<S--;)N+="../";var T=b.read_shift(0,"lpstr-ansi");if(b.l+=2,b.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(b.read_shift(4)===0)return N+T.replace(/\\/g,"/");if(T=b.read_shift(4),b.read_shift(2)!=3)throw new Error("Bad FileMoniker");return N+b.read_shift(T>>1,"utf16le").replace(Ce,"")})(s);default:throw new Error("Unsupported Moniker "+x)}}function Al(s){var c=s.read_shift(4);return 0<c?s.read_shift(c,"utf16le").replace(Ce,""):""}function Do(s,c){(c=c||xt(6+2*s.length)).write_shift(4,1+s.length);for(var u=0;u<s.length;++u)c.write_shift(2,s.charCodeAt(u));return c.write_shift(2,0),c}function Cu(s){return[s.read_shift(1),s.read_shift(1),s.read_shift(1),s.read_shift(1)]}function Qc(s){return s=Cu(s),s[3]=0,s}function Ni(s){return{r:s.read_shift(2),c:s.read_shift(2),ixfe:s.read_shift(2)}}function Yl(s,c,u,d){return(d=d||xt(6)).write_shift(2,s),d.write_shift(2,c),d.write_shift(2,u||0),d}function Nc(s){return[s.read_shift(2),vc(s)]}function Ks(s){var c=s.read_shift(2),u=s.read_shift(2);return{s:{c:s.read_shift(2),r:c},e:{c:s.read_shift(2),r:u}}}function qh(s,c){return(c=c||xt(8)).write_shift(2,s.s.r),c.write_shift(2,s.e.r),c.write_shift(2,s.s.c),c.write_shift(2,s.e.c),c}function jf(s){var c=s.read_shift(2),u=s.read_shift(2);return{s:{c:s.read_shift(1),r:c},e:{c:s.read_shift(1),r:u}}}var bp=jf;function U0(s){s.l+=4;var c=s.read_shift(2),u=s.read_shift(2),d=s.read_shift(2);return s.l+=12,[u,c,d]}function qi(s){s.l+=2,s.l+=s.read_shift(2)}var Hs={0:qi,4:qi,5:qi,6:qi,7:function(s){return s.l+=4,s.cf=s.read_shift(2),{}},8:qi,9:qi,10:qi,11:qi,12:qi,13:function(s){var c={};return s.l+=4,s.l+=16,c.fSharedNote=s.read_shift(2),s.l+=4,c},14:qi,15:qi,16:qi,17:qi,18:qi,19:qi,20:qi,21:U0};function Tc(s,c){var u={BIFFVer:0,dt:0};switch(u.BIFFVer=s.read_shift(2),2<=(c-=2)&&(u.dt=s.read_shift(2),s.l-=2),u.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<c)throw new Error("Unexpected BIFF Ver "+u.BIFFVer)}return s.read_shift(c),u}function Nu(s,c,u){var d=1536,g=16;switch(u.bookType){case"biff8":break;case"biff5":d=1280,g=8;break;case"biff4":d=4,g=6;break;case"biff3":d=3,g=6;break;case"biff2":d=2,g=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return u=xt(g),u.write_shift(2,d),u.write_shift(2,c),4<g&&u.write_shift(2,29282),6<g&&u.write_shift(2,1997),8<g&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function Gh(s){var c=xt(8);c.write_shift(4,s.Count),c.write_shift(4,s.Unique);for(var u,d,g,x=[],b=0;b<s.length;++b)x[b]=(u=s[b],g=d=void 0,d=u.t||"",(g=xt(3)).write_shift(2,d.length),g.write_shift(1,1),(u=xt(2*d.length)).write_shift(2*d.length,d,"utf16le"),Ae([g,u]));var S=Ae([c].concat(x));return S.parts=[c.length].concat(x.map(function(N){return N.length})),S}function Vh(s,c,u){var d=0;return u&&u.biff==2||(d=s.read_shift(2)),s=s.read_shift(2),u&&u.biff==2&&(d=1-(s>>15),s&=32767),[{Unsynced:1&d,DyZero:(2&d)>>1,ExAsc:(4&d)>>2,ExDsc:(8&d)>>3},s]}var Ch=Wl;function C(s,x,b){var d=s.l+x,S=b.biff!=8&&b.biff?2:4,g=s.read_shift(S),x=s.read_shift(S),b=s.read_shift(2),S=s.read_shift(2);return s.l=d,{s:{r:g,c:b},e:{r:x,c:S}}}function _(s,c,u,d){return u=u&&u.biff==5,(d=d||xt(u?16:20)).write_shift(2,0),s.style?(d.write_shift(2,s.numFmtId||0),d.write_shift(2,65524)):(d.write_shift(2,s.numFmtId||0),d.write_shift(2,c<<4)),c=0,0<s.numFmtId&&u&&(c|=1024),d.write_shift(4,c),d.write_shift(4,0),u||d.write_shift(4,0),d.write_shift(2,0),d}function P(s,c,u){var d=Ni(s);return u.biff!=2&&c!=9||++s.l,s=(c=s).read_shift(1),s=c.read_shift(1)===1?s:s===1,d.val=s,d.t=s===!0||s===!1?"b":"e",d}function Y(s,c,u){return c===0?"":Wl(s,0,u)}function oe(s,c,u){var d,g=s.read_shift(2),g={fBuiltIn:1&g,fWantAdvise:g>>>1&1,fWantPict:g>>>2&1,fOle:g>>>3&1,fOleLink:g>>>4&1,cf:g>>>5&1023,fIcon:g>>>15&1};return u.sbcch===14849&&(d=(function(x,T,S){x.l+=4,T-=4;var N=x.l+T,T=Sl(x,0,S);if((S=x.read_shift(2))!==(N-=x.l))throw new Error("Malformed AddinUdf: padding = "+N+" != "+S);return x.l+=S,T})(s,c-2,u)),g.body=d||s.read_shift(c-2),typeof d=="string"&&(g.Name=d),g}var fe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ge(s,N,u){var d=s.l+N,g=s.read_shift(2),x=s.read_shift(1),b=s.read_shift(1),S=s.read_shift(u&&u.biff==2?1:2),N=0;return(!u||5<=u.biff)&&(u.biff!=5&&(s.l+=2),N=s.read_shift(2),u.biff==5&&(s.l+=2),s.l+=4),b=Ac(s,b,u),32&g&&(b=fe[b.charCodeAt(0)]),g=d-s.l,u&&u.biff==2&&--g,{chKey:x,Name:b,itab:N,rgce:d!=s.l&&S!==0&&0<g?(function(T,ee,O,G){var B,ee=T.l+ee,G=Jf(T,G,O);return ee!==T.l&&(B=td(T,ee-T.l,G,O)),[G,B]})(s,g,u,S):[]}}function Se(s,c,u){if(u.biff<8)return(function(S,N){return S[S.l+1]==3&&S[S.l]++,N=Sl(S,0,N),N.charCodeAt(0)==3?N.slice(1):N})(s,u);for(var d,g,x=[],c=s.l+c,b=s.read_shift(8<u.biff?4:2);b--!=0;)x.push((d=s,u.biff,g=8<(g=u).biff?4:2,[d.read_shift(g),d.read_shift(g,"i"),d.read_shift(g,"i")]));if(s.l!=c)throw new Error("Bad ExternSheet: "+s.l+" != "+c);return x}function Ne(s,c,u){var d=bp(s);switch(u.biff){case 2:s.l++,c-=7;break;case 3:case 4:s.l+=2,c-=8;break;default:s.l+=6,c-=12}return[d,(function(g,x,b){var S,N=g.l+x,T=b.biff==2?1:2,F=g.read_shift(T);if(F==65535)return[[],cs(g,x-2)];var O=Jf(g,F,b);return x!==F+T&&(S=td(g,x-F-T,O,b)),g.l=N,[O,S]})(s,c,u)]}var Re={8:function(s,c){var u=s.l+c;s.l+=10;var d=s.read_shift(2);return s.l+=4,s.l+=2,s.l+=2,s.l+=2,s.l+=4,c=s.read_shift(1),s.l+=c,s.l=u,{fmt:d}}};function Ke(s){var c=xt(24),u=ga(s[0]);c.write_shift(2,u.r),c.write_shift(2,u.r),c.write_shift(2,u.c),c.write_shift(2,u.c);for(var d="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),g=0;g<16;++g)c.write_shift(1,parseInt(d[g],16));return Ae([c,(function(x){var b=xt(512),S=0,N=x.Target,T=-1<(x=(N=N.slice(0,7)=="file://"?N.slice(7):N).indexOf("#"))?31:23;switch(N.charAt(0)){case"#":T=28;break;case".":T&=-3}b.write_shift(4,2),b.write_shift(4,T);for(var F=[8,6815827,6619237,4849780,83],S=0;S<F.length;++S)b.write_shift(4,F[S]);if(T==28)Do(N=N.slice(1),b);else if(2&T){for(F="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),S=0;S<F.length;++S)b.write_shift(1,parseInt(F[S],16));var O=-1<x?N.slice(0,x):N;for(b.write_shift(4,2*(O.length+1)),S=0;S<O.length;++S)b.write_shift(2,O.charCodeAt(S));b.write_shift(2,0),8&T&&Do(-1<x?N.slice(x+1):"",b)}else{for(F="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),S=0;S<F.length;++S)b.write_shift(1,parseInt(F[S],16));for(var L=0;N.slice(3*L,3*L+3)=="../"||N.slice(3*L,3*L+3)=="..\\";)++L;for(b.write_shift(2,L),b.write_shift(4,N.length-3*L+1),S=0;S<N.length-3*L;++S)b.write_shift(1,255&N.charCodeAt(S+3*L));for(b.write_shift(1,0),b.write_shift(2,65535),b.write_shift(2,57005),S=0;S<6;++S)b.write_shift(4,0)}return b.slice(0,b.l)})(s[1])])}function ot(s,N,u){if(!u.cellStyles)return cs(s,N);var d=u&&12<=u.biff?4:2,g=s.read_shift(d),x=s.read_shift(d),b=s.read_shift(d),S=s.read_shift(d),N=s.read_shift(2);return d==2&&(s.l+=2),S={s:g,e:x,w:b,ixfe:S,flags:N},(5<=u.biff||!u.biff)&&(S.level=N>>8&7),S}var Fe=Ni,Ze=Gl,gm=Vl,nt,At,st,wt=[2,3,48,49,131,139,140,245],kt=(nt={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},At=Yr({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),st={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(s,c){try{return oi($t(s,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:$t,from_sheet:function(s,c){if(0<=+(c=c||{}).codepage&&I(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");for(var u=xs(),d=(c=T1(s,{header:1,raw:!0,cellDates:!0}))[0],g=c.slice(1),x=s["!cols"]||[],T=0,b=0,S=0,N=1,T=0;T<d.length;++T)if(((x[T]||{}).DBF||{}).name)d[T]=x[T].DBF.name,++S;else if(d[T]!=null){if(++S,typeof d[T]=="number"&&(d[T]=d[T].toString(10)),typeof d[T]!="string")throw new Error("DBF Invalid column name "+d[T]+" |"+typeof d[T]+"|");if(d.indexOf(d[T])!==T){for(b=0;b<1024;++b)if(d.indexOf(d[T]+"_"+b)==-1){d[T]+="_"+b;break}}}var F=wn(s["!ref"]),O=[],L=[],B=[];for(T=0;T<=F.e.c-F.s.c;++T){for(var ee="",G="",he=0,ne=[],b=0;b<g.length;++b)g[b][T]!=null&&ne.push(g[b][T]);if(ne.length!=0&&d[T]!=null){for(b=0;b<ne.length;++b){switch(typeof ne[b]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=ne[b]instanceof Date?"D":"C";break;default:G="C"}he=Math.max(he,String(ne[b]).length),ee=ee&&ee!=G?"C":G}250<he&&(he=250),(G=((x[T]||{}).DBF||{}).type)=="C"&&x[T].DBF.len>he&&(he=x[T].DBF.len),ee=="B"&&G=="N"&&(ee="N",B[T]=x[T].DBF.dec,he=x[T].DBF.len),L[T]=ee=="C"||G=="N"?he:st[ee]||0,N+=L[T],O[T]=ee}else O[T]="?"}var J,ue,be=u.next(32);for(be.write_shift(4,318902576),be.write_shift(4,g.length),be.write_shift(2,296+32*S),be.write_shift(2,N),T=0;T<4;++T)be.write_shift(4,0);for(be.write_shift(4,0|(+At[m]||3)<<8),b=T=0;T<d.length;++T)d[T]!=null&&(J=u.next(32),ue=(d[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),J.write_shift(1,ue,"sbcs"),J.write_shift(1,O[T]=="?"?"C":O[T],"sbcs"),J.write_shift(4,b),J.write_shift(1,L[T]||st[O[T]]||0),J.write_shift(1,B[T]||0),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(4,0),b+=L[T]||st[O[T]]||0);var we=u.next(264);for(we.write_shift(4,13),T=0;T<65;++T)we.write_shift(4,0);for(T=0;T<g.length;++T){var $e=u.next(N);for($e.write_shift(1,0),b=0;b<d.length;++b)if(d[b]!=null)switch(O[b]){case"L":$e.write_shift(1,g[T][b]==null?63:g[T][b]?84:70);break;case"B":$e.write_shift(8,g[T][b]||0,"f");break;case"N":var et="0";for(typeof g[T][b]=="number"&&(et=g[T][b].toFixed(B[b]||0)),S=0;S<L[b]-et.length;++S)$e.write_shift(1,32);$e.write_shift(1,et,"sbcs");break;case"D":g[T][b]?($e.write_shift(4,("0000"+g[T][b].getFullYear()).slice(-4),"sbcs"),$e.write_shift(2,("00"+(g[T][b].getMonth()+1)).slice(-2),"sbcs"),$e.write_shift(2,("00"+g[T][b].getDate()).slice(-2),"sbcs")):$e.write_shift(8,"00000000","sbcs");break;case"C":var Xe=String(g[T][b]!=null?g[T][b]:"").slice(0,L[b]);for($e.write_shift(1,Xe,"sbcs"),S=0;S<L[b]-Xe.length;++S)$e.write_shift(1,32)}}return u.next(1).write_shift(1,26),u.end()}});function $t(s,c){return c=c||{},c.dateNF||(c.dateNF="yyyymmdd"),s=ri((function(u,d){var g=[],x=De(1);switch(d.type){case"base64":x=de(re(u));break;case"binary":x=de(u);break;case"buffer":case"array":x=u}Ra(x,0);var b=x.read_shift(1),S=!!(136&b),N=!1,T=!1;switch(b){case 2:case 3:break;case 48:case 49:S=N=!0;break;case 131:case 139:break;case 140:T=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+b.toString(16))}var F=0,O=521;b==2&&(F=x.read_shift(2)),x.l+=3,1048576<(F=b!=2?x.read_shift(4):F)&&(F=1e6),b!=2&&(O=x.read_shift(2));var L=x.read_shift(2),B=d.codepage||1252;b!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(B=nt[x[x.l]]),x.l+=1,x.l+=2),T&&(x.l+=36);for(var ee=[],G={},he=Math.min(x.length,b==2?521:O-10-(N?264:0)),ne=T?32:11;x.l<he&&x[x.l]!=13;)switch((G={}).name=e.utils.decode(B,x.slice(x.l,x.l+ne)).replace(/[\u0000\r\n].*$/g,""),x.l+=ne,G.type=String.fromCharCode(x.read_shift(1)),b==2||T||(G.offset=x.read_shift(4)),G.len=x.read_shift(1),b==2&&(G.offset=x.read_shift(2)),G.dec=x.read_shift(1),G.name.length&&ee.push(G),b!=2&&(x.l+=T?13:14),G.type){case"B":N&&G.len==8||!d.WTF||console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(x[x.l]!==13&&(x.l=O-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=O;var J=0,ue=0;for(g[0]=[],ue=0;ue!=ee.length;++ue)g[0][ue]=ee[ue].name;for(;0<F--;)if(x[x.l]!==42)for(++x.l,g[++J]=[],ue=ue=0;ue!=ee.length;++ue){var be=x.slice(x.l,x.l+ee[ue].len);x.l+=ee[ue].len,Ra(be,0);var we=e.utils.decode(B,be);switch(ee[ue].type){case"C":we.trim().length&&(g[J][ue]=we.replace(/\s+$/,""));break;case"D":we.length===8?g[J][ue]=new Date(+we.slice(0,4),+we.slice(4,6)-1,+we.slice(6,8)):g[J][ue]=we;break;case"F":g[J][ue]=parseFloat(we.trim());break;case"+":case"I":g[J][ue]=T?2147483648^be.read_shift(-4,"i"):be.read_shift(4,"i");break;case"L":switch(we.trim().toUpperCase()){case"Y":case"T":g[J][ue]=!0;break;case"N":case"F":g[J][ue]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+we+"|")}break;case"M":if(!S)throw new Error("DBF Unexpected MEMO for type "+b.toString(16));g[J][ue]="##MEMO##"+(T?parseInt(we.trim(),10):be.read_shift(4));break;case"N":(we=we.replace(/\u0000/g,"").trim())&&we!="."&&(g[J][ue]=+we||0);break;case"@":g[J][ue]=new Date(be.read_shift(-8,"f")-621356832e5);break;case"T":g[J][ue]=new Date(864e5*(be.read_shift(4)-2440588)+be.read_shift(4));break;case"Y":g[J][ue]=be.read_shift(4,"i")/1e4+be.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[J][ue]=-be.read_shift(-8,"f");break;case"B":if(N&&ee[ue].len==8){g[J][ue]=be.read_shift(8,"f");break}case"G":case"P":be.l+=ee[ue].len;break;case"0":if(ee[ue].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+ee[ue].type)}}else x.l+=L;if(b!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),d.DBF=ee,g})(s,c),c),s["!cols"]=c.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete c.DBF,s}var Lt,Ir,yr,An,Er=(Lt={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},Ir=new RegExp("\x1BN("+fa(Lt).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),yr=function(s,c){return c=Lt[c],typeof c=="number"?U(c):c},An=function(s,c,u){return u=c.charCodeAt(0)-32<<4|u.charCodeAt(0)-48,u==59?s:U(u)},Lt["|"]=254,{to_workbook:function(s,c){return oi(za(s,c),c)},to_sheet:za,from_sheet:function(s,c){var u,d,g=["ID;PWXL;N;E"],x=[],b=wn(s["!ref"]),S=Array.isArray(s),N=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),s["!cols"]&&(u=g,s["!cols"].forEach(function(L,B){B="F;W"+(B+1)+" "+(B+1)+" ",L.hidden?B+="0":(typeof L.width!="number"||L.wpx||(L.wpx=ph(L.width)),typeof L.wpx!="number"||L.wch||(L.wch=Zl(L.wpx)),typeof L.wch=="number"&&(B+=Math.round(L.wch))),B.charAt(B.length-1)!=" "&&u.push(B)})),s["!rows"]&&(d=g,s["!rows"].forEach(function(L,B){var ee="F;";L.hidden?ee+="M0;":L.hpt?ee+="M"+20*L.hpt+";":L.hpx&&(ee+="M"+20*zd(L.hpx)+";"),2<ee.length&&d.push(ee+"R"+(B+1))})),g.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var T=b.s.r;T<=b.e.r;++T)for(var F=b.s.c;F<=b.e.c;++F){var O=sn({r:T,c:F});(O=S?(s[T]||[])[F]:s[O])&&(O.v!=null||O.f&&!O.F)&&x.push((function(L,B,ee){var G="C;Y"+(B+1)+";X"+(ee+1)+";K";switch(L.t){case"n":G+=L.v||0,L.f&&!L.F&&(G+=";E"+K0(L.f,{r:B,c:ee}));break;case"b":G+=L.v?"TRUE":"FALSE";break;case"e":G+=L.w||L.v;break;case"d":G+='"'+(L.w||L.v)+'"';break;case"s":G+='"'+L.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return G})(O,T,F))}return g.join(N)+N+x.join(N)+N+"E"+N}});function Pn(L,c){var u,d,g=L.split(/[\n\r]+/),x=-1,b=-1,S=0,N=0,T=[],F=[],O=null,L={},B=[],ee=[],G=0;for(0<=+c.codepage&&I(+c.codepage);S!==g.length;++S){G=0;var he,ne=g[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,An).replace(Ir,yr),J=ne.replace(/;;/g,"\0").split(";").map(function(qt){return qt.replace(/\u0000/g,";")}),ue=J[0];if(0<ne.length)switch(ue){case"ID":case"E":case"B":case"O":case"W":break;case"P":J[1].charAt(0)=="P"&&F.push(ne.slice(3).replace(/;;/g,";"));break;case"C":for(var be=!1,we=!1,$e=!1,et=!1,Xe=-1,lt=-1,N=1;N<J.length;++N)switch(J[N].charAt(0)){case"A":break;case"X":b=parseInt(J[N].slice(1))-1,we=!0;break;case"Y":for(x=parseInt(J[N].slice(1))-1,we||(b=0),d=T.length;d<=x;++d)T[d]=[];break;case"K":(he=J[N].slice(1)).charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(bi(he))?isNaN(Oi(he).getDate())||(he=vn(he)):(he=bi(he),O!==null&&_r(O)&&(he=Ms(he))),e!==void 0&&typeof he=="string"&&(c||{}).type!="string"&&(c||{}).codepage&&(he=e.utils.decode(c.codepage,he)),be=!0;break;case"E":et=!0;var _t=Zh(J[N].slice(1),{r:x,c:b});T[x][b]=[T[x][b],_t];break;case"S":$e=!0,T[x][b]=[T[x][b],"S5S"];break;case"G":break;case"R":Xe=parseInt(J[N].slice(1))-1;break;case"C":lt=parseInt(J[N].slice(1))-1;break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+ne)}if(be&&(T[x][b]&&T[x][b].length==2?T[x][b][0]=he:T[x][b]=he,O=null),$e){if(et)throw new Error("SYLK shared formula cannot have own formula");var Dt=-1<Xe&&T[Xe][lt];if(!Dt||!Dt[1])throw new Error("SYLK shared formula cannot find base");T[x][b][1]=Wf(Dt[1],{r:x-Xe,c:b-lt})}break;case"F":var ft=0;for(N=1;N<J.length;++N)switch(J[N].charAt(0)){case"X":b=parseInt(J[N].slice(1))-1,++ft;break;case"Y":for(x=parseInt(J[N].slice(1))-1,d=T.length;d<=x;++d)T[d]=[];break;case"M":G=parseInt(J[N].slice(1))/20;break;case"F":case"G":break;case"P":O=F[parseInt(J[N].slice(1))];break;case"S":case"D":case"N":break;case"W":for(u=J[N].slice(1).split(" "),d=parseInt(u[0],10);d<=parseInt(u[1],10);++d)G=parseInt(u[2],10),ee[d-1]=G===0?{hidden:!0}:{wch:G},mh(ee[d-1]);break;case"C":ee[b=parseInt(J[N].slice(1))-1]||(ee[b]={});break;case"R":B[x=parseInt(J[N].slice(1))-1]||(B[x]={}),0<G?(B[x].hpt=G,B[x].hpx=Xh(G)):G===0&&(B[x].hidden=!0);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+ne)}ft<1&&(O=null);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+ne)}}return 0<B.length&&(L["!rows"]=B),0<ee.length&&(L["!cols"]=ee),[T=c&&c.sheetRows?T.slice(0,c.sheetRows):T,L]}function za(d,c){var u=(function(b,S){switch(S.type){case"base64":return Pn(re(b),S);case"binary":return Pn(b,S);case"buffer":return Pn(xe&&Buffer.isBuffer(b)?b.toString("binary"):z(b),S);case"array":return Pn(Cs(b),S)}throw new Error("Unrecognized type "+S.type)})(d,c),d=u[0],g=u[1],x=ri(d,c);return fa(g).forEach(function(b){x[b]=g[b]}),x}var En={to_workbook:function(s,c){return oi(sr(s,c),c)},to_sheet:sr,from_sheet:function(s){var c=[],u=wn(s["!ref"]),d=Array.isArray(s);$a(c,"TABLE",0,1,"sheetjs"),$a(c,"VECTORS",0,u.e.r-u.s.r+1,""),$a(c,"TUPLES",0,u.e.c-u.s.c+1,""),$a(c,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){qr(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var b,S=sn({r:g,c:x});if(b=d?(s[g]||[])[x]:s[S])switch(b.t){case"n":var N=b.w;(N=!N&&b.v!=null?b.v:N)==null?b.f&&!b.F?qr(c,1,0,"="+b.f):qr(c,1,0,""):qr(c,0,N,"V");break;case"b":qr(c,0,b.v?1:0,b.v?"TRUE":"FALSE");break;case"s":qr(c,1,0,isNaN(b.v)?b.v:'="'+b.v+'"');break;case"d":b.w||(b.w=xr(b.z||se[14],pa(vn(b.v)))),qr(c,0,b.w,"V");break;default:qr(c,1,0,"")}else qr(c,1,0,"")}}return qr(c,-1,0,"EOD"),c.join(`\r
`)}};function pr(s,c){for(var u=s.split(`
`),d=-1,g=-1,x=0,b=[];x!==u.length;++x)if(u[x].trim()!=="BOT"){if(!(d<0)){for(var S=u[x].trim().split(","),N=S[0],T=S[1],F=u[++x]||"";1&(F.match(/["]/g)||[]).length&&x<u.length-1;)F+=`
`+u[++x];switch(F=F.trim(),+N){case-1:if(F==="BOT"){b[++d]=[],g=0;continue}if(F!=="EOD")throw new Error("Unrecognized DIF special command "+F);break;case 0:F==="TRUE"?b[d][g]=!0:F==="FALSE"?b[d][g]=!1:isNaN(bi(T))?isNaN(Oi(T).getDate())?b[d][g]=T:b[d][g]=vn(T):b[d][g]=bi(T),++g;break;case 1:F=(F=F.slice(1,F.length-1)).replace(/""/g,'"'),F&&F.match(/^=".*"$/)&&(F=F.slice(2,-1)),b[d][g++]=F!==""?F:null}if(F==="EOD")break}}else b[++d]=[],g=0;return b=c&&c.sheetRows?b.slice(0,c.sheetRows):b}function sr(s,c){return ri((function(u,d){switch(d.type){case"base64":return pr(re(u),d);case"binary":return pr(u,d);case"buffer":return pr(xe&&Buffer.isBuffer(u)?u.toString("binary"):z(u),d);case"array":return pr(Cs(u),d)}throw new Error("Unrecognized type "+d.type)})(s,c),c)}function $a(s,c,u,d,g){s.push(c),s.push(u+","+d),s.push('"'+g.replace(/"/g,'""')+'"')}function qr(s,c,u,d){s.push(c+","+u),s.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)}var In,ya,Ys,hi,Ma=(In=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),ya=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,Ys=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),hi="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(s,c){return oi(Ti(s,c),c)},to_sheet:Ti,from_sheet:function(s){return[In,ya,Ys,ya,(function(c){if(!c||!c["!ref"])return"";for(var u,d,g=[],x=[],b=ti(c["!ref"]),S=Array.isArray(c),N=b.s.r;N<=b.e.r;++N)for(var T=b.s.c;T<=b.e.c;++T)if(d=sn({r:N,c:T}),(u=S?(c[N]||[])[T]:c[d])&&u.v!=null&&u.t!=="z"){switch(x=["cell",d,"t"],u.t){case"s":case"str":x.push(_s(u.v));break;case"n":u.f?(x[2]="vtf",x[3]="n",x[4]=u.v,x[5]=_s(u.f)):(x[2]="v",x[3]=u.v);break;case"b":x[2]="vt"+(u.f?"f":"c"),x[3]="nl",x[4]=u.v?"1":"0",x[5]=_s(u.f||(u.v?"TRUE":"FALSE"));break;case"d":var F=pa(vn(u.v));x[2]="vtc",x[3]="nd",x[4]=""+F,x[5]=u.w||xr(u.z||se[14],F);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)})(s),hi].join(`
`)}});function _s(s){return s.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function Ti(s,c){return ri((function(u,d){for(var g,x=u.split(`
`),b=-1,S=0,N=[];S!==x.length;++S){var T=x[S].trim().split(":");if(T[0]==="cell"){var F=ga(T[1]);if(N.length<=F.r)for(b=N.length;b<=F.r;++b)N[b]||(N[b]=[]);switch(b=F.r,g=F.c,T[2]){case"t":N[b][g]=T[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":N[b][g]=+T[3];break;case"vtf":var O=T[T.length-1];case"vtc":T[3]==="nl"?N[b][g]=!!+T[4]:N[b][g]=+T[4],T[2]=="vtf"&&(N[b][g]=[N[b][g],O])}}}return N=d&&d.sheetRows?N.slice(0,d.sheetRows):N})(s,c),c)}var Is,Dn,Hn=(Is={44:",",9:"	",59:";",124:"|"},Dn={44:3,9:2,59:1,124:0},{to_workbook:function(s,c){return oi(ia(s,c),c)},to_sheet:ia,from_sheet:function(s){for(var c=[],u=wn(s["!ref"]),d=Array.isArray(s),g=u.s.r;g<=u.e.r;++g){for(var x=[],b=u.s.c;b<=u.e.c;++b){var S=sn({r:g,c:b});if((S=d?(s[g]||[])[b]:s[S])&&S.v!=null){for(var N=(S.w||(io(S),S.w)||"").slice(0,10);N.length<10;)N+=" ";x.push(N+(b===0?" ":""))}else x.push("          ")}c.push(x.join(""))}return c.join(`
`)}});function hs(s,c,u,d,g){g.raw?c[u][d]=s:s===""||(s==="TRUE"?c[u][d]=!0:s==="FALSE"?c[u][d]=!1:isNaN(bi(s))?isNaN(Oi(s).getDate())?c[u][d]=s:c[u][d]=vn(s):c[u][d]=bi(s))}function ua(s){for(var c={},u=!1,d=0,g=0;d<s.length;++d)(g=s.charCodeAt(d))==34?u=!u:!u&&g in Is&&(c[g]=(c[g]||0)+1);for(d in g=[],c)Object.prototype.hasOwnProperty.call(c,d)&&g.push([c[d],d]);if(!g.length)for(d in c=Dn)Object.prototype.hasOwnProperty.call(c,d)&&g.push([c[d],d]);return g.sort(function(x,b){return x[0]-b[0]||Dn[x[1]]-Dn[b[1]]}),Is[g.pop()[1]]||44}function ni(s,d){var u=d||{},d="",g=u.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};s.slice(0,4)=="sep="?s.charCodeAt(5)==13&&s.charCodeAt(6)==10?(d=s.charAt(4),s=s.slice(7)):s.charCodeAt(5)==13||s.charCodeAt(5)==10?(d=s.charAt(4),s=s.slice(6)):d=ua(s.slice(0,1024)):d=u&&u.FS?u.FS:ua(s.slice(0,1024));var b=0,S=0,N=0,T=0,F=0,O=d.charCodeAt(0),L=!1,B=0,ee=s.charCodeAt(0);s=s.replace(/\r\n/gm,`
`);var G=u.dateNF!=null?(d=(d=typeof(d=u.dateNF)=="number"?se[d]:d).replace(xa,"(\\d+)"),new RegExp("^"+d+"$")):null;function he(){var ne,J=s.slice(T,F),ue={};if((J=J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'?J.slice(1,-1).replace(/""/g,'"'):J).length===0?ue.t="z":u.raw||J.trim().length===0?(ue.t="s",ue.v=J):J.charCodeAt(0)==61?J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(ue.t="s",ue.v=J.slice(2,-1).replace(/""/g,'"')):J.length!=1?(ue.t="n",ue.f=J.slice(1)):(ue.t="s",ue.v=J):J=="TRUE"?(ue.t="b",ue.v=!0):J=="FALSE"?(ue.t="b",ue.v=!1):isNaN(N=bi(J))?!isNaN(Oi(J).getDate())||G&&J.match(G)?(ue.z=u.dateNF||se[14],ne=0,G&&J.match(G)&&(J=(function(be,we){var $e=-1,et=-1,Xe=-1,lt=-1,_t=-1,Dt=-1;(be.match(xa)||[]).forEach(function(qt,hr){var lr=parseInt(we[hr+1],10);switch(qt.toLowerCase().charAt(0)){case"y":$e=lr;break;case"d":Xe=lr;break;case"h":lt=lr;break;case"s":Dt=lr;break;case"m":0<=lt?_t=lr:et=lr}}),0<=Dt&&_t==-1&&0<=et&&(_t=et,et=-1);var ft=(""+(0<=$e?$e:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=et?et:1)).slice(-2)+"-"+("00"+(1<=Xe?Xe:1)).slice(-2);return(ft=ft.length==7?"0"+ft:ft).length==8&&(ft="20"+ft),be=("00"+(0<=lt?lt:0)).slice(-2)+":"+("00"+(0<=_t?_t:0)).slice(-2)+":"+("00"+(0<=Dt?Dt:0)).slice(-2),lt==-1&&_t==-1&&Dt==-1?ft:$e==-1&&et==-1&&Xe==-1?be:ft+"T"+be})(u.dateNF,J.match(G)||[]),ne=1),u.cellDates?(ue.t="d",ue.v=vn(J,ne)):(ue.t="n",ue.v=pa(vn(J,ne))),u.cellText!==!1&&(ue.w=xr(ue.z,ue.v instanceof Date?pa(ue.v):ue.v)),u.cellNF||delete ue.z):(ue.t="s",ue.v=J):(!(ue.t="n")!==u.cellText&&(ue.w=J),ue.v=N),ue.t=="z"||(u.dense?(g[b]||(g[b]=[]),g[b][S]=ue):g[sn({c:S,r:b})]=ue),T=F+1,ee=s.charCodeAt(T),x.e.c<S&&(x.e.c=S),x.e.r<b&&(x.e.r=b),B!=O)return S=0,++b,u.sheetRows&&u.sheetRows<=b?1:void 0;++S}e:for(;F<s.length;++F)switch(B=s.charCodeAt(F)){case 34:ee===34&&(L=!L);break;case O:case 10:case 13:if(!L&&he())break e}return 0<F-T&&he(),g["!ref"]=rn(x),g}function ws(s,c){return!c||!c.PRN||c.FS||s.slice(0,4)=="sep="||0<=s.indexOf("	")||0<=s.indexOf(",")||0<=s.indexOf(";")?ni(s,c):ri((function(u,d){var g=d||{},x=[];if(!u||u.length===0)return x;for(var b=u.split(/[\r\n]/),S=b.length-1;0<=S&&b[S].length===0;)--S;for(var N=10,T=0,F=0;F<=S;++F)(T=b[F].indexOf(" "))==-1?T=b[F].length:T++,N=Math.max(N,T);for(F=0;F<=S;++F){x[F]=[];var O=0;for(hs(b[F].slice(0,N).trim(),x,F,O,g),O=1;O<=(b[F].length-N)/10+1;++O)hs(b[F].slice(N+10*(O-1),N+10*O).trim(),x,F,O,g)}return x=g.sheetRows?x.slice(0,g.sheetRows):x})(s,c),c)}function ia(s,c){var u="",d=c.type=="string"?[0,0,0,0]:cm(s,c);switch(c.type){case"base64":u=re(s);break;case"binary":u=s;break;case"buffer":u=c.codepage==65001?s.toString("utf8"):c.codepage&&e!==void 0?e.utils.decode(c.codepage,s):xe&&Buffer.isBuffer(s)?s.toString("binary"):z(s);break;case"array":u=Cs(s);break;case"string":u=s;break;default:throw new Error("Unrecognized type "+c.type)}return d[0]==239&&d[1]==187&&d[2]==191?u=Xn(u.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?u=Xn(u):c.type=="binary"&&e!==void 0&&c.codepage&&(u=e.utils.decode(c.codepage,e.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?Ma.to_sheet(c.type=="string"?u:Xn(u),c):ws(u,c)}var ds,va,Ds,zs,oa=(ds={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},va=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],Ds={0:{n:"BOF",f:Pa},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(s,c,u){var d={s:{c:0,r:0},e:{c:0,r:0}};return c==8&&u.qpro?(d.s.c=s.read_shift(1),s.l++,d.s.r=s.read_shift(2),d.e.c=s.read_shift(1),s.l++,d.e.r=s.read_shift(2)):(d.s.c=s.read_shift(2),d.s.r=s.read_shift(2),c==12&&u.qpro&&(s.l+=2),d.e.c=s.read_shift(2),d.e.r=s.read_shift(2),c==12&&u.qpro&&(s.l+=2),d.s.c==65535&&(d.s.c=d.e.c=d.s.r=d.e.r=0)),d}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(s,c,u){return(u=es(s,0,u))[1].v=s.read_shift(2,"i"),u}},14:{n:"NUMBER",f:function(s,c,u){return(u=es(s,0,u))[1].v=s.read_shift(8,"f"),u}},15:{n:"LABEL",f:Zr},16:{n:"FORMULA",f:function(s,c,u){var d=s.l+c;return(c=es(s,0,u))[1].v=s.read_shift(8,"f"),u.qpro?s.l=d:(d=s.read_shift(2),(function(g,x){Ra(g,0);for(var b=[],S=0,N="",T="",F="",O="";g.l<g.length;){var L=g[g.l++];switch(L){case 0:b.push(g.read_shift(8,"f"));break;case 1:T=Kr(x[0].c,g.read_shift(2),!0),N=Kr(x[0].r,g.read_shift(2),!1),b.push(T+N);break;case 2:var B=Kr(x[0].c,g.read_shift(2),!0),ee=Kr(x[0].r,g.read_shift(2),!1);T=Kr(x[0].c,g.read_shift(2),!0),N=Kr(x[0].r,g.read_shift(2),!1),b.push(B+ee+":"+T+N);break;case 3:if(g.l<g.length)return console.error("WK1 premature formula end");break;case 4:b.push("("+b.pop()+")");break;case 5:b.push(g.read_shift(2));break;case 6:for(var G="";L=g[g.l++];)G+=String.fromCharCode(L);b.push('"'+G.replace(/"/g,'""')+'"');break;case 8:b.push("-"+b.pop());break;case 23:b.push("+"+b.pop());break;case 22:b.push("NOT("+b.pop()+")");break;case 20:case 21:O=b.pop(),F=b.pop(),b.push(["AND","OR"][L-20]+"("+F+","+O+")");break;default:if(L<32&&va[L])O=b.pop(),F=b.pop(),b.push(F+va[L]+O);else{if(!ds[L])return L<=7?console.error("WK1 invalid opcode "+L.toString(16)):L<=24?console.error("WK1 unsupported op "+L.toString(16)):L<=30?console.error("WK1 invalid opcode "+L.toString(16)):L<=115?console.error("WK1 unsupported function opcode "+L.toString(16)):console.error("WK1 unrecognized opcode "+L.toString(16));if((S=(S=ds[L][1])==69?g[g.l++]:S)>b.length)return console.error("WK1 bad formula parse 0x"+L.toString(16)+":|"+b.join("|")+"|");ee=b.slice(-S),b.length-=S,b.push(ds[L][0]+"("+ee.join(",")+")")}}}b.length==1?x[1].f=""+b[0]:console.error("WK1 bad formula parse |"+b.join("|")+"|")})(s.slice(s.l,s.l+d),c),s.l+=d),c}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:Zr},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Gi},222:{n:"SHEETNAMELP",f:function(s,c){var u=s[s.l++];c-1<u&&(u=c-1);for(var d="";d.length<u;)d+=String.fromCharCode(s[s.l++]);return d}},65535:{n:""}},zs={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(s,c){var u=Vn(s);return u[1].t="s",u[1].v=s.read_shift(c-4,"cstr"),u}},23:{n:"NUMBER17",f:eo},24:{n:"NUMBER18",f:function(s,c){var u=Vn(s);u[1].v=s.read_shift(2);var d=u[1].v>>1;if(1&u[1].v)switch(7&d){case 0:d=5e3*(d>>3);break;case 1:d=500*(d>>3);break;case 2:d=(d>>3)/20;break;case 3:d=(d>>3)/200;break;case 4:d=(d>>3)/2e3;break;case 5:d=(d>>3)/2e4;break;case 6:d=(d>>3)/16;break;case 7:d=(d>>3)/64}return u[1].v=d,u}},25:{n:"FORMULA19",f:function(s,c){var u=eo(s);return s.l+=c-14,u}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(s,c){for(var u={},d=s.l+c;s.l<d;){var g=s.read_shift(2);if(g==14e3){for(u[g]=[0,""],u[g][0]=s.read_shift(2);s[s.l];)u[g][1]+=String.fromCharCode(s[s.l]),s.l++;s.l++}}return u}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(d,c){var u=Vn(d),d=d.read_shift(4);return u[1].v=d>>6,u}},38:{n:"??"},39:{n:"NUMBER27",f:Fo},40:{n:"FORMULA28",f:function(s,c){var u=Fo(s);return s.l+=c-10,u}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Gi},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(s,c,u){if(u.qpro&&!(c<21))return u=s.read_shift(1),s.l+=17,s.l+=1,s.l+=2,[u,s.read_shift(c-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(s,c){var u=c||{};if(0<=+u.codepage&&I(+u.codepage),u.type=="string")throw new Error("Cannot write WK1 to JS string");var d=xs(),g=wn(s["!ref"]),x=Array.isArray(s),b=[];ir(d,0,(c=1030,(u=xt(2)).write_shift(2,c),u)),ir(d,6,(c=g,(u=xt(8)).write_shift(2,c.s.c),u.write_shift(2,c.s.r),u.write_shift(2,c.e.c),u.write_shift(2,c.e.r),u));for(var S,N,T,F,O=Math.min(g.e.r,8191),L=g.s.r;L<=O;++L)for(var B=ja(L),ee=g.s.c;ee<=g.e.c;++ee){L===g.s.r&&(b[ee]=Ln(ee));var G=b[ee]+B,G=x?(s[L]||[])[ee]:s[G];G&&G.t!="z"&&(G.t=="n"?(0|G.v)==G.v&&-32768<=G.v&&G.v<=32767?ir(d,13,(S=L,N=ee,T=G.v,F=void 0,(F=xt(7)).write_shift(1,255),F.write_shift(2,N),F.write_shift(2,S),F.write_shift(2,T,"i"),F)):ir(d,14,(N=L,S=ee,T=G.v,F=void 0,(F=xt(13)).write_shift(1,255),F.write_shift(2,S),F.write_shift(2,N),F.write_shift(8,T,"f"),F)):ir(d,15,(function(he,ne,J){var ue=xt(7+J.length);ue.write_shift(1,255),ue.write_shift(2,ne),ue.write_shift(2,he),ue.write_shift(1,39);for(var be=0;be<ue.length;++be){var we=J.charCodeAt(be);ue.write_shift(1,128<=we?95:we)}return ue.write_shift(1,0),ue})(L,ee,io(G).slice(0,239))))}return ir(d,1),d.end()},book_to_wk3:function(s,c){if(0<=+(c=c||{}).codepage&&I(+c.codepage),c.type=="string")throw new Error("Cannot write WK3 to JS string");var u=xs();ir(u,0,(function(G){var he=xt(26);he.write_shift(2,4096),he.write_shift(2,4),he.write_shift(4,0);for(var ne=0,J=0,ue=0,be=0;be<G.SheetNames.length;++be){var we=G.SheetNames[be],we=G.Sheets[we];we&&we["!ref"]&&(++ue,we=ti(we["!ref"]),ne<we.e.r&&(ne=we.e.r),J<we.e.c&&(J=we.e.c))}return 8191<ne&&(ne=8191),he.write_shift(2,ne),he.write_shift(1,ue),he.write_shift(1,J),he.write_shift(2,0),he.write_shift(2,0),he.write_shift(1,1),he.write_shift(1,2),he.write_shift(4,0),he.write_shift(4,0),he})(s));for(var d=0,g=0;d<s.SheetNames.length;++d)(s.Sheets[s.SheetNames[d]]||{})["!ref"]&&ir(u,27,(function(G,he){var ne=xt(5+G.length);ne.write_shift(2,14e3),ne.write_shift(2,he);for(var J=0;J<G.length;++J){var ue=G.charCodeAt(J);ne[ne.l++]=127<ue?95:ue}return ne[ne.l++]=0,ne})(s.SheetNames[d],g++));for(var x=0,d=0;d<s.SheetNames.length;++d){var b=s.Sheets[s.SheetNames[d]];if(b&&b["!ref"]){for(var S=wn(b["!ref"]),N=Array.isArray(b),T=[],F=Math.min(S.e.r,8191),O=S.s.r;O<=F;++O)for(var L=ja(O),B=S.s.c;B<=S.e.c;++B){O===S.s.r&&(T[B]=Ln(B));var ee=T[B]+L,ee=N?(b[O]||[])[B]:b[ee];ee&&ee.t!="z"&&(ee.t=="n"?ir(u,23,(function($e,Xe,et,ue){var be=xt(14);if(be.write_shift(2,$e),be.write_shift(1,et),be.write_shift(1,Xe),ue==0)return be.write_shift(4,0),be.write_shift(4,0),be.write_shift(2,65535),be;var we=0,$e=0,et=0,Xe=0;return ue<0&&(we=1,ue=-ue),$e=0|Math.log2(ue),ue/=Math.pow(2,$e-31),(2147483648&(Xe=ue>>>0))==0&&(++$e,Xe=(ue/=2)>>>0),ue-=Xe,Xe|=2147483648,Xe>>>=0,ue*=Math.pow(2,32),et=ue>>>0,be.write_shift(4,et),be.write_shift(4,Xe),$e+=16383+(we?32768:0),be.write_shift(2,$e),be})(O,B,x,ee.v)):ir(u,22,(function(he,ne,J,ue){var be=xt(6+ue.length);be.write_shift(2,he),be.write_shift(1,J),be.write_shift(1,ne),be.write_shift(1,39);for(var we=0;we<ue.length;++we){var $e=ue.charCodeAt(we);be.write_shift(1,128<=$e?95:$e)}return be.write_shift(1,0),be})(O,B,x,io(ee).slice(0,239))))}++x}}return ir(u,1),u.end()},to_workbook:function(s,c){switch(c.type){case"base64":return di(de(re(s)),c);case"binary":return di(de(s),c);case"buffer":case"array":return di(s,c)}throw"Unsupported type "+c.type}});function Zn(s,c,u){if(s){Ra(s,s.l||0);for(var d=u.Enum||Ds;s.l<s.length;){var g=s.read_shift(2),x=d[g]||d[65535],S=s.read_shift(2),b=s.l+S,S=x.f&&x.f(s,S,u);if(s.l=b,c(S,x,g))return}}}function di(s,c){if(!s)return s;var u=c||{},d=u.dense?[]:{},g="Sheet1",x="",b=0,S={},N=[],T=[],F={s:{r:0,c:0},e:{r:0,c:0}},O=u.sheetRows||0;if(s[2]==0&&(s[3]==8||s[3]==9)&&16<=s.length&&s[14]==5&&s[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(s[2]==2)u.Enum=Ds,Zn(s,function(G,he,ne){switch(ne){case 0:4096<=(u.vers=G)&&(u.qpro=!0);break;case 6:F=G;break;case 204:G&&(x=G);break;case 222:x=G;break;case 15:case 51:u.qpro||(G[1].v=G[1].v.slice(1));case 13:case 14:case 16:ne==14&&(112&G[2])==112&&1<(15&G[2])&&(15&G[2])<15&&(G[1].z=u.dateNF||se[14],u.cellDates&&(G[1].t="d",G[1].v=Ms(G[1].v))),u.qpro&&G[3]>b&&(d["!ref"]=rn(F),S[g]=d,N.push(g),d=u.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},b=G[3],g=x||"Sheet"+(b+1),x="");var J=u.dense?(d[G[0].r]||[])[G[0].c]:d[sn(G[0])];if(J){J.t=G[1].t,J.v=G[1].v,G[1].z!=null&&(J.z=G[1].z),G[1].f!=null&&(J.f=G[1].f);break}u.dense?(d[G[0].r]||(d[G[0].r]=[]),d[G[0].r][G[0].c]=G[1]):d[sn(G[0])]=G[1]}},u);else{if(s[2]!=26&&s[2]!=14)throw new Error("Unrecognized LOTUS BOF "+s[2]);u.Enum=zs,s[2]==14&&(u.qpro=!0,s.l=0),Zn(s,function(G,he,ne){switch(ne){case 204:g=G;break;case 22:G[1].v=G[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(G[3]>b&&(d["!ref"]=rn(F),S[g]=d,N.push(g),d=u.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},b=G[3],g="Sheet"+(b+1)),0<O&&G[0].r>=O)break;u.dense?(d[G[0].r]||(d[G[0].r]=[]),d[G[0].r][G[0].c]=G[1]):d[sn(G[0])]=G[1],F.e.c<G[0].c&&(F.e.c=G[0].c),F.e.r<G[0].r&&(F.e.r=G[0].r);break;case 27:G[14e3]&&(T[G[14e3][0]]=G[14e3][1]);break;case 1537:T[G[0]]=G[1],G[0]==b&&(g=G[1])}},u)}if(d["!ref"]=rn(F),S[x||g]=d,N.push(x||g),!T.length)return{SheetNames:N,Sheets:S};for(var L={},B=[],ee=0;ee<T.length;++ee)S[N[ee]]?(B.push(T[ee]||N[ee]),L[T[ee]]=S[T[ee]]||S[N[ee]]):(B.push(T[ee]),L[T[ee]]={"!ref":"A1"});return{SheetNames:B,Sheets:L}}function es(s,c,u){var d=[{c:0,r:0},{t:"n",v:0},0,0];return u.qpro&&u.vers!=20768?(d[0].c=s.read_shift(1),d[3]=s.read_shift(1),d[0].r=s.read_shift(2),s.l+=2):(d[2]=s.read_shift(1),d[0].c=s.read_shift(2),d[0].r=s.read_shift(2)),d}function Zr(s,g,u){var d=s.l+g,g=es(s,0,u);return g[1].t="s",u.vers!=20768?(u.qpro&&s.l++,g[1].v=s.read_shift(d-s.l,"cstr"),g):(s.l++,d=s.read_shift(1),g[1].v=s.read_shift(d,"utf8"),g)}function Kr(s,c,u){var d=32768&c;return(d?"":"$")+(u?Ln:ja)(c=(d?s:0)+(8192<=(c&=-32769)?c-16384:c))}function Vn(s){var c=[{c:0,r:0},{t:"n",v:0},0];return c[0].r=s.read_shift(2),c[3]=s[s.l++],c[0].c=s[s.l++],c}function eo(x,c){var u=Vn(x),d=x.read_shift(4),g=x.read_shift(4);if((b=x.read_shift(2))==65535)return d===0&&g===3221225472?(u[1].t="e",u[1].v=15):d===0&&g===3489660928?(u[1].t="e",u[1].v=42):u[1].v=0,u;var x=32768&b,b=(32767&b)-16446;return u[1].v=(1-2*x)*(g*Math.pow(2,32+b)+d*Math.pow(2,b)),u}function Fo(d,c){var u=Vn(d),d=d.read_shift(8,"f");return u[1].v=d,u}function Gi(s,c){return s[s.l+c-1]==0?s.read_shift(c,"cstr"):""}var $s,Ec,kc,Wh,qa=($s=tn("t"),Ec=tn("rPr"),kc=/<(?:\w+:)?r>/g,Wh=/<\/(?:\w+:)?r>/,function(s){return s.replace(kc,"").split(Wh).map(Of).filter(function(c){return c.v})});function Of(s){var c=s.match($s);return c?(c={t:"s",v:cn(c[1])},s=s.match(Ec),s&&(c.s=(function(u){var d={},g=u.match(os),x=0,b=!1;if(g)for(;x!=g.length;++x){var S=ln(g[x]);switch(S[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!S.val)break;case"<shadow>":case"<shadow/>":d.shadow=1;break;case"</shadow>":break;case"<charset":if(S.val=="1")break;d.cp=w[parseInt(S.val,10)];break;case"<outline":if(!S.val)break;case"<outline>":case"<outline/>":d.outline=1;break;case"</outline>":break;case"<rFont":d.name=S.val;break;case"<sz":d.sz=S.val;break;case"<strike":if(!S.val)break;case"<strike>":case"<strike/>":d.strike=1;break;case"</strike>":break;case"<u":if(!S.val)break;switch(S.val){case"double":d.uval="double";break;case"singleAccounting":d.uval="single-accounting";break;case"doubleAccounting":d.uval="double-accounting"}case"<u>":case"<u/>":d.u=1;break;case"</u>":break;case"<b":if(S.val=="0")break;case"<b>":case"<b/>":d.b=1;break;case"</b>":break;case"<i":if(S.val=="0")break;case"<i>":case"<i/>":d.i=1;break;case"</i>":break;case"<color":S.rgb&&(d.color=S.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":d.family=S.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":d.valign=S.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(S[0].charCodeAt(1)!==47&&!b)throw new Error("Unrecognized rich format "+S[0])}}return d})(s[1])),c):{t:"s",v:""}}var jd,Od=(jd=/(\r\n|\n)/g,function(s){return s.map(_c).join("")});function _c(s){var c,u,d,g=[[],s.v,[]];return s.v?(s.s&&(c=s.s,u=g[0],d=g[2],s=[],c.u&&s.push("text-decoration: underline;"),c.uval&&s.push("text-underline-style:"+c.uval+";"),c.sz&&s.push("font-size:"+c.sz+"pt;"),c.outline&&s.push("text-effect: outline;"),c.shadow&&s.push("text-shadow: auto;"),u.push('<span style="'+s.join("")+'">'),c.b&&(u.push("<b>"),d.push("</b>")),c.i&&(u.push("<i>"),d.push("</i>")),c.strike&&(u.push("<s>"),d.push("</s>")),(s=c.valign||"")=="superscript"||s=="super"?s="sup":s=="subscript"&&(s="sub"),s!=""&&(u.push("<"+s+">"),d.push("</"+s+">")),d.push("</span>")),g[0].join("")+g[1].replace(jd,"<br/>")+g[2].join("")):""}var xp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Lf=/<(?:\w+:)?r>/,Pf=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fh(s,d){var u=!d||d.cellHTML,d={};return s?(s.match(/^\s*<(?:\w+:)?t[^>]*>/)?(d.t=cn(Xn(s.slice(s.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),d.r=Xn(s),u&&(d.h=pu(d.t))):s.match(Lf)&&(d.r=Xn(s),d.t=cn(Xn((s.replace(Pf,"").match(xp)||[]).join("").replace(os,""))),u&&(d.h=Od(qa(d.r)))),d):{t:""}}var fi=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Fs=/<(?:\w+:)?(?:si|sstItem)>/g,Kh=/<\/(?:\w+:)?(?:si|sstItem)>/,Xc=/^\s|\s$|[\t\n\r]/;function Tu(s,c){if(!c.bookSST)return"";var u=[is];u[u.length]=Xt("sst",null,{xmlns:Jo[0],count:s.Count,uniqueCount:s.Unique});for(var d,g,x=0;x!=s.length;++x)s[x]!=null&&(g="<si>",(d=s[x]).r?g+=d.r:(g+="<t",d.t||(d.t=""),d.t.match(Xc)&&(g+=' xml:space="preserve"'),g+=">"+aa(d.t)+"</t>"),g+="</si>",u[u.length]=g);return 2<u.length&&(u[u.length]="</sst>",u[1]=u[1].replace("/>",">")),u.join("")}var Eu=function(s,c){var u=!1;return c==null&&(u=!0,c=xt(15+4*s.t.length)),c.write_shift(1,0),Oa(s.t,c),u?c.slice(0,c.l):c};function Jl(s){var c,u,d=xs();jt(d,159,(c=s,(u=u||xt(8)).write_shift(4,c.Count),u.write_shift(4,c.Unique),u));for(var g=0;g<s.length;++g)jt(d,19,Eu(s[g]));return jt(d,160),d.end()}function Yh(s){if(e!==void 0)return e.utils.encode(m,s);for(var c=[],u=s.split(""),d=0;d<u.length;++d)c[d]=u[d].charCodeAt(0);return c}function fo(s,c){var u={};return u.Major=s.read_shift(2),u.Minor=s.read_shift(2),4<=c&&(s.l+=c-4),u}function Ld(s){var c=[];s.l+=4;for(var u=s.read_shift(4);0<u--;)c.push((function(d){for(var x=d.read_shift(4),g=d.l+x-4,x={},b=d.read_shift(4),S=[];0<b--;)S.push({t:d.read_shift(4),v:d.read_shift(0,"lpp4")});if(x.name=d.read_shift(0,"lpp4"),x.comps=S,d.l!=g)throw new Error("Bad DataSpaceMapEntry: "+d.l+" != "+g);return x})(s));return c}function Pd(s){var c,u,u=(u={},(c=s).read_shift(4),c.l+=4,u.id=c.read_shift(0,"lpp4"),u.name=c.read_shift(0,"lpp4"),u.R=fo(c,4),u.U=fo(c,4),u.W=fo(c,4),u);if(u.ename=s.read_shift(0,"8lpp4"),u.blksz=s.read_shift(4),u.cmode=s.read_shift(4),s.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function Ql(s,u){var u=s.l+u,d={};d.Flags=63&s.read_shift(4),s.l+=4,d.AlgID=s.read_shift(4);var g=!1;switch(d.AlgID){case 26126:case 26127:case 26128:g=d.Flags==36;break;case 26625:g=d.Flags==4;break;case 0:g=d.Flags==16||d.Flags==4||d.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+d.AlgID}if(!g)throw new Error("Encryption Flags/AlgID mismatch");return d.AlgIDHash=s.read_shift(4),d.KeySize=s.read_shift(4),d.ProviderType=s.read_shift(4),s.l+=8,d.CSPName=s.read_shift(u-s.l>>1,"utf16le"),s.l=u,d}function Md(s,d){var u={},d=s.l+d;return s.l+=4,u.Salt=s.slice(s.l,s.l+16),s.l+=16,u.Verifier=s.slice(s.l,s.l+16),s.l+=16,s.read_shift(4),u.VerifierHash=s.slice(s.l,d),s.l=d,u}function Mf(s){var c=fo(s);switch(c.Minor){case 2:return[c.Minor,(function(g){if((63&g.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var d=g.read_shift(4),d=Ql(g,d),g=Md(g,g.length-g.l);return{t:"Std",h:d,v:g}})(s)];case 3:return[c.Minor,(function(){throw new Error("File is password-protected: ECMA-376 Extensible")})()];case 4:return[c.Minor,(function(g){var d=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];g.l+=4;var g=g.read_shift(g.length-g.l,"utf8"),x={};return g.replace(os,function(b){var S=ln(b);switch(Zs(S[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":d.forEach(function(N){x[N]=S[N]});break;case"<dataIntegrity":x.encryptedHmacKey=S.encryptedHmacKey,x.encryptedHmacValue=S.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":x.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":x.uri=S.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":x.encs.push(S);break;default:throw S[0]}}),x})(s)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+c.Minor)}function Ud(s){var c,u=0,d=Yh(s),g=d.length+1,x=De(g);for(x[0]=d.length,c=1;c!=g;++c)x[c]=d[c-1];for(c=g-1;0<=c;--c)u=(((16384&u)==0?0:1)|u<<1&32767)^x[c];return 52811^u}var Jh,Ic,Uf,Bf=(Jh=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],Ic=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],Uf=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(s){for(var c,u,d=Yh(s),g=(function(N){for(var T=Ic[N.length-1],F=104,O=N.length-1;0<=O;--O)for(var L=N[O],B=0;B!=7;++B)64&L&&(T^=Uf[F]),L*=2,--F;return T})(d),x=d.length,b=De(16),S=0;S!=16;++S)b[S]=0;for((1&x)==1&&(c=g>>8,b[x]=ku(Jh[0],c),--x,c=255&g,s=d[d.length-1],b[x]=ku(s,c));0<x;)c=g>>8,b[--x]=ku(d[x],c),c=255&g,b[--x]=ku(d[x],c);for(u=(x=15)-d.length;0<u;)c=g>>8,b[x]=ku(Jh[u],c),--u,c=255&g,b[--x]=ku(d[x],c),--x,--u;return b});function ku(s,c){return 255&((c=s^c)/2|128*c)}var Hf=function(s){var c=0,u=Bf(s);return function(d){return d=(function(g,x,b,S,N){var T,F;for(N=N||x,S=S||Bf(g),T=0;T!=x.length;++T)F=x[T],F=255&((F^=S[b])>>5|F<<3),N[T]=F,++b;return[N,b,S]})("",d,c,u),c=d[1],d[0]}};function B0(s,c,u){return u=u||{},u.Info=s.read_shift(2),s.l-=2,u.Info===1?u.Data=(function(d){var g={},x=g.EncryptionVersionInfo=fo(d,4);if(x.Major!=1||x.Minor!=1)throw"unrecognized version code "+x.Major+" : "+x.Minor;return g.Salt=d.read_shift(16),g.EncryptedVerifier=d.read_shift(16),g.EncryptedVerifierHash=d.read_shift(16),g})(s):u.Data=(function(d,g){var x={},b=x.EncryptionVersionInfo=fo(d,4);if(g-=4,b.Minor!=2)throw new Error("unrecognized minor version code: "+b.Minor);if(4<b.Major||b.Major<2)throw new Error("unrecognized major version code: "+b.Major);return x.Flags=d.read_shift(4),g-=4,b=d.read_shift(4),g-=4,x.EncryptionHeader=Ql(d,b),g-=b,x.EncryptionVerifier=Md(d,g),x})(s,c),u}var Zc={to_workbook:function(s,c){return oi(Qh(s,c),c)},to_sheet:Qh,from_sheet:function(s){for(var c=["{\\rtf1\\ansi"],u=wn(s["!ref"]),d=Array.isArray(s),g=u.s.r;g<=u.e.r;++g){c.push("\\trowd\\trautofit1");for(var x=u.s.c;x<=u.e.c;++x)c.push("\\cellx"+(x+1));for(c.push("\\pard\\intbl"),x=u.s.c;x<=u.e.c;++x){var b=sn({r:g,c:x});(b=d?(s[g]||[])[x]:s[b])&&(b.v!=null||b.f&&!b.F)&&(c.push(" "+(b.w||(io(b),b.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}};function Qh(s,c){switch(c.type){case"base64":return eu(re(s),c);case"binary":return eu(s,c);case"buffer":return eu(xe&&Buffer.isBuffer(s)?s.toString("binary"):z(s),c);case"array":return eu(Cs(s),c)}throw new Error("Unrecognized type "+c.type)}function eu(d,c){var u=(c||{}).dense?[]:{},d=d.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(x,b){Array.isArray(u)&&(u[b]=[]);for(var S,N=/\\\w+\b/g,T=0,F=-1;S=N.exec(x);)S[0]==="\\cell"&&(++F,(S=(S=x.slice(T,N.lastIndex-S[0].length))[0]==" "?S.slice(1):S).length&&(S={v:S,t:"s"},Array.isArray(u)?u[b][F]=S:u[sn({r:b,c:F})]=S)),T=N.lastIndex;F>g.e.c&&(g.e.c=F)}),u["!ref"]=rn(g),u}function po(s){for(var c=0,u=1;c!=3;++c)u=256*u+(255<s[c]?255:s[c]<0?0:s[c]);return u.toString(16).toUpperCase().slice(1)}function tl(s,c){return c===0?s:(s=(function(F){var d=F[0]/255,g=F[1]/255,x=F[2]/255,b=Math.max(d,g,x),S=Math.min(d,g,x),N=b-S;if(N==0)return[0,0,d];var T=0,F=0,F=N/(1<(S=b+S)?2-S:S);switch(b){case d:T=((g-x)/N+6)%6;break;case g:T=(x-d)/N+2;break;case x:T=(d-g)/N+4}return[T/6,F,S/2]})((s=(s=s).slice(s[0]==="#"?1:0).slice(0,6),[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)])),s[2]=c<0?s[2]*(1+c):1-(1-s[2])*(1-c),po((function(b){var d,g=b[0],x=b[1],b=b[2],S=2*x*(b<.5?b:1-b),N=[b=b-S/2,b,b],T=6*g;if(x!==0)switch(0|T){case 0:case 6:d=S*T,N[0]+=S,N[1]+=d;break;case 1:d=S*(2-T),N[0]+=d,N[1]+=S;break;case 2:d=S*(T-2),N[1]+=S,N[2]+=d;break;case 3:d=S*(4-T),N[1]+=d,N[2]+=S;break;case 4:d=S*(T-4),N[2]+=S,N[0]+=d;break;case 5:d=S*(6-T),N[2]+=d,N[0]+=S}for(var F=0;F!=3;++F)N[F]=Math.round(255*N[F]);return N})(s)))}var Xl=6,Bd=15,Hd=1,Rs=Xl;function ph(s){return Math.floor((s+Math.round(128/Rs)/256)*Rs)}function Zl(s){return Math.floor((s-5)/Rs*100+.5)/100}function Dc(s){return Math.round((s*Rs+5)/Rs*256)/256}function H0(s){return Dc(Zl(ph(s)))}function zf(s){var c=Math.abs(s-H0(s)),u=Rs;if(.005<c)for(Rs=Hd;Rs<Bd;++Rs)Math.abs(s-H0(s))<=c&&(c=Math.abs(s-H0(s)),u=Rs);Rs=u}function mh(s){s.width?(s.wpx=ph(s.width),s.wch=Zl(s.wpx),s.MDW=Rs):s.wpx?(s.wch=Zl(s.wpx),s.width=Dc(s.wch),s.MDW=Rs):typeof s.wch=="number"&&(s.width=Dc(s.wch),s.wpx=ph(s.width),s.MDW=Rs),s.customWidth&&delete s.customWidth}var wp=96;function zd(s){return 96*s/wp}function Xh(s){return s*wp/96}var Xm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},$f=["numFmtId","fillId","fontId","borderId","xfId"],$d=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Sp,Ap,z0,Cp,Np,qf,Tp=(Sp=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,Ap=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,z0=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,Cp=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Np=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(s,c,u){var d,g,x,b,S,N={};return s&&((d=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Sp))&&(function(T,F,O){F.NumberFmt=[];for(var L=fa(se),B=0;B<L.length;++B)F.NumberFmt[L[B]]=se[L[B]];var ee=T[0].match(os);if(ee)for(B=0;B<ee.length;++B){var G=ln(ee[B]);switch(Zs(G[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var he=cn(Xn(G.formatCode)),ne=parseInt(G.numFmtId,10);if(F.NumberFmt[ne]=he,0<ne){if(392<ne){for(ne=392;60<ne&&F.NumberFmt[ne]!=null;--ne);F.NumberFmt[ne]=he}an(he,ne)}break;case"</numFmt>":break;default:if(O.WTF)throw new Error("unrecognized "+G[0]+" in numFmts")}}})(d,N,u),(d=s.match(Cp))&&(function(T,F,O,L){F.Fonts=[];var B={},ee=!1;(T[0].match(os)||[]).forEach(function(G){var he,ne=ln(G);switch(Zs(ne[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":F.Fonts.push(B),B={};break;case"<name":ne.val&&(B.name=Xn(ne.val));break;case"<name/>":case"</name>":break;case"<b":B.bold=ne.val?Ea(ne.val):1;break;case"<b/>":B.bold=1;break;case"<i":B.italic=ne.val?Ea(ne.val):1;break;case"<i/>":B.italic=1;break;case"<u":switch(ne.val){case"none":B.underline=0;break;case"single":B.underline=1;break;case"double":B.underline=2;break;case"singleAccounting":B.underline=33;break;case"doubleAccounting":B.underline=34}break;case"<u/>":B.underline=1;break;case"<strike":B.strike=ne.val?Ea(ne.val):1;break;case"<strike/>":B.strike=1;break;case"<outline":B.outline=ne.val?Ea(ne.val):1;break;case"<outline/>":B.outline=1;break;case"<shadow":B.shadow=ne.val?Ea(ne.val):1;break;case"<shadow/>":B.shadow=1;break;case"<condense":B.condense=ne.val?Ea(ne.val):1;break;case"<condense/>":B.condense=1;break;case"<extend":B.extend=ne.val?Ea(ne.val):1;break;case"<extend/>":B.extend=1;break;case"<sz":ne.val&&(B.sz=+ne.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":ne.val&&(B.vertAlign=ne.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":ne.val&&(B.family=parseInt(ne.val,10));break;case"<family/>":case"</family>":break;case"<scheme":ne.val&&(B.scheme=ne.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(ne.val=="1")break;ne.codepage=w[parseInt(ne.val,10)];break;case"<color":B.color||(B.color={}),ne.auto&&(B.color.auto=Ea(ne.auto)),ne.rgb?B.color.rgb=ne.rgb.slice(-6):ne.indexed?(B.color.index=parseInt(ne.indexed,10),he=vu[B.color.index],he=(he=B.color.index==81?vu[1]:he)||vu[1],B.color.rgb=he[0].toString(16)+he[1].toString(16)+he[2].toString(16)):ne.theme&&(B.color.theme=parseInt(ne.theme,10),ne.tint&&(B.color.tint=parseFloat(ne.tint)),ne.theme&&O.themeElements&&O.themeElements.clrScheme&&(B.color.rgb=tl(O.themeElements.clrScheme[B.color.theme].rgb,B.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":ee=!0;break;case"</AlternateContent>":ee=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":ee=!0;break;case"</ext>":ee=!1;break;default:if(L&&L.WTF&&!ee)throw new Error("unrecognized "+ne[0]+" in fonts")}})})(d,N,c,u),(d=s.match(z0))&&(function(T,F,O){F.Fills=[];var L={},B=!1;(T[0].match(os)||[]).forEach(function(ee){var G=ln(ee);switch(Zs(G[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":L={},F.Fills.push(L);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":F.Fills.push(L),L={};break;case"<patternFill":case"<patternFill>":G.patternType&&(L.patternType=G.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":L.bgColor||(L.bgColor={}),G.indexed&&(L.bgColor.indexed=parseInt(G.indexed,10)),G.theme&&(L.bgColor.theme=parseInt(G.theme,10)),G.tint&&(L.bgColor.tint=parseFloat(G.tint)),G.rgb&&(L.bgColor.rgb=G.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":L.fgColor||(L.fgColor={}),G.theme&&(L.fgColor.theme=parseInt(G.theme,10)),G.tint&&(L.fgColor.tint=parseFloat(G.tint)),G.rgb!=null&&(L.fgColor.rgb=G.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;default:if(O&&O.WTF&&!B)throw new Error("unrecognized "+G[0]+" in fills")}})})(d,N,u),(d=s.match(Np))&&(function(T,F,O){F.Borders=[];var L={},B=!1;(T[0].match(os)||[]).forEach(function(ee){var G=ln(ee);switch(Zs(G[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":L={},G.diagonalUp&&(L.diagonalUp=Ea(G.diagonalUp)),G.diagonalDown&&(L.diagonalDown=Ea(G.diagonalDown)),F.Borders.push(L);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;default:if(O&&O.WTF&&!B)throw new Error("unrecognized "+G[0]+" in borders")}})})(d,N,u),(d=s.match(Ap))&&(d=d,x=u,S=!((g=N).CellXf=[]),(d[0].match(os)||[]).forEach(function(T){var F=ln(T),O=0;switch(Zs(F[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(b=F)[0],O=0;O<$f.length;++O)b[$f[O]]&&(b[$f[O]]=parseInt(b[$f[O]],10));for(O=0;O<$d.length;++O)b[$d[O]]&&(b[$d[O]]=Ea(b[$d[O]]));if(g.NumberFmt&&392<b.numFmtId){for(O=392;60<O;--O)if(g.NumberFmt[b.numFmtId]==g.NumberFmt[O]){b.numFmtId=O;break}}g.CellXf.push(b);break;case"</xf>":break;case"<alignment":case"<alignment/>":var L={};F.vertical&&(L.vertical=F.vertical),F.horizontal&&(L.horizontal=F.horizontal),F.textRotation!=null&&(L.textRotation=F.textRotation),F.indent&&(L.indent=F.indent),F.wrapText&&(L.wrapText=Ea(F.wrapText)),b.alignment=L;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":S=!0;break;case"</AlternateContent>":S=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":S=!0;break;case"</ext>":S=!1;break;default:if(x&&x.WTF&&!S)throw new Error("unrecognized "+F[0]+" in cellXfs")}}))),N});function Ep(s,c){if(qf!==void 0)return qf.toXml();var u,d,g,x,b=[is,Xt("styleSheet",null,{xmlns:Jo[0],"xmlns:vt":ls.vt})];return s.SSF&&(d=s.SSF,g=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(S){for(var N=S[0];N<=S[1];++N)d[N]!=null&&(g[g.length]=Xt("numFmt",null,{numFmtId:N,formatCode:aa(d[N])}))}),(u=g.length===1?"":(g[g.length]="</numFmts>",g[0]=Xt("numFmts",null,{count:g.length-2}).replace("/>",">"),g.join("")))!=null)&&(b[b.length]=u),b[b.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',b[b.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',b[b.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',b[b.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',c=c.cellXfs,(x=[])[x.length]="<cellXfs/>",c.forEach(function(S){x[x.length]=Xt("xf",null,S)}),x[x.length]="</cellXfs>",(u=x.length===2?"":(x[0]=Xt("cellXfs",null,{count:x.length-2}).replace("/>",">"),x.join("")))&&(b[b.length]=u),b[b.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',b[b.length]='<dxfs count="0"/>',b[b.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<b.length&&(b[b.length]="</styleSheet>",b[1]=b[1].replace("/>",">")),b.join("")}function Zm(s,c){var u;(c=c||xt(153)).write_shift(2,20*s.sz),u=s,d=(d=c)||xt(2),u=(u.italic?2:0)|(u.strike?8:0)|(u.outline?16:0)|(u.shadow?32:0)|(u.condense?64:0)|(u.extend?128:0),d.write_shift(1,u),d.write_shift(1,0),c.write_shift(2,s.bold?700:400);var d=0;return s.vertAlign=="superscript"?d=1:s.vertAlign=="subscript"&&(d=2),c.write_shift(2,d),c.write_shift(1,s.underline||0),c.write_shift(1,s.family||0),c.write_shift(1,s.charset||0),c.write_shift(1,0),Ca(s.color,c),d=0,s.scheme=="major"&&(d=1),s.scheme=="minor"&&(d=2),c.write_shift(1,d),Oa(s.name,c),c.length>c.l?c.slice(0,c.l):c}var $0,eg=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],tg=cs;function rg(s,c){c=c||xt(84),s=($0=$0||Yr(eg))[s.patternType],s==null&&(s=40),c.write_shift(4,s);var u=0;if(s!=40)for(Ca({auto:1},c),Ca({auto:1},c);u<12;++u)c.write_shift(4,0);else{for(;u<4;++u)c.write_shift(4,0);for(;u<12;++u)c.write_shift(4,0)}return c.length>c.l?c.slice(0,c.l):c}function ng(s,c,u){return(u=u||xt(16)).write_shift(2,c||0),u.write_shift(2,s.numFmtId||0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u}function qd(s,c){return(c=c||xt(10)).write_shift(1,0),c.write_shift(1,0),c.write_shift(4,0),c.write_shift(4,0),c}Ri=cs;function Gf(s,c){var u;c&&(u=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(d){for(var g=d[0];g<=d[1];++g)c[g]!=null&&++u}),u!=0&&(jt(s,615,Qa(u)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(d){for(var g,x,b,S=d[0];S<=d[1];++S)c[S]!=null&&jt(s,44,(g=S,x=c[S],(b=(b=void 0)||xt(6+4*x.length)).write_shift(2,g),Oa(x,b),x=b.length>b.l?b.slice(0,b.l):b,b.l==null&&(b.l=b.length),x))}),jt(s,616)))}function kp(s){var c;jt(s,613,Qa(1)),jt(s,46,((c=c||xt(51)).write_shift(1,0),qd(0,c),qd(0,c),qd(0,c),qd(0,c),qd(0,c),c.length>c.l?c.slice(0,c.l):c)),jt(s,614)}function q0(s){var c,u;jt(s,619,Qa(1)),jt(s,48,(c={xfId:0,builtinId:0,name:"Normal"},(u=u||xt(52)).write_shift(4,c.xfId),u.write_shift(2,1),u.write_shift(1,+c.builtinId),u.write_shift(1,0),gc(c.name||"",u),u.length>u.l?u.slice(0,u.l):u)),jt(s,620)}function ag(s){var c,u,d,g;jt(s,508,(c=0,u="TableStyleMedium9",d="PivotStyleMedium4",(g=xt(2052)).write_shift(4,c),gc(u,g),gc(d,g),g.length>g.l?g.slice(0,g.l):g)),jt(s,509)}function sg(s,c){var u,d=xs();return jt(d,278),Gf(d,s.SSF),jt(s=d,611,Qa(1)),jt(s,43,Zm({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),jt(s,612),jt(s=d,603,Qa(2)),jt(s,45,rg({patternType:"none"})),jt(s,45,rg({patternType:"gray125"})),jt(s,604),kp(d),jt(s=d,626,Qa(1)),jt(s,47,ng({numFmtId:0},65535)),jt(s,627),u=d,c=c.cellXfs,jt(u,617,Qa(c.length)),c.forEach(function(g){jt(u,47,ng(g,0))}),jt(u,618),q0(d),jt(c=d,505,Qa(0)),jt(c,506),ag(d),jt(d,279),d.end()}var Vf=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ig(s,c,u){c.themeElements.clrScheme=[];var d={};(s[0].match(os)||[]).forEach(function(g){var x=ln(g);switch(x[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":d.rgb=x.val;break;case"<a:sysClr":d.rgb=x.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":x[0].charAt(1)==="/"?(c.themeElements.clrScheme[Vf.indexOf(x[0])]=d,d={}):d.name=x[0].slice(3,x[0].length-1);break;default:if(u&&u.WTF)throw new Error("Unrecognized "+x[0]+" in clrScheme")}})}function _p(){}function og(){}var Ip=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Dp=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,lg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,cg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function gh(s,c){var u,d,g,x,b,S={};if(!(u=(s=!s||s.length===0?G0():s).match(cg)))throw new Error("themeElements not found in theme");return d=u[0],x=c,(g=S).themeElements={},[["clrScheme",Ip,ig],["fontScheme",Dp,_p],["fmtScheme",lg,og]].forEach(function(N){if(!(b=d.match(N[1])))throw new Error(N[0]+" not found in themeElements");N[2](b,g,x)}),S.raw=s,S}function G0(s,c){return c&&c.themeXLSX?c.themeXLSX:s&&typeof s.raw=="string"?s.raw:(s=[is],s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join(""))}function ug(s){var c={};switch(c.xclrType=s.read_shift(2),c.nTintShade=s.read_shift(2),c.xclrType){case 0:s.l+=4;break;case 1:c.xclrValue=cs(s,4);break;case 2:c.xclrValue=Cu(s);break;case 3:c.xclrValue=s.read_shift(4);break;case 4:s.l+=4}return s.l+=8,c}function hg(s){var c=s.read_shift(2),u=s.read_shift(2)-4,d=[c];switch(c){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:d[1]=ug(s);break;case 6:d[1]=cs(s,u);break;case 14:case 15:d[1]=s.read_shift(u==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+c+" "+u)}return d}function V0(){var s,c,u,d=xs();return jt(d,332),jt(d,334,Qa(1)),jt(d,335,((u=xt(12+2*(c={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,c.flags),u.write_shift(4,c.version),Oa(c.name,u),u.slice(0,u.l))),jt(d,336),jt(d,339,(s=1,(u=xt(8+2*(c="XLDAPR").length)).write_shift(4,s),Oa(c,u),u.slice(0,u.l))),jt(d,52),jt(d,35,Qa(514)),jt(d,4096,Qa(0)),jt(d,4097,ho(1)),jt(d,36),jt(d,53),jt(d,340),jt(d,337,(s=1,c=!0,(u=xt(8)).write_shift(4,s),u.write_shift(4,c?1:0),u)),jt(d,51,(function(g){var x=xt(4+8*g.length);x.write_shift(4,g.length);for(var b=0;b<g.length;++b)x.write_shift(4,g[b][0]),x.write_shift(4,g[b][1]);return x})([[1,0]])),jt(d,338),jt(d,333),d.end()}function Fp(){var s=[is];return s.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),s.join("")}var yh=1024;function Rp(s,c){for(var u=[21600,21600],d=["m0,0l0",u[1],u[0],u[1],u[0],"0xe"].join(","),g=[Xt("xml",null,{"xmlns:v":wa.v,"xmlns:o":wa.o,"xmlns:x":wa.x,"xmlns:mv":wa.mv}).replace(/\/>/,">"),Xt("o:shapelayout",Xt("o:idmap",null,{"v:ext":"edit",data:s}),{"v:ext":"edit"}),Xt("v:shapetype",[Xt("v:stroke",null,{joinstyle:"miter"}),Xt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:u.join(","),path:d})];yh<1e3*s;)yh+=1e3;return c.forEach(function(x){var b=ga(x[0]),N={color2:"#BEFF82",type:"gradient"};N.type=="gradient"&&(N.angle="-180");var S=N.type=="gradient"?Xt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,N=Xt("v:fill",S,N);++yh,g=g.concat(["<v:shape"+wi({id:"_x0000_s"+yh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(x[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",N,Xt("v:shadow",null,{on:"t",obscured:"t"}),Xt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",vs("x:Anchor",[b.c+1,0,b.r+1,0,b.c+3,20,b.r+5,20].join(",")),vs("x:AutoFill","False"),vs("x:Row",String(b.r)),vs("x:Column",String(b.c)),x[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),g.push("</xml>"),g.join("")}function jp(s,c,u,d){var g,x=Array.isArray(s);c.forEach(function(b){var S,N=ga(b.ref);(g=x?(s[N.r]||(s[N.r]=[]),s[N.r][N.c]):s[b.ref])||(g={t:"z"},x?s[N.r][N.c]=g:s[b.ref]=g,(S=wn(s["!ref"]||"BDWGO1000001:A1")).s.r>N.r&&(S.s.r=N.r),S.e.r<N.r&&(S.e.r=N.r),S.s.c>N.c&&(S.s.c=N.c),S.e.c<N.c&&(S.e.c=N.c),(S=rn(S))!==s["!ref"]&&(s["!ref"]=S)),g.c||(g.c=[]);var T={a:b.author,t:b.t,r:b.r,T:u};b.h&&(T.h=b.h);for(var F=g.c.length-1;0<=F;--F){if(!u&&g.c[F].T)return;u&&!g.c[F].T&&g.c.splice(F,1)}if(u&&d){for(F=0;F<d.length;++F)if(T.a==d[F].id){T.a=d[F].name||T.a;break}}g.c.push(T)})}function dg(s){var c=[is,Xt("comments",null,{xmlns:Jo[0]})],u=[];return c.push("<authors>"),s.forEach(function(d){d[1].forEach(function(g){var x=aa(g.a);u.indexOf(x)==-1&&(u.push(x),c.push("<author>"+x+"</author>")),g.T&&g.ID&&u.indexOf("tc="+g.ID)==-1&&(u.push("tc="+g.ID),c.push("<author>tc="+g.ID+"</author>"))})}),u.length==0&&(u.push("SheetJ5"),c.push("<author>SheetJ5</author>")),c.push("</authors>"),c.push("<commentList>"),s.forEach(function(d){var g=0,x=[];if(d[1][0]&&d[1][0].T&&d[1][0].ID?g=u.indexOf("tc="+d[1][0].ID):d[1].forEach(function(N){N.a&&(g=u.indexOf(aa(N.a))),x.push(N.t||"")}),c.push('<comment ref="'+d[0]+'" authorId="'+g+'"><text>'),x.length<=1)c.push(vs("t",aa(x[0]||"")));else{for(var b=`Comment:
    `+x[0]+`
`,S=1;S<x.length;++S)b+=`Reply:
    `+x[S]+`
`;c.push(vs("t",aa(b)))}c.push("</text></comment>")}),c.push("</commentList>"),2<c.length&&(c[c.length]="</comments>",c[1]=c[1].replace("/>",">")),c.join("")}pl=Xa;function Op(s){var c=xs(),u=[];return jt(c,628),jt(c,630),s.forEach(function(d){d[1].forEach(function(g){-1<u.indexOf(g.a)||(u.push(g.a.slice(0,54)),jt(c,632,Oa(g.a.slice(0,54))))})}),jt(c,631),jt(c,633),s.forEach(function(d){d[1].forEach(function(g){g.iauthor=u.indexOf(g.a);var x,b={s:ga(d[0]),e:ga(d[0])};jt(c,635,(b=[b,g],(x=x??xt(36)).write_shift(4,b[1].iauthor),Ci(b[0],x),x.write_shift(4,0),x.write_shift(4,0),x.write_shift(4,0),x.write_shift(4,0),x)),g.t&&0<g.t.length&&jt(c,637,lh(g)),jt(c,636),delete g.iauthor})}),jt(c,634),jt(c,629),c.end()}var pi="application/vnd.ms-office.vbaProject",Vi=["xlsb","xlsm","xlam","biff8","xla"],W0,Lp,Zh=(Lp=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(s,c){return W0=c,s.replace(Lp,fg)});function fg(s,c,u,d){var g=!1,x=!1;return u.length==0?x=!0:u.charAt(0)=="["&&(x=!0,u=u.slice(1,-1)),d.length==0?g=!0:d.charAt(0)=="["&&(g=!0,d=d.slice(1,-1)),u=0<u.length?0|parseInt(u,10):0,d=0<d.length?0|parseInt(d,10):0,g?d+=W0.c:--d,x?u+=W0.r:--u,c+(g?"":"$")+Ln(d)+(x?"":"$")+ja(u)}var ed=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,K0=function(s,c){return s.replace(ed,function(u,d,g,x,b,S){return x=Qo(x)-(g?0:c.c),S=Hl(S)-(b?0:c.r),d+"R"+(S==0?"":b?1+S:"["+S+"]")+"C"+(x==0?"":g?1+x:"["+x+"]")})};function Wf(s,c){return s.replace(ed,function(u,d,g,x,b,S){return d+(g=="$"?g+x:Ln(Qo(x)+c.c))+(b=="$"?b+S:ja(Hl(S)+c.r))})}function Pp(s){return s.replace(/_xlfn\./g,"")}function mi(s){s.l+=1}function Fc(s,c){return c=s.read_shift(c==1?1:2),[16383&c,c>>14&1,c>>15&1]}function Y0(b,c,g){var x=2;if(g){if(2<=g.biff&&g.biff<=5)return Mp(b);g.biff==12&&(x=4)}var d=b.read_shift(x),g=b.read_shift(x),x=Fc(b,2),b=Fc(b,2);return{s:{r:d,c:x[0],cRel:x[1],rRel:x[2]},e:{r:g,c:b[0],cRel:b[1],rRel:b[2]}}}function Mp(g){var c=Fc(g,2),u=Fc(g,2),d=g.read_shift(1),g=g.read_shift(1);return{s:{r:c[0],c:d,cRel:c[1],rRel:c[2]},e:{r:u[0],c:g,cRel:u[1],rRel:u[2]}}}function Up(b,c,x){if(x&&2<=x.biff&&x.biff<=5)return g=Fc(d=b,2),d=d.read_shift(1),{r:g[0],c:d,cRel:g[1],rRel:g[2]};var d,g,x=b.read_shift(x&&x.biff==12?4:2),b=Fc(b,2);return{r:x,c:b[0],cRel:b[1],rRel:b[2]}}function pg(b,c,x){if(x=x&&x.biff?x.biff:8,2<=x&&x<=5)return(function(O){var N=O.read_shift(2),T=O.read_shift(1),F=(32768&N)>>15,O=(16384&N)>>14;return N&=16383,F==1&&8192<=N&&(N-=16384),O==1&&128<=T&&(T-=256),{r:N,c:T,cRel:O,rRel:F}})(b);var d=b.read_shift(12<=x?4:2),g=b.read_shift(2),x=(16384&g)>>14,b=(32768&g)>>15;if(g&=16383,b==1)for(;524287<d;)d-=1048576;if(x==1)for(;8191<g;)g-=16384;return{r:d,c:g,cRel:x,rRel:b}}function J0(s){var c=1&s[s.l+1];return s.l+=4,[c,1]}function Q0(s){return[s.read_shift(1),s.read_shift(1)]}function Bp(s,c,u){var d=0,g=0;u.biff==12?(d=s.read_shift(4),g=s.read_shift(4)):(g=1+s.read_shift(1),d=1+s.read_shift(2)),2<=u.biff&&u.biff<8&&(--d,--g==0&&(g=256));for(var x=0,b=[];x!=d&&(b[x]=[]);++x)for(var S=0;S!=g;++S)b[x][S]=(function(N,T){var F=[N.read_shift(1)];if(T==12)switch(F[0]){case 2:F[0]=4;break;case 4:F[0]=16;break;case 0:F[0]=1;break;case 1:F[0]=2}switch(F[0]){case 4:F[1]=_n(N,1)?"TRUE":"FALSE",T!=12&&(N.l+=7);break;case 37:case 16:F[1]=Zi[N[N.l]],N.l+=T==12?4:8;break;case 0:N.l+=8;break;case 1:F[1]=Sn(N);break;case 2:F[1]=Wl(N,0,{biff:0<T&&T<8?2:T});break;default:throw new Error("Bad SerAr: "+F[0])}return F})(s,u.biff);return b}function Gd(s,c,u){return s.l+=2,[(s=(d=s).read_shift(2),d=d.read_shift(2),{r:s,c:255&d,fQuoted:!!(16384&d),cRel:d>>15,rRel:d>>15})];var d}function Kf(s){return s.l+=6,[]}function Yf(s){return s.l+=2,[Pa(s),1&s.read_shift(2)]}var Hp=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],zp={1:{n:"PtgExp",f:function(s,c,u){return s.l++,u&&u.biff==12?[s.read_shift(4,"i"),0]:[s.read_shift(2),s.read_shift(u&&u.biff==2?1:2)]}},2:{n:"PtgTbl",f:cs},3:{n:"PtgAdd",f:mi},4:{n:"PtgSub",f:mi},5:{n:"PtgMul",f:mi},6:{n:"PtgDiv",f:mi},7:{n:"PtgPower",f:mi},8:{n:"PtgConcat",f:mi},9:{n:"PtgLt",f:mi},10:{n:"PtgLe",f:mi},11:{n:"PtgEq",f:mi},12:{n:"PtgGe",f:mi},13:{n:"PtgGt",f:mi},14:{n:"PtgNe",f:mi},15:{n:"PtgIsect",f:mi},16:{n:"PtgUnion",f:mi},17:{n:"PtgRange",f:mi},18:{n:"PtgUplus",f:mi},19:{n:"PtgUminus",f:mi},20:{n:"PtgPercent",f:mi},21:{n:"PtgParen",f:mi},22:{n:"PtgMissArg",f:mi},23:{n:"PtgStr",f:function(s,c,u){return s.l++,Sl(s,0,u)}},26:{n:"PtgSheet",f:function(s,c,u){return s.l+=5,s.l+=2,s.l+=u.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(s,c,u){return s.l+=u.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(s){return s.l++,Zi[s.read_shift(1)]}},29:{n:"PtgBool",f:function(s){return s.l++,s.read_shift(1)!==0}},30:{n:"PtgInt",f:function(s){return s.l++,s.read_shift(2)}},31:{n:"PtgNum",f:function(s){return s.l++,Sn(s)}},32:{n:"PtgArray",f:function(s,c,u){var d=(96&s[s.l++])>>5;return s.l+=u.biff==2?6:u.biff==12?14:7,[d]}},33:{n:"PtgFunc",f:function(s,c,u){var d=(96&s[s.l])>>5;return s.l+=1,u=s.read_shift(u&&u.biff<=3?1:2),[vg[u],qp[u],d]}},34:{n:"PtgFuncVar",f:function(s,c,u){var d=s[s.l++],g=s.read_shift(1),x=u&&u.biff<=3?[d==88?-1:0,s.read_shift(1)]:[(x=s)[x.l+1]>>7,32767&x.read_shift(2)];return[g,(x[0]===0?qp:vh)[x[1]]]}},35:{n:"PtgName",f:function(s,c,u){var d=s.read_shift(1)>>>5&3,g=!u||8<=u.biff?4:2,g=s.read_shift(g);switch(u.biff){case 2:s.l+=5;break;case 3:case 4:s.l+=8;break;case 5:s.l+=12}return[d,0,g]}},36:{n:"PtgRef",f:function(s,c,u){var d=(96&s[s.l])>>5;return s.l+=1,[d,Up(s,0,u)]}},37:{n:"PtgArea",f:function(s,c,u){return[(96&s[s.l++])>>5,Y0(s,2<=u.biff&&u.biff,u)]}},38:{n:"PtgMemArea",f:function(s,c,u){var d=s.read_shift(1)>>>5&3;return s.l+=u&&u.biff==2?3:4,[d,s.read_shift(u&&u.biff==2?1:2)]}},39:{n:"PtgMemErr",f:cs},40:{n:"PtgMemNoMem",f:cs},41:{n:"PtgMemFunc",f:function(s,c,u){return[s.read_shift(1)>>>5&3,s.read_shift(u&&u.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(s,c,u){var d=s.read_shift(1)>>>5&3;return s.l+=4,u.biff<8&&s.l--,u.biff==12&&(s.l+=2),[d]}},43:{n:"PtgAreaErr",f:function(s,c,u){var d=(96&s[s.l++])>>5;return s.l+=u&&8<u.biff?12:u.biff<8?6:8,[d]}},44:{n:"PtgRefN",f:function(s,c,u){var d=(96&s[s.l])>>5;return s.l+=1,[d,pg(s,0,u)]}},45:{n:"PtgAreaN",f:function(s,c,u){return[(96&s[s.l++])>>5,(function(N,S){if(S.biff<8)return Mp(N);var x=N.read_shift(S.biff==12?4:2),b=N.read_shift(S.biff==12?4:2),S=Fc(N,2),N=Fc(N,2);return{s:{r:x,c:S[0],cRel:S[1],rRel:S[2]},e:{r:b,c:N[0],cRel:N[1],rRel:N[2]}}})(s,u)]}},46:{n:"PtgMemAreaN",f:function(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},57:{n:"PtgNameX",f:function(s,c,u){return u.biff==5?(function(d){var g=d.read_shift(1)>>>5&3,x=d.read_shift(2,"i");d.l+=8;var b=d.read_shift(2);return d.l+=12,[g,x,b]})(s):[s.read_shift(1)>>>5&3,s.read_shift(2),s.read_shift(4)]}},58:{n:"PtgRef3d",f:function(s,c,u){var d=(96&s[s.l])>>5;s.l+=1;var g=s.read_shift(2);return u&&u.biff==5&&(s.l+=12),[d,g,Up(s,0,u)]}},59:{n:"PtgArea3d",f:function(s,c,u){var d=(96&s[s.l++])>>5,g=s.read_shift(2,"i");return u&&u.biff===5&&(s.l+=12),[d,g,Y0(s,0,u)]}},60:{n:"PtgRefErr3d",f:function(s,c,u){var d=(96&s[s.l++])>>5,g=s.read_shift(2),x=4;if(u)switch(u.biff){case 5:x=15;break;case 12:x=6}return s.l+=x,[d,g]}},61:{n:"PtgAreaErr3d",f:function(s,c,u){var d=(96&s[s.l++])>>5,g=s.read_shift(2),x=8;if(u)switch(u.biff){case 5:s.l+=12,x=6;break;case 12:x=12}return s.l+=x,[d,g]}},255:{}},$p={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},mg={1:{n:"PtgElfLel",f:Yf},2:{n:"PtgElfRw",f:Gd},3:{n:"PtgElfCol",f:Gd},6:{n:"PtgElfRwV",f:Gd},7:{n:"PtgElfColV",f:Gd},10:{n:"PtgElfRadical",f:Gd},11:{n:"PtgElfRadicalS",f:Kf},13:{n:"PtgElfColS",f:Kf},15:{n:"PtgElfColSV",f:Kf},16:{n:"PtgElfRadicalLel",f:Yf},25:{n:"PtgList",f:function(x){x.l+=2;var c=x.read_shift(2),u=x.read_shift(2),d=x.read_shift(4),g=x.read_shift(2),x=x.read_shift(2);return{ixti:c,coltype:3&u,rt:Hp[u>>2&31],idx:d,c:g,C:x}}},29:{n:"PtgSxName",f:function(s){return s.l+=2,[s.read_shift(4)]}},255:{}},_u={0:{n:"PtgAttrNoop",f:function(s){return s.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(s,c,u){var d=255&s[s.l+1]?1:0;return s.l+=u&&u.biff==2?3:4,[d]}},2:{n:"PtgAttrIf",f:function(s,c,u){var d=255&s[s.l+1]?1:0;return s.l+=2,[d,s.read_shift(u&&u.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(s,c,u){s.l+=2;for(var d=s.read_shift(u&&u.biff==2?1:2),g=[],x=0;x<=d;++x)g.push(s.read_shift(u&&u.biff==2?1:2));return g}},8:{n:"PtgAttrGoto",f:function(s,c,u){var d=255&s[s.l+1]?1:0;return s.l+=2,[d,s.read_shift(u&&u.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(s,c,u){s.l+=u&&u.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:J0},33:{n:"PtgAttrBaxcel",f:J0},64:{n:"PtgAttrSpace",f:function(s){return s.read_shift(2),Q0(s)}},65:{n:"PtgAttrSpaceSemi",f:function(s){return s.read_shift(2),Q0(s)}},128:{n:"PtgAttrIfError",f:function(s){var c=255&s[s.l+1]?1:0;return s.l+=2,[c,s.read_shift(2)]}},255:{}};function td(s,c,u,d){if(d.biff<8)return cs(s,c);for(var g=s.l+c,x=[],b=0;b!==u.length;++b)switch(u[b][0]){case"PtgArray":u[b][1]=Bp(s,0,d),x.push(u[b][1]);break;case"PtgMemArea":u[b][2]=(function(S,N){for(var T=S.read_shift(N.biff==12?4:2),F=[],O=0;O!=T;++O)F.push((N.biff==12?Ts:Ks)(S));return F})(s,(u[b][1],d)),x.push(u[b][2]);break;case"PtgExp":d&&d.biff==12&&(u[b][1][1]=s.read_shift(4),x.push(u[b][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+u[b][0]}return(c=g-s.l)!==0&&x.push(cs(s,c)),x}function Jf(s,c,u){for(var d,g,x=s.l+c,b=[];x!=s.l;)c=x-s.l,g=s[s.l],d=zp[g]||zp[$p[g]],(d=g===24||g===25?(g===24?mg:_u)[s[s.l+1]]:d)&&d.f?b.push([d.n,d.f(s,c,u)]):cs(s,c);return b}var gg={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tu(s,c,u){if(!s)return"SH33TJSERR0";if(8<u.biff&&(!s.XTI||!s.XTI[c]))return s.SheetNames[c];if(!s.XTI)return"SH33TJSERR6";var d=s.XTI[c];if(u.biff<8)return 1e4<c&&(c-=65536),(c=c<0?-c:c)==0?"":s.XTI[c-1];if(!d)return"SH33TJSERR1";var g="";if(8<u.biff)switch(s[d[0]][0]){case 357:return g=d[1]==-1?"#REF":s.SheetNames[d[1]],d[1]==d[2]?g:g+":"+s.SheetNames[d[2]];case 358:return u.SID!=null?s.SheetNames[u.SID]:"SH33TJSSAME"+s[d[0]][0];default:return"SH33TJSSRC"+s[d[0]][0]}switch(s[d[0]][0][0]){case 1025:return g=d[1]==-1?"#REF":s.SheetNames[d[1]]||"SH33TJSERR3",d[1]==d[2]?g:g+":"+s.SheetNames[d[2]];case 14849:return s[d[0]].slice(1).map(function(x){return x.Name}).join(";;");default:return s[d[0]][0][3]?(g=d[1]==-1?"#REF":s[d[0]][0][3][d[1]]||"SH33TJSERR4",d[1]==d[2]?g:g+":"+s[d[0]][0][3][d[2]]):"SH33TJSERR2"}}function X0(s,c,u){return c=tu(s,c,u),c=="#REF"?c:(function(d,g){if(!(d||g&&g.biff<=5&&2<=g.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(d)?"'"+d+"'":d})(c,u)}function mo(s,c,u,d,g){var x,b,S,N=g&&g.biff||8,T={s:{c:0,r:0}},F=[],O=0,L=0,B="";if(!s[0]||!s[0][0])return"";for(var ee=-1,G="",he=0,ne=s[0].length;he<ne;++he){var J=s[0][he];switch(J[0]){case"PtgUminus":F.push("-"+F.pop());break;case"PtgUplus":F.push("+"+F.pop());break;case"PtgPercent":F.push(F.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(hr=F.pop(),x=F.pop(),0<=ee){switch(s[0][ee][1][0]){case 0:G=na(" ",s[0][ee][1][1]);break;case 1:G=na("\r",s[0][ee][1][1]);break;default:if(G="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][ee][1][0])}x+=G,ee=-1}F.push(x+gg[J[0]]+hr);break;case"PtgIsect":hr=F.pop(),x=F.pop(),F.push(x+" "+hr);break;case"PtgUnion":hr=F.pop(),x=F.pop(),F.push(x+","+hr);break;case"PtgRange":hr=F.pop(),x=F.pop(),F.push(x+":"+hr);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":b=bl(J[1][1],T,g),F.push(Ns(b,N));break;case"PtgRefN":b=u?bl(J[1][1],u,g):J[1][1],F.push(Ns(b,N));break;case"PtgRef3d":O=J[1][1],b=bl(J[1][2],T,g),B=X0(d,O,g),F.push(B+"!"+Ns(b,N));break;case"PtgFunc":case"PtgFuncVar":var be=J[1][0],ue=J[1][1],be=be||0,we=(be&=127)==0?[]:F.slice(-be);F.length-=be,ue==="User"&&(ue=we.shift()),F.push(ue+"("+we.join(",")+")");break;case"PtgBool":F.push(J[1]?"TRUE":"FALSE");break;case"PtgInt":F.push(J[1]);break;case"PtgNum":F.push(String(J[1]));break;case"PtgStr":F.push('"'+J[1].replace(/"/g,'""')+'"');break;case"PtgErr":F.push(J[1]);break;case"PtgAreaN":S=Ul(J[1][1],u?{s:u}:T,g),F.push(Bl(S,g));break;case"PtgArea":S=Ul(J[1][1],T,g),F.push(Bl(S,g));break;case"PtgArea3d":O=J[1][1],S=J[1][2],B=X0(d,O,g),F.push(B+"!"+Bl(S,g));break;case"PtgAttrSum":F.push("SUM("+F.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":L=J[1][2];var $e=(d.names||[])[L-1]||(d[0]||[])[L],et=$e?$e.Name:"SH33TJSNAME"+String(L);et&&et.slice(0,6)=="_xlfn."&&!g.xlfn&&(et=et.slice(6)),F.push(et);break;case"PtgNameX":var Xe,lt=J[1][1],L=J[1][2];if(!(g.biff<=5)){$e="",((d[lt]||[])[0]||[])[0]==14849||(((d[lt]||[])[0]||[])[0]==1025?d[lt][L]&&0<d[lt][L].itab&&($e=d.SheetNames[d[lt][L].itab-1]+"!"):$e=d.SheetNames[L-1]+"!"),d[lt]&&d[lt][L]?$e+=d[lt][L].Name:d[0]&&d[0][L]?$e+=d[0][L].Name:(et=(tu(d,lt,g)||"").split(";;"))[L-1]?$e=et[L-1]:$e+="SH33TJSERRX",F.push($e);break}Xe=(Xe=d[lt=lt<0?-lt:lt]?d[lt][L]:Xe)||{Name:"SH33TJSERRY"},F.push(Xe.Name);break;case"PtgParen":var _t="(",Dt=")";if(0<=ee){switch(G="",s[0][ee][1][0]){case 2:_t=na(" ",s[0][ee][1][1])+_t;break;case 3:_t=na("\r",s[0][ee][1][1])+_t;break;case 4:Dt=na(" ",s[0][ee][1][1])+Dt;break;case 5:Dt=na("\r",s[0][ee][1][1])+Dt;break;default:if(g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][ee][1][0])}ee=-1}F.push(_t+F.pop()+Dt);break;case"PtgRefErr":case"PtgRefErr3d":F.push("#REF!");break;case"PtgExp":b={c:J[1][1],r:J[1][0]};var ft={c:u.c,r:u.r};if(d.sharedf[sn(b)])lt=d.sharedf[sn(b)],F.push(mo(lt,0,ft,d,g));else{for(var qt=!1,hr=0;hr!=d.arrayf.length;++hr)if(x=d.arrayf[hr],!(b.c<x[0].s.c||b.c>x[0].e.c||b.r<x[0].s.r||b.r>x[0].e.r)){F.push(mo(x[1],0,ft,d,g)),qt=!0;break}qt||F.push(J[1])}break;case"PtgArray":F.push("{"+(function(tr){for(var Kt=[],Bt=0;Bt<tr.length;++Bt){for(var mr=tr[Bt],Nr=[],Gr=0;Gr<mr.length;++Gr){var Mn=mr[Gr];Mn?Mn[0]===2?Nr.push('"'+Mn[1].replace(/"/g,'""')+'"'):Nr.push(Mn[1]):Nr.push("")}Kt.push(Nr.join(","))}return Kt.join(";")})(J[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":ee=he;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":F.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":F.push("#REF!");break;case"PtgList":F.push("Table"+J[1].idx+"[#"+J[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(J))}if(g.biff!=3&&0<=ee&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(s[0][he][0])==-1){var lr=!0;switch((J=s[0][ee])[1][0]){case 4:lr=!1;case 0:G=na(" ",J[1][1]);break;case 5:lr=!1;case 1:G=na("\r",J[1][1]);break;default:if(G="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+J[1][0])}F.push((lr?G:"")+F.pop()+(lr?"":G)),ee=-1}}if(1<F.length&&g.WTF)throw new Error("bad formula stack");return F[0]}function Vd(s,b,u){var d=s.l+b,g=Ni(s);u.biff==2&&++s.l;var x=(function(S){var N;if(Cr(S,S.l+6)!==65535)return[Sn(S),"n"];switch(S[S.l]){case 0:return S.l+=8,["String","s"];case 1:return N=S[S.l+2]===1,S.l+=8,[N,"b"];case 2:return N=S[S.l+2],S.l+=8,[N,"e"];case 3:return S.l+=8,["","s"]}return[]})(s),b=s.read_shift(1);return u.biff!=2&&(s.read_shift(1),5<=u.biff&&s.read_shift(4)),u=(function(S,N,T){var F,O=S.l+N,L=T.biff==2?1:2,B=S.read_shift(L);if(B==65535)return[[],cs(S,N-2)];var ee=Jf(S,B,T);return N!==B+L&&(F=td(S,N-B-L,ee,T)),S.l=O,[ee,F]})(s,d-s.l,u),{cell:g,val:x[0],formula:u,shared:b>>3&1,tt:x[1]}}function Qf(s,c,u,d,g){c=Yl(c,u,g),g=(u=s.v)!=null?Un(typeof u=="number"?u:0):((u=xt(8)).write_shift(1,3),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,65535),u),u=xt(6),u.write_shift(2,33),u.write_shift(4,0);for(var x=xt(s.bf.length),b=0;b<s.bf.length;++b)x[b]=s.bf[b];return Ae([c,g,u,x])}function Ga(s,c,u){var g=s.read_shift(4),d=Jf(s,g,u),g=s.read_shift(4);return[d,0<g?td(s,g,d,u):null]}var Gy=Ga,Z0=Ga,yg=Ga,Xf=Ga,vh={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},qp={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vg={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Wd(s){return(s=(s=(s=(s=(s=s.slice(0,3)=="of:"?s.slice(3):s).charCodeAt(0)==61&&(s=s.slice(1)).charCodeAt(0)==61?s.slice(1):s).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(c,u){return u.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function ec(s){return s=s.split(":"),[s[0].split(".")[0],s[0].split(".")[1]+(1<s.length?":"+(s[1].split(".")[1]||s[1].split(".")[0]):"")]}var Kd={},bh={},Yd=typeof Map<"u";function Zf(s,c,u){var d=0,g=s.length;if(u){if(Yd?u.has(c):Object.prototype.hasOwnProperty.call(u,c)){for(var x=Yd?u.get(c):u[c];d<x.length;++d)if(s[x[d]].t===c)return s.Count++,x[d]}}else for(;d<g;++d)if(s[d].t===c)return s.Count++,d;return s[g]={t:c},s.Count++,s.Unique++,u&&(Yd?(u.has(c)||u.set(c,[]),u.get(c).push(g)):(Object.prototype.hasOwnProperty.call(u,c)||(u[c]=[]),u[c].push(g))),g}function Jd(d,c){var u={min:d+1,max:d+1},d=-1;return c.MDW&&(Rs=c.MDW),c.width!=null?u.customWidth=1:c.wpx!=null?d=Zl(c.wpx):c.wch!=null&&(d=c.wch),-1<d?(u.width=Dc(d),u.customWidth=1):c.width!=null&&(u.width=c.width),c.hidden&&(u.hidden=!0),c.level!=null&&(u.outlineLevel=u.level=c.level),u}function ru(s,c){s&&(c=c=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],s.left==null&&(s.left=c[0]),s.right==null&&(s.right=c[1]),s.top==null&&(s.top=c[2]),s.bottom==null&&(s.bottom=c[3]),s.header==null&&(s.header=c[4]),s.footer==null&&(s.footer=c[5]))}function Iu(s,c,u){if(qf!==void 0){if(/^\d+$/.exec(c.s)||c.s&&c.s==+c.s)return c.s;var d=c.s||{};return c.z&&(d.numFmt=c.z),qf.addStyle(d)}var g=u.revssf[c.z!=null?c.z:"General"],x=60,b=s.length;if(g==null&&u.ssf){for(;x<392;++x)if(u.ssf[x]==null){an(c.z,x),u.ssf[x]=c.z,u.revssf[c.z]=g=x;break}}for(x=0;x!=b;++x)if(s[x].numFmtId===g)return x;return s[b]={numFmtId:g,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},b}function nu(s,c,u,d,g,x){try{d.cellNF&&(s.z=se[c])}catch(S){if(d.WTF)throw S}if(s.t!=="z"||d.cellStyles){if(s.t==="d"&&typeof s.v=="string"&&(s.v=vn(s.v)),(!d||d.cellText!==!1)&&s.t!=="z")try{if(se[c]==null&&an(gn[c]||"General",c),s.t==="e")s.w=s.w||Zi[s.v];else if(c===0)if(s.t==="n")(0|s.v)===s.v?s.w=s.v.toString(10):s.w=Te(s.v);else if(s.t==="d"){var b=pa(s.v);s.w=(0|b)===b?b.toString(10):Te(b)}else{if(s.v===void 0)return;s.w=Ht(s.v,bh)}else s.t==="d"?s.w=xr(c,pa(s.v),bh):s.w=xr(c,s.v,bh)}catch(S){if(d.WTF)throw S}if(d.cellStyles&&u!=null)try{s.s=x.Fills[u],s.s.fgColor&&s.s.fgColor.theme&&!s.s.fgColor.rgb&&(s.s.fgColor.rgb=tl(g.themeElements.clrScheme[s.s.fgColor.theme].rgb,s.s.fgColor.tint||0),d.WTF&&(s.s.fgColor.raw_rgb=g.themeElements.clrScheme[s.s.fgColor.theme].rgb)),s.s.bgColor&&s.s.bgColor.theme&&(s.s.bgColor.rgb=tl(g.themeElements.clrScheme[s.s.bgColor.theme].rgb,s.s.bgColor.tint||0),d.WTF&&(s.s.bgColor.raw_rgb=g.themeElements.clrScheme[s.s.bgColor.theme].rgb))}catch(S){if(d.WTF&&x.Fills)throw S}}}var gi=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Gp=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,bg=/<(?:\w:)?hyperlink [^>]*>/gm,Wi=/"(\w*:\w*)"/,Vy=/<(?:\w:)?col\b[^>]*[\/]?>/g,xg=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wg=/<(?:\w:)?pageMargins[^>]*\/>/g,Ss=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,rl=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Du=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Sg(s,c,u,d,g,x,b){if(!s)return s;d=d||{"!id":{}};var S=c.dense?[]:{},N={s:{r:2e6,c:2e6},e:{r:0,c:0}},T="",et="",F=s.match(Gp);F?(T=s.slice(0,F.index),et=s.slice(F.index+F[0].length)):T=et=s;var O=T.match(Ss);O?e1(O[0],0,g,u):(O=T.match(rl))&&(s=O[0],O[1],O=S,L=g,B=u,e1(s.slice(0,s.indexOf(">")),0,L,B));var L,B,ee=(T.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<ee&&(L=T.slice(ee,ee+50).match(Wi))&&(B=S,(he=wn(he=L[1])).s.r<=he.e.r&&he.s.c<=he.e.c&&0<=he.s.r&&0<=he.s.c&&(B["!ref"]=rn(he)));var G,he=T.match(Du);he&&he[1]&&(J=he[1],(G=g).Views||(G.Views=[{}]),(J.match(t1)||[]).forEach(function(Xe,lt){Xe=ln(Xe),G.Views[lt]||(G.Views[lt]={}),+Xe.zoomScale&&(G.Views[lt].zoom=+Xe.zoomScale),Ea(Xe.rightToLeft)&&(G.Views[lt].RTL=!0)}));var ne,J=[];c.cellStyles&&(ne=T.match(Vy))&&(function(Xe,lt){for(var _t=!1,Dt=0;Dt!=lt.length;++Dt){var ft=ln(lt[Dt],!0);ft.hidden&&(ft.hidden=Ea(ft.hidden));var qt=parseInt(ft.min,10)-1,hr=parseInt(ft.max,10)-1;for(ft.outlineLevel&&(ft.level=+ft.outlineLevel||0),delete ft.min,delete ft.max,ft.width=+ft.width,!_t&&ft.width&&(_t=!0,zf(ft.width)),mh(ft);qt<=hr;)Xe[qt++]=jn(ft)}})(J,ne),F&&Fu(F[1],S,c,N,x,b),b=et.match(xg),b&&(S["!autofilter"]={ref:(b[0].match(/ref="([^"]*)"/)||[])[1]});var ue=[],be=et.match(gi);if(be)for(ee=0;ee!=be.length;++ee)ue[ee]=wn(be[ee].slice(be[ee].indexOf('"')+1));b=et.match(bg),b&&(function(Xe,lt,_t){for(var Dt=Array.isArray(Xe),ft=0;ft!=lt.length;++ft){var qt=ln(Xn(lt[ft]),!0);if(!qt.ref)return;var hr=((_t||{})["!id"]||[])[qt.id];hr?(qt.Target=hr.Target,qt.location&&(qt.Target+="#"+cn(qt.location))):(qt.Target="#"+cn(qt.location),hr={Target:qt.Target,TargetMode:"Internal"}),qt.Rel=hr,qt.tooltip&&(qt.Tooltip=qt.tooltip,delete qt.tooltip);for(var lr=wn(qt.ref),Zt=lr.s.r;Zt<=lr.e.r;++Zt)for(var tr=lr.s.c;tr<=lr.e.c;++tr){var Kt=sn({c:tr,r:Zt});Dt?(Xe[Zt]||(Xe[Zt]=[]),Xe[Zt][tr]||(Xe[Zt][tr]={t:"z",v:void 0}),Xe[Zt][tr].l=qt):(Xe[Kt]||(Xe[Kt]={t:"z",v:void 0}),Xe[Kt].l=qt)}}})(S,b,d);var we,$e,et=et.match(wg);return et&&(S["!margins"]=(we=ln(et[0]),$e={},["left","right","top","bottom","header","footer"].forEach(function(Xe){we[Xe]&&($e[Xe]=parseFloat(we[Xe]))}),$e)),!S["!ref"]&&N.e.c>=N.s.c&&N.e.r>=N.s.r&&(S["!ref"]=rn(N)),0<c.sheetRows&&S["!ref"]&&(et=wn(S["!ref"]),c.sheetRows<=+et.e.r&&(et.e.r=c.sheetRows-1,et.e.r>N.e.r&&(et.e.r=N.e.r),et.e.r<et.s.r&&(et.s.r=et.e.r),et.e.c>N.e.c&&(et.e.c=N.e.c),et.e.c<et.s.c&&(et.s.c=et.e.c),S["!fullref"]=S["!ref"],S["!ref"]=rn(et))),0<J.length&&(S["!cols"]=J),0<ue.length&&(S["!merges"]=ue),S}function e1(s,c,u,d){s=ln(s),u.Sheets[d]||(u.Sheets[d]={}),s.codeName&&(u.Sheets[d].CodeName=cn(Xn(s.codeName)))}var Ag=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Wy=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],t1=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,Ro,tc,Vp,jo,Wp,au,xh,Fu=(Ro=/<(?:\w+:)?c[ \/>]/,tc=/<\/(?:\w+:)?row>/,Vp=/r=["']([^"']*)["']/,jo=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,Wp=/ref=["']([^"']*)["']/,au=tn("v"),xh=tn("f"),function(s,c,u,d,g,x){for(var b,S,N,T,F,O,L=0,B="",ee=[],G=[],he=0,ne=0,J="",ue=0,be=0,we=0,$e=0,et=Array.isArray(x.CellXf),Xe=[],lt=[],_t=Array.isArray(c),Dt=[],ft={},qt=!1,hr=!!u.sheetStubs,lr=s.split(tc),Zt=0,tr=lr.length;Zt!=tr;++Zt){var Kt=(B=lr[Zt].trim()).length;if(Kt!==0){var Bt=0;e:for(L=0;L<Kt;++L)switch(B[L]){case">":if(B[L-1]!="/"){++L;break e}if(u&&u.cellStyles){if(ue=(N=ln(B.slice(Bt,L),!0)).r!=null?parseInt(N.r,10):ue+1,be=-1,u.sheetRows&&u.sheetRows<ue)continue;qt=!(ft={}),N.ht&&(qt=!0,ft.hpt=parseFloat(N.ht),ft.hpx=Xh(ft.hpt)),N.hidden=="1"&&(qt=!0,ft.hidden=!0),N.outlineLevel!=null&&(qt=!0,ft.level=+N.outlineLevel),qt&&(Dt[ue-1]=ft)}break;case"<":Bt=L}if(L<=Bt)break;if(ue=(N=ln(B.slice(Bt,L),!0)).r!=null?parseInt(N.r,10):ue+1,be=-1,!(u.sheetRows&&u.sheetRows<ue)){d.s.r>ue-1&&(d.s.r=ue-1),d.e.r<ue-1&&(d.e.r=ue-1),u&&u.cellStyles&&(qt=!(ft={}),N.ht&&(qt=!0,ft.hpt=parseFloat(N.ht),ft.hpx=Xh(ft.hpt)),N.hidden=="1"&&(qt=!0,ft.hidden=!0),N.outlineLevel!=null&&(qt=!0,ft.level=+N.outlineLevel),qt&&(Dt[ue-1]=ft)),ee=B.slice(L).split(Ro);for(var mr,Nr=0;Nr!=ee.length&&ee[Nr].trim().charAt(0)=="<";++Nr);for(ee=ee.slice(Nr),L=0;L!=ee.length;++L)if((B=ee[L].trim()).length!==0){if(G=B.match(Vp),he=L,ne=0,B="<c "+(B.slice(0,1)=="<"?">":"")+B,G!=null&&G.length===2){for(he=0,J=G[1],ne=0;ne!=J.length&&!((b=J.charCodeAt(ne)-64)<1||26<b);++ne)he=26*he+b;be=--he}else++be;for(ne=0;ne!=B.length&&B.charCodeAt(ne)!==62;++ne);if(++ne,(N=ln(B.slice(0,ne),!0)).r||(N.r=sn({r:ue-1,c:be})),S={t:""},(G=(J=B.slice(ne)).match(au))!=null&&G[1]!==""&&(S.v=cn(G[1])),u.cellFormula){(G=J.match(xh))!=null&&G[1]!==""?(S.f=cn(Xn(G[1])).replace(/\r\n/g,`
`),u.xlfn||(S.f=Pp(S.f)),-1<G[0].indexOf('t="array"')?(S.F=(J.match(Wp)||[])[1],-1<S.F.indexOf(":")&&Xe.push([wn(S.F),S.F])):-1<G[0].indexOf('t="shared"')&&(F=ln(G[0]),mr=cn(Xn(G[1])),u.xlfn||(mr=Pp(mr)),lt[parseInt(F.si,10)]=[F,mr,N.r])):(G=J.match(/<f[^>]*\/>/))&&lt[(F=ln(G[0])).si]&&(S.f=(O=lt[F.si][1],dr=lt[F.si][2],mr=N.r,dr=ti(dr).s,mr=ga(mr),Wf(O,{r:mr.r-dr.r,c:mr.c-dr.c})));for(var Gr=ga(N.r),ne=0;ne<Xe.length;++ne)Gr.r>=Xe[ne][0].s.r&&Gr.r<=Xe[ne][0].e.r&&Gr.c>=Xe[ne][0].s.c&&Gr.c<=Xe[ne][0].e.c&&(S.F=Xe[ne][1])}if(N.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else{if(!hr)continue;S.t="z"}else S.t=N.t||"n";switch(d.s.c>be&&(d.s.c=be),d.e.c<be&&(d.e.c=be),S.t){case"n":if(S.v==""||S.v==null){if(!hr)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(S.v===void 0){if(!hr)continue;S.t="z"}else T=Kd[parseInt(S.v,10)],S.v=T.t,S.r=T.r,u.cellHTML&&(S.h=T.h);break;case"str":S.t="s",S.v=S.v!=null?Xn(S.v):"",u.cellHTML&&(S.h=pu(S.v));break;case"inlineStr":G=J.match(jo),S.t="s",G!=null&&(T=fh(G[1]))?(S.v=T.t,u.cellHTML&&(S.h=T.h)):S.v="";break;case"b":S.v=Ea(S.v);break;case"d":u.cellDates?S.v=vn(S.v,1):(S.v=pa(vn(S.v,1)),S.t="n");break;case"e":u&&u.cellText===!1||(S.w=S.v),S.v=No[S.v]}var Mn,we=$e=0,dr=null;et&&N.s!==void 0&&(dr=x.CellXf[N.s])!=null&&(dr.numFmtId!=null&&(we=dr.numFmtId),u.cellStyles&&dr.fillId!=null&&($e=dr.fillId)),nu(S,we,$e,u,g,x),u.cellDates&&et&&S.t=="n"&&_r(se[we])&&(S.t="d",S.v=Ms(S.v)),N.cm&&u.xlmeta&&(Mn=(u.xlmeta.Cell||[])[+N.cm-1])&&Mn.type=="XLDAPR"&&(S.D=!0),_t?(c[(Mn=ga(N.r)).r]||(c[Mn.r]=[]),c[Mn.r][Mn.c]=S):c[N.r]=S}}}}0<Dt.length&&(c["!rows"]=Dt)});function Kp(s,c){for(var u,d,g,x,b=[],S=[],N=wn(s["!ref"]),T=[],F=0,G=0,O=s["!rows"],L=Array.isArray(s),B={r:""},ee=-1,G=N.s.c;G<=N.e.c;++G)T[G]=Ln(G);for(F=N.s.r;F<=N.e.r;++F){for(S=[],g=ja(F),G=N.s.c;G<=N.e.c;++G){d=T[G]+g;var he=L?(s[F]||[])[G]:s[d];he!==void 0&&(u=(function(ne,J,ue,be){if(ne.c&&ue["!comments"].push([J,ne.c]),ne.v===void 0&&typeof ne.f!="string"||ne.t==="z"&&!ne.f)return"";var we="",$e=ne.t,et=ne.v;if(ne.t!=="z")switch(ne.t){case"b":we=ne.v?"1":"0";break;case"n":we=""+ne.v;break;case"e":we=Zi[ne.v];break;case"d":we=be&&be.cellDates?vn(ne.v,-1).toISOString():((ne=jn(ne)).t="n",""+(ne.v=pa(vn(ne.v)))),ne.z===void 0&&(ne.z=se[14]);break;default:we=ne.v}var Xe=vs("v",aa(we)),lt={r:J},_t=Iu(be.cellXfs,ne,be);switch(_t!==0&&(lt.s=_t),ne.t){case"n":break;case"d":lt.t="d";break;case"b":lt.t="b";break;case"e":lt.t="e";break;case"z":break;default:if(ne.v==null){delete ne.t;break}if(32767<ne.v.length)throw new Error("Text length must not exceed 32767 characters");if(be&&be.bookSST){Xe=vs("v",""+Zf(be.Strings,ne.v,be.revStrings)),lt.t="s";break}lt.t="str"}return ne.t!=$e&&(ne.t=$e,ne.v=et),typeof ne.f=="string"&&ne.f&&(et=ne.F&&ne.F.slice(0,J.length)==J?{t:"array",ref:ne.F}:null,Xe=Xt("f",aa(ne.f),et)+(ne.v!=null?Xe:"")),ne.l&&ue["!links"].push([J,ne.l]),ne.D&&(lt.cm=1),Xt("c",Xe,lt)})(he,d,s,c))!=null&&S.push(u)}(0<S.length||O&&O[F])&&(B={r:g},O&&O[F]&&((x=O[F]).hidden&&(B.hidden=1),ee=-1,x.hpx?ee=zd(x.hpx):x.hpt&&(ee=x.hpt),-1<ee&&(B.ht=ee,B.customHeight=1),x.level&&(B.outlineLevel=x.level)),b[b.length]=Xt("row",S.join(""),B))}if(O)for(;F<O.length;++F)O&&O[F]&&(B={r:F+1},(x=O[F]).hidden&&(B.hidden=1),ee=-1,x.hpx?ee=zd(x.hpx):x.hpt&&(ee=x.hpt),-1<ee&&(B.ht=ee,B.customHeight=1),x.level&&(B.outlineLevel=x.level),b[b.length]=Xt("row","",B));return b.join("")}function r1(s,c,u,d){var g,x,b=[is,Xt("worksheet",null,{xmlns:Jo[0],"xmlns:r":ls.r})],S=u.SheetNames[s],N=u.Sheets[S],T=(N=N??{})["!ref"]||"A1",F=wn(T);if(16383<F.e.c||1048575<F.e.r){if(c.WTF)throw new Error("Range "+T+" exceeds format limit A1:XFD1048576");F.e.c=Math.min(F.e.c,16383),F.e.r=Math.min(F.e.c,1048575),T=rn(F)}d=d||{},N["!comments"]=[];var O,L,B=[];(function(ne,J,ue,be,we){var $e=!1,et={},Xe=null;if(be.bookType!=="xlsx"&&J.vbaraw){var lt=J.SheetNames[ue];try{J.Workbook&&(lt=J.Workbook.Sheets[ue].CodeName||lt)}catch{}$e=!0,et.codeName=xi(aa(lt))}ne&&ne["!outline"]&&(be={summaryBelow:1,summaryRight:1},ne["!outline"].above&&(be.summaryBelow=0),ne["!outline"].left&&(be.summaryRight=0),Xe=(Xe||"")+Xt("outlinePr",null,be)),($e||Xe)&&(we[we.length]=Xt("sheetPr",Xe,et))})(N,u,s,c,b),b[b.length]=Xt("dimension",null,{ref:T}),b[b.length]=(S={workbookViewId:"0"},((((F=u)||{}).Workbook||{}).Views||[])[0]&&(S.rightToLeft=F.Workbook.Views[0].RTL?"1":"0"),Xt("sheetViews",Xt("sheetView",null,S),{})),c.sheetFormat&&(b[b.length]=Xt("sheetFormatPr",null,{defaultRowHeight:c.sheetFormat.defaultRowHeight||"16",baseColWidth:c.sheetFormat.baseColWidth||"10",outlineLevelRow:c.sheetFormat.outlineLevelRow||"7"})),N["!cols"]!=null&&0<N["!cols"].length&&(b[b.length]=(function(ne){for(var J,ue=["<cols>"],be=0;be!=ne.length;++be)(J=ne[be])&&(ue[ue.length]=Xt("col",null,Jd(be,J)));return ue[ue.length]="</cols>",ue.join("")})(N["!cols"])),b[g=b.length]="<sheetData/>",N["!links"]=[],N["!ref"]!=null&&0<(x=Kp(N,c)).length&&(b[b.length]=x),b.length>g+1&&(b[b.length]="</sheetData>",b[g]=b[g].replace("/>",">")),N["!protect"]&&(b[b.length]=(O=N["!protect"],L={sheet:1},Ag.forEach(function(ne){O[ne]!=null&&O[ne]&&(L[ne]="1")}),Wy.forEach(function(ne){O[ne]==null||O[ne]||(L[ne]="0")}),O.password&&(L.password=Ud(O.password).toString(16).toUpperCase()),Xt("sheetProtection",null,L))),N["!autofilter"]!=null&&(b[b.length]=(function(ne,J,ue,be){var we=typeof ne.ref=="string"?ne.ref:rn(ne.ref);ue.Workbook||(ue.Workbook={Sheets:[]}),ue.Workbook.Names||(ue.Workbook.Names=[]);var $e=ue.Workbook.Names;(ne=ti(we)).s.r==ne.e.r&&(ne.e.r=ti(J["!ref"]).e.r,we=rn(ne));for(var et=0;et<$e.length;++et){var Xe=$e[et];if(Xe.Name=="_xlnm._FilterDatabase"&&Xe.Sheet==be){Xe.Ref="'"+ue.SheetNames[be]+"'!"+we;break}}return et==$e.length&&$e.push({Name:"_xlnm._FilterDatabase",Sheet:be,Ref:"'"+ue.SheetNames[be]+"'!"+we}),Xt("autoFilter",null,{ref:we})})(N["!autofilter"],N,u,s)),N["!merges"]!=null&&0<N["!merges"].length&&(b[b.length]=(function(ne){if(ne.length===0)return"";for(var J='<mergeCells count="'+ne.length+'">',ue=0;ue!=ne.length;++ue)J+='<mergeCell ref="'+rn(ne[ue])+'"/>';return J+"</mergeCells>"})(N["!merges"]));var ee,G,he=-1;return 0<N["!links"].length&&(b[b.length]="<hyperlinks>",N["!links"].forEach(function(ne){ne[1].Target&&(G={ref:ne[0]},ne[1].Target.charAt(0)!="#"&&(he=sa(d,-1,aa(ne[1].Target).replace(/#.*$/,""),Cn.HLINK),G["r:id"]="rId"+he),-1<(ee=ne[1].Target.indexOf("#"))&&(G.location=aa(ne[1].Target.slice(ee+1))),ne[1].Tooltip&&(G.tooltip=aa(ne[1].Tooltip)),b[b.length]=Xt("hyperlink",null,G))}),b[b.length]="</hyperlinks>"),delete N["!links"],N["!margins"]!=null&&(b[b.length]=(ru(u=N["!margins"]),Xt("pageMargins",null,u))),c&&!c.ignoreEC&&c.ignoreEC!=null||(b[b.length]=vs("ignoredErrors",Xt("ignoredError",null,{numberStoredAsText:1,sqref:T}))),0<B.length&&(he=sa(d,-1,"../drawings/drawing"+(s+1)+".xml",Cn.DRAW),b[b.length]=Xt("drawing",null,{"r:id":"rId"+he}),N["!drawing"]=B),0<N["!comments"].length&&(he=sa(d,-1,"../drawings/vmlDrawing"+(s+1)+".vml",Cn.VML),b[b.length]=Xt("legacyDrawing",null,{"r:id":"rId"+he}),N["!legacy"]=he),1<b.length&&(b[b.length]="</worksheet>",b[1]=b[1].replace("/>",">")),b.join("")}function Rc(s,c,u,d){u=(function(g,x,b){var S=xt(145),N=(b["!rows"]||[])[g]||{};S.write_shift(4,g),S.write_shift(4,0);var F=320;N.hpx?F=20*zd(N.hpx):N.hpt&&(F=20*N.hpt),S.write_shift(2,F),S.write_shift(1,0),F=0,N.level&&(F|=N.level),N.hidden&&(F|=16),(N.hpx||N.hpt)&&(F|=32),S.write_shift(1,F),S.write_shift(1,0);var T=0,F=S.l;S.l+=4;for(var O={r:g,c:0},L=0;L<16;++L)if(!(x.s.c>L+1<<10||x.e.c<L<<10)){for(var B=-1,ee=-1,G=L<<10;G<L+1<<10;++G)O.c=G,(Array.isArray(b)?(b[O.r]||[])[O.c]:b[sn(O)])&&(B<0&&(B=G),ee=G);B<0||(++T,S.write_shift(4,B),S.write_shift(4,ee))}return g=S.l,S.l=F,S.write_shift(4,T),S.l=g,S.length>S.l?S.slice(0,S.l):S})(d,u,c),(17<u.length||(c["!rows"]||[])[d])&&jt(s,0,u)}var e0=Ts,Qd=Ci;function Xd(s){return[Bi(s),Sn(s),"n"]}var su=Ts,Zd=Ci,Yp=["left","right","top","bottom","header","footer"];function Cg(s,c,u,d,g,x,b){if(c.v===void 0)return!1;var S="";switch(c.t){case"b":S=c.v?"1":"0";break;case"d":(c=jn(c)).z=c.z||se[14],c.v=pa(vn(c.v)),c.t="n";break;case"n":case"e":S=""+c.v;break;default:S=c.v}var N,T,F,O,L,B,ee,G,he,ne,J,ue,be,we,$e,et,Xe,lt,_t,Dt,ft={r:u,c:d};switch(ft.s=Iu(g.cellXfs,c,g),c.l&&x["!links"].push([sn(ft),c.l]),c.c&&x["!comments"].push([sn(ft),c.c]),c.t){case"s":case"str":return g.bookSST?(S=Zf(g.Strings,c.v,g.revStrings),ft.t="s",ft.v=S,b?jt(s,18,(Hi(Xe=ft,lt=lt??xt(8)),lt.write_shift(4,Xe.v),lt)):jt(s,7,(zl(Xe=ft,et=et??xt(12)),et.write_shift(4,Xe.v),et))):(ft.t="str",b?jt(s,17,(we=c,Hi(ft,$e=$e??xt(8+4*we.v.length)),Oa(we.v,$e),$e.length>$e.l?$e.slice(0,$e.l):$e)):jt(s,6,(we=c,zl(ft,be=be??xt(12+4*we.v.length)),Oa(we.v,be),be.length>be.l?be.slice(0,be.l):be))),!0;case"n":return c.v==(0|c.v)&&-1e3<c.v&&c.v<1e3?b?jt(s,13,(J=c,Hi(ft,ue=ue??xt(8)),oo(J.v,ue),ue)):jt(s,2,(J=c,zl(ft,ne=ne??xt(12)),oo(J.v,ne),ne)):b?jt(s,16,(G=c,Hi(ft,he=he??xt(12)),Un(G.v,he),he)):jt(s,5,(G=c,zl(ft,ee=ee??xt(16)),Un(G.v,ee),ee)),!0;case"b":return ft.t="b",b?jt(s,15,(L=c,Hi(ft,B=B??xt(5)),B.write_shift(1,L.v?1:0),B)):jt(s,4,(L=c,zl(ft,O=O??xt(9)),O.write_shift(1,L.v?1:0),O)),!0;case"e":return ft.t="e",b?jt(s,14,(T=c,Hi(ft,F=F??xt(8)),F.write_shift(1,T.v),F.write_shift(2,0),F.write_shift(1,0),F)):jt(s,3,(T=c,zl(ft,N=N??xt(9)),N.write_shift(1,T.v),N)),!0}return b?jt(s,12,Hi(ft,Dt=Dt??xt(4))):jt(s,1,zl(ft,_t=_t??xt(8))),!0}function t0(s,c){var u,d;c&&c["!merges"]&&(jt(s,177,(u=c["!merges"].length,(d=d??xt(4)).write_shift(4,u),d)),c["!merges"].forEach(function(g){jt(s,176,Zd(g))}),jt(s,178))}function Ng(s,c){c&&c["!cols"]&&(jt(s,390),c["!cols"].forEach(function(u,d){u&&jt(s,60,(function(g,x,b){b==null&&(b=xt(18));var S=Jd(g,x);return b.write_shift(-4,g),b.write_shift(-4,g),b.write_shift(4,256*(S.width||10)),b.write_shift(4,0),g=0,x.hidden&&(g|=1),typeof S.width=="number"&&(g|=2),x.level&&(g|=x.level<<8),b.write_shift(2,g),b})(d,u))}),jt(s,391))}function n1(s,c){var u;c&&c["!ref"]&&(jt(s,648),jt(s,649,(u=wn(c["!ref"]),(c=xt(24)).write_shift(4,4),c.write_shift(4,1),Ci(u,c),c)),jt(s,650))}function Tg(s,c,u){c["!links"].forEach(function(d){var g,x;d[1].Target&&(g=sa(u,-1,d[1].Target.replace(/#.*$/,""),Cn.HLINK),jt(s,494,(x=g,d=xt(50+4*((g=d)[1].Target.length+(g[1].Tooltip||"").length)),Ci({s:ga(g[0]),e:ga(g[0])},d),Xo("rId"+x,d),Oa(((x=g[1].Target.indexOf("#"))==-1?"":g[1].Target.slice(x+1))||"",d),Oa(g[1].Tooltip||"",d),Oa("",d),d.slice(0,d.l))))}),delete c["!links"]}function Ky(s,c,u){jt(s,133),jt(s,137,(function(d,g){g==null&&(g=xt(30));var x=924;return(((d||{}).Views||[])[0]||{}).RTL&&(x|=32),g.write_shift(2,x),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(1,0),g.write_shift(1,0),g.write_shift(2,0),g.write_shift(2,100),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(4,0),g})(u)),jt(s,138),jt(s,134)}function Yy(s,c){var u,d;c["!protect"]&&jt(s,535,(u=c["!protect"],(d=d??xt(66)).write_shift(2,u.password?Ud(u.password):0),d.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(g){g[1]?d.write_shift(4,u[g[0]]==null||u[g[0]]?0:1):d.write_shift(4,u[g[0]]!=null&&u[g[0]]?0:1)}),d))}function Na(s,c,u,d){var g=xs(),T=u.SheetNames[s],x=u.Sheets[T]||{},b=T;try{u&&u.Workbook&&(b=u.Workbook.Sheets[s].CodeName||b)}catch{}var S,N,T=wn(x["!ref"]||"A1");if(16383<T.e.c||1048575<T.e.r){if(c.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");T.e.c=Math.min(T.e.c,16383),T.e.r=Math.min(T.e.c,1048575)}return x["!links"]=[],x["!comments"]=[],jt(g,129),(u.vbaraw||x["!outline"])&&jt(g,147,(function(F,O,L){L==null&&(L=xt(84+4*F.length));var B=192;O&&(O.above&&(B&=-65),O.left&&(B&=-129)),L.write_shift(1,B);for(var ee=1;ee<3;++ee)L.write_shift(1,0);return Ca({auto:1},L),L.write_shift(-4,-1),L.write_shift(-4,-1),$l(F,L),L.slice(0,L.l)})(b,x["!outline"])),jt(g,148,Qd(T)),Ky(g,0,u.Workbook),Ng(g,x),(function(F,O,L){var B,ee=wn(O["!ref"]||"A1"),G=[];jt(F,145);var he=Array.isArray(O),ne=ee.e.r;O["!rows"]&&(ne=Math.max(ee.e.r,O["!rows"].length-1));for(var J=ee.s.r;J<=ne;++J){B=ja(J),Rc(F,O,ee,J);var ue=!1;if(J<=ee.e.r)for(var be=ee.s.c;be<=ee.e.c;++be){J===ee.s.r&&(G[be]=Ln(be)),we=G[be]+B;var we=he?(O[J]||[])[be]:O[we];we?ue=Cg(F,we,J,be,L,O,ue):ue=!1}}jt(F,146)})(g,x,c),Yy(g,x),(function(F,O,L,B){if(O["!autofilter"]){var he=O["!autofilter"],ee=typeof he.ref=="string"?he.ref:rn(he.ref);L.Workbook||(L.Workbook={Sheets:[]}),L.Workbook.Names||(L.Workbook.Names=[]);var G=L.Workbook.Names,he=ti(ee);he.s.r==he.e.r&&(he.e.r=ti(O["!ref"]).e.r,ee=rn(he));for(var ne=0;ne<G.length;++ne){var J=G[ne];if(J.Name=="_xlnm._FilterDatabase"&&J.Sheet==B){J.Ref="'"+L.SheetNames[B]+"'!"+ee;break}}ne==G.length&&G.push({Name:"_xlnm._FilterDatabase",Sheet:B,Ref:"'"+L.SheetNames[B]+"'!"+ee}),jt(F,161,Ci(wn(ee))),jt(F,162)}})(g,x,u,s),t0(g,x),Tg(g,x,d),x["!margins"]&&jt(g,476,(S=x["!margins"],N==null&&(N=xt(48)),ru(S),Yp.forEach(function(F){Un(S[F],N)}),N)),c&&!c.ignoreEC&&c.ignoreEC!=null||n1(g,x),T=g,c=s,d=d,0<(x=x)["!comments"].length&&(c=sa(d,-1,"../drawings/vmlDrawing"+(c+1)+".vml",Cn.VML),jt(T,551,Xo("rId"+c)),x["!legacy"]=c),jt(g,130),g.end()}function ts(s,c,u,d,g,x){var b=x||{"!type":"chart"};if(!s)return x;var S,N=0,T=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(s.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(O){var L=(function(B){var ee,G=[],he=B.match(/^<c:numCache>/);(B.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(J){J=J.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),J&&(G[+J[1]]=he?+J[2]:J[2])});var ne=cn((B.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(B.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(J){ee=J.replace(/<.*?>/g,"")}),[G,ne,ee]})(O);F.s.r=F.s.c=0,F.e.c=N,S=Ln(N),L[0].forEach(function(B,ee){b[S+ja(ee)]={t:"n",v:B,z:L[1]},T=ee}),F.e.r<T&&(F.e.r=T),++N}),0<N&&(b["!ref"]=rn(F)),b}var zn=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ea=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ua=[],Cl=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ru(s,c){for(var u=0;u!=s.length;++u)for(var d=s[u],g=0;g!=c.length;++g){var x=c[g];if(d[x[0]]==null)d[x[0]]=x[1];else switch(x[2]){case"bool":typeof d[x[0]]=="string"&&(d[x[0]]=Ea(d[x[0]]));break;case"int":typeof d[x[0]]=="string"&&(d[x[0]]=parseInt(d[x[0]],10))}}}function rd(s,c){for(var u=0;u!=c.length;++u){var d=c[u];if(s[d[0]]==null)s[d[0]]=d[1];else switch(d[2]){case"bool":typeof s[d[0]]=="string"&&(s[d[0]]=Ea(s[d[0]]));break;case"int":typeof s[d[0]]=="string"&&(s[d[0]]=parseInt(s[d[0]],10))}}}function a1(s){rd(s.WBProps,zn),rd(s.CalcPr,Cl),Ru(s.WBView,ea),Ru(s.Sheets,Ua),bh.date1904=Ea(s.WBProps.date1904)}var ju="][*?/\\".split("");function qs(s,c){if(31<s.length)throw new Error("Sheet names cannot exceed 31 chars");var u=!0;return ju.forEach(function(d){if(s.indexOf(d)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),u}function Ou(s){if(!s||!s.SheetNames||!s.Sheets)throw new Error("Invalid Workbook");if(!s.SheetNames.length)throw new Error("Workbook is empty");var c,u,d,g=s.Workbook&&s.Workbook.Sheets||[];c=s.SheetNames,u=g,d=!!s.vbaraw,c.forEach(function(b,S){qs(b);for(var N=0;N<S;++N)if(b==c[N])throw new Error("Duplicate Sheet Name: "+b);if(d){var T=u&&u[S]&&u[S].CodeName||b;if(T.charCodeAt(0)==95&&22<T.length)throw new Error("Bad Code Name: Worksheet"+T)}});for(var x=0;x<s.SheetNames.length;++x)(function(b,S){if(b&&b["!ref"]){var N=wn(b["!ref"]);if(N.e.c<N.s.c||N.e.r<N.s.r)throw new Error("Bad range ("+S+"): "+b["!ref"])}})(s.Sheets[s.SheetNames[x]],(s.SheetNames[x],x))}var nd=/<\w+:workbook/;function s1(s){var c=[is];c[c.length]=Xt("workbook",null,{xmlns:Jo[0],"xmlns:r":ls.r});var u=s.Workbook&&0<(s.Workbook.Names||[]).length,d={codeName:"ThisWorkbook"};s.Workbook&&s.Workbook.WBProps&&(zn.forEach(function(S){s.Workbook.WBProps[S[0]]!=null&&s.Workbook.WBProps[S[0]]!=S[1]&&(d[S[0]]=s.Workbook.WBProps[S[0]])}),s.Workbook.WBProps.CodeName&&(d.codeName=s.Workbook.WBProps.CodeName,delete d.CodeName)),c[c.length]=Xt("workbookPr",null,d);var g=s.Workbook&&s.Workbook.Sheets||[],x=0;if(g&&g[0]&&g[0].Hidden){for(c[c.length]="<bookViews>",x=0;x!=s.SheetNames.length&&g[x]&&g[x].Hidden;++x);x==s.SheetNames.length&&(x=0),c[c.length]='<workbookView firstSheet="'+x+'" activeTab="'+x+'"/>',c[c.length]="</bookViews>"}for(c[c.length]="<sheets>",x=0;x!=s.SheetNames.length;++x){var b={name:aa(s.SheetNames[x].slice(0,31))};if(b.sheetId=""+(x+1),b["r:id"]="rId"+(x+1),g[x])switch(g[x].Hidden){case 1:b.state="hidden";break;case 2:b.state="veryHidden"}c[c.length]=Xt("sheet",null,b)}return c[c.length]="</sheets>",u&&(c[c.length]="<definedNames>",s.Workbook&&s.Workbook.Names&&s.Workbook.Names.forEach(function(S){var N={name:S.Name};S.Comment&&(N.comment=S.Comment),S.Sheet!=null&&(N.localSheetId=""+S.Sheet),S.Hidden&&(N.hidden="1"),S.Ref&&(c[c.length]=Xt("definedName",aa(S.Ref),N))}),c[c.length]="</definedNames>"),2<c.length&&(c[c.length]="</workbook>",c[1]=c[1].replace("/>",">")),c.join("")}function Nl(s,c){var u={};return s.read_shift(4),u.ArchID=s.read_shift(4),s.l+=c-8,u}function ef(s,c){jt(s,143);for(var u,d=0;d!=c.SheetNames.length;++d){var g={Hidden:c.Workbook&&c.Workbook.Sheets&&c.Workbook.Sheets[d]&&c.Workbook.Sheets[d].Hidden||0,iTabID:d+1,strRelID:"rId"+(d+1),name:c.SheetNames[d]};jt(s,156,(u=g,(g=(g=void 0)||xt(127)).write_shift(4,u.Hidden),g.write_shift(4,u.iTabID),Xo(u.strRelID,g),Oa(u.name.slice(0,31),g),g.length>g.l?g.slice(0,g.l):g))}jt(s,144)}function r0(s,c){if(c.Workbook&&c.Workbook.Sheets){for(var u,d=c.Workbook.Sheets,g=0,x=-1,b=-1;g<d.length;++g)!d[g]||!d[g].Hidden&&x==-1?x=g:d[g].Hidden==1&&b==-1&&(b=g);x<b||(jt(s,135),jt(s,158,(c=x,(u=u||xt(29)).write_shift(-4,0),u.write_shift(-4,460),u.write_shift(4,28800),u.write_shift(4,17600),u.write_shift(4,500),u.write_shift(4,c),u.write_shift(4,c),u.write_shift(1,120),u.length>u.l?u.slice(0,u.l):u)),jt(s,136))}}function nl(s,c){var u=xs();return jt(u,131),jt(u,128,(function(d){d=d||xt(127);for(var g=0;g!=4;++g)d.write_shift(4,0);return Oa("SheetJS",d),Oa(n.version,d),Oa(n.version,d),Oa("7262",d),d.length>d.l?d.slice(0,d.l):d})()),jt(u,153,(function(d,g){g=g||xt(72);var x=0;return d&&d.filterPrivacy&&(x|=8),g.write_shift(4,x),g.write_shift(4,0),$l(d&&d.CodeName||"ThisWorkbook",g),g.slice(0,g.l)})(s.Workbook&&s.Workbook.WBProps||null)),r0(u,s),ef(u,s),jt(u,132),u.end()}function Jp(s,c,u){return(c.slice(-4)===".bin"?function(d,g){var x={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},b=[],S=!1;(g=g||{}).biff=12;var N=[],T=[[]];return T.SheetNames=[],T.XTI=[],ad[16]={n:"BrtFRTArchID$",f:Nl},so(d,function(F,O,L){switch(L){case 156:T.SheetNames.push(F.name),x.Sheets.push(F);break;case 153:x.WBProps=F;break;case 39:F.Sheet!=null&&(g.SID=F.Sheet),F.Ref=mo(F.Ptg,0,null,T,g),delete g.SID,delete F.Ptg,N.push(F);break;case 1036:break;case 357:case 358:case 355:case 667:T[0].length?T.push([L,F]):T[0]=[L,F],T[T.length-1].XTI=[];break;case 362:T.length===0&&(T[0]=[],T[0].XTI=[]),T[T.length-1].XTI=T[T.length-1].XTI.concat(F),T.XTI=T.XTI.concat(F);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:b.push(L),S=!0;break;case 36:b.pop(),S=!1;break;case 37:b.push(L),S=!0;break;case 38:b.pop(),S=!1;break;case 16:break;default:if(!O.T&&(!S||g.WTF&&b[b.length-1]!=37&&b[b.length-1]!=35))throw new Error("Unexpected record 0x"+L.toString(16))}},g),a1(x),x.Names=N,x.supbooks=T,x}:function(d,g){if(!d)throw new Error("Could not find file");var x={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},b=!1,S="xmlns",N={},T=0;if(d.replace(os,function(F,O){var L=ln(F);switch(Zs(L[0])){case"<?xml":break;case"<workbook":F.match(nd)&&(S="xmlns"+F.match(/<(\w+):/)[1]),x.xmlns=L[S];break;case"</workbook>":break;case"<fileVersion":delete L[0],x.AppVersion=L;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":zn.forEach(function(B){if(L[B[0]]!=null)switch(B[2]){case"bool":x.WBProps[B[0]]=Ea(L[B[0]]);break;case"int":x.WBProps[B[0]]=parseInt(L[B[0]],10);break;default:x.WBProps[B[0]]=L[B[0]]}}),L.codeName&&(x.WBProps.CodeName=Xn(L.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete L[0],x.WBView.push(L);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(L.state){case"hidden":L.Hidden=1;break;case"veryHidden":L.Hidden=2;break;default:L.Hidden=0}delete L.state,L.name=cn(Xn(L.name)),delete L[0],x.Sheets.push(L);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":b=!0;break;case"</definedNames>":b=!1;break;case"<definedName":(N={}).Name=Xn(L.name),L.comment&&(N.Comment=L.comment),L.localSheetId&&(N.Sheet=+L.localSheetId),Ea(L.hidden||"0")&&(N.Hidden=!0),T=O+F.length;break;case"</definedName>":N.Ref=cn(Xn(d.slice(T,O))),x.Names.push(N);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete L[0],x.CalcPr=L;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":b=!0;break;case"</AlternateContent>":b=!1;break;case"<revisionPtr":break;default:if(!b&&g.WTF)throw new Error("unrecognized "+L[0]+" in workbook")}return F}),Jo.indexOf(x.xmlns)===-1)throw new Error("Unknown Namespace: "+x.xmlns);return a1(x),x})(s,u)}function i1(s,c,u,d,g,x,b,S){return(c.slice(-4)===".bin"?function(N,T,F,O,L,B,ee){if(!N)return N;var G=T||{};O=O||{"!id":{}};var he,ne,J,ue,be,we,$e,et,Xe,lt,_t=G.dense?[]:{},Dt={s:{r:2e6,c:2e6},e:{r:0,c:0}},ft=!1,qt=!1,hr=[];G.biff=12;var lr=G["!row"]=0,Zt=!1,tr=[],Kt={},Bt=G.supbooks||L.supbooks||[[]];if(Bt.sharedf=Kt,Bt.arrayf=tr,Bt.SheetNames=L.SheetNames||L.Sheets.map(function(Gt){return Gt.name}),!G.supbooks&&(G.supbooks=Bt,L.Names))for(var mr=0;mr<L.Names.length;++mr)Bt[0][mr+1]=L.Names[mr];var Nr,Gr=[],Mn=[],dr=!1;return ad[16]={n:"BrtShortReal",f:Xd},so(N,function(Gt,bn,Qn){if(!qt)switch(Qn){case 148:he=Gt;break;case 0:ne=Gt,G.sheetRows&&G.sheetRows<=ne.r&&(qt=!0),Xe=ja(be=ne.r),G["!row"]=ne.r,(Gt.hidden||Gt.hpt||Gt.level!=null)&&(Gt.hpt&&(Gt.hpx=Xh(Gt.hpt)),Mn[Gt.r]=Gt);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(J={t:Gt[2]},Gt[2]){case"n":J.v=Gt[1];break;case"s":et=Kd[Gt[1]],J.v=et.t,J.r=et.r;break;case"b":J.v=!!Gt[1];break;case"e":J.v=Gt[1],G.cellText!==!1&&(J.w=Zi[J.v]);break;case"str":J.t="s",J.v=Gt[1];break;case"is":J.t="s",J.v=Gt[1].t}if((ue=ee.CellXf[Gt[0].iStyleRef])&&nu(J,ue.numFmtId,null,G,B,ee),we=Gt[0].c==-1?we+1:Gt[0].c,G.dense?(_t[be]||(_t[be]=[]),_t[be][we]=J):_t[Ln(we)+Xe]=J,G.cellFormula){for(Zt=!1,lr=0;lr<tr.length;++lr){var $n=tr[lr];ne.r>=$n[0].s.r&&ne.r<=$n[0].e.r&&we>=$n[0].s.c&&we<=$n[0].e.c&&(J.F=rn($n[0]),Zt=!0)}!Zt&&3<Gt.length&&(J.f=Gt[3])}Dt.s.r>ne.r&&(Dt.s.r=ne.r),Dt.s.c>we&&(Dt.s.c=we),Dt.e.r<ne.r&&(Dt.e.r=ne.r),Dt.e.c<we&&(Dt.e.c=we),G.cellDates&&ue&&J.t=="n"&&_r(se[ue.numFmtId])&&(Sa=pe(J.v))&&(J.t="d",J.v=new Date(Sa.y,Sa.m-1,Sa.d,Sa.H,Sa.M,Sa.S,Sa.u)),Nr&&(Nr.type=="XLDAPR"&&(J.D=!0),Nr=void 0);break;case 1:case 12:if(!G.sheetStubs||ft)break;J={t:"z",v:void 0},we=Gt[0].c==-1?we+1:Gt[0].c,G.dense?(_t[be]||(_t[be]=[]),_t[be][we]=J):_t[Ln(we)+Xe]=J,Dt.s.r>ne.r&&(Dt.s.r=ne.r),Dt.s.c>we&&(Dt.s.c=we),Dt.e.r<ne.r&&(Dt.e.r=ne.r),Dt.e.c<we&&(Dt.e.c=we),Nr&&(Nr.type=="XLDAPR"&&(J.D=!0),Nr=void 0);break;case 176:hr.push(Gt);break;case 49:Nr=((G.xlmeta||{}).Cell||[])[Gt-1];break;case 494:var Sa=O["!id"][Gt.relId];for(Sa?(Gt.Target=Sa.Target,Gt.loc&&(Gt.Target+="#"+Gt.loc),Gt.Rel=Sa):Gt.relId==""&&(Gt.Target="#"+Gt.loc),be=Gt.rfx.s.r;be<=Gt.rfx.e.r;++be)for(we=Gt.rfx.s.c;we<=Gt.rfx.e.c;++we)G.dense?(_t[be]||(_t[be]=[]),_t[be][we]||(_t[be][we]={t:"z",v:void 0}),_t[be][we].l=Gt):($e=sn({c:we,r:be}),_t[$e]||(_t[$e]={t:"z",v:void 0}),_t[$e].l=Gt);break;case 426:if(!G.cellFormula)break;tr.push(Gt),(lt=G.dense?_t[be][we]:_t[Ln(we)+Xe]).f=mo(Gt[1],0,{r:ne.r,c:we},Bt,G),lt.F=rn(Gt[0]);break;case 427:if(!G.cellFormula)break;Kt[sn(Gt[0].s)]=Gt[1],(lt=G.dense?_t[be][we]:_t[Ln(we)+Xe]).f=mo(Gt[1],0,{r:ne.r,c:we},Bt,G);break;case 60:if(!G.cellStyles)break;for(;Gt.e>=Gt.s;)Gr[Gt.e--]={width:Gt.w/256,hidden:!!(1&Gt.flags),level:Gt.level},dr||(dr=!0,zf(Gt.w/256)),mh(Gr[Gt.e+1]);break;case 161:_t["!autofilter"]={ref:rn(Gt)};break;case 476:_t["!margins"]=Gt;break;case 147:L.Sheets[F]||(L.Sheets[F]={}),Gt.name&&(L.Sheets[F].CodeName=Gt.name),(Gt.above||Gt.left)&&(_t["!outline"]={above:Gt.above,left:Gt.left});break;case 137:L.Views||(L.Views=[{}]),L.Views[0]||(L.Views[0]={}),Gt.RTL&&(L.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:ft=!0;break;case 36:ft=!1;break;case 37:ft=!0;break;case 38:ft=!1;break;default:if(!bn.T&&(!ft||G.WTF))throw new Error("Unexpected record 0x"+Qn.toString(16))}},G),delete G.supbooks,delete G["!row"],!_t["!ref"]&&(Dt.s.r<2e6||he&&(0<he.e.r||0<he.e.c||0<he.s.r||0<he.s.c))&&(_t["!ref"]=rn(he||Dt)),G.sheetRows&&_t["!ref"]&&(N=wn(_t["!ref"]),G.sheetRows<=+N.e.r&&(N.e.r=G.sheetRows-1,N.e.r>Dt.e.r&&(N.e.r=Dt.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>Dt.e.c&&(N.e.c=Dt.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),_t["!fullref"]=_t["!ref"],_t["!ref"]=rn(N))),0<hr.length&&(_t["!merges"]=hr),0<Gr.length&&(_t["!cols"]=Gr),0<Mn.length&&(_t["!rows"]=Mn),_t}:Sg)(s,d,u,g,x,b,S)}function Eg(s,c,u,d,g,x){return c.slice(-4)===".bin"?(function(b,S,N,T,F){if(!b)return b;T=T||{"!id":{}};var O={"!type":"chart","!drawel":null,"!rel":""},L=!1;return so(b,function(B,ee,G){switch(G){case 550:O["!rel"]=B;break;case 651:F.Sheets[N]||(F.Sheets[N]={}),B.name&&(F.Sheets[N].CodeName=B.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:L=!0;break;case 36:L=!1;break;case 37:break;case 38:break;default:if(!(0<ee.T)){if(!(ee.T<0)){if(!L||S.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}}},S),T["!id"][O["!rel"]]&&(O["!drawel"]=T["!id"][O["!rel"]]),O})(s,d,u,g,x):(function(b,S,N,T){if(!b)return b;N=N||{"!id":{}};var F={"!type":"chart","!drawel":null,"!rel":""},O=b.match(Ss);return O&&e1(O[0],0,T,S),(b=b.match(/drawing r:id="(.*?)"/))&&(F["!rel"]=b[1]),N["!id"][F["!rel"]]&&(F["!drawel"]=N["!id"][F["!rel"]]),F})(s,u,g,x)}function o1(s,c,u,d){return(c.slice(-4)===".bin"?function(g,x,b){var S,N={NumberFmt:[]};for(S in se)N.NumberFmt[S]=se[S];N.CellXf=[],N.Fonts=[];var T=[],F=!1;return so(g,function(O,L,B){switch(B){case 44:N.NumberFmt[O[0]]=O[1],an(O[1],O[0]);break;case 43:N.Fonts.push(O),O.color.theme!=null&&x&&x.themeElements&&x.themeElements.clrScheme&&(O.color.rgb=tl(x.themeElements.clrScheme[O.color.theme].rgb,O.color.tint||0));break;case 1025:case 45:case 46:break;case 47:T[T.length-1]==617&&N.CellXf.push(O);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:F=!0;break;case 36:F=!1;break;case 37:T.push(B),F=!0;break;case 38:T.pop(),F=!1;break;default:if(0<L.T)T.push(B);else if(L.T<0)T.pop();else if(!F||b.WTF&&T[T.length-1]!=37)throw new Error("Unexpected record 0x"+B.toString(16))}}),N}:Tp)(s,u,d)}function l1(s,c,u){return c.slice(-4)===".bin"?(d=u,x=!(g=[]),so(s,function(b,S,N){switch(N){case 159:g.Count=b[0],g.Unique=b[1];break;case 19:g.push(b);break;case 160:return 1;case 35:x=!0;break;case 36:x=!1;break;default:if(S.T,!x||d.WTF)throw new Error("Unexpected record 0x"+N.toString(16))}}),g):(function(b,S){var N=[],T="";if(!b)return N;if(b=b.match(fi)){T=b[2].replace(Fs,"").split(Kh);for(var F=0;F!=T.length;++F){var O=fh(T[F].trim(),S);O!=null&&(N[N.length]=O)}b=ln(b[1]),N.Count=b.count,N.Unique=b.uniqueCount}return N})(s,u);var d,g,x}function wh(s,c,u){return c.slice(-4)===".bin"?(d=u,g=[],x=[],S=!(b={}),so(s,function(N,T,F){switch(F){case 632:x.push(N);break;case 635:b=N;break;case 637:b.t=N.t,b.h=N.h,b.r=N.r;break;case 636:if(b.author=x[b.iauthor],delete b.iauthor,d.sheetRows&&b.rfx&&d.sheetRows<=b.rfx.r)break;b.t||(b.t=""),delete b.rfx,g.push(b);break;case 3072:break;case 35:S=!0;break;case 36:S=!1;break;case 37:case 38:break;default:if(!T.T&&(!S||d.WTF))throw new Error("Unexpected record 0x"+F.toString(16))}}),g):(function(N,T){if(N.match(/<(?:\w+:)?comments *\/>/))return[];var F=[],O=[],L=N.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return L&&L[1]&&L[1].split(/<\/\w*:?author>/).forEach(function(B){B===""||B.trim()===""||(B=B.match(/<(?:\w+:)?author[^>]*>(.*)/))&&F.push(B[1])}),(N=N.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&N[1]&&N[1].split(/<\/\w*:?comment>/).forEach(function(B){var ee,G;B===""||B.trim()===""||(ee=B.match(/<(?:\w+:)?comment[^>]*>/))&&(ee={author:(G=ln(ee[0])).authorId&&F[G.authorId]||"sheetjsghost",ref:G.ref,guid:G.guid},G=ga(G.ref),T.sheetRows&&T.sheetRows<=G.r||(B=!!(B=B.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!B[1]&&fh(B[1])||{r:"",t:"",h:""},ee.r=B.r,B.r=="<t></t>"&&(B.t=B.h=""),ee.t=(B.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),T.cellHTML&&(ee.h=B.h),O.push(ee)))}),O})(s,u);var d,g,x,b,S}function Ei(s,c){return c.slice(-4)===".bin"?(u=[],so(s,function(d,g,x){if(x===63)u.push(d);else if(!g.T)throw new Error("Unexpected record 0x"+x.toString(16))}),u):(function(d){var g=[];if(!d)return g;var x=1;return(d.match(os)||[]).forEach(function(b){var S=ln(b);switch(S[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete S[0],S.i?x=S.i:S.i=x,g.push(S)}}),g})(s);var u}function Sh(s,c,u,d){if(u.slice(-4)===".bin")return(function(g,x){if(!g)return g;var b=x||{},S=!1;so(g,function(N,T,F){switch(F){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:S=!0;break;case 36:S=!1;break;default:if(!T.T&&(!S||b.WTF))throw new Error("Unexpected record 0x"+F.toString(16))}},b)})(s,d)}function tf(s,c,u){return c.slice(-4)===".bin"?(d={Types:[],Cell:[],Value:[]},g=u||{},b=!(x=[]),S=2,so(s,function(N,T,F){switch(F){case 335:d.Types.push({name:N.name});break;case 51:N.forEach(function(O){S==1?d.Cell.push({type:d.Types[O[0]-1].name,index:O[1]}):S==0&&d.Value.push({type:d.Types[O[0]-1].name,index:O[1]})});break;case 337:S=N?1:0;break;case 338:S=2;break;case 35:x.push(F),b=!0;break;case 36:x.pop(),b=!1;break;default:if(!T.T&&(!b||g.WTF&&x[x.length-1]!=35))throw new Error("Unexpected record 0x"+F.toString(16))}}),d):(function(N,T){var F={Types:[],Cell:[],Value:[]};if(!N)return F;var O,L=!1,B=2;return N.replace(os,function(ee){var G=ln(ee);switch(Zs(G[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":F.Types.push({name:G.name});break;case"</metadataType>":break;case"<futureMetadata":for(var he=0;he<F.Types.length;++he)F.Types[he].name==G.name&&(O=F.Types[he]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":B==1?F.Cell.push({type:F.Types[G.t-1].name,index:+G.v}):B==0&&F.Value.push({type:F.Types[G.t-1].name,index:+G.v});break;case"</rc>":break;case"<cellMetadata":B=1;break;case"</cellMetadata>":B=2;break;case"<valueMetadata":B=0;break;case"</valueMetadata>":B=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":L=!0;break;case"</ext>":L=!1;break;case"<rvb":if(!O)break;O.offsets||(O.offsets=[]),O.offsets.push(+G.i);break;default:if(!L&&T.WTF)throw new Error("unrecognized "+G[0]+" in metadata")}return ee}),F})(s,u);var d,g,x,b,S}var Tl,c1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,u1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function rc(s,c){var u=s.split(/\s+/),d=[];if(d[0]=u[0],u.length===1)return d;var g,x,b,S=s.match(c1);if(S)for(b=0;b!=S.length;++b)(x=(g=S[b].match(u1))[1].indexOf(":"))===-1?d[g[1]]=g[2].slice(1,g[2].length-1):d[g[1].slice(0,6)==="xmlns:"?"xmlns"+g[1].slice(6):g[1].slice(x+1)]=g[2].slice(1,g[2].length-1);return d}function n0(s,c,u){if(s.t!=="z"){if(!u||u.cellText!==!1)try{s.t==="e"?s.w=s.w||Zi[s.v]:c==="General"?s.t==="n"?(0|s.v)===s.v?s.w=s.v.toString(10):s.w=Te(s.v):s.w=Ht(s.v):s.w=(d=c||"General",g=s.v,(d=Tl[d]||cn(d))==="General"?Ht(g):xr(d,g))}catch(b){if(u.WTF)throw b}var d,g;try{var x=Tl[c]||c||"General";u.cellNF&&(s.z=x),u.cellDates&&s.t=="n"&&_r(x)&&(x=pe(s.v))&&(s.t="d",s.v=new Date(x.y,x.m-1,x.d,x.H,x.M,x.S,x.u))}catch(b){if(u.WTF)throw b}}}function a0(s,c){var u=c||{};Jn();var d,g=V(sh(s)),x=(g=u.type=="binary"||u.type=="array"||u.type=="base64"?e!==void 0?e.utils.decode(65001,k(g)):Xn(g):g).slice(0,1024).toLowerCase(),b=!1;if((1023&(x=x.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&x.indexOf(","),1023&x.indexOf(";"))){var S=jn(u);return S.type="string",Hn.to_workbook(g,S)}if(x.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(He){0<=x.indexOf("<"+He)&&(b=!0)}),b)return(function(He,zt){if(He=He.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!He||He.length==0)throw new Error("Invalid HTML: could not find <table>");if(He.length==1)return oi(l0(He[0],zt),zt);var ct=mm();return He.forEach(function(gt,it){I1(ct,l0(gt,zt),"Sheet"+(it+1))}),ct})(g,u);Tl={"General Number":"General","General Date":se[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":se[15],"Short Date":se[14],"Long Time":se[19],"Medium Time":se[18],"Short Time":se[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:se[2],Standard:se[4],Percent:se[10],Scientific:se[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var N,T=[],F,O={},L=[],B=u.dense?[]:{},ee="",G={},he={},ne=rc('<Data ss:Type="String">'),J=0,ue=0,be=0,we={s:{r:2e6,c:2e6},e:{r:0,c:0}},$e={},et={},Xe="",lt=0,_t=[],Dt={},ft={},qt=0,hr=[],lr=[],Zt={},tr=[],Kt=!1,Bt=[],mr=[],Nr={},Gr=0,Mn=0,dr={Sheets:[],WBProps:{date1904:!1}},Gt={};Ui.lastIndex=0,g=g.replace(/<!--([\s\S]*?)-->/gm,"");for(var bn,Qn,$n,Sa,Ls="";d=Ui.exec(g);)switch(d[3]=(Ls=d[3]).toLowerCase()){case"data":if(Ls=="data"){if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&T.push([d[3],!0]);break}if(T[T.length-1][1])break;d[1]==="/"?(function(He,zt,ct,gt,it,Nt,Vt,vr,gr,or){var br="General",Pr=gt.StyleID,Rr={};or=or||{};var rr=[],Wt=0;for((Pr=Pr===void 0&&vr?vr.StyleID:Pr)===void 0&&Vt&&(Pr=Vt.StyleID);Nt[Pr]!==void 0&&(Nt[Pr].nf&&(br=Nt[Pr].nf),Nt[Pr].Interior&&rr.push(Nt[Pr].Interior),Nt[Pr].Parent);)Pr=Nt[Pr].Parent;switch(ct.Type){case"Boolean":gt.t="b",gt.v=Ea(He);break;case"String":gt.t="s",gt.r=Gc(cn(He)),gt.v=-1<He.indexOf("<")?cn(zt||He).replace(/<.*?>/g,""):gt.r;break;case"DateTime":He.slice(-1)!="Z"&&(He+="Z"),gt.v=(vn(He)-new Date(Date.UTC(1899,11,30)))/864e5,gt.v!=gt.v?gt.v=cn(He):gt.v<60&&(gt.v=gt.v-1),br&&br!="General"||(br="yyyy-mm-dd");case"Number":gt.v===void 0&&(gt.v=+He),gt.t||(gt.t="n");break;case"Error":gt.t="e",gt.v=No[He],or.cellText!==!1&&(gt.w=He);break;default:He==""&&zt==""?gt.t="z":(gt.t="s",gt.v=Gc(zt||He))}if(n0(gt,br,or),or.cellFormula!==!1)if(gt.Formula)ct=cn(gt.Formula),ct.charCodeAt(0)==61&&(ct=ct.slice(1)),gt.f=Zh(ct,it),delete gt.Formula,gt.ArrayRange=="RC"?gt.F=Zh("RC:RC",it):gt.ArrayRange&&(gt.F=Zh(gt.ArrayRange,it),gr.push([wn(gt.F),gt.F]));else for(Wt=0;Wt<gr.length;++Wt)it.r>=gr[Wt][0].s.r&&it.r<=gr[Wt][0].e.r&&it.c>=gr[Wt][0].s.c&&it.c<=gr[Wt][0].e.c&&(gt.F=gr[Wt][1]);or.cellStyles&&(rr.forEach(function(Ur){!Rr.patternType&&Ur.patternType&&(Rr.patternType=Ur.patternType)}),gt.s=Rr),gt.StyleID!==void 0&&(gt.ixfe=gt.StyleID)})(g.slice(J,d.index),Xe,ne,T[T.length-1][0]=="comment"?Zt:G,{c:ue,r:be},$e,tr[ue],he,Bt,u):(Xe="",ne=rc(d[0]),J=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(0<lr.length&&(G.c=lr),(!u.sheetRows||u.sheetRows>be)&&G.v!==void 0&&(u.dense?(B[be]||(B[be]=[]),B[be][ue]=G):B[Ln(ue)+ja(be)]=G),G.HRef&&(G.l={Target:cn(G.HRef)},G.HRefScreenTip&&(G.l.Tooltip=G.HRefScreenTip),delete G.HRef,delete G.HRefScreenTip),(G.MergeAcross||G.MergeDown)&&(Gr=ue+(0|parseInt(G.MergeAcross,10)),Mn=be+(0|parseInt(G.MergeDown,10)),_t.push({s:{c:ue,r:be},e:{c:Gr,r:Mn}})),u.sheetStubs)if(G.MergeAcross||G.MergeDown){for(var We=ue;We<=Gr;++We)for(var Aa=be;Aa<=Mn;++Aa)(ue<We||be<Aa)&&(u.dense?(B[Aa]||(B[Aa]=[]),B[Aa][We]={t:"z"}):B[Ln(We)+ja(Aa)]={t:"z"});ue=Gr+1}else++ue;else G.MergeAcross?ue=Gr+1:++ue;else(ue=(G=(function(He){var zt={};if(He.split(/\s+/).length===1)return zt;var ct,gt,it,Nt=He.match(c1);if(Nt)for(it=0;it!=Nt.length;++it)(gt=(ct=Nt[it].match(u1))[1].indexOf(":"))===-1?zt[ct[1]]=ct[2].slice(1,ct[2].length-1):zt[ct[1].slice(0,6)==="xmlns:"?"xmlns"+ct[1].slice(6):ct[1].slice(gt+1)]=ct[2].slice(1,ct[2].length-1);return zt})(d[0])).Index?+G.Index-1:ue)<we.s.c&&(we.s.c=ue),ue>we.e.c&&(we.e.c=ue),d[0].slice(-2)==="/>"&&++ue,lr=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(be<we.s.r&&(we.s.r=be),be>we.e.r&&(we.e.r=be),d[0].slice(-2)==="/>"&&(he=rc(d[0])).Index&&(be=+he.Index-1),ue=0,++be):((he=rc(d[0])).Index&&(be=+he.Index-1),Nr={},he.AutoFitHeight!="0"&&!he.Height||(Nr.hpx=parseInt(he.Height,10),Nr.hpt=zd(Nr.hpx),mr[be]=Nr),he.Hidden=="1"&&(Nr.hidden=!0,mr[be]=Nr));break;case"worksheet":if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"));L.push(ee),we.s.r<=we.e.r&&we.s.c<=we.e.c&&(B["!ref"]=rn(we),u.sheetRows&&u.sheetRows<=we.e.r&&(B["!fullref"]=B["!ref"],we.e.r=u.sheetRows-1,B["!ref"]=rn(we))),_t.length&&(B["!merges"]=_t),0<tr.length&&(B["!cols"]=tr),0<mr.length&&(B["!rows"]=mr),O[ee]=B}else we={s:{r:2e6,c:2e6},e:{r:0,c:0}},be=ue=0,T.push([d[3],!1]),N=rc(d[0]),ee=cn(N.Name),B=u.dense?[]:{},_t=[],Bt=[],mr=[],Gt={name:ee,Hidden:0},dr.Sheets.push(Gt);break;case"table":if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"))}else{if(d[0].slice(-2)=="/>")break;T.push([d[3],!1]),Kt=!(tr=[])}break;case"style":d[1]==="/"?(Qn=$e,$n=et,(Sa=u).cellStyles&&(!$n.Interior||(Sa=$n.Interior).Pattern&&(Sa.patternType=Xm[Sa.Pattern]||Sa.Pattern)),Qn[$n.ID]=$n):et=rc(d[0]);break;case"numberformat":et.nf=cn(rc(d[0]).Format||"General"),Tl[et.nf]&&(et.nf=Tl[et.nf]);for(var la=0;la!=392&&se[la]!=et.nf;++la);if(la==392){for(la=57;la!=392;++la)if(se[la]==null){an(et.nf,la);break}}break;case"column":if(T[T.length-1][0]!=="table")break;if((F=rc(d[0])).Hidden&&(F.hidden=!0,delete F.Hidden),F.Width&&(F.wpx=parseInt(F.Width,10)),!Kt&&10<F.wpx){Kt=!0,Rs=Xl;for(var ki=0;ki<tr.length;++ki)tr[ki]&&mh(tr[ki])}Kt&&mh(F),tr[F.Index-1||tr.length]=F;for(var ac=0;ac<+F.Span;++ac)tr[tr.length]=jn(F);break;case"namedrange":if(d[1]==="/")break;dr.Names||(dr.Names=[]);var Ie=ln(d[0]),pt={Name:Ie.Name,Ref:Zh(Ie.RefersTo.slice(1),{r:0,c:0})};0<dr.Sheets.length&&(pt.Sheet=dr.Sheets.length-1),dr.Names.push(pt);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?Xe+=g.slice(lt,d.index):lt=d.index+d[0].length;break;case"interior":if(!u.cellStyles)break;et.Interior=rc(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?($n=Dt,Ie=Ls,pt=g.slice(qt,d.index),$n[Ie=(Au=Au||Yr(wc))[Ie]||Ie]=pt):qt=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"))}else T.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"));(bn=Zt).t=bn.v||"",bn.t=bn.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),bn.v=bn.w=bn.ixfe=void 0,lr.push(Zt)}else T.push([d[3],!1]),Zt={a:(N=rc(d[0])).Author};break;case"autofilter":if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&(bn=rc(d[0]),B["!autofilter"]={ref:Zh(bn.Range).replace(/\$/g,"")},T.push([d[3],!0]));break;case"name":break;case"datavalidation":if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&T.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((N=T.pop())[0]!==d[3])throw new Error("Bad state: "+N.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&T.push([d[3],!0]);break;case"null":break;default:if(T.length==0&&d[3]=="document"||T.length==0&&d[3]=="uof")return m1(g,u);var qe=!0;switch(T[T.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:qe=!1}break;case"componentoptions":switch(d[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:qe=!1}break;case"excelworkbook":switch(d[3]){case"date1904":dr.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:qe=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":case"height":case"width":break;default:qe=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(g.slice(qt,d.index)){case"SheetHidden":Gt.Hidden=1;break;case"SheetVeryHidden":Gt.Hidden=2}else qt=d.index+d[0].length;break;case"header":B["!margins"]||ru(B["!margins"]={},"xlml"),isNaN(+ln(d[0]).Margin)||(B["!margins"].header=+ln(d[0]).Margin);break;case"footer":B["!margins"]||ru(B["!margins"]={},"xlml"),isNaN(+ln(d[0]).Margin)||(B["!margins"].footer=+ln(d[0]).Margin);break;case"pagemargins":var dt=ln(d[0]);B["!margins"]||ru(B["!margins"]={},"xlml"),isNaN(+dt.Top)||(B["!margins"].top=+dt.Top),isNaN(+dt.Left)||(B["!margins"].left=+dt.Left),isNaN(+dt.Right)||(B["!margins"].right=+dt.Right),isNaN(+dt.Bottom)||(B["!margins"].bottom=+dt.Bottom);break;case"displayrighttoleft":dr.Views||(dr.Views=[]),dr.Views[0]||(dr.Views[0]={}),dr.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":B["!outline"]||(B["!outline"]={}),B["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":B["!outline"]||(B["!outline"]={}),B["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:qe=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:qe=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:qe=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:qe=!1}break;case"querytable":switch(d[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:qe=!1}break;case"datavalidation":switch(d[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:qe=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:qe=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:qe=!1}break;case"smarttags":break;default:qe=!1}if(qe||d[3].match(/!\[CDATA/))break;if(!T[T.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+T.join("|");if(T[T.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?(function(He,zt,ct,gt){var it=gt;switch((ct[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":it=Ea(gt);break;case"i2":case"int":it=parseInt(gt,10);break;case"r4":case"float":it=parseFloat(gt);break;case"date":case"dateTime.tz":it=vn(gt);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+ct[0])}He[cn(zt)]=it})(ft,Ls,hr,g.slice(qt,d.index)):qt=(hr=d).index+d[0].length;break}if(u.WTF)throw"Unrecognized tag: "+d[3]+"|"+T.join("|")}return S={},u.bookSheets||u.bookProps||(S.Sheets=O),S.SheetNames=L,S.Workbook=dr,S.SSF=jn(se),S.Props=Dt,S.Custprops=ft,S}function Oo(s,c){switch(im(c=c||{}),c.type||"base64"){case"base64":return a0(re(s),c);case"binary":case"buffer":case"file":return a0(s,c);case"array":return a0(z(s),c)}}function kg(s,c){var u,d,g,x,b,S,N,T=[];return s.Props&&T.push((u=s.Props,d=c,g=[],fa(wc).map(function(F){for(var O=0;O<La.length;++O)if(La[O][1]==F)return La[O];for(O=0;O<co.length;++O)if(co[O][1]==F)return co[O];throw F}).forEach(function(F){var O;u[F[1]]!=null&&(O=(d&&d.Props&&d.Props[F[1]]!=null?d.Props:u)[F[1]],typeof(O=F[2]==="date"?new Date(O).toISOString().replace(/\.\d*Z/,"Z"):O)=="number"?O=String(O):O===!0||O===!1?O=O?"1":"0":O instanceof Date&&(O=new Date(O).toISOString().replace(/\.\d*Z/,"")),g.push(vs(wc[F[1]]||F[1],O)))}),Xt("DocumentProperties",g.join(""),{xmlns:wa.o}))),s.Custprops&&T.push((x=s.Props,b=s.Custprops,S=["Worksheets","SheetNames"],s="CustomDocumentProperties",N=[],x&&fa(x).forEach(function(F){if(Object.prototype.hasOwnProperty.call(x,F)){for(var O=0;O<La.length;++O)if(F==La[O][1])return;for(O=0;O<co.length;++O)if(F==co[O][1])return;for(O=0;O<S.length;++O)if(F==S[O])return;var L="string",B=typeof(B=x[F])=="number"?(L="float",String(B)):B===!0||B===!1?(L="boolean",B?"1":"0"):String(B);N.push(Xt(Pi(F),B,{"dt:dt":L}))}}),b&&fa(b).forEach(function(F){var O,L;Object.prototype.hasOwnProperty.call(b,F)&&(x&&Object.prototype.hasOwnProperty.call(x,F)||(O="string",L=typeof(L=b[F])=="number"?(O="float",String(L)):L===!0||L===!1?(O="boolean",L?"1":"0"):L instanceof Date?(O="dateTime.tz",L.toISOString()):String(L),N.push(Xt(Pi(F),L,{"dt:dt":O}))))}),"<"+s+' xmlns="'+wa.o+'">'+N.join("")+"</"+s+">")),T.join("")}function Lo(s){return Xt("NamedRange",null,{"ss:Name":s.Name,"ss:RefersTo":"="+K0(s.Ref,{r:0,c:0})})}function _g(s,c,u,d,g,x,b){if(!s||s.v==null&&s.f==null)return"";var S={};if(s.f&&(S["ss:Formula"]="="+aa(K0(s.f,b))),s.F&&s.F.slice(0,c.length)==c&&(c=ga(s.F.slice(c.length+1)),S["ss:ArrayRange"]="RC:R"+(c.r==b.r?"":"["+(c.r-b.r)+"]")+"C"+(c.c==b.c?"":"["+(c.c-b.c)+"]")),s.l&&s.l.Target&&(S["ss:HRef"]=aa(s.l.Target),s.l.Tooltip&&(S["x:HRefScreenTip"]=aa(s.l.Tooltip))),u["!merges"])for(var N=u["!merges"],T=0;T!=N.length;++T)N[T].s.c==b.c&&N[T].s.r==b.r&&(N[T].e.c>N[T].s.c&&(S["ss:MergeAcross"]=N[T].e.c-N[T].s.c),N[T].e.r>N[T].s.r&&(S["ss:MergeDown"]=N[T].e.r-N[T].s.r));var F="",O="";switch(s.t){case"z":if(!d.sheetStubs)return"";break;case"n":F="Number",O=String(s.v);break;case"b":F="Boolean",O=s.v?"1":"0";break;case"e":F="Error",O=Zi[s.v];break;case"d":F="DateTime",O=new Date(s.v).toISOString(),s.z==null&&(s.z=s.z||se[14]);break;case"s":F="String",O=((s.v||"")+"").replace(qc,function(L){return Bs[L]}).replace(rh,function(L){return"&#x"+L.charCodeAt(0).toString(16).toUpperCase()+";"})}return u=Iu(d.cellXfs,s,d),S["ss:StyleID"]="s"+(21+u),S["ss:Index"]=b.c+1,u=s.v!=null?O:"",u=s.t=="z"?"":'<Data ss:Type="'+F+'">'+u+"</Data>",0<(s.c||[]).length&&(u+=s.c.map(function(L){var B=Xt("ss:Data",(L.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Xt("Comment",B,{"ss:Author":L.a})}).join("")),Xt("Cell",u,S)}function Ig(s,c){if(!s["!ref"])return"";var u=wn(s["!ref"]),d=s["!merges"]||[],g=0,x=[];s["!cols"]&&s["!cols"].forEach(function(he,be){mh(he);var J=!!he.width,ue=Jd(be,he),be={"ss:Index":be+1};J&&(be["ss:Width"]=ph(ue.width)),he.hidden&&(be["ss:Hidden"]="1"),x.push(Xt("Column",null,be))});for(var b,S,N=Array.isArray(s),T=u.s.r;T<=u.e.r;++T){for(var F=[(b=T,S=(s["!rows"]||[])[T],b='<Row ss:Index="'+(b+1)+'"',S&&(S.hpt&&!S.hpx&&(S.hpx=Xh(S.hpt)),S.hpx&&(b+=' ss:AutoFitHeight="0" ss:Height="'+S.hpx+'"'),S.hidden&&(b+=' ss:Hidden="1"')),b+">")],O=u.s.c;O<=u.e.c;++O){for(var L,B,ee,G=!1,g=0;g!=d.length;++g)if(!(d[g].s.c>O||d[g].s.r>T||d[g].e.c<O||d[g].e.r<T)){d[g].s.c==O&&d[g].s.r==T||(G=!0);break}G||(B=sn(L={r:T,c:O}),ee=N?(s[T]||[])[O]:s[B],F.push(_g(ee,B,s,c,0,0,L)))}F.push("</Row>"),2<F.length&&x.push(F.join(""))}return x.join("")}function Jy(s,c,u){var d=[],x=u.SheetNames[s],g=u.Sheets[x],x=g?(function(b,S,N){if(!b||!((N||{}).Workbook||{}).Names)return"";for(var T=N.Workbook.Names,F=[],O=0;O<T.length;++O){var L=T[O];L.Sheet==S&&(L.Name.match(/^_xlfn\./)||F.push(Lo(L)))}return F.join("")})(g,s,u):"";return 0<x.length&&d.push("<Names>"+x+"</Names>"),0<(x=g?Ig(g,c):"").length&&d.push("<Table>"+x+"</Table>"),d.push((function(b,S,N){if(!b)return"";var T=[];if(b["!margins"]&&(T.push("<PageSetup>"),b["!margins"].header&&T.push(Xt("Header",null,{"x:Margin":b["!margins"].header})),b["!margins"].footer&&T.push(Xt("Footer",null,{"x:Margin":b["!margins"].footer})),T.push(Xt("PageMargins",null,{"x:Bottom":b["!margins"].bottom||"0.75","x:Left":b["!margins"].left||"0.7","x:Right":b["!margins"].right||"0.7","x:Top":b["!margins"].top||"0.75"})),T.push("</PageSetup>")),N&&N.Workbook&&N.Workbook.Sheets&&N.Workbook.Sheets[S])if(N.Workbook.Sheets[S].Hidden)T.push(Xt("Visible",N.Workbook.Sheets[S].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var F=0;F<S&&(!N.Workbook.Sheets[F]||N.Workbook.Sheets[F].Hidden);++F);F==S&&T.push("<Selected/>")}return((((N||{}).Workbook||{}).Views||[])[0]||{}).RTL&&T.push("<DisplayRightToLeft/>"),b["!protect"]&&(T.push(vs("ProtectContents","True")),b["!protect"].objects&&T.push(vs("ProtectObjects","True")),b["!protect"].scenarios&&T.push(vs("ProtectScenarios","True")),b["!protect"].selectLockedCells==null||b["!protect"].selectLockedCells?b["!protect"].selectUnlockedCells==null||b["!protect"].selectUnlockedCells||T.push(vs("EnableSelection","UnlockedCells")):T.push(vs("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(O){b["!protect"][O[0]]&&T.push("<"+O[1]+"/>")})),T.length==0?"":Xt("WorksheetOptions",T.join(""),{xmlns:wa.x})})(g,s,u)),d.join("")}function Ah(s,c){c=c||{},s.SSF||(s.SSF=jn(se)),s.SSF&&(Jn(),Lr(s.SSF),c.revssf=qo(s.SSF),c.revssf[s.SSF[65535]]=0,c.ssf=s.SSF,c.cellXfs=[],Iu(c.cellXfs,{},{revssf:{General:0}}));var u=[];u.push(kg(s,c)),u.push(""),u.push(""),u.push("");for(var d,g=0;g<s.SheetNames.length;++g)u.push(Xt("Worksheet",Jy(g,c,s),{"ss:Name":aa(s.SheetNames[g])}));return u[2]=(d=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],c.cellXfs.forEach(function(x,b){var S=[];S.push(Xt("NumberFormat",null,{"ss:Format":aa(se[x.numFmtId])})),b={"ss:ID":"s"+(21+b)},d.push(Xt("Style",S.join(""),b))}),Xt("Styles",d.join(""))),u[3]=(function(x){if(!((x||{}).Workbook||{}).Names)return"";for(var b=x.Workbook.Names,S=[],N=0;N<b.length;++N){var T=b[N];T.Sheet==null&&(T.Name.match(/^_xlfn\./)||S.push(Lo(T)))}return Xt("Names",S.join(""))})(s),is+Xt("Workbook",u.join(""),{xmlns:wa.ss,"xmlns:o":wa.o,"xmlns:x":wa.x,"xmlns:ss":wa.ss,"xmlns:dt":wa.dt,"xmlns:html":wa.html})}function h1(s){var c={},u=s.content;return u.l=28,c.AnsiUserType=u.read_shift(0,"lpstr-ansi"),c.AnsiClipboardFormat=Es(u,1),u.length-u.l<=4?c:(s=u.read_shift(4),s==0||40<s?c:(u.l-=4,c.Reserved1=u.read_shift(0,"lpstr-ansi"),u.length-u.l<=4||(s=u.read_shift(4))!==1907505652?c:(c.UnicodeClipboardFormat=Es(u,2),(s=u.read_shift(4))==0||40<s?c:(u.l-=4,void(c.Reserved2=u.read_shift(0,"lpwstr"))))))}var Qp=[60,1084,2066,2165,2175];function Po(s,c,u){if(s.t!=="z"&&s.XF){var d,g=0;try{g=s.z||s.XF.numFmtId||0,c.cellNF&&(s.z=se[g])}catch(x){if(c.WTF)throw x}if(!c||c.cellText!==!1)try{s.t==="e"?s.w=s.w||Zi[s.v]:g===0||g=="General"?s.t==="n"?(0|s.v)===s.v?s.w=s.v.toString(10):s.w=Te(s.v):s.w=Ht(s.v):s.w=xr(g,s.v,{date1904:!!u,dateNF:c&&c.dateNF})}catch(x){if(c.WTF)throw x}c.cellDates&&g&&s.t=="n"&&_r(se[g]||String(g))&&(d=pe(s.v))&&(s.t="d",s.v=new Date(d.y,d.m-1,d.d,d.H,d.M,d.S,d.u))}}function s0(s,c,u){return{v:s,ixfe:c,t:u}}function Dg(s,c){var u={opts:{}},d={};function g(it){return!(it<8)&&it<64&&$e[it-8]||vu[it]}function x(it,Nt,Vt){if(!(1<Kt||Vt.sheetRows&&it.r>=Vt.sheetRows)){var vr,gr,or;if(Vt.cellStyles&&Nt.XF&&Nt.XF.data&&(gr=Vt,(or=(vr=Nt).XF.data)&&or.patternType&&gr&&gr.cellStyles&&(vr.s={},vr.s.patternType=or.patternType,(gr=po(g(or.icvFore)))&&(vr.s.fgColor={rgb:gr}),(gr=po(g(or.icvBack)))&&(vr.s.bgColor={rgb:gr}))),delete Nt.ixfe,delete Nt.XF,J=sn(b=it),B&&B.s&&B.e||(B={s:{r:0,c:0},e:{r:0,c:0}}),it.r<B.s.r&&(B.s.r=it.r),it.c<B.s.c&&(B.s.c=it.c),it.r+1>B.e.r&&(B.e.r=it.r+1),it.c+1>B.e.c&&(B.e.c=it.c+1),Vt.cellFormula&&Nt.f){for(var br=0;br<be.length;++br)if(!(be[br][0].s.c>it.c||be[br][0].s.r>it.r||be[br][0].e.c<it.c||be[br][0].e.r<it.r)){Nt.F=rn(be[br][0]),be[br][0].s.c==it.c&&be[br][0].s.r==it.r||delete Nt.f,Nt.f&&(Nt.f=""+mo(be[br][1],0,it,lr,lt));break}}Vt.dense?(O[it.r]||(O[it.r]=[]),O[it.r][it.c]=Nt):O[J]=Nt}}var b,S,N,T,F,O=c.dense?[]:{},L={},B={},ee=null,G=[],he="",ne={},J="",ue={},be=[],we=[],$e=[],et={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Xe={},lt={enc:!1,sbcch:0,snames:[],sharedf:ue,arrayf:be,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!c&&!!c.cellStyles,WTF:!!c&&!!c.wtf};c.password&&(lt.password=c.password);var _t=[],Dt=[],ft=[],qt=[],hr=!1,lr=[];lr.SheetNames=lt.snames,lr.sharedf=lt.sharedf,lr.arrayf=lt.arrayf,lr.names=[],lr.XTI=[];var Zt,tr=0,Kt=0,Bt=0,mr=[],Nr=[];lt.codepage=1200,I(1200);for(var Gr=!1;s.l<s.length-1;){var Mn=s.l,dr=s.read_shift(2);if(dr===0&&tr===10)break;var Gt=s.l===s.length?0:s.read_shift(2),bn=Xp[dr];if(bn&&bn.f){if(c.bookSheets&&tr===133&&dr!==133)break;if(tr=dr,bn.r===2||bn.r==12){var Qn=s.read_shift(2);if(Gt-=2,!lt.enc&&Qn!==dr&&((255&Qn)<<8|Qn>>8)!==dr)throw new Error("rt mismatch: "+Qn+"!="+dr);bn.r==12&&(s.l+=10,Gt-=10)}var $n,Sa,Ls,We={},We=dr===10?bn.f(s,Gt,lt):(function(it,Nt,Vt,vr,gr){var or=vr,br=[],Pr=Vt.slice(Vt.l,Vt.l+or);if(gr&&gr.enc&&gr.enc.insitu&&0<Pr.length)switch(it){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:gr.enc.insitu(Pr)}br.push(Pr),Vt.l+=or;for(var Rr=Cr(Vt,Vt.l),rr=Xp[Rr],Wt=0;rr!=null&&-1<Qp.indexOf(Rr);)or=Cr(Vt,Vt.l+2),Wt=Vt.l+4,Rr==2066?Wt+=4:Rr!=2165&&Rr!=2175||(Wt+=12),Pr=Vt.slice(Wt,Vt.l+4+or),br.push(Pr),Vt.l+=4+or,rr=Xp[Rr=Cr(Vt,Vt.l)];var Ur=Ae(br);Ra(Ur,0);var fr=0;Ur.lens=[];for(var Yt=0;Yt<br.length;++Yt)Ur.lens.push(fr),fr+=br[Yt].length;if(Ur.length<vr)throw"XLS Record 0x"+it.toString(16)+" Truncated: "+Ur.length+" < "+vr;return Nt.f(Ur,Ur.length,gr)})(dr,bn,s,Gt,lt);if(Kt!=0||[9,521,1033,2057].indexOf(tr)!==-1)switch(dr){case 34:u.opts.Date1904=et.WBProps.date1904=We;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(lt.enc||(s.l=0),lt.enc=We,!c.password)throw new Error("File is password-protected");if(We.valid==null)throw new Error("Encryption scheme unsupported");if(!We.valid)throw new Error("Password is incorrect");break;case 92:lt.lastuser=We;break;case 66:var Aa=Number(We);switch(Aa){case 21010:Aa=1200;break;case 32768:Aa=1e4;break;case 32769:Aa=1252}I(lt.codepage=Aa),Gr=!0;break;case 317:lt.rrtabid=We;break;case 25:lt.winlocked=We;break;case 439:u.opts.RefreshAll=We;break;case 12:u.opts.CalcCount=We;break;case 16:u.opts.CalcDelta=We;break;case 17:u.opts.CalcIter=We;break;case 13:u.opts.CalcMode=We;break;case 14:u.opts.CalcPrecision=We;break;case 95:u.opts.CalcSaveRecalc=We;break;case 15:lt.CalcRefMode=We;break;case 2211:u.opts.FullCalc=We;break;case 129:We.fDialog&&(O["!type"]="dialog"),We.fBelow||((O["!outline"]||(O["!outline"]={})).above=!0),We.fRight||((O["!outline"]||(O["!outline"]={})).left=!0);break;case 224:we.push(We);break;case 430:lr.push([We]),lr[lr.length-1].XTI=[];break;case 35:case 547:lr[lr.length-1].push(We);break;case 24:case 536:Zt={Name:We.Name,Ref:mo(We.rgce,0,null,lr,lt)},0<We.itab&&(Zt.Sheet=We.itab-1),lr.names.push(Zt),lr[0]||(lr[0]=[],lr[0].XTI=[]),lr[lr.length-1].push(We),We.Name=="_xlnm._FilterDatabase"&&0<We.itab&&We.rgce&&We.rgce[0]&&We.rgce[0][0]&&We.rgce[0][0][0]=="PtgArea3d"&&(Nr[We.itab-1]={ref:rn(We.rgce[0][0][1][2])});break;case 22:lt.ExternCount=We;break;case 23:lr.length==0&&(lr[0]=[],lr[0].XTI=[]),lr[lr.length-1].XTI=lr[lr.length-1].XTI.concat(We),lr.XTI=lr.XTI.concat(We);break;case 2196:if(lt.biff<8)break;Zt!=null&&(Zt.Comment=We[1]);break;case 18:O["!protect"]=We;break;case 19:We!==0&&lt.WTF&&console.error("Password verifier: "+We);break;case 133:L[We.pos]=We,lt.snames.push(We.name);break;case 10:if(--Kt)break;B.e&&(0<B.e.r&&0<B.e.c&&(B.e.r--,B.e.c--,O["!ref"]=rn(B),c.sheetRows&&c.sheetRows<=B.e.r&&(la=B.e.r,B.e.r=c.sheetRows-1,O["!fullref"]=O["!ref"],O["!ref"]=rn(B),B.e.r=la),B.e.r++,B.e.c++),0<_t.length&&(O["!merges"]=_t),0<Dt.length&&(O["!objects"]=Dt),0<ft.length&&(O["!cols"]=ft),0<qt.length&&(O["!rows"]=qt),et.Sheets.push(Xe)),he===""?ne=O:d[he]=O,O=c.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(lt.biff===8&&(lt.biff={9:2,521:3,1033:4}[dr]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[We.BIFFVer]||8),lt.biffguess=We.BIFFVer==0,We.BIFFVer==0&&We.dt==4096&&(lt.biff=5,Gr=!0,I(lt.codepage=28591)),lt.biff==8&&We.BIFFVer==0&&We.dt==16&&(lt.biff=2),Kt++)break;var la,O=c.dense?[]:{};lt.biff<8&&!Gr&&(Gr=!0,I(lt.codepage=c.codepage||1252)),lt.biff<5||We.BIFFVer==0&&We.dt==4096?(he===""&&(he="Sheet1"),B={s:{r:0,c:0},e:{r:0,c:0}},la={pos:s.l-Gt,name:he},L[la.pos]=la,lt.snames.push(he)):he=(L[Mn]||{name:""}).name,We.dt==32&&(O["!type"]="chart"),We.dt==64&&(O["!type"]="macro"),_t=[],Dt=[],lt.arrayf=be=[],ft=[],hr=!(qt=[]),Xe={Hidden:(L[Mn]||{hs:0}).hs,name:he};break;case 515:case 3:case 2:O["!type"]=="chart"&&(c.dense?(O[We.r]||[])[We.c]:O[sn({c:We.c,r:We.r})])&&++We.c,Ie={ixfe:We.ixfe,XF:we[We.ixfe]||{},v:We.val,t:"n"},0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:We.c,r:We.r},Ie,c);break;case 5:case 517:Ie={ixfe:We.ixfe,XF:we[We.ixfe],v:We.val,t:We.t},0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:We.c,r:We.r},Ie,c);break;case 638:Ie={ixfe:We.ixfe,XF:we[We.ixfe],v:We.rknum,t:"n"},0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:We.c,r:We.r},Ie,c);break;case 189:for(var ki=We.c;ki<=We.C;++ki){var ac=We.rkrec[ki-We.c][0],Ie={ixfe:ac,XF:we[ac],v:We.rkrec[ki-We.c][1],t:"n"};0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:ki,r:We.r},Ie,c)}break;case 6:case 518:case 1030:if(We.val=="String"){ee=We;break}(Ie=s0(We.val,We.cell.ixfe,We.tt)).XF=we[Ie.ixfe],c.cellFormula&&(!((pt=We.formula)&&pt[0]&&pt[0][0]&&pt[0][0][0]=="PtgExp")||ue[Ls=sn({r:$n=pt[0][0][1][0],c:Sa=pt[0][0][1][1]})]?Ie.f=""+mo(We.formula,0,We.cell,lr,lt):Ie.F=((c.dense?(O[$n]||[])[Sa]:O[Ls])||{}).F),0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x(We.cell,Ie,c),ee=We;break;case 7:case 519:if(!ee)throw new Error("String record expects Formula");(Ie=s0(ee.val=We,ee.cell.ixfe,"s")).XF=we[Ie.ixfe],c.cellFormula&&(Ie.f=""+mo(ee.formula,0,ee.cell,lr,lt)),0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x(ee.cell,Ie,c),ee=null;break;case 33:case 545:be.push(We);var pt=sn(We[0].s),qe=c.dense?(O[We[0].s.r]||[])[We[0].s.c]:O[pt];if(c.cellFormula&&qe){if(!ee||!pt||!qe)break;qe.f=""+mo(We[1],0,We[0],lr,lt),qe.F=rn(We[0])}break;case 1212:if(!c.cellFormula)break;if(J){if(!ee)break;ue[sn(ee.cell)]=We[0],((qe=c.dense?(O[ee.cell.r]||[])[ee.cell.c]:O[sn(ee.cell)])||{}).f=""+mo(We[0],0,b,lr,lt)}break;case 253:Ie=s0(G[We.isst].t,We.ixfe,"s"),G[We.isst].h&&(Ie.h=G[We.isst].h),Ie.XF=we[Ie.ixfe],0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:We.c,r:We.r},Ie,c);break;case 513:c.sheetStubs&&(Ie={ixfe:We.ixfe,XF:we[We.ixfe],t:"z"},0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:We.c,r:We.r},Ie,c));break;case 190:if(c.sheetStubs)for(var dt=We.c;dt<=We.C;++dt){var He=We.ixfe[dt-We.c];Ie={ixfe:He,XF:we[He],t:"z"},0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:dt,r:We.r},Ie,c)}break;case 214:case 516:case 4:(Ie=s0(We.val,We.ixfe,"s")).XF=we[Ie.ixfe],0<Bt&&(Ie.z=mr[Ie.ixfe>>8&63]),Po(Ie,c,u.opts.Date1904),x({c:We.c,r:We.r},Ie,c);break;case 0:case 512:Kt===1&&(B=We);break;case 252:G=We;break;case 1054:if(lt.biff==4){mr[Bt++]=We[1];for(var zt=0;zt<Bt+163&&se[zt]!=We[1];++zt);163<=zt&&an(We[1],Bt+163)}else an(We[1],We[0]);break;case 30:mr[Bt++]=We;for(var ct=0;ct<Bt+163&&se[ct]!=We;++ct);163<=ct&&an(We,Bt+163);break;case 229:_t=_t.concat(We);break;case 93:Dt[We.cmo[0]]=lt.lastobj=We;break;case 438:lt.lastobj.TxO=We;break;case 127:lt.lastobj.ImData=We;break;case 440:for(N=We[0].s.r;N<=We[0].e.r;++N)for(S=We[0].s.c;S<=We[0].e.c;++S)(qe=c.dense?(O[N]||[])[S]:O[sn({c:S,r:N})])&&(qe.l=We[1]);break;case 2048:for(N=We[0].s.r;N<=We[0].e.r;++N)for(S=We[0].s.c;S<=We[0].e.c;++S)(qe=c.dense?(O[N]||[])[S]:O[sn({c:S,r:N})])&&qe.l&&(qe.l.Tooltip=We[1]);break;case 28:if(lt.biff<=5&&2<=lt.biff)break;qe=c.dense?(O[We[0].r]||[])[We[0].c]:O[sn(We[0])];var gt=Dt[We[2]];qe||(qe=c.dense?(O[We[0].r]||(O[We[0].r]=[]),O[We[0].r][We[0].c]={t:"z"}):O[sn(We[0])]={t:"z"},B.e.r=Math.max(B.e.r,We[0].r),B.s.r=Math.min(B.s.r,We[0].r),B.e.c=Math.max(B.e.c,We[0].c),B.s.c=Math.min(B.s.c,We[0].c)),qe.c||(qe.c=[]),gt={a:We[1],t:gt.TxO.t},qe.c.push(gt);break;case 2173:we[We.ixfe],We.ext.forEach(function(Nt){Nt[0]});break;case 125:if(!lt.cellStyles)break;for(;We.e>=We.s;)ft[We.e--]={width:We.w/256,level:We.level||0,hidden:!!(1&We.flags)},hr||(hr=!0,zf(We.w/256)),mh(ft[We.e+1]);break;case 520:gt={},We.level!=null&&((qt[We.r]=gt).level=We.level),We.hidden&&((qt[We.r]=gt).hidden=!0),We.hpt&&((qt[We.r]=gt).hpt=We.hpt,gt.hpx=Xh(We.hpt));break;case 38:case 39:case 40:case 41:O["!margins"]||ru(O["!margins"]={}),O["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[dr]]=We;break;case 161:O["!margins"]||ru(O["!margins"]={}),O["!margins"].header=We.header,O["!margins"].footer=We.footer;break;case 574:We.RTL&&(et.Views[0].RTL=!0);break;case 146:$e=We;break;case 2198:F=We;break;case 140:T=We;break;case 442:he?Xe.CodeName=We||Xe.name:et.WBProps.CodeName=We||"ThisWorkbook"}}else bn||console.error("Missing Info for XLS Record 0x"+dr.toString(16)),s.l+=Gt}return u.SheetNames=fa(L).sort(function(it,Nt){return Number(it)-Number(Nt)}).map(function(it){return L[it].name}),c.bookSheets||(u.Sheets=d),!u.SheetNames.length&&ne["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=ne)):u.Preamble=ne,u.Sheets&&Nr.forEach(function(it,Nt){u.Sheets[u.SheetNames[Nt]]["!autofilter"]=it}),u.Strings=G,u.SSF=jn(se),lt.enc&&(u.Encryption=lt.enc),F&&(u.Themes=F),u.Metadata={},T!==void 0&&(u.Metadata.Country=T),0<lr.names.length&&(et.Names=lr.names),u.Workbook=et,u}var rf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function i0(s,c){var u,d,g,x,b;if(im(c=c||{}),R(),c.codepage&&A(c.codepage),s.FullPaths){if(Jt.find(s,"/encryption"))throw new Error("File is password-protected");u=Jt.find(s,"!CompObj"),g=Jt.find(s,"/Workbook")||Jt.find(s,"/Book")}else{switch(c.type){case"base64":s=de(re(s));break;case"binary":s=de(s);break;case"buffer":break;case"array":Array.isArray(s)||(s=Array.prototype.slice.call(s))}Ra(s,0),g={content:s}}if(u&&h1(u),c.bookProps&&!c.bookSheets)d={};else{var S=xe?"buffer":"array";if(g&&g.content)d=Dg(g.content,c);else if((g=Jt.find(s,"PerfectOffice_MAIN"))&&g.content)d=oa.to_workbook(g.content,(c.type=S,c));else{if(!(g=Jt.find(s,"NativeContent_MAIN"))||!g.content)throw(g=Jt.find(s,"MN0"))&&g.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");d=oa.to_workbook(g.content,(c.type=S,c))}c.bookVBA&&s.FullPaths&&Jt.find(s,"/_VBA_PROJECT_CUR/VBA/dir")&&(d.vbaraw=(x=s,b=Jt.utils.cfb_new({root:"R"}),x.FullPaths.forEach(function(N,T){N.slice(-1)!=="/"&&N.match(/_VBA_PROJECT_CUR/)&&(N=N.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),Jt.utils.cfb_add(b,N,x.FileIndex[T].content))}),Jt.write(b)))}return S={},s.FullPaths&&(function(N,T,F){var O=Jt.find(N,"/!DocumentSummaryInformation");if(O&&0<O.size)try{var L,B=Ha(O,_d,rf.DSI);for(L in B)T[L]=B[L]}catch(ne){if(F.WTF)throw ne}var ee=Jt.find(N,"/!SummaryInformation");if(ee&&0<ee.size)try{var G,he=Ha(ee,Id,rf.SI);for(G in he)T[G]==null&&(T[G]=he[G])}catch(ne){if(F.WTF)throw ne}T.HeadingPairs&&T.TitlesOfParts&&(Hh(T.HeadingPairs,T.TitlesOfParts,T,F),delete T.HeadingPairs,delete T.TitlesOfParts)})(s,S,c),d.Props=d.Custprops=S,c.bookFiles&&(d.cfb=s),d}function d1(s,x){var u,d,g=x||{},x=Jt.utils.cfb_new({root:"R"}),b="/Workbook";switch(g.bookType||"xls"){case"xls":g.bookType="biff8";case"xla":g.bookType||(g.bookType="xla");case"biff8":b="/Workbook",g.biff=8;break;case"biff5":b="/Book",g.biff=5;break;default:throw new Error("invalid type "+g.bookType+" for XLS CFB")}return Jt.utils.cfb_add(x,b,Zp(s,g)),g.biff==8&&(s.Props||s.Custprops)&&(function(S,N){var T,F=[],O=[],L=[],B=0,ee=xo(_d,"n"),G=xo(Id,"n");if(S.Props)for(T=fa(S.Props),B=0;B<T.length;++B)(Object.prototype.hasOwnProperty.call(ee,T[B])?F:Object.prototype.hasOwnProperty.call(G,T[B])?O:L).push([T[B],S.Props[T[B]]]);if(S.Custprops)for(T=fa(S.Custprops),B=0;B<T.length;++B)Object.prototype.hasOwnProperty.call(S.Props||{},T[B])||(Object.prototype.hasOwnProperty.call(ee,T[B])?F:Object.prototype.hasOwnProperty.call(G,T[B])?O:L).push([T[B],S.Custprops[T[B]]]);for(var he=[],B=0;B<L.length;++B)-1<Rf.indexOf(L[B][0])||-1<uh.indexOf(L[B][0])||L[B][1]!=null&&he.push(L[B]);O.length&&Jt.utils.cfb_add(N,"/SummaryInformation",Gn(O,rf.SI,G,Id)),(F.length||he.length)&&Jt.utils.cfb_add(N,"/DocumentSummaryInformation",Gn(F,rf.DSI,ee,_d,he.length?he:null,rf.UDI))})(s,x),g.biff==8&&s.vbaraw&&(u=x,(d=Jt.read(s.vbaraw,{type:typeof s.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(S,N){N==0||(S=S.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&Jt.utils.cfb_add(u,S,d.FileIndex[N].content)})),x}var ad={0:{f:function(s,c){var u={},d=s.l+c;u.r=s.read_shift(4),s.l+=4;var g=s.read_shift(2);return s.l+=1,c=s.read_shift(1),s.l=d,7&c&&(u.level=7&c),16&c&&(u.hidden=!0),32&c&&(u.hpt=g/20),u}},1:{f:function(s){return[ca(s)]}},2:{f:function(s){return[ca(s),vc(s),"n"]}},3:{f:function(s){return[ca(s),s.read_shift(1),"e"]}},4:{f:function(s){return[ca(s),s.read_shift(1),"b"]}},5:{f:function(s){return[ca(s),Sn(s),"n"]}},6:{f:function(s){return[ca(s),Xa(s),"str"]}},7:{f:function(s){return[ca(s),s.read_shift(4),"s"]}},8:{f:function(s,c,u){var d=s.l+c,g=ca(s);g.r=u["!row"];var x=[g,Xa(s),"str"];return u.cellFormula?(s.l+=2,c=Z0(s,d-s.l,u),x[3]=mo(c,0,g,u.supbooks,u)):s.l=d,x}},9:{f:function(s,c,u){var d=s.l+c,g=ca(s);g.r=u["!row"];var x=[g,Sn(s),"n"];return u.cellFormula?(s.l+=2,c=Z0(s,d-s.l,u),x[3]=mo(c,0,g,u.supbooks,u)):s.l=d,x}},10:{f:function(s,c,u){var d=s.l+c,g=ca(s);g.r=u["!row"];var x=[g,s.read_shift(1),"b"];return u.cellFormula?(s.l+=2,c=Z0(s,d-s.l,u),x[3]=mo(c,0,g,u.supbooks,u)):s.l=d,x}},11:{f:function(s,c,u){var d=s.l+c,g=ca(s);g.r=u["!row"];var x=[g,s.read_shift(1),"e"];return u.cellFormula?(s.l+=2,c=Z0(s,d-s.l,u),x[3]=mo(c,0,g,u.supbooks,u)):s.l=d,x}},12:{f:function(s){return[Bi(s)]}},13:{f:function(s){return[Bi(s),vc(s),"n"]}},14:{f:function(s){return[Bi(s),s.read_shift(1),"e"]}},15:{f:function(s){return[Bi(s),s.read_shift(1),"b"]}},16:{f:Xd},17:{f:function(s){return[Bi(s),Xa(s),"str"]}},18:{f:function(s){return[Bi(s),s.read_shift(4),"s"]}},19:{f:xl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(s,b,S){var d=s.l+b;s.l+=4,s.l+=1;var g=s.read_shift(4),x=yc(s),b=yg(s,0,S),S=Kc(s);return s.l=d,b={Name:x,Ptg:b},g<268435455&&(b.Sheet=g),S&&(b.Comment=S),b}},40:{},42:{},43:{f:function(s,c,u){var d={};d.sz=s.read_shift(2)/20;var g,x=(x=(g=s).read_shift(1),g.l++,{fBold:1&x,fItalic:2&x,fUnderline:4&x,fStrikeout:8&x,fOutline:16&x,fShadow:32&x,fCondense:64&x,fExtend:128&x});switch(x.fItalic&&(d.italic=1),x.fCondense&&(d.condense=1),x.fExtend&&(d.extend=1),x.fShadow&&(d.shadow=1),x.fOutline&&(d.outline=1),x.fStrikeout&&(d.strike=1),s.read_shift(2)===700&&(d.bold=1),s.read_shift(2)){case 1:d.vertAlign="superscript";break;case 2:d.vertAlign="subscript"}switch((x=s.read_shift(1))!=0&&(d.underline=x),0<(x=s.read_shift(1))&&(d.family=x),0<(x=s.read_shift(1))&&(d.charset=x),s.l++,d.color=(function(b){var S={},N=b.read_shift(1)>>>1,T=b.read_shift(1),F=b.read_shift(2,"i"),O=b.read_shift(1),L=b.read_shift(1),B=b.read_shift(1);switch(b.l++,N){case 0:S.auto=1;break;case 1:S.index=T;var ee=vu[T];ee&&(S.rgb=po(ee));break;case 2:S.rgb=po([O,L,B]);break;case 3:S.theme=T}return F!=0&&(S.tint=0<F?F/32767:F/32768),S})(s),s.read_shift(1)){case 1:d.scheme="major";break;case 2:d.scheme="minor"}return d.name=Xa(s),d}},44:{f:function(s,c){return[s.read_shift(2),Xa(s)]}},45:{f:tg},46:{f:Ri},47:{f:function(s,g){var u=s.l+g,d=s.read_shift(2),g=s.read_shift(2);return s.l=u,{ixfe:d,numFmtId:g}}},48:{},49:{f:function(s){return s.read_shift(4,"i")}},50:{},51:{f:function(s){for(var c=[],u=s.read_shift(4);0<u--;)c.push([s.read_shift(4),s.read_shift(4)]);return c}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ot},62:{f:function(s){return[ca(s),xl(s),"is"]}},63:{f:function(s){var c={};c.i=s.read_shift(4);var u={};return u.r=s.read_shift(4),u.c=s.read_shift(4),c.r=sn(u),2&(s=s.read_shift(1))&&(c.l="1"),8&s&&(c.a="1"),c}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(s){var c=s.read_shift(2);return s.l+=28,{RTL:32&c}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(s,c){var u={},d=s[s.l];return++s.l,u.above=!(64&d),u.left=!(128&d),s.l+=18,u.name=Ai(s),u}},148:{f:e0,p:16},151:{f:function(){}},152:{},153:{f:function(s,c){var u={},d=s.read_shift(4);return u.defaultThemeVersion=s.read_shift(4),0<(s=8<c?Xa(s):"").length&&(u.CodeName=s),u.autoCompressPictures=!!(65536&d),u.backupFile=!!(64&d),u.checkCompatibility=!!(4096&d),u.date1904=!!(1&d),u.filterPrivacy=!!(8&d),u.hidePivotFieldList=!!(1024&d),u.promptedSolutions=!!(16&d),u.publishItems=!!(2048&d),u.refreshAllConnections=!!(262144&d),u.saveExternalLinkValues=!!(128&d),u.showBorderUnselectedTables=!!(4&d),u.showInkAnnotation=!!(32&d),u.showObjects=["all","placeholders","none"][d>>13&3],u.showPivotChartFilter=!!(32768&d),u.updateLinks=["userSet","never","always"][d>>8&3],u}},154:{},155:{},156:{f:function(s,c){var u={};return u.Hidden=s.read_shift(4),u.iTabID=s.read_shift(4),u.strRelID=wl(s),u.name=Xa(s),u}},157:{},158:{},159:{T:1,f:function(s){return[s.read_shift(4),s.read_shift(4)]}},160:{T:-1},161:{T:1,f:Ts},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:su},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(s,c){return{flags:s.read_shift(4),version:s.read_shift(4),name:Xa(s)}}},336:{T:-1},337:{f:function(s){return s.l+=4,s.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Se},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(s,x,u){var d=s.l+x,g=ql(s),x=s.read_shift(1);return(g=[g])[2]=x,u.cellFormula?(u=Gy(s,d-s.l,u),g[1]=u):s.l=d,g}},427:{f:function(s,g,u){var d=s.l+g,g=[Ts(s)];return u.cellFormula&&(u=Xf(s,d-s.l,u),g[1]=u),s.l=d,g}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(s){var c={};return Yp.forEach(function(u){c[u]=Sn(s)}),c}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(s,S){var u=s.l+S,d=Ts(s),g=Kc(s),x=Xa(s),b=Xa(s),S=Xa(s);return s.l=u,S={rfx:d,relId:g,loc:x,display:S},b&&(S.Tooltip=b),S}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pl},633:{T:1},634:{T:-1},635:{T:1,f:function(s){var c={};c.iauthor=s.read_shift(4);var u=Ts(s);return c.rfx=u.s,c.ref=sn(u.s),s.l+=16,c}},636:{T:-1},637:{f:oh},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(s,c){return s.l+=10,{name:Xa(s)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Xp={6:{f:Vd},10:{f:ks},12:{f:Pa},13:{f:Pa},14:{f:_n},15:{f:_n},16:{f:Sn},17:{f:_n},18:{f:_n},19:{f:Pa},20:{f:Y},21:{f:Y},23:{f:Se},24:{f:ge},25:{f:_n},26:{},27:{},28:{f:function(s,c,u){return(function(d,g){if(!(g.biff<8)){var x=d.read_shift(2),b=d.read_shift(2),S=d.read_shift(2),N=d.read_shift(2),T=Wl(d,0,g);return g.biff<8&&d.read_shift(1),[{r:x,c:b},T,N,S]}})(s,u)}},29:{},34:{f:_n},35:{f:oe},38:{f:Sn},39:{f:Sn},40:{f:Sn},41:{f:Sn},42:{f:_n},43:{f:_n},47:{f:function(s,c,u){var d={Type:8<=u.biff?s.read_shift(2):0};return d.Type?B0(s,c-2,d):(c=s,u.biff,s=u,u=d,c={key:Pa(c),verificationBytes:Pa(c)},s.password&&(c.verifier=Ud(s.password)),u.valid=c.verificationBytes===c.verifier,u.valid&&(u.insitu=Hf(s.password))),d}},49:{f:function(s,c,u){var d={dyHeight:s.read_shift(2),fl:s.read_shift(2)};switch(u&&u.biff||8){case 2:break;case 3:case 4:s.l+=2;break;default:s.l+=10}return d.name=Sl(s,0,u),d}},51:{f:Pa},60:{},61:{f:function(s){return{Pos:[s.read_shift(2),s.read_shift(2)],Dim:[s.read_shift(2),s.read_shift(2)],Flags:s.read_shift(2),CurTab:s.read_shift(2),FirstTab:s.read_shift(2),Selected:s.read_shift(2),TabRatio:s.read_shift(2)}}},64:{f:_n},65:{f:function(){}},66:{f:Pa},77:{},80:{},81:{},82:{},85:{f:Pa},89:{},90:{},91:{},92:{f:function(s,c,g){if(g.enc)return s.l+=c,"";var d=s.l,g=Wl(s,0,g);return s.read_shift(c+d-s.l),g}},93:{f:function(s,c,u){return u&&u.biff<8?(function(d,g,x){d.l+=4;var b=d.read_shift(2),S=d.read_shift(2),N=d.read_shift(2);d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=6,g-=36;var T=[];return T.push((Re[b]||cs)(d,g,x)),{cmo:[S,b,N],ft:T}})(s,c,u):{cmo:u=U0(s),ft:(function(d,g){for(var x=d.l+g,b=[];d.l<x;){var S=d.read_shift(2);d.l-=2;try{b.push(Hs[S](d,x-d.l))}catch{return d.l=x,b}}return d.l!=x&&(d.l=x),b})(s,c-22,u[1])}}},94:{},95:{f:_n},96:{},97:{},99:{f:_n},125:{f:ot},128:{f:function(s){if(s.l+=4,(s=[s.read_shift(2),s.read_shift(2)])[0]!==0&&s[0]--,s[1]!==0&&s[1]--,7<s[0]||7<s[1])throw new Error("Bad Gutters: "+s.join("|"));return s}},129:{f:function(s,c,u){return{fDialog:16&(c=u&&u.biff==8||c==2?s.read_shift(2):(s.l+=c,0)),fBelow:64&c,fRight:128&c}}},130:{f:Pa},131:{f:_n},132:{f:_n},133:{f:function(s,c,u){var d=s.read_shift(4),g=3&s.read_shift(1),x=s.read_shift(1);switch(x){case 0:x="Worksheet";break;case 1:x="Macrosheet";break;case 2:x="Chartsheet";break;case 6:x="VBAModule"}return u=Sl(s,0,u),{pos:d,hs:g,dt:x,name:u=u.length===0?"Sheet1":u}}},134:{},140:{f:function(s){var c=[0,0],u=s.read_shift(2);return c[0]=Df[u]||u,u=s.read_shift(2),c[1]=Df[u]||u,c}},141:{f:Pa},144:{},146:{f:function(s){for(var c=s.read_shift(2),u=[];0<c--;)u.push(Qc(s));return u}},151:{},152:{},153:{},154:{},155:{},156:{f:Pa},157:{},158:{},160:{f:Ze},161:{f:function(s,c){var u={};return c<32||(s.l+=16,u.header=Sn(s),u.footer=Sn(s),s.l+=2),u}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(s,c){for(var u=s.l+c-2,d=s.read_shift(2),g=s.read_shift(2),x=[];s.l<u;)x.push(Nc(s));if(s.l!==u)throw new Error("MulRK read error");if(c=s.read_shift(2),x.length!=c-g+1)throw new Error("MulRK length mismatch");return{r:d,c:g,C:c,rkrec:x}}},190:{f:function(s,c){for(var u=s.l+c-2,d=s.read_shift(2),g=s.read_shift(2),x=[];s.l<u;)x.push(s.read_shift(2));if(s.l!==u)throw new Error("MulBlank read error");if(c=s.read_shift(2),x.length!=c-g+1)throw new Error("MulBlank length mismatch");return{r:d,c:g,C:c,ixfe:x}}},193:{f:ks},197:{},198:{},199:{},200:{},201:{},202:{f:_n},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Pa},220:{},221:{f:_n},222:{},224:{f:function(s,c,u){var d,g,x,b={};return b.ifnt=s.read_shift(2),b.numFmtId=s.read_shift(2),b.flags=s.read_shift(2),b.fStyle=b.flags>>2&1,c-=6,b.data=(d=s,b.fStyle,g=u,x={},c=d.read_shift(4),s=d.read_shift(4),u=d.read_shift(4),d=d.read_shift(2),x.patternType=Ff[u>>26],g.cellStyles&&(x.alc=7&c,x.fWrap=c>>3&1,x.alcV=c>>4&7,x.fJustLast=c>>7&1,x.trot=c>>8&255,x.cIndent=c>>16&15,x.fShrinkToFit=c>>20&1,x.iReadOrder=c>>22&2,x.fAtrNum=c>>26&1,x.fAtrFnt=c>>27&1,x.fAtrAlc=c>>28&1,x.fAtrBdr=c>>29&1,x.fAtrPat=c>>30&1,x.fAtrProt=c>>31&1,x.dgLeft=15&s,x.dgRight=s>>4&15,x.dgTop=s>>8&15,x.dgBottom=s>>12&15,x.icvLeft=s>>16&127,x.icvRight=s>>23&127,x.grbitDiag=s>>30&3,x.icvTop=127&u,x.icvBottom=u>>7&127,x.icvDiag=u>>14&127,x.dgDiag=u>>21&15,x.icvFore=127&d,x.icvBack=d>>7&127,x.fsxButton=d>>14&1),x),b}},225:{f:function(s,c){return c===0||s.read_shift(2),1200}},226:{f:ks},227:{},229:{f:function(s,c){for(var u=[],d=s.read_shift(2);d--;)u.push(Ks(s));return u}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(s,c){for(var u=s.l+c,c=s.read_shift(4),d=s.read_shift(4),g=[],x=0;x!=d&&s.l<u;++x)g.push((function(S){var N=p;p=1200;var T,F=S.read_shift(2),O=4&(G=S.read_shift(1)),L=8&G,B=1+(1&G),ee=0,G={};return L&&(ee=S.read_shift(2)),O&&(T=S.read_shift(4)),B=B==2?"dbcs-cont":"sbcs-cont",B=F===0?"":S.read_shift(F,B),L&&(S.l+=4*ee),O&&(S.l+=T),G.t=B,L||(G.raw="<t>"+G.t+"</t>",G.r=G.t),p=N,G})(s));return g.Count=c,g.Unique=d,g}},253:{f:function(s){var c=Ni(s);return c.isst=s.read_shift(4),c}},255:{f:function(s,c){var u={};return u.dsst=s.read_shift(2),s.l+=c-2,u}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Gl},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:_n},353:{f:ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(s,x,u){var d=s.l+x,g=s.read_shift(2),x=s.read_shift(2);if((u.sbcch=x)==1025||x==14849)return[x,g];if(x<1||255<x)throw new Error("Unexpected SupBook type: "+x);for(var u=Ac(s,x),b=[];d>s.l;)b.push(Vl(s));return[x,g,u,b]}},431:{f:_n},432:{},433:{},434:{},437:{},438:{f:function(s,c,u){var d=s.l,g="";try{s.l+=4;var x=(u.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(x)==-1?s.l+=6:(function(T){var F=T.read_shift(1);T.l++;var O=T.read_shift(2);T.l+=2})(s);var b=s.read_shift(2);s.read_shift(2),Pa(s),x=s.read_shift(2),s.l+=x;for(var S=1;S<s.lens.length-1;++S){if(s.l-d!=s.lens[S])throw new Error("TxO: bad continue record");var N=s[s.l];if((g+=Ac(s,s.lens[S+1]-s.lens[S]-1)).length>=(N?b:2*b))break}if(g.length!==b&&g.length!==2*b)throw new Error("cchText: "+b+" != "+g.length);return s.l=d+c,{t:g}}catch{return s.l=d+c,{t:g}}}},439:{f:_n},440:{f:function(s,c){var u=Ks(s);return s.l+=16,[u,(function(d,g){var x=d.l+g;if((O=d.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+O);g=d.read_shift(2),d.l+=2;var b,S,N,T,F,O="";16&g&&(b=Al(d,d.l)),128&g&&(S=Al(d,d.l)),(257&g)==257&&(N=Al(d,d.l)),(257&g)==1&&(L=Kl(d,d.l)),8&g&&(O=Al(d,d.l)),32&g&&(T=d.read_shift(16)),64&g&&(F=hh(d)),d.l=x;var L=S||N||L||"";return L&&O&&(L+="#"+O),L=L||"#"+O,L={Target:L=2&g&&L.charAt(0)=="/"&&L.charAt(1)!="/"?"file://"+L:L},T&&(L.guid=T),F&&(L.time=F),b&&(L.Tooltip=b),L})(s,c-24)]}},441:{},442:{f:Vl},443:{},444:{f:Pa},445:{},446:{},448:{f:ks},449:{f:function(s){return s.read_shift(2),s.read_shift(4)},r:2},450:{f:ks},512:{f:C},513:{f:Fe},515:{f:function(s,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),u=Ni(s),s=Sn(s),u.val=s,u}},516:{f:function(s,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),s.l,c=Ni(s),u.biff==2&&s.l++,u=Vl(s,s.l,u),c.val=u,c}},517:{f:P},519:{f:gm},520:{f:function(s){var c={};c.r=s.read_shift(2),c.c=s.read_shift(2),c.cnt=s.read_shift(2)-c.c;var u=s.read_shift(2);s.l+=4;var d=s.read_shift(1);return s.l+=3,7&d&&(c.level=7&d),32&d&&(c.hidden=!0),64&d&&(c.hpt=u/20),c}},523:{},545:{f:Ne},549:{f:Vh},566:{},574:{f:function(s,c,u){return u&&2<=u.biff&&u.biff<5?{}:{RTL:64&s.read_shift(2)}}},638:{f:function(d){var c=d.read_shift(2),u=d.read_shift(2),d=Nc(d);return{r:c,c:u,ixfe:d[0],rknum:d[1]}}},659:{},1048:{},1054:{f:function(s,c,u){return[s.read_shift(2),Wl(s,0,u)]}},1084:{},1212:{f:function(s,c,u){var d=jf(s);s.l++;var g=s.read_shift(1);return[(function(x,b,S){var N,T=x.l+b,F=x.read_shift(2),O=Jf(x,F,S);return F==65535?[[],cs(x,b-2)]:(b!==F+2&&(N=td(x,T-F-2,O,S)),[O,N])})(s,c-=8,u),g,d]}},2048:{f:function(s,c){return s.read_shift(2),[Ks(s),s.read_shift((c-10)/2,"dbcs-cont").replace(Ce,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Tc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(s){s.l+=2;var c={cxfs:0,crc:0};return c.cxfs=s.read_shift(2),c.crc=s.read_shift(4),c},r:12},2173:{f:function(s,c){s.l,s.l+=2,c=s.read_shift(2),s.l+=2;for(var u=s.read_shift(2),d=[];0<u--;)d.push(hg(s,s.l));return{ixfe:c,ext:d}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:_n,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(s,c,u){if(!(u.biff<8)){var d=s.read_shift(2),g=s.read_shift(2);return[Ac(s,d,u),Ac(s,g,u)]}s.l+=c},r:12},2197:{},2198:{f:function(s,c,u){var d=s.l+c;if(s.read_shift(4)!==124226)if(u.cellStyles){var g,x=s.slice(s.l);s.l=d;try{g=eh(x,{type:"array"})}catch{return}if(c=Ya(g,"theme/theme/theme1.xml",!0),c)return gh(c,u)}else s.l=d},r:12},2199:{},2200:{},2201:{},2202:{f:function(s){return[s.read_shift(4)!==0,s.read_shift(4)!==0,s.read_shift(4)]},r:12},2203:{f:ks},2204:{},2205:{},2206:{},2207:{},2211:{f:function(s){var c,u,d=(u=(c=s).read_shift(2),d=c.read_shift(2),c.l+=8,{type:u});if(d.type!=2211)throw new Error("Invalid Future Record "+d.type);return s.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Pa},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(s,c,u){var d={area:!1};return u.biff!=5?s.l+=c:(c=s.read_shift(1),s.l+=3,16&c&&(d.area=!0)),d}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(s){for(var c=s.read_shift(2),u=[];0<c--;)u.push(Qc(s));return u}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:C},1:{},2:{f:function(s){var c=Ni(s);return++s.l,s=s.read_shift(2),c.t="n",c.val=s,c}},3:{f:function(s){var c=Ni(s);return++s.l,s=Sn(s),c.t="n",c.val=s,c}},4:{f:function(s,c,u){u.biffguess&&u.biff==5&&(u.biff=2);var d=Ni(s);return++s.l,u=Wl(s,0,u),d.t="str",d.val=u,d}},5:{f:P},7:{f:function(s){var c=s.read_shift(1);return c===0?(s.l++,""):s.read_shift(c,"sbcs-cont")}},8:{},9:{f:Tc},11:{},22:{f:Pa},30:{f:Ch},31:{},32:{},33:{f:Ne},36:{},37:{f:Vh},50:{f:function(s,c){s.l+=6,s.l+=2,s.l+=1,s.l+=3,s.l+=1,s.l+=c-13}},62:{},52:{},67:{},68:{f:Pa},69:{},86:{},126:{},127:{f:function(s){var c=s.read_shift(2),d=s.read_shift(2),u=s.read_shift(4),d={fmt:c,env:d,len:u,data:s.slice(s.l,s.l+u)};return s.l+=u,d}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(s,x,b){var d=s.l+x,g=Ni(s),x=s.read_shift(2),b=Ac(s,x,b);return s.l=d,g.t="str",g.val=b,g}},223:{},234:{},354:{},421:{},518:{f:Vd},521:{f:Tc},536:{f:ge},547:{f:oe},561:{},579:{},1030:{f:Vd},1033:{f:Tc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ir(s,c,u,d){var g=c;isNaN(g)||(c=d||(u||[]).length||0,(d=s.next(4)).write_shift(2,g),d.write_shift(2,c),0<c&&Ut(u)&&s.push(u))}function o0(s,c,u){return(s=s||xt(7)).write_shift(2,c),s.write_shift(2,u),s.write_shift(2,0),s.write_shift(1,0),s}function Fg(s,c,u,d){if(c.v!=null)switch(c.t){case"d":case"n":var g=c.t=="d"?pa(vn(c.v)):c.v;return void(g==(0|g)&&0<=g&&g<65536?ir(s,2,(F=u,O=d,L=g,o0(B=xt(9),F,O),B.write_shift(2,L),B)):ir(s,3,(L=u,B=d,g=g,o0(T=xt(15),L,B),T.write_shift(8,g,"f"),T)));case"b":case"e":return void ir(s,5,(T=u,x=d,b=c.v,S=c.t,o0(N=xt(9),T,x),ui(b,S||"b",N),N));case"s":case"str":return void ir(s,4,(x=u,b=d,S=(c.v||"").slice(0,255),o0(N=xt(8+2*S.length),x,b),N.write_shift(1,S.length),N.write_shift(S.length,S,"sbcs"),N.l<N.length?N.slice(0,N.l):N))}var x,b,S,N,T,F,O,L,B;ir(s,1,o0(null,u,d))}function Rg(s,c){for(var u=c||{},c=xs(),d=0,g=0;g<s.SheetNames.length;++g)s.SheetNames[g]==u.sheet&&(d=g);if(d==0&&u.sheet&&s.SheetNames[0]!=u.sheet)throw new Error("Sheet not found: "+u.sheet);return ir(c,u.biff==4?1033:u.biff==3?521:9,Nu(0,16,u)),(function(x,b,S){var N,T,F=Array.isArray(b),O=wn(b["!ref"]||"A1"),L=[];if(255<O.e.c||16383<O.e.r){if(S.WTF)throw new Error("Range "+(b["!ref"]||"A1")+" exceeds format limit A1:IV16384");O.e.c=Math.min(O.e.c,255),O.e.r=Math.min(O.e.c,16383),N=rn(O)}for(var B=O.s.r;B<=O.e.r;++B){T=ja(B);for(var ee=O.s.c;ee<=O.e.c;++ee){B===O.s.r&&(L[ee]=Ln(ee)),N=L[ee]+T;var G=F?(b[B]||[])[ee]:b[N];G&&Fg(x,G,B,ee)}}})(c,s.Sheets[s.SheetNames[d]],u),ir(c,10),c.end()}function nf(s,c,u){var d,g;ir(s,49,(g=(d={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(s=xt((u=(s=u)&&s.biff==5)?15+g.length:16+2*g.length)).write_shift(2,20*(d.sz||12)),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,g.length),u||s.write_shift(1,1),s.write_shift((u?1:2)*g.length,g,u?"sbcs":"utf16le"),s))}function f1(s,c,u){c&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(d){for(var g,x,b,S,N=d[0];N<=d[1];++N)c[N]!=null&&ir(s,1054,(g=N,x=c[N],S=void 0,b=(b=u)&&b.biff==5,(S=S||xt(b?3+x.length:5+2*x.length)).write_shift(2,g),S.write_shift(b?1:2,x.length),b||S.write_shift(1,1),S.write_shift((b?1:2)*x.length,x,b?"sbcs":"utf16le"),(S=S.length>S.l?S.slice(0,S.l):S).l==null&&(S.l=S.length),S))})}function jg(s,c){for(var u=0;u<c["!links"].length;++u){var d=c["!links"][u];ir(s,440,Ke(d)),d[1].Tooltip&&ir(s,2048,(function(g){var x=g[1].Tooltip,b=xt(10+2*(x.length+1));b.write_shift(2,2048),g=ga(g[0]),b.write_shift(2,g.r),b.write_shift(2,g.r),b.write_shift(2,g.c),b.write_shift(2,g.c);for(var S=0;S<x.length;++S)b.write_shift(2,x.charCodeAt(S));return b.write_shift(2,0),b})(d))}delete c["!links"]}function Og(s,c){var u;c&&(u=0,c.forEach(function(d,g){var x;++u<=256&&d&&ir(s,125,(x=Jd(g,d),d=g,(g=xt(12)).write_shift(2,d),g.write_shift(2,d),g.write_shift(2,256*x.width),g.write_shift(2,0),d=0,x.hidden&&(d|=1),g.write_shift(1,d),d=x.level||0,g.write_shift(1,d),g.write_shift(2,0),g))}))}function Lg(s,c,u,d,g){var x,b,S,N,T,F,O,L,B,ee,G,he=16+Iu(g.cellXfs,c,g);if(c.v!=null||c.bf)if(c.bf)ir(s,6,Qf(c,u,d,0,he));else switch(c.t){case"d":case"n":var ne=c.t=="d"?pa(vn(c.v)):c.v;ir(s,515,(F=u,O=d,L=ne,B=he,ee=xt(14),Yl(F,O,B,ee),Un(L,ee),ee));break;case"b":case"e":ir(s,517,(ne=u,F=d,O=c.v,B=he,L=c.t,ee=xt(8),Yl(ne,F,B,ee),ui(O,L,ee),ee));break;case"s":case"str":g.bookSST?(G=Zf(g.Strings,c.v,g.revStrings),ir(s,253,(x=u,b=d,S=G,N=he,T=xt(10),Yl(x,b,N,T),T.write_shift(4,S),T))):ir(s,516,(G=u,x=d,b=(c.v||"").slice(0,255),N=he,S=xt(+(T=!(S=g)||S.biff==8)+8+(1+T)*b.length),Yl(G,x,N,S),S.write_shift(2,b.length),T&&S.write_shift(1,1),S.write_shift((1+T)*b.length,b,T?"utf16le":"sbcs"),S));break;default:ir(s,513,Yl(u,d,he))}else ir(s,513,Yl(u,d,he))}function Pg(s,c,u){var d,g,x=xs(),ue=u.SheetNames[s],b=u.Sheets[ue]||{},S=(u||{}).Workbook||{},N=(S.Sheets||[])[s]||{},T=Array.isArray(b),F=c.biff==8,O=[],L=wn(b["!ref"]||"A1"),B=F?65536:16384;if(255<L.e.c||L.e.r>=B){if(c.WTF)throw new Error("Range "+(b["!ref"]||"A1")+" exceeds format limit A1:IV16384");L.e.c=Math.min(L.e.c,255),L.e.r=Math.min(L.e.c,B-1)}ir(x,2057,Nu(0,16,c)),ir(x,13,ho(1)),ir(x,12,ho(100)),ir(x,15,Za(!0)),ir(x,17,Za(!1)),ir(x,16,Un(.001)),ir(x,95,Za(!0)),ir(x,42,Za(!1)),ir(x,43,Za(!1)),ir(x,130,ho(1)),ir(x,128,(u=[0,0],(s=xt(8)).write_shift(4,0),s.write_shift(2,u[0]?u[0]+1:0),s.write_shift(2,u[1]?u[1]+1:0),s)),ir(x,131,Za(!1)),ir(x,132,Za(!1)),F&&Og(x,b["!cols"]),ir(x,512,(B=L,(u=xt(2*(s=(u=c).biff!=8&&u.biff?2:4)+6)).write_shift(s,B.s.r),u.write_shift(s,B.e.r+1),u.write_shift(2,B.s.c),u.write_shift(2,B.e.c+1),u.write_shift(2,0),u)),F&&(b["!links"]=[]);for(var ee=L.s.r;ee<=L.e.r;++ee){g=ja(ee);for(var G=L.s.c;G<=L.e.c;++G){ee===L.s.r&&(O[G]=Ln(G)),d=O[G]+g;var he=T?(b[ee]||[])[G]:b[d];he&&(Lg(x,he,ee,G,c),F&&he.l&&b["!links"].push([d,he.l]))}}var ne,J,ue=N.CodeName||N.name||ue;return F&&ir(x,574,(S=(S.Views||[])[0],J=xt(18),ne=1718,S&&S.RTL&&(ne|=64),J.write_shift(2,ne),J.write_shift(4,0),J.write_shift(4,64),J.write_shift(4,0),J.write_shift(4,0),J)),F&&(b["!merges"]||[]).length&&ir(x,229,(function(be){var we=xt(2+8*be.length);we.write_shift(2,be.length);for(var $e=0;$e<be.length;++$e)qh(be[$e],we);return we})(b["!merges"])),F&&jg(x,b),ir(x,442,Cc(ue)),F&&(ne=x,J=b,(ue=xt(19)).write_shift(4,2151),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,3),ue.write_shift(1,1),ue.write_shift(4,0),ir(ne,2151,ue),(ue=xt(39)).write_shift(4,2152),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,3),ue.write_shift(1,0),ue.write_shift(4,0),ue.write_shift(2,1),ue.write_shift(4,4),ue.write_shift(2,0),qh(wn(J["!ref"]||"A1"),ue),ue.write_shift(4,4),ir(ne,2152,ue)),ir(x,10),x.end()}function Mg(s,c,u){var d=xs(),S=(s||{}).Workbook||{},g=S.Sheets||[],x=S.WBProps||{},b=u.biff==8,S=u.biff==5;ir(d,2057,Nu(0,5,u)),u.bookType=="xla"&&ir(d,135),ir(d,225,b?ho(1200):null),ir(d,193,(function(ne,J){J=J||xt(ne);for(var ue=0;ue<ne;++ue)J.write_shift(1,0);return J})(2)),S&&ir(d,191),S&&ir(d,192),ir(d,226),ir(d,92,(function(ne){var J=!ne||ne.biff==8,ue=xt(J?112:54);for(ue.write_shift(ne.biff==8?2:1,7),J&&ue.write_shift(1,0),ue.write_shift(4,859007059),ue.write_shift(4,5458548|(J?0:536870912));ue.l<ue.length;)ue.write_shift(1,J?0:32);return ue})(u)),ir(d,66,ho(b?1200:1252)),b&&ir(d,353,ho(0)),b&&ir(d,448),ir(d,317,(function(ne){for(var J=xt(2*ne),ue=0;ue<ne;++ue)J.write_shift(2,ue+1);return J})(s.SheetNames.length)),b&&s.vbaraw&&ir(d,211),b&&s.vbaraw&&ir(d,442,Cc(x.CodeName||"ThisWorkbook")),ir(d,156,ho(17)),ir(d,25,Za(!1)),ir(d,18,Za(!1)),ir(d,19,ho(0)),b&&ir(d,431,Za(!1)),b&&ir(d,444,ho(0)),ir(d,61,((S=xt(18)).write_shift(2,0),S.write_shift(2,0),S.write_shift(2,29280),S.write_shift(2,17600),S.write_shift(2,56),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,1),S.write_shift(2,500),S)),ir(d,64,Za(!1)),ir(d,141,ho(0)),ir(d,34,Za(((x=s).Workbook&&x.Workbook.WBProps&&Ea(x.Workbook.WBProps.date1904)?"true":"false")=="true")),ir(d,14,Za(!0)),b&&ir(d,439,Za(!1)),ir(d,218,ho(0)),nf(d,0,u),f1(d,s.SSF,u),(function(ne,J){for(var ue=0;ue<16;++ue)ir(ne,224,_({numFmtId:0,style:!0},0,J));J.cellXfs.forEach(function(be){ir(ne,224,_(be,0,J))})})(d,u),b&&ir(d,352,Za(!1)),S=d.end(),x=xs(),b&&ir(x,140,((he=he||xt(4)).write_shift(2,1),he.write_shift(2,1),he)),b&&u.Strings&&(function(ne,J,ue){var be=(ue||[]).length||0;if(be<=8224)return ir(ne,J,ue,be);if(!isNaN(J)){for(var we=ue.parts||[],$e=0,et=0,Xe=0;Xe+(we[$e]||8224)<=8224;)Xe+=we[$e]||8224,$e++;var lt=ne.next(4);for(lt.write_shift(2,J),lt.write_shift(2,Xe),ne.push(ue.slice(et,et+Xe)),et+=Xe;et<be;){for((lt=ne.next(4)).write_shift(2,60),Xe=0;Xe+(we[$e]||8224)<=8224;)Xe+=we[$e]||8224,$e++;lt.write_shift(2,Xe),ne.push(ue.slice(et,et+Xe)),et+=Xe}}})(x,252,Gh(u.Strings)),ir(x,10);for(var d=x.end(),N=xs(),T=0,F=0,F=0;F<s.SheetNames.length;++F)T+=(b?12:11)+(b?2:1)*s.SheetNames[F].length;var O,L,B,ee,G=S.length+T+d.length;for(F=0;F<s.SheetNames.length;++F)ir(N,133,(O={pos:G,hs:(g[F]||{}).Hidden||0,dt:0,name:s.SheetNames[F]},ee=B=void 0,B=!(L=u)||8<=L.biff?2:1,(ee=xt(8+B*O.name.length)).write_shift(4,O.pos),ee.write_shift(1,O.hs||0),ee.write_shift(1,O.dt),ee.write_shift(1,O.name.length),8<=L.biff&&ee.write_shift(1,1),ee.write_shift(B*O.name.length,O.name,L.biff<8?"sbcs":"utf16le"),(L=ee.slice(0,ee.l)).l=ee.l,L)),G+=c[F].length;var he=N.end();if(T!=he.length)throw new Error("BS8 "+T+" != "+he.length);return x=[],S.length&&x.push(S),he.length&&x.push(he),d.length&&x.push(d),Ae(x)}function Zp(s,c){for(var u=0;u<=s.SheetNames.length;++u){var d=s.Sheets[s.SheetNames[u]];d&&d["!ref"]&&255<ti(d["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+s.SheetNames[u]+"' extends beyond column IV (255).  Data may be lost.")}var g=c||{};switch(g.biff||2){case 8:case 5:return(function(x,b){var S=b||{},N=[];x&&!x.SSF&&(x.SSF=jn(se)),x&&x.SSF&&(Jn(),Lr(x.SSF),S.revssf=qo(x.SSF),S.revssf[x.SSF[65535]]=0,S.ssf=x.SSF),S.Strings=[],S.Strings.Count=0,S.Strings.Unique=0,S1(S),S.cellXfs=[],Iu(S.cellXfs,{},{revssf:{General:0}}),x.Props||(x.Props={});for(var T=0;T<x.SheetNames.length;++T)N[N.length]=Pg(T,S,x);return N.unshift(Mg(x,N,S)),Ae(N)})(s,c);case 4:case 3:case 2:return Rg(s,c)}throw new Error("invalid type "+g.bookType+" for BIFF")}function l0(s,c){var u=c||{},d=u.dense?[]:{},g=(s=s.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!g)throw new Error("Invalid HTML: could not find <table>");for(var x,c=s.match(/<\/table/i),L=g.index,b=c&&c.index||s.length,S=gl(s.slice(L,b),/(:?<tr[^>]*>)/i,"<tr>"),N=-1,T=0,F={s:{r:1e7,c:1e7},e:{r:0,c:0}},O=[],L=0;L<S.length;++L){var B=S[L].trim(),ee=B.slice(0,3).toLowerCase();if(ee!="<tr"){if(ee=="<td"||ee=="<th")for(var G=B.split(/<\/t[dh]>/i),b=0;b<G.length;++b){var he=G[b].trim();if(he.match(/<t[dh]/i)){for(var ne=he,J=0;ne.charAt(0)=="<"&&-1<(J=ne.indexOf(">"));)ne=ne.slice(J+1);for(var ue=0;ue<O.length;++ue){var be=O[ue];be.s.c==T&&be.s.r<N&&N<=be.e.r&&(T=be.e.c+1,ue=-1)}var we=ln(he.slice(0,he.indexOf(">"))),$e=we.colspan?+we.colspan:1;(1<(x=+we.rowspan)||1<$e)&&O.push({s:{r:N,c:T},e:{r:N+(x||1)-1,c:T+$e-1}}),he=we.t||we["data-t"]||"",ne.length&&(ne=Ph(ne),F.s.r>N&&(F.s.r=N),F.e.r<N&&(F.e.r=N),F.s.c>T&&(F.s.c=T),F.e.c<T&&(F.e.c=T),ne.length&&(we={t:"s",v:ne},u.raw||!ne.trim().length||he=="s"||(ne==="TRUE"?we={t:"b",v:!0}:ne==="FALSE"?we={t:"b",v:!1}:isNaN(bi(ne))?isNaN(Oi(ne).getDate())||(we={t:"d",v:vn(ne)},(we=u.cellDates?we:{t:"n",v:pa(we.v)}).z=u.dateNF||se[14]):we={t:"n",v:bi(ne)}),u.dense?(d[N]||(d[N]=[]),d[N][T]=we):d[sn({r:N,c:T})]=we)),T+=$e}}}else{if(++N,u.sheetRows&&u.sheetRows<=N){--N;break}T=0}}return d["!ref"]=rn(F),O.length&&(d["!merges"]=O),d}function em(s,c,u,d){for(var g=s["!merges"]||[],x=[],b=c.s.c;b<=c.e.c;++b){for(var S,N,T,F,O=0,L=0,B=0;B<g.length;++B)if(!(g[B].s.r>u||g[B].s.c>b||g[B].e.r<u||g[B].e.c<b)){if(g[B].s.r<u||g[B].s.c<b){O=-1;break}O=g[B].e.r-g[B].s.r+1,L=g[B].e.c-g[B].s.c+1;break}O<0||(S=sn({r:u,c:b}),T=(N=d.dense?(s[u]||[])[b]:s[S])&&N.v!=null&&(N.h||pu(N.w||(io(N),N.w)||""))||"",F={},1<O&&(F.rowspan=O),1<L&&(F.colspan=L),d.editable?T='<span contenteditable="true">'+T+"</span>":N&&(F["data-t"]=N&&N.t||"z",N.v!=null&&(F["data-v"]=N.v),N.z!=null&&(F["data-z"]=N.z),N.l&&(N.l.Target||"#").charAt(0)!="#"&&(T='<a href="'+N.l.Target+'">'+T+"</a>")),F.id=(d.id||"sjs")+"-"+S,x.push(Xt("td",T,F)))}return"<tr>"+x.join("")+"</tr>"}var tm='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ka="</body></html>";function p1(s,c,u){return[].join("")+"<table"+(u&&u.id?' id="'+u.id+'"':"")+">"}function Ug(s,g){var u=g||{},d=u.header!=null?u.header:tm,g=u.footer!=null?u.footer:ka,x=[d],b=ti(s["!ref"]);u.dense=Array.isArray(s),x.push(p1(0,0,u));for(var S=b.s.r;S<=b.e.r;++S)x.push(em(s,b,S,u));return x.push("</table>"+g),x.join("")}function rm(s,c,u){var d=u||{},g=0,x=0;d.origin!=null&&(typeof d.origin=="number"?g=d.origin:(g=(u=typeof d.origin=="string"?ga(d.origin):d.origin).r,x=u.c));var b=c.getElementsByTagName("tr"),S=Math.min(d.sheetRows||1e7,b.length),N={s:{r:0,c:0},e:{r:g,c:x}};s["!ref"]&&(c=ti(s["!ref"]),N.s.r=Math.min(N.s.r,c.s.r),N.s.c=Math.min(N.s.c,c.s.c),N.e.r=Math.max(N.e.r,c.e.r),N.e.c=Math.max(N.e.c,c.e.c),g==-1&&(N.e.r=g=c.e.r+1));var T,F,O=[],L=0,B=s["!rows"]||(s["!rows"]=[]),ee=0,G=0,he=0,ne=0;for(s["!cols"]||(s["!cols"]=[]);ee<b.length&&G<S;++ee){var J=b[ee];if(Hg(J)){if(d.display)continue;B[G]={hidden:!0}}for(var ue=J.children,he=ne=0;he<ue.length;++he){var be=ue[he];if(!d.display||!Hg(be)){for(var we=be.hasAttribute("data-v")?be.getAttribute("data-v"):be.hasAttribute("v")?be.getAttribute("v"):Ph(be.innerHTML),$e=be.getAttribute("data-z")||be.getAttribute("z"),L=0;L<O.length;++L){var et=O[L];et.s.c==ne+x&&et.s.r<G+g&&G+g<=et.e.r&&(ne=et.e.c+1-x,L=-1)}F=+be.getAttribute("colspan")||1,(1<(T=+be.getAttribute("rowspan")||1)||1<F)&&O.push({s:{r:G+g,c:ne+x},e:{r:G+g+(T||1)-1,c:ne+x+(F||1)-1}});var Xe={t:"s",v:we},lt=be.getAttribute("data-t")||be.getAttribute("t")||"";we!=null&&(we.length==0?Xe.t=lt||"z":d.raw||we.trim().length==0||lt=="s"||(we==="TRUE"?Xe={t:"b",v:!0}:we==="FALSE"?Xe={t:"b",v:!1}:isNaN(bi(we))?isNaN(Oi(we).getDate())||(Xe={t:"d",v:vn(we)},(Xe=d.cellDates?Xe:{t:"n",v:pa(Xe.v)}).z=d.dateNF||se[14]):Xe={t:"n",v:bi(we)})),Xe.z===void 0&&$e!=null&&(Xe.z=$e);var _t="",Dt=be.getElementsByTagName("A");if(Dt&&Dt.length)for(var ft=0;ft<Dt.length&&(!Dt[ft].hasAttribute("href")||(_t=Dt[ft].getAttribute("href")).charAt(0)=="#");++ft);_t&&_t.charAt(0)!="#"&&(Xe.l={Target:_t}),d.dense?(s[G+g]||(s[G+g]=[]),s[G+g][ne+x]=Xe):s[sn({c:ne+x,r:G+g})]=Xe,N.e.c<ne+x&&(N.e.c=ne+x),ne+=F}}++G}return O.length&&(s["!merges"]=(s["!merges"]||[]).concat(O)),N.e.r=Math.max(N.e.r,G-1+g),s["!ref"]=rn(N),S<=G&&(s["!fullref"]=rn((N.e.r=b.length-ee+G-1+g,N))),s}function Bg(s,c){return rm((c||{}).dense?[]:{},s,c)}function Hg(s){var u,c="",u=(u=s).ownerDocument.defaultView&&typeof u.ownerDocument.defaultView.getComputedStyle=="function"?u.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(c=(c=u?u(s).getPropertyValue("display"):c)||s.style&&s.style.display)==="none"}var zg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function c0(s,c){var u=c||{},d,g,x,b,S,N=sh(s),T=[],F={name:""},O="",L=0,B={},ee=[],G=u.dense?[]:{},he={value:""},ne="",J=0,ue=[],be=-1,we=-1,$e={s:{r:1e6,c:1e7},e:{r:0,c:0}},et=0,Xe={},lt=[],_t={},Dt=[],ft=1,qt=1,hr=[],lr={Names:[]},Zt={},tr=["",""],Kt=[],Bt={},mr="",Nr=0,Gr=!1,Mn=!1,dr=0;for(Ui.lastIndex=0,N=N.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Ui.exec(N);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?($e.e.c>=$e.s.c&&$e.e.r>=$e.s.r?G["!ref"]=rn($e):G["!ref"]="A1:A1",0<u.sheetRows&&u.sheetRows<=$e.e.r&&(G["!fullref"]=G["!ref"],$e.e.r=u.sheetRows-1,G["!ref"]=rn($e)),lt.length&&(G["!merges"]=lt),Dt.length&&(G["!rows"]=Dt),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),ee.push(x.name),B[x.name]=G,Mn=!1):b[0].charAt(b[0].length-2)!=="/"&&(x=ln(b[0],!1),be=we=-1,$e.s.r=$e.s.c=1e7,$e.e.r=$e.e.c=0,G=u.dense?[]:{},lt=[],Dt=[],Mn=!0);break;case"table-row-group":b[1]==="/"?--et:++et;break;case"table-row":case"":if(b[1]==="/"){be+=ft,ft=1;break}if((Gt=ln(b[0],!1)).?be=Gt.-1:be==-1&&(be=0),(ft=+Gt["number-rows-repeated"]||1)<10)for(dr=0;dr<ft;++dr)0<et&&(Dt[be+dr]={level:et});we=-1;break;case"covered-table-cell":b[1]!=="/"&&++we,u.sheetStubs&&(u.dense?(G[be]||(G[be]=[]),G[be][we]={t:"z"}):G[sn({r:be,c:we})]={t:"z"}),ne="",ue=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++we,he=ln(b[0],!1),qt=parseInt(he["number-columns-repeated"]||"1",10),S={t:"z",v:null},he.formula&&u.cellFormula!=0&&(S.f=Wd(cn(he.formula))),(he.||he["value-type"])=="string"&&(S.t="s",S.v=cn(he["string-value"]||""),u.dense?(G[be]||(G[be]=[]),G[be][we]=S):G[sn({r:be,c:we})]=S),we+=qt-1;else if(b[1]!=="/"){ne="",J=0,ue=[],qt=1;var Gt=ft?be+ft-1:be;if(++we>$e.e.c&&($e.e.c=we),we<$e.s.c&&($e.s.c=we),be<$e.s.r&&($e.s.r=be),Gt>$e.e.r&&($e.e.r=Gt),Kt=[],Bt={},S={t:(he=ln(b[0],!1)).||he["value-type"],v:null},u.cellFormula)if(he.formula&&(he.formula=cn(he.formula)),he["number-matrix-columns-spanned"]&&he["number-matrix-rows-spanned"]&&(_t={s:{r:be,c:we},e:{r:be+(parseInt(he["number-matrix-rows-spanned"],10)||0)-1,c:we+(parseInt(he["number-matrix-columns-spanned"],10)||0)-1}},S.F=rn(_t),hr.push([_t,S.F])),he.formula)S.f=Wd(he.formula);else for(dr=0;dr<hr.length;++dr)be>=hr[dr][0].s.r&&be<=hr[dr][0].e.r&&we>=hr[dr][0].s.c&&we<=hr[dr][0].e.c&&(S.F=hr[dr][1]);switch((he["number-columns-spanned"]||he["number-rows-spanned"])&&(_t={s:{r:be,c:we},e:{r:be+(parseInt(he["number-rows-spanned"],10)||0)-1,c:we+(parseInt(he["number-columns-spanned"],10)||0)-1}},lt.push(_t)),he["number-columns-repeated"]&&(qt=parseInt(he["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Ea(he["boolean-value"]);break;case"float":case"percentage":case"currency":S.t="n",S.v=parseFloat(he.value);break;case"date":S.t="d",S.v=vn(he["date-value"]),u.cellDates||(S.t="n",S.v=pa(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=(function($n){var Sa=0,Ls=0,We=!1,Aa=$n.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!Aa)throw new Error("|"+$n+"| is not an ISO8601 Duration");for(var la=1;la!=Aa.length;++la)if(Aa[la]){switch(Ls=1,3<la&&(We=!0),Aa[la].slice(Aa[la].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+Aa[la].slice(Aa[la].length-1));case"D":Ls*=24;case"H":Ls*=60;case"M":if(!We)throw new Error("Unsupported ISO Duration Field: M");Ls*=60}Sa+=Ls*parseInt(Aa[la],10)}return Sa})(he["time-value"])/86400,u.cellDates&&(S.t="d",S.v=Ms(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(he.);break;default:if(S.t!=="string"&&S.t!=="text"&&S.t)throw new Error("Unsupported value type "+S.t);S.t="s",he["string-value"]!=null&&(ne=cn(he["string-value"]),ue=[])}}else{if(Gr=!1,S.t==="s"&&(S.v=ne||"",ue.length&&(S.R=ue),Gr=J==0),Zt.Target&&(S.l=Zt),0<Kt.length&&(S.c=Kt,Kt=[]),ne&&u.cellText!==!1&&(S.w=ne),Gr&&(S.t="z",delete S.v),(!Gr||u.sheetStubs)&&!(u.sheetRows&&u.sheetRows<=be))for(var bn=0;bn<ft;++bn){if(qt=parseInt(he["number-columns-repeated"]||"1",10),u.dense)for(G[be+bn]||(G[be+bn]=[]),G[be+bn][we]=bn==0?S:jn(S);0<--qt;)G[be+bn][we+qt]=jn(S);else for(G[sn({r:be+bn,c:we})]=S;0<--qt;)G[sn({r:be+bn,c:we+qt})]=jn(S);$e.e.c<=we&&($e.e.c=we)}we+=(qt=parseInt(he["number-columns-repeated"]||"1",10))-1,qt=0,S={},ne="",ue=[]}Zt={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((d=T.pop())[0]!==b[3])throw"Bad state: "+d}else b[0].charAt(b[0].length-2)!=="/"&&T.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((d=T.pop())[0]!==b[3])throw"Bad state: "+d;Bt.t=ne,ue.length&&(Bt.R=ue),Bt.a=mr,Kt.push(Bt)}else b[0].charAt(b[0].length-2)!=="/"&&T.push([b[3],!1]);ne=mr="",J=Nr=0,ue=[];break;case"creator":b[1]==="/"?mr=N.slice(Nr,b.index):Nr=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((d=T.pop())[0]!==b[3])throw"Bad state: "+d}else b[0].charAt(b[0].length-2)!=="/"&&T.push([b[3],!1]);ne="",J=0,ue=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(Xe[F.name]=O,(d=T.pop())[0]!==b[3])throw"Bad state: "+d}else b[0].charAt(b[0].length-2)!=="/"&&(O="",F=ln(b[0],!1),T.push([b[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(T[T.length-1][0]){case"time-style":case"date-style":g=ln(b[0],!1),O+=zg[b[3]][g.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(T[T.length-1][0]){case"time-style":case"date-style":g=ln(b[0],!1),O+=zg[b[3]][g.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(T[T.length-1][0]){case"number-style":case"date-style":case"time-style":O+=N.slice(L,b.index)}else L=b.index+b[0].length;break;case"named-range":tr=ec((g=ln(b[0],!1))["cell-range-address"]);var Qn={Name:g.name,Ref:tr[0]+"!"+tr[1]};Mn&&(Qn.Sheet=ee.length),lr.Names.push(Qn);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(T[T.length-1][0]))break;b[1]!=="/"||he&&he["string-value"]?(ln(b[0],!1),J=b.index+b[0].length):(Qn=(Qn=N.slice(J,b.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function($n,Sa){return Array(parseInt(Sa,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),Qn=[cn(Qn.replace(/<[^>]*>/g,""))],ne=(0<ne.length?ne+`
`:"")+Qn[0]);break;case"s":break;case"database-range":if(b[1]==="/")break;try{B[(tr=ec(ln(b[0])["target-range-address"]))[0]]["!autofilter"]={ref:tr[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(b[1]!=="/"){if(!(Zt=ln(b[0],!1)).href)break;Zt.Target=cn(Zt.href),delete Zt.href,Zt.Target.charAt(0)=="#"&&-1<Zt.Target.indexOf(".")?(tr=ec(Zt.Target.slice(1)),Zt.Target="#"+tr[0]+"!"+tr[1]):Zt.Target.match(/^\.\.[\\\/]/)&&(Zt.Target=Zt.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(u.WTF)throw new Error(b)}}return s={Sheets:B,SheetNames:ee,Workbook:lr},u.bookSheets&&delete s.Sheets,s}function sd(s,c){c=c||{},Us(s,"META-INF/manifest.xml")&&(function(d,g){for(var x,b,S=sh(d);x=Ui.exec(S);)switch(x[3]){case"manifest":break;case"file-entry":if((b=ln(x[0],!1)).path=="/"&&b.type!==$i)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(g&&g.WTF)throw x}})(ss(s,"META-INF/manifest.xml"),c);var u=Ya(s,"content.xml");if(!u)throw new Error("Missing content.xml in ODS / UOF file");return c=c0(Xn(u),c),Us(s,"meta.xml")&&(c.Props=To(ss(s,"meta.xml"))),c}function m1(s,c){return c0(s,c)}var g1=(function(){var s=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),c="<office:document-styles "+wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+s+"</office:document-styles>";return function(){return is+c}})(),y1=(function(){function s(u,d,g){var x=[];x.push('      <table:table table:name="'+aa(d.SheetNames[g])+`" table:style-name="ta1">
`);var b=0,S=0,N=ti(u["!ref"]||"A1"),T=u["!merges"]||[],F=0,O=Array.isArray(u);if(u["!cols"])for(S=0;S<=N.e.c;++S)x.push("        <table:table-column"+(u["!cols"][S]?' table:style-name="co'+u["!cols"][S].ods+'"':"")+`></table:table-column>
`);for(var L="",B=u["!rows"]||[],b=0;b<N.s.r;++b)L=B[b]?' table:style-name="ro'+B[b].ods+'"':"",x.push("        <table:table-row"+L+`></table:table-row>
`);for(;b<=N.e.r;++b){for(L=B[b]?' table:style-name="ro'+B[b].ods+'"':"",x.push("        <table:table-row"+L+`>
`),S=0;S<N.s.c;++S)x.push(c);for(;S<=N.e.c;++S){for(var ee=!1,G={},he="",F=0;F!=T.length;++F)if(!(T[F].s.c>S||T[F].s.r>b||T[F].e.c<S||T[F].e.r<b)){T[F].s.c==S&&T[F].s.r==b||(ee=!0),G["table:number-columns-spanned"]=T[F].e.c-T[F].s.c+1,G["table:number-rows-spanned"]=T[F].e.r-T[F].s.r+1;break}if(ee)x.push(`          <table:covered-table-cell/>
`);else{var ne=sn({r:b,c:S}),J=O?(u[b]||[])[S]:u[ne];if(J&&J.f&&(G["table:formula"]=aa(("of:="+J.f.replace(ed,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),J.F&&J.F.slice(0,ne.length)==ne&&(ue=ti(J.F),G["table:number-matrix-columns-spanned"]=ue.e.c-ue.s.c+1,G["table:number-matrix-rows-spanned"]=ue.e.r-ue.s.r+1)),J){switch(J.t){case"b":he=J.v?"TRUE":"FALSE",G["office:value-type"]="boolean",G["office:boolean-value"]=J.v?"true":"false";break;case"n":he=J.w||String(J.v||0),G["office:value-type"]="float",G["office:value"]=J.v||0;break;case"s":case"str":he=J.v==null?"":J.v,G["office:value-type"]="string";break;case"d":he=J.w||vn(J.v).toISOString(),G["office:value-type"]="date",G["office:date-value"]=vn(J.v).toISOString(),G["table:style-name"]="ce1";break;default:x.push(c);continue}var ue,ne=aa(he).replace(/  +/g,function(we){return'<text:s text:c="'+we.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");J.l&&J.l.Target&&(ne=Xt("text:a",ne,{"xlink:href":(ue=(ue=(ue=J.l.Target).charAt(0)=="#"?"#"+ue.slice(1).replace(/\./,"!"):ue).charAt(0)!="#"&&!ue.match(/^\w+:/)?"../"+ue:ue).replace(/&/g,"&amp;")})),x.push("          "+Xt("table:table-cell",Xt("text:p",ne,{}),G)+`
`)}else x.push(c)}}x.push(`        </table:table-row>
`)}return x.push(`      </table:table>
`),x.join("")}var c=`          <table:table-cell />
`;return function(u,d){var g=[is],x=wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),b=wi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(g.push("<office:document"+x+b+`>
`),g.push(Bh().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+x+`>
`),(function(N,T){N.push(` <office:automatic-styles>
`),N.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),N.push(`   <number:month number:style="long"/>
`),N.push(`   <number:text>/</number:text>
`),N.push(`   <number:day number:style="long"/>
`),N.push(`   <number:text>/</number:text>
`),N.push(`   <number:year/>
`),N.push(`  </number:date-style>
`);var F=0;T.SheetNames.map(function(L){return T.Sheets[L]}).forEach(function(L){if(L&&L["!cols"]){for(var B=0;B<L["!cols"].length;++B)if(L["!cols"][B]){var ee=L["!cols"][B];if(ee.width==null&&ee.wpx==null&&ee.wch==null)continue;mh(ee),ee.ods=F,ee=L["!cols"][B].wpx+"px",N.push('  <style:style style:name="co'+F+`" style:family="table-column">
`),N.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+ee+`"/>
`),N.push(`  </style:style>
`),++F}}});var O=0;T.SheetNames.map(function(L){return T.Sheets[L]}).forEach(function(L){if(L&&L["!rows"])for(var B,ee=0;ee<L["!rows"].length;++ee)L["!rows"][ee]&&(L["!rows"][ee].ods=O,B=L["!rows"][ee].hpx+"px",N.push('  <style:style style:name="ro'+O+`" style:family="table-row">
`),N.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+B+`"/>
`),N.push(`  </style:style>
`),++O)}),N.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),N.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),N.push(`  </style:style>
`),N.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),N.push(` </office:automatic-styles>
`)})(g,u),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var S=0;S!=u.SheetNames.length;++S)g.push(s(u.Sheets[u.SheetNames[S]],u,S));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),d.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function Lu(s,c){if(c.bookType=="fods")return y1(s,c);var u=fu(),d=[],g=[];return mn(u,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),mn(u,"content.xml",y1(s,c)),d.push(["content.xml","text/xml"]),g.push(["content.xml","ContentFile"]),mn(u,"styles.xml",g1(s,c)),d.push(["styles.xml","text/xml"]),g.push(["styles.xml","StylesFile"]),mn(u,"meta.xml",is+Bh()),d.push(["meta.xml","text/xml"]),g.push(["meta.xml","MetadataFile"]),mn(u,"manifest.rdf",(function(x){var b=[is];b.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var S=0;S!=x.length;++S)b.push(li(x[S][0],x[S][1])),b.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+x[S][0]+`"/>
`,`  </rdf:Description>
`].join(""));return b.push(li("","Document","pkg")),b.push("</rdf:RDF>"),b.join("")})(g)),d.push(["manifest.rdf","application/rdf+xml"]),mn(u,"META-INF/manifest.xml",(function(x){var b=[is];b.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),b.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var S=0;S<x.length;++S)b.push('  <manifest:file-entry manifest:full-path="'+x[S][0]+'" manifest:media-type="'+x[S][1]+`"/>
`);return b.push("</manifest:manifest>"),b.join("")})(d)),u}function Ki(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function id(s){return typeof TextDecoder<"u"?new TextDecoder().decode(s):Xn(z(s))}function $g(s){return typeof TextEncoder<"u"?new TextEncoder().encode(s):de(xi(s))}function Pu(s){var c=s.reduce(function(g,x){return g+x.length},0),u=new Uint8Array(c),d=0;return s.forEach(function(g){u.set(g,d),d+=g.length}),u}function nm(s){return 16843009*((s=(858993459&(s-=s>>1&1431655765))+(s>>2&858993459))+(s>>4)&252645135)>>>24}function af(s,c){var u=c?c[0]:0,d=127&s[u];return 128<=s[u++]&&(d|=(127&s[u])<<7,s[u++]<128||(d|=(127&s[u])<<14,s[u++]<128||(d|=(127&s[u])<<21,s[u++]<128||(d+=(127&s[u])*Math.pow(2,28),++u,s[u++]<128||(d+=(127&s[u])*Math.pow(2,35),++u,s[u++]<128||(d+=(127&s[u])*Math.pow(2,42),++u,s[u++])))))),c&&(c[0]=u),d}function ha(s){var c=new Uint8Array(7);c[0]=127&s;var u=1;return 127<s&&(c[u-1]|=128,c[u]=s>>7&127,++u,s<=16383||(c[u-1]|=128,c[u]=s>>14&127,++u,s<=2097151||(c[u-1]|=128,c[u]=s>>21&127,++u,s<=268435455||(c[u-1]|=128,c[u]=s/256>>>21&127,++u,s<=34359738367||(c[u-1]|=128,c[u]=s/65536>>>21&127,++u,s<=4398046511103||(c[u-1]|=128,c[u]=s/16777216>>>21&127,++u)))))),c.slice(0,u)}function js(s){var c=0,u=127&s[0];return 128<=s[c++]&&(u|=(127&s[1])<<7,s[c++]<128||(u|=(127&s[2])<<14,s[c++]<128||(u|=(127&s[3])<<21,s[+c]<128||(u|=(127&s[4])<<28)))),u}function Wn(s){for(var c=[],u=[0];u[0]<s.length;){var d,g=u[0],x=af(s,u),b=7&x,S=0;if((x=Math.floor(x/8))==0)break;switch(b){case 0:for(var N=u[0];128<=s[u[0]++];);d=s.slice(N,u[0]);break;case 5:S=4,d=s.slice(u[0],u[0]+S),u[0]+=S;break;case 1:S=8,d=s.slice(u[0],u[0]+S),u[0]+=S;break;case 2:S=af(s,u),d=s.slice(u[0],u[0]+S),u[0]+=S;break;default:throw new Error("PB Type ".concat(b," for Field ").concat(x," at offset ").concat(g))}var T={data:d,type:b};c[x]==null?c[x]=[T]:c[x].push(T)}return c}function Os(s){var c=[];return s.forEach(function(u,d){d!=0&&u.forEach(function(g){g.data&&(c.push(ha(8*d+g.type)),g.type==2&&c.push(ha(g.data.length)),c.push(g.data))})}),Pu(c)}function v1(s,c){return s?.map(function(u){return c(u.data)})||[]}function nc(s){for(var c=[],u=[0];u[0]<s.length;){var d=af(s,u),g=Wn(s.slice(u[0],u[0]+d));u[0]+=d;var x={id:js(g[1][0].data),messages:[]};g[2].forEach(function(N){var S=Wn(N.data),N=js(S[3][0].data);x.messages.push({meta:S,data:s.slice(u[0],u[0]+N)}),u[0]+=N}),(d=g[3])!=null&&d[0]&&(x.merge=0<js(g[3][0].data)>>>0),c.push(x)}return c}function Mu(s){var c=[];return s.forEach(function(u){var d=[[],[{data:ha(u.id),type:0}],[]];u.merge!=null&&(d[3]=[{data:ha(+!!u.merge),type:0}]);var g=[];u.messages.forEach(function(x){g.push(x.data),x.meta[3]=[{type:0,data:ha(x.data.length)}],d[2].push({data:Os(x.meta),type:2})}),u=Os(d),c.push(ha(u.length)),c.push(u),g.forEach(function(x){return c.push(x)})}),Pu(c)}function al(s){for(var c=[],u=0;u<s.length;){var d=s[u++],g=s[u]|s[u+1]<<8|s[u+2]<<16;u+=3,c.push((function(x,b){if(x!=0)throw new Error("Unexpected Snappy chunk type ".concat(x));for(var S=[0],N=af(b,S),T=[];S[0]<b.length;){var F=3&b[S[0]];if(F!=0){var O=0,L=0;if(F==1?(L=4+(b[S[0]]>>2&7),O=(224&b[S[0]++])<<3,O|=b[S[0]++]):(L=1+(b[S[0]++]>>2),F==2?(O=b[S[0]]|b[S[0]+1]<<8,S[0]+=2):(O=(b[S[0]]|b[S[0]+1]<<8|b[S[0]+2]<<16|b[S[0]+3]<<24)>>>0,S[0]+=4)),T=[Pu(T)],O==0)throw new Error("Invalid offset 0");if(O>T[0].length)throw new Error("Invalid offset beyond length");if(O<=L)for(T.push(T[0].slice(-O)),L-=O;L>=T[T.length-1].length;)T.push(T[T.length-1]),L-=T[T.length-1].length;T.push(T[0].slice(-O,-O+L))}else F=b[S[0]++]>>2,F<60?++F:(O=F-59,F=b[S[0]],1<O&&(F|=b[S[0]+1]<<8),2<O&&(F|=b[S[0]+2]<<16),3<O&&(F|=b[S[0]+3]<<24),F>>>=0,F++,S[0]+=O),T.push(b.slice(S[0],S[0]+F)),S[0]+=F}if((x=Pu(T)).length!=N)throw new Error("Unexpected length: ".concat(x.length," != ").concat(N));return x})(d,s.slice(u,u+g))),u+=g}if(u!==s.length)throw new Error("data is not a valid framed stream!");return Pu(c)}function od(s){for(var c=[],u=0;u<s.length;){var d=Math.min(s.length-u,268435455),g=new Uint8Array(4);c.push(g);var x=ha(d),b=x.length;c.push(x),d<=60?(b++,c.push(new Uint8Array([d-1<<2]))):d<=256?(b+=2,c.push(new Uint8Array([240,d-1&255]))):d<=65536?(b+=3,c.push(new Uint8Array([244,d-1&255,d-1>>8&255]))):d<=16777216?(b+=4,c.push(new Uint8Array([248,d-1&255,d-1>>8&255,d-1>>16&255]))):d<=4294967296&&(b+=5,c.push(new Uint8Array([252,d-1&255,d-1>>8&255,d-1>>16&255,d-1>>>24&255]))),c.push(s.slice(u,u+d)),b+=d,g[0]=0,g[1]=255&b,g[2]=b>>8&255,g[3]=b>>16&255,u+=d}return Pu(c)}function Qy(s,c,u){var d,g=Ki(s),x=g.getUint32(8,!0),b=12,S=-1,N=-1,T=NaN,F=NaN,O=new Date(2001,0,1);switch(1&x&&(T=(function(L,B){for(var ee=(127&L[B+15])<<7|L[B+14]>>1,G=1&L[B+14],he=B+13;B<=he;--he)G=256*G+L[he];return(128&L[B+15]?-G:G)*Math.pow(10,ee-6176)})(s,b),b+=16),2&x&&(F=g.getFloat64(b,!0),b+=8),4&x&&(O.setTime(O.getTime()+1e3*g.getFloat64(b,!0)),b+=8),8&x&&(N=g.getUint32(b,!0),b+=4),16&x&&(S=g.getUint32(b,!0),b+=4),s[1]){case 0:break;case 2:d={t:"n",v:T};break;case 3:d={t:"s",v:c[N]};break;case 5:d={t:"d",v:O};break;case 6:d={t:"b",v:0<F};break;case 7:d={t:"n",v:F/86400};break;case 8:d={t:"e",v:0};break;case 9:if(!(-1<S))throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(31&x," : ").concat(s.slice(0,4)));d={t:"s",v:u[S]};break;case 10:d={t:"n",v:T};break;default:throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(31&x," : ").concat(s.slice(0,4)))}return d}function ld(s,c){var u=new Uint8Array(32),d=Ki(u),g=12,x=0;switch(u[0]=5,s.t){case"n":u[1]=2,(function(b,S,N){var T=Math.floor(N==0?0:Math.LOG10E*Math.log(Math.abs(N)))+6176-16,F=N/Math.pow(10,T-6176);b[S+15]|=T>>7,b[S+14]|=(127&T)<<1;for(var O=0;1<=F;++O,F/=256)b[S+O]=255&F;b[S+15]|=0<=N?0:128})(u,g,s.v),x|=1,g+=16;break;case"b":u[1]=6,d.setFloat64(g,s.v?1:0,!0),x|=2,g+=8;break;case"s":if(c.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));u[1]=3,d.setUint32(g,c.indexOf(s.v),!0),x|=8,g+=4;break;default:throw"unsupported cell type "+s.t}return d.setUint32(8,x,!0),u.slice(0,g)}function am(s,c){var u=new Uint8Array(32),d=Ki(u),g=12,x=0;switch(u[0]=3,s.t){case"n":u[2]=2,d.setFloat64(g,s.v,!0),x|=32,g+=8;break;case"b":u[2]=6,d.setFloat64(g,s.v?1:0,!0),x|=32,g+=8;break;case"s":if(c.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));u[2]=3,d.setUint32(g,c.indexOf(s.v),!0),x|=16,g+=4;break;default:throw"unsupported cell type "+s.t}return d.setUint32(4,x,!0),u.slice(0,g)}function qg(s,c,u){switch(s[0]){case 0:case 1:case 2:case 3:return(function(d,g,x,b){var S,N=Ki(d),T=N.getUint32(4,!0),F=(1<b?12:8)+4*nm(T&(1<b?3470:398)),O=-1,L=-1,B=NaN,ee=new Date(2001,0,1);switch(512&T&&(O=N.getUint32(F,!0),F+=4),F+=4*nm(T&(1<b?12288:4096)),16&T&&(L=N.getUint32(F,!0),F+=4),32&T&&(B=N.getFloat64(F,!0),F+=8),64&T&&(ee.setTime(ee.getTime()+1e3*N.getFloat64(F,!0)),F+=8),d[2]){case 0:break;case 2:S={t:"n",v:B};break;case 3:S={t:"s",v:g[L]};break;case 5:S={t:"d",v:ee};break;case 6:S={t:"b",v:0<B};break;case 7:S={t:"n",v:B/86400};break;case 8:S={t:"e",v:0};break;case 9:if(-1<O)S={t:"s",v:x[O]};else if(-1<L)S={t:"s",v:g[L]};else{if(isNaN(B))throw new Error("Unsupported cell type ".concat(d.slice(0,4)));S={t:"n",v:B}}break;default:throw new Error("Unsupported cell type ".concat(d.slice(0,4)))}return S})(s,c,u,s[0]);case 5:return Qy(s,c,u);default:throw new Error("Unsupported payload version ".concat(s[0]))}}function hn(s){return af(Wn(s)[1][0].data)}function b1(s,d){var d=Wn(d.data),u=js(d[1][0].data),d=d[3],g=[];return(d||[]).forEach(function(x){var b=Wn(x.data),S=js(b[1][0].data)>>>0;switch(u){case 1:g[S]=id(b[3][0].data);break;case 8:var T=Wn(s[hn(b[9][0].data)][0].data),N=s[hn(T[1][0].data)][0],T=js(N.meta[1][0].data);if(T!=2001)throw new Error("2000 unexpected reference to ".concat(T));N=Wn(N.data),g[S]=N[3].map(function(F){return id(F.data)}).join("")}}),g}function x1(s,g){var u=Wn(g.data),d=(g=u?.[7])!=null&&g[0]?0<js(u[7][0].data)>>>0?1:0:-1,g=v1(u[5],function(x){return(function(b,S){var N,T,F,O=Wn(b),L=js(O[1][0].data)>>>0,B=js(O[2][0].data)>>>0,ee=((b=(ee=O[8])==null?void 0:ee[0])==null?void 0:b.data)&&0<js(O[8][0].data)||!1;if((b=(b=O[7])==null?void 0:b[0])!=null&&b.data&&S!=0)T=(N=(N=O[7])==null?void 0:N[0])==null?void 0:N.data,F=(N=(N=O[6])==null?void 0:N[0])==null?void 0:N.data;else{if((N=(N=O[4])==null?void 0:N[0])==null||!N.data||S==1)throw"NUMBERS Tile missing ".concat(S," cell storage");T=(S=(S=O[4])==null?void 0:S[0])==null?void 0:S.data,F=(O=(O=O[3])==null?void 0:O[0])==null?void 0:O.data}for(var G=ee?4:1,he=Ki(T),ne=[],J=0;J<T.length/2;++J){var ue=he.getUint16(2*J,!0);ue<65535&&ne.push([J,ue])}if(ne.length!=B)throw"Expected ".concat(B," cells, found ").concat(ne.length);for(var be=[],J=0;J<ne.length-1;++J)be[ne[J][0]]=F.subarray(ne[J][1]*G,ne[J+1][1]*G);return 1<=ne.length&&(be[ne[ne.length-1][0]]=F.subarray(ne[ne.length-1][1]*G)),{R:L,cells:be}})(x,d)});return{nrows:js(u[4][0].data)>>>0,data:g.reduce(function(x,b){return x[b.R]||(x[b.R]=[]),b.cells.forEach(function(S,N){if(x[b.R][N])throw new Error("Duplicate cell r=".concat(b.R," c=").concat(N));x[b.R][N]=S}),x},[])}}function sm(s,g){var u={"!ref":"A1"},d=s[hn(Wn(g.data)[2][0].data)],g=js(d[0].meta[1][0].data);if(g!=6001)throw new Error("6000 unexpected reference to ".concat(g));return(function(x,N,S){var O=Wn(N.data);if((N={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(js(O[6][0].data)>>>0)-1,N.e.r<0)throw new Error("Invalid row varint ".concat(O[6][0].data));if(N.e.c=(js(O[7][0].data)>>>0)-1,N.e.c<0)throw new Error("Invalid col varint ".concat(O[7][0].data));S["!ref"]=rn(N);var N=Wn(O[4][0].data),T=b1(x,x[hn(N[4][0].data)][0]),F=(O=N[17])!=null&&O[0]?b1(x,x[hn(N[17][0].data)][0]):[],O=Wn(N[3][0].data),L=0;if(O[1].forEach(function(ee){var G=Wn(ee.data),ee=x[hn(G[2][0].data)][0],G=js(ee.meta[1][0].data);if(G!=6002)throw new Error("6001 unexpected reference to ".concat(G));ee=x1(0,ee),ee.data.forEach(function(he,ne){he.forEach(function(J,ue){ue=sn({r:L+ne,c:ue}),J=qg(J,T,F),J&&(S[ue]=J)})}),L+=ee.nrows}),(O=N[13])!=null&&O[0]){if(O=x[hn(N[13][0].data)][0],N=js(O.meta[1][0].data),N!=6144)throw new Error("Expected merge type 6144, found ".concat(N));S["!merges"]=(O=Wn(O.data))==null?void 0:O[1].map(function(ee){var G=Wn(ee.data),ee=Ki(Wn(G[1][0].data)[1][0].data),G=Ki(Wn(G[2][0].data)[1][0].data);return{s:{r:ee.getUint16(0,!0),c:ee.getUint16(2,!0)},e:{r:ee.getUint16(0,!0)+G.getUint16(0,!0)-1,c:ee.getUint16(2,!0)+G.getUint16(2,!0)-1}}})}})(s,d[0],u),u}function Gg(s,c){var u=mm(),d=Wn(c.data);if((c=d[2])!=null&&c[0])throw new Error("Keynote presentations are not supported");if(v1(d[1],hn).forEach(function(g){s[g].forEach(function(x){var b,S,N,T;js(x.meta[1][0].data)==2&&(S=s,x=Wn((N=x).data),T={name:(N=x[1])!=null&&N[0]?id(x[1][0].data):"",sheets:[]},v1(x[2],hn).forEach(function(F){S[F].forEach(function(O){js(O.meta[1][0].data)==6e3&&T.sheets.push(sm(S,O))})}),(b=T).sheets.forEach(function(F,O){I1(u,F,O==0?b.name:b.name+"_"+O,!0)}))})}),u.SheetNames.length==0)throw new Error("Empty NUMBERS file");return u}function w1(s){var c={},u=[];if(s.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),s.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var x,b;try{x=al(g.content)}catch(S){return console.log("?? "+g.content.length+" "+(S.message||S))}try{b=nc(x)}catch(S){return console.log("## "+(S.message||S))}b.forEach(function(S){c[S.id]=S.messages,u.push(S.id)})}}),!u.length)throw new Error("File has no messages");if((s=(s=(s=(s=c?.[1])==null?void 0:s[0])==null?void 0:s.meta)==null?void 0:s[1])!=null&&s[0].data&&js(c[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var d=((s=(s=(s=(s=c?.[1])==null?void 0:s[0])==null?void 0:s.meta)==null?void 0:s[1])==null?void 0:s[0].data)&&js(c[1][0].meta[1][0].data)==1&&c[1][0];if(d||u.forEach(function(g){c[g].forEach(function(x){if(js(x.meta[1][0].data)>>>0==1){if(d)throw new Error("Document has multiple roots");d=x}})}),!d)throw new Error("Cannot find Document root");return Gg(c,d)}function u0(s,c){if(!c||!c.numbers)throw new Error("Must pass a `numbers` option -- check the README");var u=s.Sheets[s.SheetNames[0]];1<s.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var d=ti(u["!ref"]);d.s.r=d.s.c=0;var g=!1;9<d.e.c&&(g=!0,d.e.c=9),49<d.e.r&&(g=!0,d.e.r=49),g&&console.error("The Numbers writer is currently limited to ".concat(rn(d)));var x=T1(u,{range:d,header:1}),b=["~Sh33tJ5~"];x.forEach(function(Zt){return Zt.forEach(function(tr){typeof tr=="string"&&b.push(tr)})});var S={},N=[],T=Jt.read(c.numbers,{type:"base64"});T.FileIndex.map(function(Zt,tr){return[Zt,T.FullPaths[tr]]}).forEach(function(Zt){var tr=Zt[0],Kt=Zt[1];tr.type==2&&tr.name.match(/\.iwa/)&&nc(al(tr.content)).forEach(function(Bt){N.push(Bt.id),S[Bt.id]={deps:[],location:Kt,type:js(Bt.messages[0].meta[1][0].data)}})}),N.sort(function(Zt,tr){return Zt-tr});var F=N.filter(function(Zt){return 1<Zt}).map(function(Zt){return[Zt,ha(Zt)]});T.FileIndex.map(function(Zt,tr){return[Zt,T.FullPaths[tr]]}).forEach(function(Zt){var tr=Zt[0];Zt[1],tr.name.match(/\.iwa/)&&nc(al(tr.content)).forEach(function(Kt){Kt.messages.forEach(function(Bt){F.forEach(function(mr){Kt.messages.some(function(Nr){return js(Nr.meta[1][0].data)!=11006&&(function(Gr,Mn){e:for(var dr=0;dr<=Gr.length-Mn.length;++dr){for(var Gt=0;Gt<Mn.length;++Gt)if(Gr[dr+Gt]!=Mn[Gt])continue e;return!0}return!1})(Nr.data,mr[1])})&&S[mr[0]].deps.push(Kt.id)})})})});for(var O,L=Jt.find(T,S[1].location),B=nc(al(L.content)),ee=0;ee<B.length;++ee){var G=B[ee];G.id==1&&(O=G)}for(var he=hn(Wn(O.messages[0].data)[1][0].data),B=nc(al((L=Jt.find(T,S[he].location)).content)),ee=0;ee<B.length;++ee)(G=B[ee]).id==he&&(O=G);var _t=Wn(O.messages[0].data);for(_t[1]=[{type:2,data:$g(s.SheetNames[0])}],O.messages[0].data=Os(_t),L.content=od(Mu(B)),L.size=L.content.length,he=hn(_t[2][0].data),B=nc(al((L=Jt.find(T,S[he].location)).content)),ee=0;ee<B.length;++ee)(G=B[ee]).id==he&&(O=G);for(he=hn(Wn(O.messages[0].data)[2][0].data),B=nc(al((L=Jt.find(T,S[he].location)).content)),ee=0;ee<B.length;++ee)(G=B[ee]).id==he&&(O=G);g=Wn(O.messages[0].data),g[6][0].data=ha(d.e.r+1),g[7][0].data=ha(d.e.c+1);for(var ne=hn(g[46][0].data),c=Jt.find(T,S[ne].location),J=nc(al(c.content)),ue=0;ue<J.length&&J[ue].id!=ne;++ue);if(J[ue].id!=ne)throw"Bad ColumnRowUIDMapArchive";var be=Wn(J[ue].messages[0].data);be[1]=[],be[2]=[],be[3]=[];for(var we=0;we<=d.e.c;++we)be[1].push({type:2,data:Os([[],[{type:0,data:ha(we+420690)}],[{type:0,data:ha(we+420690)}]])}),be[2].push({type:0,data:ha(we)}),be[3].push({type:0,data:ha(we)});be[4]=[],be[5]=[],be[6]=[];for(var $e=0;$e<=d.e.r;++$e)be[4].push({type:2,data:Os([[],[{type:0,data:ha($e+726270)}],[{type:0,data:ha($e+726270)}]])}),be[5].push({type:0,data:ha($e)}),be[6].push({type:0,data:ha($e)});if(J[ue].messages[0].data=Os(be),c.content=od(Mu(J)),c.size=c.content.length,delete g[46],s=Wn(g[4][0].data),s[7][0].data=ha(d.e.r+1),_t=hn(Wn(s[1][0].data)[2][0].data),(J=nc(al((c=Jt.find(T,S[_t].location)).content)))[0].id!=_t)throw"Bad HeaderStorageBucket";for(var et=Wn(J[0].messages[0].data),$e=0;$e<x.length;++$e){var Xe=Wn(et[2][0].data);Xe[1][0].data=ha($e),Xe[4][0].data=ha(x[$e].length),et[2][$e]={type:et[2][0].type,data:Os(Xe)}}J[0].messages[0].data=Os(et),c.content=od(Mu(J)),c.size=c.content.length;var lt,_t=hn(s[2][0].data);if((J=nc(al((c=Jt.find(T,S[_t].location)).content)))[0].id!=_t)throw"Bad HeaderStorageBucket";for(et=Wn(J[0].messages[0].data),we=0;we<=d.e.c;++we)(Xe=Wn(et[2][0].data))[1][0].data=ha(we),Xe[4][0].data=ha(d.e.r+1),et[2][we]={type:et[2][0].type,data:Os(Xe)};J[0].messages[0].data=Os(et),c.content=od(Mu(J)),c.size=c.content.length,u["!merges"]&&(hr=(function(Zt){for(var tr=927262;tr<2e6;++tr)if(!S[tr])return S[tr]=Zt,tr;throw new Error("Too many messages")})({type:6144,deps:[he],location:S[he].location}),lt=[[],[]],u["!merges"].forEach(function(Zt){lt[1].push({type:2,data:Os([[],[{type:2,data:Os([[],[{type:5,data:new Uint8Array(new Uint16Array([Zt.s.r,Zt.s.c]).buffer)}]])}],[{type:2,data:Os([[],[{type:5,data:new Uint8Array(new Uint16Array([Zt.e.r-Zt.s.r+1,Zt.e.c-Zt.s.c+1]).buffer)}]])}]])})}),s[13]=[{type:2,data:Os([[],[{type:0,data:ha(hr)}]])}],B.push({id:hr,messages:[(qt=6144,hr=Os(lt),{meta:[[],[{type:0,data:ha(qt)}]],data:hr})]}));var Dt=hn(s[4][0].data);(function(){for(var Zt,tr=Jt.find(T,S[Dt].location),Kt=nc(al(tr.content)),Bt=0;Bt<Kt.length;++Bt){var mr=Kt[Bt];mr.id==Dt&&(Zt=mr)}var Nr=Wn(Zt.messages[0].data);Nr[3]=[],b.forEach(function(Gr,Mn){Nr[3].push({type:2,data:Os([[],[{type:0,data:ha(Mn)}],[{type:0,data:ha(1)}],[{type:2,data:$g(Gr)}]])})}),Zt.messages[0].data=Os(Nr),tr.content=od(Mu(Kt)),tr.size=tr.content.length})();var ft=Wn(s[3][0].data),qt=ft[1][0];delete ft[2];var qt,hr,hr=Wn(qt.data),lr=hn(hr[2][0].data);return(function(){for(var Zt,tr=Jt.find(T,S[lr].location),Kt=nc(al(tr.content)),Bt=0;Bt<Kt.length;++Bt){var mr=Kt[Bt];mr.id==lr&&(Zt=mr)}var Nr=Wn(Zt.messages[0].data);delete Nr[6],delete ft[7];var Gr=new Uint8Array(Nr[5][0].data);Nr[5]=[];for(var Mn=0,dr=0;dr<=d.e.r;++dr){var Gt=Wn(Gr);Mn+=(function(bn,Qn,$n){var Sa,Ls;if((Sa=bn[6])==null||!Sa[0]||(Ls=bn[7])==null||!Ls[0])throw"Mutation only works on post-BNC storages!";if((Ls=(Ls=bn[8])==null?void 0:Ls[0])!=null&&Ls.data&&0<js(bn[8][0].data))throw"Math only works with normal offsets";for(var We,Aa,la=0,ki=Ki(bn[7][0].data),ac=0,Ie=[],pt=Ki(bn[4][0].data),qe=0,dt=[],He=0;He<Qn.length;++He)if(Qn[He]!=null){switch(ki.setUint16(2*He,ac,!0),pt.setUint16(2*He,qe,!0),typeof Qn[He]){case"string":We=ld({t:"s",v:Qn[He]},$n),Aa=am({t:"s",v:Qn[He]},$n);break;case"number":We=ld({t:"n",v:Qn[He]},$n),Aa=am({t:"n",v:Qn[He]},$n);break;case"boolean":We=ld({t:"b",v:Qn[He]},$n),Aa=am({t:"b",v:Qn[He]},$n);break;default:throw new Error("Unsupported value "+Qn[He])}Ie.push(We),ac+=We.length,dt.push(Aa),qe+=Aa.length,++la}else ki.setUint16(2*He,65535,!0),pt.setUint16(2*He,65535);for(bn[2][0].data=ha(la);He<bn[7][0].data.length/2;++He)ki.setUint16(2*He,65535,!0),pt.setUint16(2*He,65535,!0);return bn[6][0].data=Pu(Ie),bn[3][0].data=Pu(dt),la})(Gt,x[dr],b),Gt[1][0].data=ha(dr),Nr[5].push({data:Os(Gt),type:2})}Nr[1]=[{type:0,data:ha(d.e.c+1)}],Nr[2]=[{type:0,data:ha(d.e.r+1)}],Nr[3]=[{type:0,data:ha(Mn)}],Nr[4]=[{type:0,data:ha(d.e.r+1)}],Zt.messages[0].data=Os(Nr),tr.content=od(Mu(Kt)),tr.size=tr.content.length})(),qt.data=Os(hr),s[3][0].data=Os(ft),g[4][0].data=Os(s),O.messages[0].data=Os(g),L.content=od(Mu(B)),L.size=L.content.length,T}function h0(s){return function(c){for(var u=0;u!=s.length;++u){var d=s[u];c[d[0]]===void 0&&(c[d[0]]=d[1]),d[2]==="n"&&(c[d[0]]=Number(c[d[0]]))}}}function im(s){h0([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(s)}function S1(s){h0([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(s)}function Xy(s,c){if(!s)return 0;try{s=c.map(function(u){return u.id||(u.id=u.strRelID),[u.name,s["!id"][u.id].Target,(u=s["!id"][u.id].Type,-1<Cn.WS.indexOf(u)?"sheet":Cn.CS&&u==Cn.CS?"chart":Cn.DS&&u==Cn.DS?"dialog":Cn.MS&&u==Cn.MS?"macro":u&&u.length?u:"sheet")]})}catch{return null}return s&&s.length!==0?s:null}function Zy(s,c,u,d,g,x,b,S,N,T,F,O){try{x[d]=Jc(Ya(s,u,!0),c);var L=ss(s,c);switch(S){case"sheet":G=i1(L,c,g,N,x[d],T,F,O);break;case"chart":if(!(G=Eg(L,c,g,N,x[d],T))||!G["!drawel"])break;var ee=hc(G["!drawel"].Target,c),B=xc(ee),J=hc((J=Ya(s,ee,!0),B=Jc(Ya(s,B,!0),ee),J?(J=(J.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],B["!id"][J].Target):"??"),ee),ee=xc(J),G=ts(Ya(s,J,!0),0,0,Jc(Ya(s,ee,!0),J),0,G);break;case"macro":ne=c,x[d],ne.slice(-4),G={"!type":"macro"};break;case"dialog":ne=c,x[d],ne.slice(-4),G={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+S)}b[d]=G;var he=[];x&&x[d]&&fa(x[d]).forEach(function(ue){var be,we,$e,et,Xe,lt,_t="";if(x[d][ue].Type==Cn.CMNT){_t=hc(x[d][ue].Target,c);var Dt=wh(ss(s,_t,!0),_t,N);if(!Dt||!Dt.length)return;jp(G,Dt,!1)}x[d][ue].Type==Cn.TCMNT&&(_t=hc(x[d][ue].Target,c),he=he.concat((be=ss(s,_t,!0),we=N,et=!($e=[]),Xe={},lt=0,be.replace(os,function(ft,qt){var hr=ln(ft);switch(Zs(hr[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":Xe={author:hr.personId,guid:hr.id,ref:hr.ref,T:1};break;case"</threadedComment>":Xe.t!=null&&$e.push(Xe);break;case"<text>":case"<text":lt=qt+ft.length;break;case"</text>":Xe.t=be.slice(lt,qt).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":et=!0;break;case"</mentions>":et=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":et=!0;break;case"</ext>":et=!1;break;default:if(!et&&we.WTF)throw new Error("unrecognized "+hr[0]+" in threaded comments")}return ft}),$e)))}),he&&he.length&&jp(G,he,!0,N.people||[])}catch(ue){if(N.WTF)throw ue}var ne,J}function El(s){return s.charAt(0)=="/"?s.slice(1):s}function om(s,c){if(Jn(),im(c=c||{}),Us(s,"META-INF/manifest.xml")||Us(s,"objectdata.xml"))return sd(s,c);if(Us(s,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(s.FileIndex)return w1(s);var u=Jt.utils.cfb_new();return Vo(s).forEach(function(Kt){mn(u,Kt,(function(mr,Nr,Gr){return $c(ys(mr,Nr))})(s,Kt))}),w1(u)}if(!Us(s,"[Content_Types].xml"))throw Us(s,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Us(s,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var d,g,x=Vo(s),b=(function(Kt){var Bt=bc();if(!Kt||!Kt.match)return Bt;var mr={};if((Kt.match(os)||[]).forEach(function(Nr){var Gr=ln(Nr);switch(Gr[0].replace(yl,"<")){case"<?xml":break;case"<Types":Bt.xmlns=Gr["xmlns"+(Gr[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":mr[Gr.Extension]=Gr.ContentType;break;case"<Override":Bt[bu[Gr.ContentType]]!==void 0&&Bt[bu[Gr.ContentType]].push(Gr.PartName)}}),Bt.xmlns!==ls.CT)throw new Error("Unknown Namespace: "+Bt.xmlns);return Bt.calcchain=0<Bt.calcchains.length?Bt.calcchains[0]:"",Bt.sst=0<Bt.strs.length?Bt.strs[0]:"",Bt.style=0<Bt.styles.length?Bt.styles[0]:"",Bt.defaults=mr,delete Bt.calcchains,Bt})(Ya(s,"[Content_Types].xml")),Xe=!1;if(b.workbooks.length===0&&ss(s,g="xl/workbook.xml",!0)&&b.workbooks.push(g),b.workbooks.length===0){if(!ss(s,g="xl/workbook.bin",!0))throw new Error("Could not find workbook");b.workbooks.push(g),Xe=!0}b.workbooks[0].slice(-3)=="bin"&&(Xe=!0);var S={},N={};if(!c.bookSheets&&!c.bookProps){if(Kd=[],b.sst)try{Kd=l1(ss(s,El(b.sst)),b.sst,c)}catch(Kt){if(c.WTF)throw Kt}c.cellStyles&&b.themes.length&&(ee=Ya(s,b.themes[0].replace(/^\//,""),!0)||"",b.themes[0],S=gh(ee,c)),b.style&&(N=o1(ss(s,El(b.style)),b.style,S,c))}b.links.map(function(Kt){try{return Jc(Ya(s,xc(El(Kt))),Kt),Sh(ss(s,El(Kt)),0,Kt,c)}catch{}});var T,F,O,L=Jp(ss(s,El(b.workbooks[0])),b.workbooks[0],c),B={},ee="";b.coreprops.length&&((ee=ss(s,El(b.coreprops[0]),!0))&&(B=To(ee)),b.extprops.length!==0&&(ee=ss(s,El(b.extprops[0]),!0))&&(G=c,O={},F=(F=B)||{},T=Xn(T=ee),co.forEach(function(Kt){var Bt=(T.match(tn(Kt[0]))||[])[1];switch(Kt[2]){case"string":Bt&&(F[Kt[1]]=cn(Bt));break;case"bool":F[Kt[1]]=Bt==="true";break;case"raw":var mr=T.match(new RegExp("<"+Kt[0]+"[^>]*>([\\s\\S]*?)</"+Kt[0]+">"));mr&&0<mr.length&&(O[Kt[1]]=mr[1])}}),O.HeadingPairs&&O.TitlesOfParts&&Hh(O.HeadingPairs,O.TitlesOfParts,F,G)));var G={};c.bookSheets&&!c.bookProps||b.custprops.length!==0&&(ee=Ya(s,El(b.custprops[0]),!0))&&(G=(function(Kt,Bt){var mr={},Nr="",Gr=Kt.match(Fd);if(Gr)for(var Mn=0;Mn!=Gr.length;++Mn){var dr=Gr[Mn],Gt=ln(dr);switch(Gt[0]){case"<?xml":case"<Properties":break;case"<property":Nr=cn(Gt.name);break;case"</property>":Nr=null;break;default:if(dr.indexOf("<vt:")===0){var bn=dr.split(">"),Qn=bn[0].slice(4),$n=bn[1];switch(Qn){case"lpstr":case"bstr":case"lpwstr":mr[Nr]=cn($n);break;case"bool":mr[Nr]=Ea($n);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":mr[Nr]=parseInt($n,10);break;case"r4":case"r8":case"decimal":mr[Nr]=parseFloat($n);break;case"filetime":case"date":mr[Nr]=vn($n);break;case"cy":case"error":mr[Nr]=cn($n);break;default:if(Qn.slice(-1)=="/")break;Bt.WTF&&typeof console<"u"&&console.warn("Unexpected",dr,Qn,bn)}}else if(dr.slice(0,2)!=="</"&&Bt.WTF)throw new Error(dr)}}return mr})(ee,c));var he={};if((c.bookSheets||c.bookProps)&&(L.Sheets?d=L.Sheets.map(function(Kt){return Kt.name}):B.Worksheets&&0<B.SheetNames.length&&(d=B.SheetNames),c.bookProps&&(he.Props=B,he.Custprops=G),c.bookSheets&&d!==void 0&&(he.SheetNames=d),c.bookSheets?he.SheetNames:c.bookProps))return he;d={},ee={},c.bookDeps&&b.calcchain&&(ee=Ei(ss(s,El(b.calcchain)),b.calcchain));var ne,J,ue=0,be={},we=L.Sheets;B.Worksheets=we.length,B.SheetNames=[];for(var $e=0;$e!=we.length;++$e)B.SheetNames[$e]=we[$e].name;var et=Xe?"bin":"xml",Xe=b.workbooks[0].lastIndexOf("/"),lt=(b.workbooks[0].slice(0,Xe+1)+"_rels/"+b.workbooks[0].slice(Xe+1)+".rels").replace(/^\//,"");Us(s,lt)||(lt="xl/_rels/workbook."+et+".rels");var _t,Dt,ft,qt=Jc(Ya(s,lt,!0),lt.replace(/_rels.*/,"s5s"));1<=(b.metadata||[]).length&&(c.xlmeta=tf(ss(s,El(b.metadata[0])),b.metadata[0],c)),1<=(b.people||[]).length&&(c.people=(Xe=ss(s,El(b.people[0])),_t=c,ft=!(Dt=[]),Xe.replace(os,function(Kt){var Bt=ln(Kt);switch(Zs(Bt[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":Dt.push({name:Bt.displayname,id:Bt.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":ft=!0;break;case"</ext>":ft=!1;break;default:if(!ft&&_t.WTF)throw new Error("unrecognized "+Bt[0]+" in threaded comments")}return Kt}),Dt)),qt=qt&&Xy(qt,L.Sheets);var hr=ss(s,"xl/worksheets/sheet.xml",!0)?1:0;e:for(ue=0;ue!=B.Worksheets;++ue){var lr="sheet";if(qt&&qt[ue]?(ne="xl/"+qt[ue][1].replace(/[\/]?xl\//,""),Us(s,ne)||(ne=qt[ue][1]),Us(s,ne)||(ne=lt.replace(/_rels\/.*$/,"")+qt[ue][1]),lr=qt[ue][2]):ne=(ne="xl/worksheets/sheet"+(ue+1-hr)+"."+et).replace(/sheet0\./,"sheet."),J=ne.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),c&&c.sheets!=null)switch(typeof c.sheets){case"number":if(ue!=c.sheets)continue e;break;case"string":if(B.SheetNames[ue].toLowerCase()!=c.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(c.sheets)){for(var Zt=!1,tr=0;tr!=c.sheets.length;++tr)typeof c.sheets[tr]=="number"&&c.sheets[tr]==ue&&(Zt=1),typeof c.sheets[tr]=="string"&&c.sheets[tr].toLowerCase()==B.SheetNames[ue].toLowerCase()&&(Zt=1);if(!Zt)continue e}}Zy(s,ne,J,B.SheetNames[ue],ue,be,d,lr,c,L,S,N)}return he={Directory:b,Workbook:L,Props:B,Custprops:G,Deps:ee,Sheets:d,SheetNames:B.SheetNames,Strings:Kd,Styles:N,Themes:S,SSF:jn(se)},c&&c.bookFiles&&(s.files?(he.keys=x,he.files=s.files):(he.keys=[],he.files={},s.FullPaths.forEach(function(Kt,Bt){Kt=Kt.replace(/^Root Entry[\/]/,""),he.keys.push(Kt),he.files[Kt]=s.FileIndex[Bt]}))),c&&c.bookVBA&&(0<b.vba.length?he.vbaraw=ss(s,El(b.vba[0]),!0):b.defaults&&b.defaults.bin===pi&&(he.vbaraw=ss(s,"xl/vbaProject.bin",!0))),he}function Va(s,c){var u,d=c||{},g="Workbook",x=Jt.find(s,g);try{if(g="/!DataSpaces/Version",!(x=Jt.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(b=x.content,(u={}).id=b.read_shift(0,"lpp4"),u.R=fo(b,4),u.U=fo(b,4),u.W=fo(b,4),g="/!DataSpaces/DataSpaceMap",!(x=Jt.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);var b=Ld(x.content);if(b.length!==1||b[0].comps.length!==1||b[0].comps[0].t!==0||b[0].name!=="StrongEncryptionDataSpace"||b[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(x=Jt.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(b=(function(S){var N=[];S.l+=4;for(var T=S.read_shift(4);0<T--;)N.push(S.read_shift(0,"lpp4"));return N})(x.content),b.length!=1||b[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(x=Jt.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);Pd(x.content)}catch{}if(g="/EncryptionInfo",!(x=Jt.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(c=Mf(x.content),g="/EncryptedPackage",!(x=Jt.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],x.content,d.password||"",d);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],x.content,d.password||"",d);throw new Error("File is password-protected")}function lm(s,c){return(c.bookType=="ods"?Lu:c.bookType=="numbers"?u0:c.bookType=="xlsb"?function(u,d){yh=1024,u&&!u.SSF&&(u.SSF=jn(se)),u&&u.SSF&&(Jn(),Lr(u.SSF),d.revssf=qo(u.SSF),d.revssf[u.SSF[65535]]=0,d.ssf=u.SSF),d.rels={},d.wbrels={},d.Strings=[],d.Strings.Count=0,d.Strings.Unique=0,Yd?d.revStrings=new Map:(d.revStrings={},d.revStrings.foo=[],delete d.revStrings.foo);var g=d.bookType=="xlsb"?"bin":"xml",x=-1<Vi.indexOf(d.bookType),b=bc();S1(d=d||{});var S=fu(),N="",T=0;if(d.cellXfs=[],Iu(d.cellXfs,{},{revssf:{General:0}}),u.Props||(u.Props={}),mn(S,N="docProps/core.xml",wu(u.Props,d)),b.coreprops.push(N),sa(d.rels,2,N,Cn.CORE_PROPS),N="docProps/app.xml",!u.Props||!u.Props.SheetNames)if(u.Workbook&&u.Workbook.Sheets){for(var F=[],O=0;O<u.SheetNames.length;++O)(u.Workbook.Sheets[O]||{}).Hidden!=2&&F.push(u.SheetNames[O]);u.Props.SheetNames=F}else u.Props.SheetNames=u.SheetNames;for(u.Props.Worksheets=u.Props.SheetNames.length,mn(S,N,Su(u.Props)),b.extprops.push(N),sa(d.rels,3,N,Cn.EXT_PROPS),u.Custprops!==u.Props&&0<fa(u.Custprops||{}).length&&(mn(S,N="docProps/custom.xml",Eo(u.Custprops)),b.custprops.push(N),sa(d.rels,4,N,Cn.CUST_PROPS)),T=1;T<=u.SheetNames.length;++T){var L,B,ee,G={"!id":{}},he=u.Sheets[u.SheetNames[T-1]];mn(S,N="xl/worksheets/sheet"+T+"."+g,(function(ne,J,ue,be,we){return(J.slice(-4)===".bin"?Na:r1)(ne,ue,be,we)})(T-1,N,d,u,G)),b.sheets.push(N),sa(d.wbrels,-1,"worksheets/sheet"+T+"."+g,Cn.WS[0]),he&&(L=he["!comments"],B=!1,ee="",L&&0<L.length&&(mn(S,ee="xl/comments"+T+"."+g,(function(ne,J,ue){return(J.slice(-4)===".bin"?Op:dg)(ne)})(L,ee)),b.comments.push(ee),sa(G,-1,"../comments"+T+"."+g,Cn.CMNT),B=!0),he["!legacy"]&&B&&mn(S,"xl/drawings/vmlDrawing"+T+".vml",Rp(T,he["!comments"])),delete he["!comments"],delete he["!legacy"]),G["!id"].rId1&&mn(S,xc(N),lo(G))}return d.Strings!=null&&0<d.Strings.length&&(mn(S,N="xl/sharedStrings."+g,(function(ne,J,ue){return(J.slice(-4)===".bin"?Jl:Tu)(ne,ue)})(d.Strings,N,d)),b.strs.push(N),sa(d.wbrels,-1,"sharedStrings."+g,Cn.SST)),mn(S,N="xl/workbook."+g,(function(ne,J,ue){return(J.slice(-4)===".bin"?nl:s1)(ne)})(u,N)),b.workbooks.push(N),sa(d.rels,1,N,Cn.WB),mn(S,N="xl/theme/theme1.xml",G0(u.Themes,d)),b.themes.push(N),sa(d.wbrels,-1,"theme/theme1.xml",Cn.THEME),mn(S,N="xl/styles."+g,(function(ne,J,ue){return(J.slice(-4)===".bin"?sg:Ep)(ne,ue)})(u,N,d)),b.styles.push(N),sa(d.wbrels,-1,"styles."+g,Cn.STY),u.vbaraw&&x&&(mn(S,N="xl/vbaProject.bin",u.vbaraw),b.vba.push(N),sa(d.wbrels,-1,"vbaProject.bin",Cn.VBA)),mn(S,N="xl/metadata."+g,(function(ne){return(ne.slice(-4)===".bin"?V0:Fp)()})(N)),b.metadata.push(N),sa(d.wbrels,-1,"metadata."+g,Cn.XLMETA),mn(S,"[Content_Types].xml",Uh(b,d)),mn(S,"_rels/.rels",lo(d.rels)),mn(S,"xl/_rels/workbook."+g+".rels",lo(d.wbrels)),delete d.revssf,delete d.ssf,S}:Yi)(s,c)}function Yi(s,c){yh=1024,s&&!s.SSF&&(s.SSF=jn(se)),s&&s.SSF&&(Jn(),Lr(s.SSF),c.revssf=qo(s.SSF),c.revssf[s.SSF[65535]]=0,c.ssf=s.SSF),c.rels={},c.wbrels={},c.Strings=[],c.Strings.Count=0,c.Strings.Unique=0,Yd?c.revStrings=new Map:(c.revStrings={},c.revStrings.foo=[],delete c.revStrings.foo);var u="xml",d=-1<Vi.indexOf(c.bookType),g=bc();S1(c=c||{});var x=fu(),b="",S=0;if(c.cellXfs=[],Iu(c.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),b="docProps/core.xml",mn(x,b,wu(s.Props,c)),g.coreprops.push(b),sa(c.rels,2,b,Cn.CORE_PROPS),b="docProps/app.xml",!s.Props||!s.Props.SheetNames)if(s.Workbook&&s.Workbook.Sheets){for(var N=[],T=0;T<s.SheetNames.length;++T)(s.Workbook.Sheets[T]||{}).Hidden!=2&&N.push(s.SheetNames[T]);s.Props.SheetNames=N}else s.Props.SheetNames=s.SheetNames;s.Props.Worksheets=s.Props.SheetNames.length,mn(x,b,Su(s.Props)),g.extprops.push(b),sa(c.rels,3,b,Cn.EXT_PROPS),s.Custprops!==s.Props&&0<fa(s.Custprops||{}).length&&(mn(x,b="docProps/custom.xml",Eo(s.Custprops)),g.custprops.push(b),sa(c.rels,4,b,Cn.CUST_PROPS));var F,O=["SheetJ5"];for(c.tcid=0,S=1;S<=s.SheetNames.length;++S){var L,B,ee,G,he={"!id":{}},ne=s.Sheets[s.SheetNames[S-1]];mn(x,b="xl/worksheets/sheet"+S+"."+u,r1(S-1,c,s,he)),g.sheets.push(b),sa(c.wbrels,-1,"worksheets/sheet"+S+"."+u,Cn.WS[0]),ne&&(B=!1,ee="",(L=ne["!comments"])&&0<L.length&&(G=!1,L.forEach(function(J){J[1].forEach(function(ue){ue.T==1&&(G=!0)})}),G&&(mn(x,ee="xl/threadedComments/threadedComment"+S+"."+u,(function(J,ue,be){var we=[is,Xt("ThreadedComments",null,{xmlns:ls.TCMNT}).replace(/[\/]>/,">")];return J.forEach(function($e){var et="";($e[1]||[]).forEach(function(Xe,lt){var _t;Xe.T?(Xe.a&&ue.indexOf(Xe.a)==-1&&ue.push(Xe.a),_t={ref:$e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+be.tcid++).slice(-12)+"}"},lt==0?et=_t.id:_t.parentId=et,Xe.ID=_t.id,Xe.a&&(_t.personId="{54EE7950-7262-4200-6969-"+("000000000000"+ue.indexOf(Xe.a)).slice(-12)+"}"),we.push(Xt("threadedComment",vs("text",Xe.t||""),_t))):delete Xe.ID})}),we.push("</ThreadedComments>"),we.join("")})(L,O,c)),g.threadedcomments.push(ee),sa(he,-1,"../threadedComments/threadedComment"+S+"."+u,Cn.TCMNT)),mn(x,ee="xl/comments"+S+"."+u,dg(L)),g.comments.push(ee),sa(he,-1,"../comments"+S+"."+u,Cn.CMNT),B=!0),ne["!legacy"]&&B&&mn(x,"xl/drawings/vmlDrawing"+S+".vml",Rp(S,ne["!comments"])),delete ne["!comments"],delete ne["!legacy"]),he["!id"].rId1&&mn(x,xc(b),lo(he))}return c.Strings!=null&&0<c.Strings.length&&(mn(x,b="xl/sharedStrings.xml",Tu(c.Strings,c)),g.strs.push(b),sa(c.wbrels,-1,"sharedStrings.xml",Cn.SST)),mn(x,b="xl/workbook.xml",s1(s)),g.workbooks.push(b),sa(c.rels,1,b,Cn.WB),mn(x,b="xl/theme/theme1.xml",G0(s.Themes,c)),g.themes.push(b),sa(c.wbrels,-1,"theme/theme1.xml",Cn.THEME),mn(x,b="xl/styles.xml",Ep(s,c)),g.styles.push(b),sa(c.wbrels,-1,"styles.xml",Cn.STY),s.vbaraw&&d&&(mn(x,b="xl/vbaProject.bin",s.vbaraw),g.vba.push(b),sa(c.wbrels,-1,"vbaProject.bin",Cn.VBA)),mn(x,b="xl/metadata.xml",Fp()),g.metadata.push(b),sa(c.wbrels,-1,"metadata.xml",Cn.XLMETA),1<O.length&&(mn(x,b="xl/persons/person.xml",(d=O,F=[is,Xt("personList",null,{xmlns:ls.TCMNT,"xmlns:x":Jo[0]}).replace(/[\/]>/,">")],d.forEach(function(J,ue){F.push(Xt("person",null,{displayName:J,id:"{54EE7950-7262-4200-6969-"+("000000000000"+ue).slice(-12)+"}",userId:J,providerId:"None"}))}),F.push("</personList>"),F.join(""))),g.people.push(b),sa(c.wbrels,-1,"persons/person.xml",Cn.PEOPLE)),mn(x,"[Content_Types].xml",Uh(g,c)),mn(x,"_rels/.rels",lo(c.rels)),mn(x,"xl/_rels/workbook.xml.rels",lo(c.wbrels)),delete c.revssf,delete c.ssf,x}function cm(s,c){var u="";switch((c||{}).type||"base64"){case"buffer":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];case"base64":u=re(s.slice(0,12));break;case"binary":u=s;break;case"array":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];default:throw new Error("Unrecognized type "+(c&&c.type||"undefined"))}return[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3),u.charCodeAt(4),u.charCodeAt(5),u.charCodeAt(6),u.charCodeAt(7)]}function um(s,c){var u=0;e:for(;u<s.length;)switch(s.charCodeAt(u)){case 10:case 13:case 32:++u;break;case 60:return Oo(s.slice(u),c);default:break e}return Hn.to_workbook(s,c)}function hm(s,c,u,d){return d?(u.type="string",Hn.to_workbook(s,u)):Hn.to_workbook(c,u)}function sf(s,c){R();var u=c||{};if(typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer)return sf(new Uint8Array(s),((u=jn(u)).type="array",u));typeof Uint8Array<"u"&&s instanceof Uint8Array&&!u.type&&(u.type=typeof Deno<"u"?"buffer":"array");var d,g,x,b,S,N=s,T=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),bh={},u.dateNF&&(bh.dateNF=u.dateNF),u.type||(u.type=xe&&Buffer.isBuffer(s)?"buffer":"base64"),u.type=="file"&&(u.type=xe?"buffer":"binary",N=(function(O){if(fn!==void 0)return fn.readFileSync(O);if(typeof Deno<"u")return Deno.readFileSync(O);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var L=File(O);L.open("r"),L.encoding="binary";var B=L.read();return L.close(),B}catch(ee){if(!ee.message||!ee.message.match(/onstruct/))throw ee}throw new Error("Cannot access file "+O)})(s),typeof Uint8Array>"u"||xe||(u.type="array")),u.type=="string"&&(T=!0,u.type="binary",u.codepage=65001,N=(F=s).match(/[^\x00-\x7F]/)?xi(F):F),u.type=="array"&&typeof Uint8Array<"u"&&s instanceof Uint8Array&&typeof ArrayBuffer<"u"){var F=new ArrayBuffer(3),F=new Uint8Array(F);if(F.foo="bar",!F.foo)return(u=jn(u)).type="array",sf(K(N),u)}switch((d=cm(N,u))[0]){case 208:if(d[1]===207&&d[2]===17&&d[3]===224&&d[4]===161&&d[5]===177&&d[6]===26&&d[7]===225)return b=Jt.read(N,u),S=u,(Jt.find(b,"EncryptedPackage")?Va:i0)(b,S);break;case 9:if(d[1]<=8)return i0(N,u);break;case 60:return Oo(N,u);case 73:if(d[1]===73&&d[2]===42&&d[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(d[1]===68)return(function(O,L){var B=L||{},ee=!!B.WTF;B.WTF=!0;try{var G=Er.to_workbook(O,B);return B.WTF=ee,G}catch(he){if(B.WTF=ee,!he.message.match(/SYLK bad record ID/)&&ee)throw he;return Hn.to_workbook(O,L)}})(N,u);break;case 84:if(d[1]===65&&d[2]===66&&d[3]===76)return En.to_workbook(N,u);break;case 80:return d[1]===75&&d[2]<9&&d[3]<9?(x=S=N,(g=(g=u)||{}).type||(g.type=xe&&Buffer.isBuffer(S)?"buffer":"base64"),om(eh(x,g),g)):hm(s,N,u,T);case 239:return d[3]===60?Oo(N,u):hm(s,N,u,T);case 255:if(d[1]===254)return x=N,(g=u).type=="base64"&&(x=re(x)),x=e.utils.decode(1200,x.slice(2),"str"),g.type="binary",um(x,g);if(d[1]===0&&d[2]===2&&d[3]===0)return oa.to_workbook(N,u);break;case 0:if(d[1]===0&&(2<=d[2]&&d[3]===0||d[2]===0&&(d[3]===8||d[3]===9)))return oa.to_workbook(N,u);break;case 3:case 131:case 139:case 140:return kt.to_workbook(N,u);case 123:if(d[1]===92&&d[2]===114&&d[3]===116)return Zc.to_workbook(N,u);break;case 10:case 13:case 32:return(function(O,L){var B="",ee=cm(O,L);switch(L.type){case"base64":B=re(O);break;case"binary":B=O;break;case"buffer":B=O.toString("binary");break;case"array":B=Cs(O);break;default:throw new Error("Unrecognized type "+L.type)}return ee[0]==239&&ee[1]==187&&ee[2]==191&&(B=Xn(B)),L.type="binary",um(B,L)})(N,u);case 137:if(d[1]===80&&d[2]===78&&d[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<wt.indexOf(d[0])&&d[2]<=12&&d[3]<=31?kt.to_workbook(N,u):hm(s,N,u,T)}function A1(s,c){return c=c||{},c.type="file",sf(s,c)}function d0(s,c){switch(c.type){case"base64":case"binary":break;case"buffer":case"array":c.type="";break;case"file":return Vs(c.file,Jt.write(s,{type:xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");default:throw new Error("Unrecognized type "+c.type)}return Jt.write(s,c)}function dm(s,c){var u={},d=xe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(c.compression&&(u.compression="DEFLATE"),c.password)u.type=d;else switch(c.type){case"base64":u.type="base64";break;case"binary":u.type="string";break;case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");case"buffer":case"file":u.type=d;break;default:throw new Error("Unrecognized type "+c.type)}if(s=s.FullPaths?Jt.write(s,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[u.type]||u.type,compression:!!c.compression}):s.generate(u),typeof Deno<"u"&&typeof s=="string"){if(c.type=="binary"||c.type=="base64")return s;s=new Uint8Array(Oe(s))}return c.password&&typeof encrypt_agile<"u"?d0(encrypt_agile(s,c.password),c):c.type==="file"?Vs(c.file,s):c.type=="string"?Xn(s):s}function jc(s,c,u){var d=(u=u||"")+s;switch(c.type){case"base64":return W(xi(d));case"binary":return xi(d);case"string":return s;case"file":return Vs(c.file,d,"utf8");case"buffer":return xe?ve(d,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(d):jc(d,{type:"binary"}).split("").map(function(g){return g.charCodeAt(0)})}throw new Error("Unrecognized type "+c.type)}function of(s,c){switch(c.type){case"string":case"base64":case"binary":for(var u="",d=0;d<s.length;++d)u+=String.fromCharCode(s[d]);return c.type=="base64"?W(u):c.type=="string"?Xn(u):u;case"file":return Vs(c.file,s);case"buffer":return s;default:throw new Error("Unrecognized type "+c.type)}}function f0(s,c){R(),Ou(s);var u,d=jn(c||{});return d.cellStyles&&(d.cellNF=!0,d.sheetStubs=!0),d.type!="array"?(u=s,c=jn((c=d)||{}),dm(Yi(u,c),c)):(d.type="binary",s=f0(s,d),d.type="array",Oe(s))}function C1(s,c){R(),Ou(s);var u=jn(c||{});if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),u.type=="array")return u.type="binary",c=C1(s,u),u.type="array",Oe(c);var d,g,x,b=0;if(u.sheet&&(b=typeof u.sheet=="number"?u.sheet:s.SheetNames.indexOf(u.sheet),!s.SheetNames[b]))throw new Error("Sheet not found: "+u.sheet+" : "+typeof u.sheet);switch(u.bookType||"xlsb"){case"xml":case"xlml":return jc(Ah(s,u),u);case"slk":case"sylk":return jc(Er.from_sheet(s.Sheets[s.SheetNames[b]],u),u);case"htm":case"html":return jc(Ug(s.Sheets[s.SheetNames[b]],u),u);case"txt":return(function(S,N){switch(N.type){case"base64":return W(S);case"binary":case"string":return S;case"file":return Vs(N.file,S,"binary");case"buffer":return xe?ve(S,"binary"):S.split("").map(function(T){return T.charCodeAt(0)})}throw new Error("Unrecognized type "+N.type)})(pm(s.Sheets[s.SheetNames[b]],u),u);case"csv":return jc(E1(s.Sheets[s.SheetNames[b]],u),u,"\uFEFF");case"dif":return jc(En.from_sheet(s.Sheets[s.SheetNames[b]],u),u);case"dbf":return of(kt.from_sheet(s.Sheets[s.SheetNames[b]],u),u);case"prn":return jc(Hn.from_sheet(s.Sheets[s.SheetNames[b]],u),u);case"rtf":return jc(Zc.from_sheet(s.Sheets[s.SheetNames[b]],u),u);case"eth":return jc(Ma.from_sheet(s.Sheets[s.SheetNames[b]],u),u);case"fods":return jc(Lu(s,u),u);case"wk1":return of(oa.sheet_to_wk1(s.Sheets[s.SheetNames[b]],u),u);case"wk3":return of(oa.book_to_wk3(s,u),u);case"biff2":u.biff||(u.biff=2);case"biff3":u.biff||(u.biff=3);case"biff4":return u.biff||(u.biff=4),of(Zp(s,u),u);case"biff5":u.biff||(u.biff=5);case"biff8":case"xla":case"xls":return u.biff||(u.biff=8),d0(d1(s,x=(x=u)||{}),x);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return d=s,x=jn((g=u)||{}),qf=new Kg(g),dm(lm(d,x),x);default:throw new Error("Unrecognized bookType |"+u.bookType+"|")}}function N1(s){var c;s.bookType||((c=s.file.slice(s.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(s.bookType=c.slice(1)),s.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[s.bookType]||s.bookType)}function Vg(s,c,u){return u=u||{},u.type="file",u.file=c,N1(u),C1(s,u)}function fm(s,c,u,d,g,x,b,S){var N=ja(u),T=S.defval,F=S.raw||!Object.prototype.hasOwnProperty.call(S,"raw"),O=!0,L=g===1?[]:{};if(g!==1)if(Object.defineProperty)try{Object.defineProperty(L,"__rowNum__",{value:u,enumerable:!1})}catch{L.__rowNum__=u}else L.__rowNum__=u;if(!b||s[u])for(var B=c.s.c;B<=c.e.c;++B){var ee=b?s[u][B]:s[d[B]+N];if(ee!==void 0&&ee.t!==void 0){var G=ee.v;switch(ee.t){case"z":if(G==null)break;continue;case"e":G=G==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+ee.t)}if(x[B]!=null){if(G==null)if(ee.t=="e"&&G===null)L[x[B]]=null;else if(T!==void 0)L[x[B]]=T;else{if(!F||G!==null)continue;L[x[B]]=null}else L[x[B]]=F&&(ee.t!=="n"||ee.t==="n"&&S.rawNumbers!==!1)?G:io(ee,G,S);G!=null&&(O=!1)}}else T!==void 0&&x[B]!=null&&(L[x[B]]=T)}return{row:L,isempty:O}}function T1(s,c){if(s==null||s["!ref"]==null)return[];var u,d={t:"n",v:0},g=0,x=1,b=[],S="",N={s:{r:0,c:0},e:{r:0,c:0}},T=c||{},F=T.range!=null?T.range:s["!ref"];switch(T.header===1?g=1:T.header==="A"?g=2:Array.isArray(T.header)?g=3:T.header==null&&(g=0),typeof F){case"string":N=wn(F);break;case"number":(N=wn(s["!ref"])).s.r=F;break;default:N=F}0<g&&(x=0);var O=ja(N.s.r),L=[],B=[],ee=0,G=0,he=Array.isArray(s),ne=N.s.r,J=0,ue={};he&&!s[ne]&&(s[ne]=[]);for(var be,we=T.skipHidden&&s["!cols"]||[],$e=T.skipHidden&&s["!rows"]||[],J=N.s.c;J<=N.e.c;++J)if(!(we[J]||{}).hidden)switch(L[J]=Ln(J),d=he?s[ne][J]:s[L[J]+O],g){case 1:b[J]=J-N.s.c;break;case 2:b[J]=L[J];break;case 3:b[J]=T.header[J-N.s.c];break;default:if(S=u=io(d=d??{w:"__EMPTY",t:"s"},null,T),G=ue[u]||0){for(;S=u+"_"+G++,ue[S];);ue[u]=G,ue[S]=1}else ue[u]=1;b[J]=S}for(ne=N.s.r+x;ne<=N.e.r;++ne)($e[ne]||{}).hidden||(be=fm(s,N,ne,L,g,b,he,T)).isempty!==!1&&(g===1?T.blankrows===!1:!T.blankrows)||(B[ee++]=be.row);return B.length=ee,B}var Wg=/"/g;function Uu(s,c,u,d,g,x,b,S){for(var N=!0,T=[],F="",O=ja(u),L=c.s.c;L<=c.e.c;++L)if(d[L]){var B=S.dense?(s[u]||[])[L]:s[d[L]+O];if(B==null)F="";else if(B.v!=null){N=!1,F=""+(S.rawNumbers&&B.t=="n"?B.v:io(B,null,S));for(var ee,G=0;G!==F.length;++G)if((ee=F.charCodeAt(G))===g||ee===x||ee===34||S.forceQuotes){F='"'+F.replace(Wg,'""')+'"';break}F=="ID"&&(F='"ID"')}else B.f==null||B.F?F="":(N=!1,0<=(F="="+B.f).indexOf(",")&&(F='"'+F.replace(Wg,'""')+'"'));T.push(F)}return S.blankrows===!1&&N?null:T.join(b)}function E1(s,c){var u=[],d=c??{};if(s==null||s["!ref"]==null)return"";var g=wn(s["!ref"]),x=d.FS!==void 0?d.FS:",",b=x.charCodeAt(0),S=d.RS!==void 0?d.RS:`
`,N=S.charCodeAt(0),T=new RegExp((x=="|"?"\\|":x)+"+$"),F="",O=[];d.dense=Array.isArray(s);for(var L=d.skipHidden&&s["!cols"]||[],B=d.skipHidden&&s["!rows"]||[],ee=g.s.c;ee<=g.e.c;++ee)(L[ee]||{}).hidden||(O[ee]=Ln(ee));for(var G=0,he=g.s.r;he<=g.e.r;++he)(B[he]||{}).hidden||(F=Uu(s,g,he,O,b,N,x,d))!=null&&(!(F=d.strip?F.replace(T,""):F)&&d.blankrows===!1||u.push((G++?S:"")+F));return delete d.dense,u.join("")}function pm(s,c){return(c=c||{}).FS="	",c.RS=`
`,s=E1(s,c),e===void 0||c.type=="string"?s:(s=e.utils.encode(1200,s,"str"),""+s)}function k1(F,c,u){var d,g=u||{},x=+!g.skipHeader,b=F||{},S=0,N=0;b&&g.origin!=null&&(typeof g.origin=="number"?S=g.origin:(T=typeof g.origin=="string"?ga(g.origin):g.origin,S=T.r,N=T.c));var T,F={s:{c:0,r:0},e:{c:N,r:S+c.length-1+x}};b["!ref"]?(T=wn(b["!ref"]),F.e.c=Math.max(F.e.c,T.e.c),F.e.r=Math.max(F.e.r,T.e.r),S==-1&&(S=T.e.r+1,F.e.r=S+c.length-1+x)):S==-1&&(S=0,F.e.r=c.length-1+x);var O=g.header||[],L=0;c.forEach(function(ee,G){fa(ee).forEach(function(be){(L=O.indexOf(be))==-1&&(O[L=O.length]=be);var ne=ee[be],J="z",ue="",be=sn({c:N+L,r:S+G+x});d=_1(b,be),!ne||typeof ne!="object"||ne instanceof Date?(typeof ne=="number"?J="n":typeof ne=="boolean"?J="b":typeof ne=="string"?J="s":ne instanceof Date?(J="d",g.cellDates||(J="n",ne=pa(ne)),ue=g.dateNF||se[14]):ne===null&&g.nullError&&(J="e",ne=0),d?(d.t=J,d.v=ne,delete d.w,delete d.R,ue&&(d.z=ue)):b[be]=d={t:J,v:ne},ue&&(d.z=ue)):b[be]=ne})}),F.e.c=Math.max(F.e.c,N+O.length-1);var B=ja(S);if(x)for(L=0;L<O.length;++L)b[Ln(L+N)+B]={t:"s",v:O[L]};return b["!ref"]=rn(F),b}function _1(s,c,u){return typeof c!="string"?_1(s,sn(typeof c!="number"?c:{r:c,c:u||0})):Array.isArray(s)?(u=ga(c),s[u.r]||(s[u.r]=[]),s[u.r][u.c]||(s[u.r][u.c]={t:"z"})):s[c]||(s[c]={t:"z"})}function mm(){return{SheetNames:[],Sheets:{}}}function I1(s,c,u,d){var g=1;if(!u)for(;g<=65535&&s.SheetNames.indexOf(u="Sheet"+g)!=-1;++g,u=void 0);if(!u||65535<=s.SheetNames.length)throw new Error("Too many worksheets");if(d&&0<=s.SheetNames.indexOf(u)){var d=u.match(/(^.*?)(\d+)$/),g=d&&+d[2]||0,x=d&&d[1]||u;for(++g;g<=65535&&s.SheetNames.indexOf(u=x+g)!=-1;++g);}if(qs(u),0<=s.SheetNames.indexOf(u))throw new Error("Worksheet with name |"+u+"| already exists!");return s.SheetNames.push(u),s.Sheets[u]=c,u}function D1(s,c,u){return c?(s.l={Target:c},u&&(s.l.Tooltip=u)):delete s.l,s}var lf,gm={encode_col:Ln,encode_row:ja,encode_cell:sn,encode_range:rn,decode_col:Qo,decode_row:Hl,split_cell:function(s){return s.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ga,decode_range:ti,format_cell:io,sheet_add_aoa:mc,sheet_add_json:k1,sheet_add_dom:rm,aoa_to_sheet:ri,json_to_sheet:function(s,c){return k1(null,s,c)},table_to_sheet:Bg,table_to_book:function(s,c){return oi(Bg(s,c),c)},sheet_to_csv:E1,sheet_to_txt:pm,sheet_to_json:T1,sheet_to_html:Ug,sheet_to_formulae:function(s){var c,u="",d="";if(s==null||s["!ref"]==null)return[];for(var g,x=wn(s["!ref"]),b=[],S=[],N=Array.isArray(s),T=x.s.c;T<=x.e.c;++T)b[T]=Ln(T);for(var F=x.s.r;F<=x.e.r;++F)for(g=ja(F),T=x.s.c;T<=x.e.c;++T)if(u=b[T]+g,d="",(c=N?(s[F]||[])[T]:s[u])!==void 0){if(c.F!=null){if(u=c.F,!c.f)continue;d=c.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(c.f!=null)d=c.f;else{if(c.t=="z")continue;if(c.t=="n"&&c.v!=null)d=""+c.v;else if(c.t=="b")d=c.v?"TRUE":"FALSE";else if(c.w!==void 0)d="'"+c.w;else{if(c.v===void 0)continue;d=c.t=="s"?"'"+c.v:""+c.v}}S[S.length]=u+"="+d}return S},sheet_to_row_object_array:T1,sheet_get_cell:_1,book_new:mm,book_append_sheet:I1,book_set_sheet_visibility:function(s,c,u){switch(s.Workbook||(s.Workbook={}),s.Workbook.Sheets||(s.Workbook.Sheets=[]),c=(function(d,g){if(typeof g=="number"){if(0<=g&&d.SheetNames.length>g)return g;throw new Error("Cannot find sheet # "+g)}if(typeof g!="string")throw new Error("Cannot find sheet |"+g+"|");if(-1<(d=d.SheetNames.indexOf(g)))return d;throw new Error("Cannot find sheet name |"+g+"|")})(s,c),s.Workbook.Sheets[c]||(s.Workbook.Sheets[c]={}),u){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+u)}s.Workbook.Sheets[c].Hidden=u},cell_set_number_format:function(s,c){return s.z=c,s},cell_set_hyperlink:D1,cell_set_internal_link:function(s,c,u){return D1(s,"#"+c,u)},cell_add_comment:function(s,c,u){s.c||(s.c=[]),s.c.push({t:c,a:u||"SheetJS"})},sheet_set_array_formula:function(s,c,u,d){for(var g=typeof c!="string"?c:wn(c),x=typeof c=="string"?c:rn(c),b=g.s.r;b<=g.e.r;++b)for(var S=g.s.c;S<=g.e.c;++S){var N=_1(s,b,S);N.t="n",N.F=x,delete N.v,b==g.s.r&&S==g.s.c&&(N.f=u,d&&(N.D=!0))}return s},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function kl(s){lf=s}var Ch={to_json:function(s,c){var u=lf({objectMode:!0});if(s==null||s["!ref"]==null)return u.push(null),u;var d,g={t:"n",v:0},x=0,b=1,S=[],N="",T={s:{r:0,c:0},e:{r:0,c:0}},F=c||{},O=F.range!=null?F.range:s["!ref"];switch(F.header===1?x=1:F.header==="A"?x=2:Array.isArray(F.header)&&(x=3),typeof O){case"string":T=wn(O);break;case"number":(T=wn(s["!ref"])).s.r=O;break;default:T=O}0<x&&(b=0);var L=ja(T.s.r),B=[],ee=0,G=Array.isArray(s),he=T.s.r,ne=0,J={};G&&!s[he]&&(s[he]=[]);for(var ue=F.skipHidden&&s["!cols"]||[],be=F.skipHidden&&s["!rows"]||[],ne=T.s.c;ne<=T.e.c;++ne)if(!(ue[ne]||{}).hidden)switch(B[ne]=Ln(ne),g=G?s[he][ne]:s[B[ne]+L],x){case 1:S[ne]=ne-T.s.c;break;case 2:S[ne]=B[ne];break;case 3:S[ne]=F.header[ne-T.s.c];break;default:if(N=d=io(g=g??{w:"__EMPTY",t:"s"},null,F),ee=J[d]||0){for(;N=d+"_"+ee++,J[N];);J[d]=ee,J[N]=1}else J[d]=1;S[ne]=N}return he=T.s.r+b,u._read=function(){for(;he<=T.e.r;)if(!(be[he-1]||{}).hidden){var we=fm(s,T,he,B,x,S,G,F);if(++he,we.isempty===!1||(x===1?F.blankrows!==!1:F.blankrows))return void u.push(we.row)}return u.push(null)},u},to_html:function(s,g){var u=lf(),d=g||{},g=d.header!=null?d.header:tm,x=d.footer!=null?d.footer:ka;u.push(g);var b=ti(s["!ref"]);d.dense=Array.isArray(s),u.push(p1(0,0,d));var S=b.s.r,N=!1;return u._read=function(){if(S>b.e.r)return N||(N=!0,u.push("</table>"+x)),u.push(null);for(;S<=b.e.r;){u.push(em(s,b,S,d)),++S;break}},u},to_csv:function(s,c){var u=lf(),d=c??{};if(s==null||s["!ref"]==null)return u.push(null),u;var g=wn(s["!ref"]),x=d.FS!==void 0?d.FS:",",b=x.charCodeAt(0),S=d.RS!==void 0?d.RS:`
`,N=S.charCodeAt(0),T=new RegExp((x=="|"?"\\|":x)+"+$"),F="",O=[];d.dense=Array.isArray(s);for(var L=d.skipHidden&&s["!cols"]||[],B=d.skipHidden&&s["!rows"]||[],ee=g.s.c;ee<=g.e.c;++ee)(L[ee]||{}).hidden||(O[ee]=Ln(ee));var G=g.s.r,he=!1,ne=0;return u._read=function(){if(!he)return he=!0,u.push("\uFEFF");for(;G<=g.e.r;)if(++G,!(B[G-1]||{}).hidden&&(F=Uu(s,g,G-1,O,b,N,x,d),F!=null&&((F=d.strip?F.replace(T,""):F)||d.blankrows!==!1)))return u.push((ne++?S:"")+F);return u.push(null)},u},set_readable:kl},ta=(function(){function s(c,u,d){return this instanceof s?(this.tagName=c,this._attributes=u||{},this._children=d||[],this._prefix="",this):new s(c,u,d)}return s.prototype.createElement=function(){return new s(arguments)},s.prototype.children=function(){return this._children},s.prototype.append=function(c){return this._children.push(c),this},s.prototype.prefix=function(c){return arguments.length==0?this._prefix:(this._prefix=c,this)},s.prototype.attr=function(c,u){if(u==null)return delete this._attributes[c],this;if(arguments.length==0)return this._attributes;if(typeof c=="string"&&arguments.length==1)return this._attributes.attr[c];if(typeof c=="object"&&arguments.length==1)for(var d in c)this._attributes[d]=c[d];else arguments.length==2&&typeof c=="string"&&(this._attributes[c]=u);return this},s.prototype.escapeAttributeValue=function(c){return'"'+c.replace(/\"/g,"&quot;")+'"'},s.prototype.toXml=function(c){var u=(c=c||this)._prefix;if(u+="<"+c.tagName,c._attributes)for(var d in c._attributes)u+=" "+d+"="+this.escapeAttributeValue(""+c._attributes[d]);if(c._children&&0<c._children.length){u+=">";for(var g=0;g<c._children.length;g++)u+=this.toXml(c._children[g]);u+="</"+c.tagName+">"}else u+="/>";return u},s})(),Kg=function(s){var c,u=164,d={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},g={};for(c in d)g[d[c]]=c;var x={};return{initialize:function(b){this.$fonts=ta("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=ta("fills").attr("count",0),this.$borders=ta("borders").attr("count",0),this.$numFmts=ta("numFmts").attr("count",0),this.$cellStyleXfs=ta("cellStyleXfs"),this.$xf=ta("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=ta("cellXfs").attr("count",0),this.$cellStyles=ta("cellStyles").append(ta("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=ta("dxfs").attr("count","0"),this.$tableStyles=ta("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=ta("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var S=b.defaultCellStyle||{};return S.font||(S.font={name:"Calibri",sz:"11"}),S.font.name||(S.font.name="Calibri"),S.font.sz||(S.font.sz=11),S.fill||(S.fill={patternType:"none",fgColor:{}}),S.border||(S.border={}),S.numFmt||(S.numFmt=0),this.defaultStyle=S,b=JSON.parse(JSON.stringify(S)),b.fill={patternType:"gray125",fgColor:{}},this.addStyles([S,b]),this},addStyle:function(b){var S=JSON.stringify(b),N=x[S];return N==null?(N=this._addXf(b),x[S]=N):N=x[S],N},addStyles:function(b){var S=this;return b.map(function(N){return S.addStyle(N)})},_duckTypeStyle:function(b){return typeof b=="object"&&(b.patternFill||b.fgColor)?{fill:b}:b.font||b.numFmt||b.border||b.fill?b:this._getStyleCSS(b)},_getStyleCSS:function(b){return b},_addXf:function(b){var S=this._addFont(b.font),N=this._addFill(b.fill),T=this._addBorder(b.border),F=this._addNumFmt(b.numFmt),O=ta("xf").attr("numFmtId",F).attr("fontId",S).attr("fillId",N).attr("borderId",T).attr("xfId","0");return 0<S&&O.attr("applyFont","1"),0<N&&O.attr("applyFill","1"),0<T&&O.attr("applyBorder","1"),0<F&&O.attr("applyNumberFormat","1"),b.alignment&&(F=ta("alignment"),b.alignment.horizontal&&F.attr("horizontal",b.alignment.horizontal),b.alignment.vertical&&F.attr("vertical",b.alignment.vertical),b.alignment.indent&&F.attr("indent",b.alignment.indent),b.alignment.readingOrder&&F.attr("readingOrder",b.alignment.readingOrder),b.alignment.wrapText&&F.attr("wrapText",b.alignment.wrapText),b.alignment.textRotation!=null&&F.attr("textRotation",b.alignment.textRotation),O.append(F).attr("applyAlignment",1)),this.$cellXfs.append(O),O=+this.$cellXfs.children().length,this.$cellXfs.attr("count",O),O-1},_addFont:function(b){if(!b)return 0;var S=ta("font").append(ta("sz").attr("val",b.sz||this.defaultStyle.font.sz)).append(ta("name").attr("val",b.name||this.defaultStyle.font.name));return b.bold&&S.append(ta("b")),b.underline&&S.append(ta("u")),b.italic&&S.append(ta("i")),b.strike&&S.append(ta("strike")),b.outline&&S.append(ta("outline")),b.shadow&&S.append(ta("shadow")),b.vertAlign&&S.append(ta("vertAlign").attr("val",b.vertAlign)),b.color&&(b.color.theme?(S.append(ta("color").attr("theme",b.color.theme)),b.color.tint&&S.append(ta("tint").attr("theme",b.color.tint))):b.color.rgb&&S.append(ta("color").attr("rgb",b.color.rgb))),this.$fonts.append(S),S=this.$fonts.children().length,this.$fonts.attr("count",S),S-1},_addNumFmt:function(b){if(!b)return 0;if(typeof b=="string"){var S=g[b];if(0<=S)return S}return/^[0-9]+$/.exec(b)?b:(b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),b=ta("numFmt").attr("numFmtId",++u).attr("formatCode",b),this.$numFmts.append(b),b=this.$numFmts.children().length,this.$numFmts.attr("count",b),u)},_addFill:function(b){if(!b)return 0;var S,N=ta("patternFill").attr("patternType",b.patternType||"solid");return b.fgColor&&(S=ta("fgColor"),b.fgColor.rgb?(b.fgColor.rgb.length==6&&(b.fgColor.rgb="FF"+b.fgColor.rgb),S.attr("rgb",b.fgColor.rgb),N.append(S)):b.fgColor.theme&&(S.attr("theme",b.fgColor.theme),b.fgColor.tint&&S.attr("tint",b.fgColor.tint),N.append(S)),b.bgColor||(b.bgColor={indexed:"64"})),b.bgColor&&(b=ta("bgColor").attr(b.bgColor),N.append(b)),N=ta("fill").append(N),this.$fills.append(N),N=this.$fills.children().length,this.$fills.attr("count",N),N-1},_getSubBorder:function(b,S){var N=ta(b);return S&&(N.attr("style",S.style||"medium"),S.color&&(b=ta("color"),S.color.auto?b.attr("auto",S.color.auto):S.color.rgb?b.attr("rgb",S.color.rgb):(S.color.theme||S.color.tint)&&(b.attr("theme",S.color.theme||"1"),b.attr("tint",S.color.tint||"0")),N.append(b))),N},_addBorder:function(b){if(!b)return 0;var S=this,N=ta("border").attr("diagonalUp",b.diagonalUp).attr("diagonalDown",b.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(F){N.append(S._getSubBorder(F,b[F]))}),this.$borders.append(N);var T=this.$borders.children().length;return this.$borders.attr("count",T),T-1},toXml:function(){return this.$styles.toXml()}}.initialize(s||{})};i0!==void 0&&(n.parse_xlscfb=i0),n.parse_zip=om,n.read=sf,n.readFile=A1,n.readFileSync=A1,n.write=C1,n.writeFile=Vg,n.writeFileSync=Vg,n.writeFileAsync=function(s,c,u,d){var g=u||{};return g.type="file",g.file=s,N1(g),g.type="buffer",d instanceof Function||(d=u),fn.writeFile(s,C1(c,g),d)},n.utils=gm,n.writeXLSX=f0,n.writeFileXLSX=function(s,c,u){return(u=u||{}).type="file",u.file=c,N1(u),f0(s,u)},n.SSF=on,Ch!==void 0&&(n.stream=Ch),Jt!==void 0&&(n.CFB=Jt),typeof F2>"u"||((Ch=$5)||{}).Readable&&kl(Ch.Readable)}if(a(t),typeof window<"u"&&!window.XLSX)try{window.XLSX=r}catch{}})(m2,m2.exports)),m2.exports}var Mo=FR();const RR=()=>{const[i,t]=le.useState(""),[r,a]=le.useState(""),[n,e]=le.useState([]),[p,m]=le.useState(!1),[y,w]=le.useState(null),[A,I]=le.useState({isOpen:!1,type:"success",title:"",message:""});le.useEffect(()=>{const M=new Date,V=new Date(M.getFullYear(),M.getMonth(),1),q=new Date(M);q.setDate(M.getDate()-1);const U=te=>{const W=te.getFullYear(),re=(te.getMonth()+1).toString().padStart(2,"0"),xe=te.getDate().toString().padStart(2,"0");return`${W}-${re}-${xe}`};t(U(V)),a(U(q))},[]);const R=async()=>{if(!i||!r){w("Please select both From Date and To Date.");return}if(new Date(i)>new Date(r)){w("From Date cannot be later than To Date.");return}w(null),m(!0),e([]);try{const V=(await cr.getAllAttendanceInRange(i,r)).map(q=>{const[U,te,W]=q.date.split("/"),re=new Date(parseInt(W),parseInt(te)-1,parseInt(U));return{Date:q.date,EmployeeName:q.name||"",StaffMail:q.email||"",Place:q.place||"",CheckInTime:q.checkInTime||"",CheckOutTime:q.checkOutTime||"",WorkingHours:q.workingHours||"",Status:q.status||"",rawDate:re}});V.sort((q,U)=>q.rawDate&&U.rawDate?q.rawDate.getTime()-U.rawDate.getTime():0),e(V)}catch(M){console.error(M),w("Failed to fetch attendance records. Please try again.")}finally{m(!1)}},k=()=>{if(console.log("Starting Excel Download..."),n.length===0){console.warn("No data to download");return}try{const M=Mo.utils.book_new(),V=new Map;n.forEach(({rawDate:re,...xe})=>{const ve=xe.EmployeeName;V.has(ve)||V.set(ve,[]),V.get(ve)?.push(xe)});const q=Array.from(V.entries()).map(([re,xe])=>{let ve=0,De=0,ke=0,de=0,Oe=0;xe.forEach(K=>{const Ae=K.Status||"";["Present","On Time","Work From Home"].some(Ce=>Ae.includes(Ce))?ve++:Ae.includes("Half Day")?ke++:["Leave","Sick Leave","Casual Leave","Privilege Leave"].some(Ce=>Ae.includes(Ce))?De++:Ae.includes("Absent")||Ae.includes("IN")||Ae==="IN"?de++:Ae.includes("Holiday")?Oe++:Ae===""&&de++});const z=ve+de+De+ke;return{"Employee Name":re,"Working Days":z,Present:ve,Leave:De,"Half Day":ke,Absent:de,Holidays:Oe}}),U=Mo.utils.json_to_sheet(q);U["!cols"]=[{wch:20},{wch:15},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10}],Mo.utils.book_append_sheet(M,U,"Attendance Summary");const te=n.map(({rawDate:re,...xe})=>xe),W=Mo.utils.json_to_sheet(te);W["!cols"]=[{wch:12},{wch:20},{wch:25},{wch:10},{wch:10},{wch:10},{wch:12},{wch:12}],Mo.utils.book_append_sheet(M,W,"Full Data"),V.forEach((re,xe)=>{let ve=0,De=0,ke=0,de=0,Oe=0;re.forEach(H=>{const ae=H.Status||"";["Present","On Time","Work From Home"].some(Z=>ae.includes(Z))?ve++:ae.includes("Half Day")?ke++:["Leave","Sick Leave","Casual Leave","Privilege Leave"].some(Z=>ae.includes(Z))?De++:ae.includes("Absent")||ae.includes("IN")||ae==="IN"?de++:ae.includes("Holiday")?Oe++:ae===""&&de++});const z=ve+de+De+ke,K=re,Ae=xe.substring(0,30).replace(/[\\/?*[\]]/g,""),Ce=Mo.utils.json_to_sheet(K),Be=10,Ee=0;Mo.utils.sheet_add_aoa(Ce,[["Metric","Count"]],{origin:{r:Ee,c:Be}}),[{metric:"Working Days",count:z,color:"C6E0B4"},{metric:"Present",count:ve,color:"92D050"},{metric:"Absent",count:de,color:"FFC7CE"},{metric:"Leave",count:De,color:"FFC000"},{metric:"Half Day",count:ke,color:"FFFF00"},{metric:"Holidays",count:Oe,color:"00B0F0"}].forEach((H,ae)=>{const Z=Ee+1+ae;Mo.utils.sheet_add_aoa(Ce,[[H.metric,H.count]],{origin:{r:Z,c:Be}});const se=Mo.utils.encode_cell({r:Z,c:Be});Ce[se]||(Ce[se]={t:"s",v:H.metric}),Ce[se].s={fill:{fgColor:{rgb:H.color}},font:{name:"Times New Roman",sz:11,bold:!0},alignment:{horizontal:"left",vertical:"center"}};const ye=Mo.utils.encode_cell({r:Z,c:Be+1});Ce[ye]||(Ce[ye]={t:"n",v:H.count}),Ce[ye].s={font:{name:"Times New Roman",sz:11},alignment:{horizontal:"center",vertical:"center"}}});const Ue=Mo.utils.decode_range(Ce["!ref"]||"A1");for(let H=0;H<=Ue.e.r;H++)for(let ae=0;ae<=8;ae++){const Z=Mo.utils.encode_cell({r:H,c:ae}),se=Ce[Z];se&&(se.s||(se.s={}),se.s.font={name:"Times New Roman",sz:11})}const _e=7;for(let H=1;H<=Ue.e.r;H++){const ae=Mo.utils.encode_cell({r:H,c:_e}),Z=Ce[ae];if(Z&&Z.v){const se=String(Z.v);let ye="FFFFFF";["Present","On Time"].some(ce=>se.includes(ce))?ye="92D050":se.includes("Half Day")?ye="FFFF00":se.includes("Absent")?ye="FFC7CE":["Leave","Sick Leave","Casual Leave","Privilege Leave"].some(ce=>se.includes(ce))?ye="FFC000":se.includes("Holiday")&&(ye="00B0F0"),Z.s={fill:{fgColor:{rgb:ye}},font:{name:"Times New Roman",sz:11,bold:!0},alignment:{horizontal:"center",vertical:"center"}}}}const Le=Mo.utils.encode_cell({r:Ee,c:Be}),X=Mo.utils.encode_cell({r:Ee,c:Be+1});Ce[Le]&&(Ce[Le].s={font:{name:"Times New Roman",sz:11,bold:!0},fill:{fgColor:{rgb:"D9D9D9"}},alignment:{horizontal:"center",vertical:"center"}}),Ce[X]&&(Ce[X].s={font:{name:"Times New Roman",sz:11,bold:!0},fill:{fgColor:{rgb:"D9D9D9"}},alignment:{horizontal:"center",vertical:"center"}}),Ce["!cols"]=[{wch:12},{wch:20},{wch:25},{wch:10},{wch:12},{wch:12},{wch:12},{wch:12},{wch:2},{wch:2},{wch:15},{wch:10}],Mo.utils.book_append_sheet(M,Ce,Ae)}),console.log("Writing file..."),Mo.writeFile(M,`Attendance_Report_${i}_to_${r}.xlsx`,{cellStyles:!0}),console.log("Download triggered.")}catch(M){console.error("Excel Generation Error:",M),I({isOpen:!0,type:"error",title:"Export Failed",message:"Failed to generate Excel report. Please check the console."})}};return h.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Download Attendance Report"}),h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col md:flex-row gap-4 md:items-end",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"From Date"}),h.jsx("input",{type:"date",value:i,onChange:M=>t(M.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none w-full md:w-48"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"To Date"}),h.jsx("input",{type:"date",value:r,onChange:M=>a(M.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none w-full md:w-48",max:new Date().toISOString().split("T")[0]})]}),h.jsx("button",{onClick:R,disabled:p,className:"px-6 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 h-[42px]",children:p?h.jsx(h.Fragment,{children:"Loading..."}):h.jsxs(h.Fragment,{children:[h.jsx($o,{})," Fetch Report"]})})]}),y&&h.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg border border-red-100",children:y}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 flex-1 flex flex-col min-h-0 overflow-hidden",children:[h.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center",children:[h.jsxs("h2",{className:"font-bold text-gray-700 flex items-center gap-2",children:[h.jsx(cu,{className:"text-gray-400"}),"Report Data",n.length>0&&h.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs",children:[n.length," records"]})]}),n.length>0&&h.jsx("div",{className:"flex gap-2",children:h.jsxs("button",{onClick:k,className:"px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 text-sm shadow-sm",children:[h.jsx(Ym,{})," Download Excel"]})})]}),h.jsx("div",{className:"flex-1 overflow-auto",children:n.length===0?h.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 p-10",children:[h.jsx(dx,{className:"text-4xl mb-4 opacity-20"}),h.jsx("p",{children:"Select a date range and fetch data to generate report."})]}):h.jsxs("table",{className:"w-full text-sm text-left",children:[h.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 sticky top-0 z-10 shadow-sm",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Date"}),h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Employee Name"}),h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Email"}),h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Place"}),h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Check In"}),h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Check Out"}),h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Working Hours"}),h.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:"Status"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:n.map((M,V)=>h.jsxs("tr",{className:"bg-white hover:bg-gray-50 transition-colors",children:[h.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap",children:M.Date}),h.jsx("td",{className:"px-6 py-4",children:M.EmployeeName}),h.jsx("td",{className:"px-6 py-4 text-gray-500",children:M.StaffMail}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs",children:M.Place})}),h.jsx("td",{className:"px-6 py-4 font-mono text-green-600",children:M.CheckInTime}),h.jsx("td",{className:"px-6 py-4 font-mono text-red-600",children:M.CheckOutTime}),h.jsx("td",{className:"px-6 py-4 font-mono font-bold",children:M.WorkingHours}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${["Present","On Time"].includes(M.Status)?"bg-green-100 text-green-700":M.Status==="Absent"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:M.Status})})]},V))})]})})]}),h.jsx(Oh,{isOpen:A.isOpen,type:A.type,title:A.title,message:A.message,onClose:()=>I({...A,isOpen:!1})})]})},jR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(""),p=new Date,m=new Date(p.getFullYear(),p.getMonth(),1),y=new Date(p.getFullYear(),p.getMonth()+1,0),w=W=>W.toISOString().split("T")[0],[A,I]=le.useState(w(m)),[R,k]=le.useState(w(y)),M=async()=>{a(!0);try{console.log("Fetching report for:",A,R);const W=await cr.getAllLeaveRequests(A,R);console.log(`Fetched ${W.length} leave requests from SharePoint`);const re=de=>{const[Oe,z,K]=de.split("-").map(Number);return new Date(Oe,z-1,K)},xe=re(A),ve=re(R);ve.setHours(23,59,59,999);const De=W.filter(de=>{if(!de.fromDate||de.fromDate==="N/A")return!1;let Oe;if(de.fromDate.includes("/")){const[z,K,Ae]=de.fromDate.split("/").map(Number);Oe=new Date(Ae,K-1,z)}else{const[z,K,Ae]=de.fromDate.split("-").map(Number);Oe=new Date(z,K-1,Ae)}return Oe>=xe&&Oe<=ve});console.log(`Filtered to ${De.length} records within date range`);const ke=De.sort((de,Oe)=>{const z=K=>{if(K.includes("/")){const[Ee,Pe,Ue]=K.split("/").map(Number);return new Date(Ue,Pe-1,Ee).getTime()}const[Ae,Ce,Be]=K.split("-").map(Number);return new Date(Ae,Ce-1,Be).getTime()};return z(de.fromDate)-z(Oe.fromDate)});t(ke)}catch(W){console.error("Failed to fetch leave report:",W)}finally{a(!1)}},V=()=>{const W=de=>de.replace(/[\u{1F600}-\u{1F64F}]/gu,"").replace(/[\u{1F300}-\u{1F5FF}]/gu,"").replace(/[\u{1F680}-\u{1F6FF}]/gu,"").replace(/[\u{1F1E0}-\u{1F1FF}]/gu,"").replace(/[\u{2600}-\u{26FF}]/gu,"").replace(/[\u{2700}-\u{27BF}]/gu,"").replace(/[\u{FE00}-\u{FE0F}]/gu,"").replace(/[\u{1F900}-\u{1F9FF}]/gu,"").replace(/[\u{1FA70}-\u{1FAFF}]/gu,"").trim(),re=["Employee Name","Submitted On","From","To","Leave","Leave Type","Reason","Status","Approving Manager"],xe=te.map(de=>[de.employeeName,q(de.submittedOn),de.fromDate,de.toDate,de.leaveDuration,W(de.leaveType),de.reason,de.status,de.manager]),ve=[re.join(","),...xe.map(de=>de.map(Oe=>`"${Oe}"`).join(","))].join(`
`),De=new Blob([ve],{type:"text/csv;charset=utf-8;"}),ke=document.createElement("a");ke.href=URL.createObjectURL(De),ke.download=`Leave_History_Report_${A}_to_${R}.csv`,ke.click()};le.useEffect(()=>{M()},[]);const q=W=>{if(!W||W==="N/A")return"N/A";try{return new Date(W).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return W}},U=W=>{const re=W.toLowerCase();return re.includes("approved")?"bg-emerald-100 text-emerald-700":re.includes("reject")?"bg-red-100 text-red-700":re.includes("pending")?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-600"},te=i.filter(W=>W.employeeName.toLowerCase().includes(n.toLowerCase()));return h.jsxs("div",{className:"flex flex-col h-full",children:[h.jsxs("div",{className:"flex-shrink-0 bg-slate-50 pb-4 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Leave History Report"}),h.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Comprehensive record of all leave requests with overlapping month support."})]}),h.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-xl shadow-sm border border-slate-200",children:[h.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200",children:[h.jsx($o,{className:"text-slate-400 text-xs"}),h.jsx("input",{type:"text",placeholder:"Filter by Name...",value:n,onChange:W=>e(W.target.value),className:"bg-transparent border-none text-sm font-medium text-slate-700 focus:ring-0 p-0 w-32"})]}),h.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),h.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200",children:[h.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"From"}),h.jsx("input",{type:"date",value:A,onChange:W=>I(W.target.value),className:"bg-transparent border-none text-sm font-medium text-slate-700 focus:ring-0 p-0"})]}),h.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200",children:[h.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"To"}),h.jsx("input",{type:"date",value:R,onChange:W=>k(W.target.value),className:"bg-transparent border-none text-sm font-medium text-slate-700 focus:ring-0 p-0"})]}),h.jsx("button",{onClick:M,className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 transition-colors",title:"Search",children:h.jsx($o,{})}),h.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-3 py-2 bg-emerald-50 text-emerald-600 rounded-lg hover:bg-emerald-100 transition-colors",title:"Export to Excel",children:[h.jsx(Ym,{})," Export"]})]})]}),h.jsx("div",{className:"flex-1 bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden flex flex-col",children:h.jsx("div",{className:"flex-1 overflow-auto",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:h.jsxs("tr",{className:"bg-slate-50/50 border-b border-slate-100",children:[h.jsx("th",{className:"px-4 py-2.5 text-left text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Employee Name"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Submitted"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"From"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"To"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Leave"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Type"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Reason"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Manager"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-50",children:r?h.jsx("tr",{children:h.jsx("td",{colSpan:9,className:"px-6 py-12 text-center text-slate-400",children:h.jsxs("div",{className:"flex flex-col items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 border-4 border-indigo-500/30 border-t-indigo-500 rounded-full animate-spin"}),h.jsx("p",{className:"text-sm font-medium",children:"Loading report data..."})]})})}):te.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:9,className:"px-6 py-12 text-center text-slate-400",children:h.jsx("p",{className:"text-sm",children:"No leave requests found for the selected period."})})}):te.map((W,re)=>h.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[h.jsx("td",{className:"px-4 py-2",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-[10px] font-bold",children:W.employeeName.charAt(0)}),h.jsx("span",{className:"text-xs text-slate-700 whitespace-nowrap",children:W.employeeName})]})}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:"text-[11px] text-slate-500 whitespace-nowrap",children:q(W.submittedOn)})}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-indigo-600 whitespace-nowrap",children:W.fromDate}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-indigo-600 whitespace-nowrap",children:W.toDate}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-slate-600 whitespace-nowrap",children:W.leaveDuration==="N/A"?"N/A":W.leaveDuration}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:"px-2 py-0.5 rounded-md bg-indigo-50 text-indigo-700 text-[10px] font-medium border border-indigo-100 whitespace-nowrap",children:W.leaveType})}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-slate-500 max-w-[180px] truncate",title:W.reason,children:W.reason}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium border ${U(W.status)} whitespace-nowrap`,children:W.status})}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-slate-600 whitespace-nowrap",children:W.manager})]},re))})]})})})]})},OR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(""),p=new Date,m=new Date(p.getFullYear(),p.getMonth(),1),y=new Date(p.getFullYear(),p.getMonth()+1,0),w=W=>W.toISOString().split("T")[0],[A,I]=le.useState(w(m)),[R,k]=le.useState(w(y)),M=le.useCallback(async()=>{a(!0);try{console.log("Fetching permission report for:",A,R);const W=await cr.getAllPermissionRequests();console.log(`Fetched ${W.length} permission requests from SharePoint`);const re=de=>{const[Oe,z,K]=de.split("-").map(Number);return new Date(Oe,z-1,K)},xe=re(A),ve=re(R);ve.setHours(23,59,59,999);const De=W.filter(de=>{const[Oe,z,K]=de.date.split("-").map(Number),Ae=new Date(Oe,z-1,K);return Ae>=xe&&Ae<=ve});console.log(`Filtered to ${De.length} records within date range`);const ke=De.sort((de,Oe)=>{const z=K=>{const[Ae,Ce,Be]=K.split("-").map(Number);return new Date(Ae,Ce-1,Be).getTime()};return z(de.date)-z(Oe.date)});t(ke)}catch(W){console.error("Failed to fetch permission report:",W)}finally{a(!1)}},[A,R]),V=()=>{const W=["Employee Name","Submitted On","Date","Hours","Reason","Status","Approving Manager"],re=te.map(ke=>[ke.employeeName||"Unknown",q(ke.submittedOn||""),ke.date,ke.hours,ke.reason,ke.status,ke.manager]),xe=[W.join(","),...re.map(ke=>ke.map(de=>`"${de}"`).join(","))].join("\\n"),ve=new Blob([xe],{type:"text/csv;charset=utf-8;"}),De=document.createElement("a");De.href=URL.createObjectURL(ve),De.download=`Permission_Report_${A}_to_${R}.csv`,De.click()};le.useEffect(()=>{M()},[M]);const q=W=>{if(!W||W==="N/A")return"N/A";try{return new Date(W).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return W}},U=W=>{const re=W.toLowerCase();return re.includes("approved")?"bg-emerald-100 text-emerald-700":re.includes("reject")?"bg-red-100 text-red-700":re.includes("pending")||re.includes("submitted")?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-600"},te=i.filter(W=>W.employeeName.toLowerCase().includes(n.toLowerCase()));return h.jsxs("div",{className:"flex flex-col h-full",children:[h.jsxs("div",{className:"flex-shrink-0 bg-slate-50 pb-4 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Permission Report"}),h.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Comprehensive record of all permission requests."})]}),h.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-xl shadow-sm border border-slate-200",children:[h.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200",children:[h.jsx($o,{className:"text-slate-400 text-xs"}),h.jsx("input",{type:"text",placeholder:"Filter by Name...",value:n,onChange:W=>e(W.target.value),className:"bg-transparent border-none text-sm font-medium text-slate-700 focus:ring-0 p-0 w-32"})]}),h.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),h.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200",children:[h.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"From"}),h.jsx("input",{type:"date",value:A,onChange:W=>I(W.target.value),className:"bg-transparent border-none text-sm font-medium text-slate-700 focus:ring-0 p-0"})]}),h.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200",children:[h.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"To"}),h.jsx("input",{type:"date",value:R,onChange:W=>k(W.target.value),className:"bg-transparent border-none text-sm font-medium text-slate-700 focus:ring-0 p-0"})]}),h.jsx("button",{onClick:M,className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 transition-colors",title:"Search",children:h.jsx($o,{})}),h.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-3 py-2 bg-emerald-50 text-emerald-600 rounded-lg hover:bg-emerald-100 transition-colors",title:"Export to Excel",children:[h.jsx(Ym,{})," Export"]})]})]}),h.jsx("div",{className:"flex-1 bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden flex flex-col",children:h.jsx("div",{className:"flex-1 overflow-auto",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:h.jsxs("tr",{className:"bg-slate-50/50 border-b border-slate-100",children:[h.jsx("th",{className:"px-4 py-2.5 text-left text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Employee Name"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Submitted"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Date"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Hours"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Reason"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),h.jsx("th",{className:"px-4 py-2.5 text-center text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Manager"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-50",children:r?h.jsx("tr",{children:h.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-slate-400",children:h.jsxs("div",{className:"flex flex-col items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 border-4 border-indigo-500/30 border-t-indigo-500 rounded-full animate-spin"}),h.jsx("p",{className:"text-sm font-medium",children:"Loading report data..."})]})})}):te.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-slate-400",children:h.jsx("p",{className:"text-sm",children:"No permission requests found for the selected period."})})}):te.map((W,re)=>h.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[h.jsx("td",{className:"px-4 py-2",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-[10px] font-bold",children:(W.employeeName||"U").charAt(0)}),h.jsx("span",{className:"text-xs text-slate-700 whitespace-nowrap",children:W.employeeName||"Unknown"})]})}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:"text-[11px] text-slate-500 whitespace-nowrap",children:q(W.submittedOn||"")})}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-indigo-600 whitespace-nowrap",children:W.date}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-slate-600 whitespace-nowrap",children:W.hours}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-slate-500 max-w-[180px] truncate",title:W.reason,children:W.reason}),h.jsx("td",{className:"px-4 py-2 text-center",children:h.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium border ${U(W.status)} whitespace-nowrap`,children:W.status})}),h.jsx("td",{className:"px-4 py-2 text-center text-[11px] text-slate-600 whitespace-nowrap",children:W.manager})]},re))})]})})})]})},LR=()=>{const i=["2024","2025","2026","2027"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],[r,a]=le.useState(null),[n,e]=le.useState({isOpen:!1,type:"success",title:"",message:""}),p=w=>{a(w)},m=()=>{a(null)},y=w=>{if(!r)return;const A="https://jmtechtalent.sharepoint.com/sites/EmployeesDOB",I=`/sites/EmployeesDOB/Records/${r}`,M=`${(t.indexOf(w)+1).toString().padStart(2,"0")}.${w}.xlsx`,V=`${I}/${M}`,q=`${A}/_layouts/15/download.aspx?SourceUrl=${encodeURIComponent(V)}`;window.open(q,"_blank"),e({isOpen:!0,type:"success",title:"Download Started",message:`Downloading attendance report for ${w} ${r}...`})};return h.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[r&&h.jsx("button",{onClick:m,className:"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-600",title:"Back to Years",children:h.jsx(fS,{})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:r?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-gray-400 font-normal cursor-pointer hover:text-blue-600 hover:underline",onClick:m,children:"Previous Month Report"}),h.jsx("span",{className:"text-gray-400",children:"/"}),h.jsx("span",{className:"text-blue-600",children:r})]}):"Previous Month Report"}),h.jsx("p",{className:"text-gray-500 mt-1",children:r?`Download monthly attendance report for ${r}`:"Select a year to view archived attendance reports."})]})]}),h.jsx("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-gray-100 flex-1",children:r?h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-6 animate-in fade-in zoom-in-95 duration-300",children:t.map(w=>h.jsxs("div",{onClick:()=>y(w),className:"group cursor-pointer bg-gray-50 hover:bg-white border border-transparent hover:border-green-200 hover:shadow-lg p-4 rounded-xl flex flex-col items-start gap-3 transition-all duration-200",children:[h.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg group-hover:bg-green-600 group-hover:text-white transition-colors",children:h.jsx(Ym,{className:"text-xl"})}),h.jsxs("div",{children:[h.jsx("span",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:r}),h.jsx("span",{className:"block font-bold text-gray-800 text-lg group-hover:text-green-700 transition-colors",children:w})]})]},w))}):h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:i.map(w=>h.jsxs("div",{onClick:()=>p(w),className:"group cursor-pointer flex flex-col items-center gap-4 p-4 rounded-xl hover:bg-blue-50 transition-all duration-300",children:[h.jsxs("div",{className:"relative",children:[h.jsx(d9,{className:"text-6xl text-yellow-400 group-hover:text-yellow-500 transition-colors drop-shadow-md group-hover:drop-shadow-lg transform group-hover:-translate-y-1 transition-transform"}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center pt-2",children:h.jsx("span",{className:"text-[10px] font-bold text-yellow-700/50 opacity-0 group-hover:opacity-100 transition-opacity",children:"OPEN"})})]}),h.jsx("span",{className:"font-bold text-xl text-gray-700 group-hover:text-blue-700 transition-colors",children:w})]},w))})}),h.jsx(Oh,{isOpen:n.isOpen,type:n.type,title:n.title,message:n.message,onClose:()=>e({...n,isOpen:!1})})]})},xx=({isOpen:i,onClose:t,onConfirm:r,title:a,message:n,confirmText:e="Confirm",cancelText:p="Cancel",isDestructive:m=!1})=>i?h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] backdrop-blur-sm animate-fade-in",children:h.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full text-center transform transition-all scale-100 animate-scale-up border-t-8 ${m?"border-red-500":"border-blue-500"}`,children:[h.jsx("div",{className:"flex justify-center mb-4",children:h.jsx("div",{className:`p-4 rounded-full ${m?"bg-red-100":"bg-blue-100"}`,children:h.jsx(N0,{className:`text-4xl ${m?"text-red-500":"text-blue-500"}`})})}),h.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:a}),h.jsx("p",{className:"text-gray-600 mb-8 text-sm leading-relaxed",children:n}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:t,className:"flex-1 py-3 rounded-xl font-bold text-gray-500 bg-gray-100 hover:bg-gray-200 transition-colors",children:p}),h.jsx("button",{onClick:()=>{r(),t()},className:`flex-1 py-3 rounded-xl font-bold text-white shadow-md transition-all transform hover:-translate-y-1 ${m?"bg-red-500 hover:bg-red-600 shadow-red-200":"bg-blue-500 hover:bg-blue-600 shadow-blue-200"}`,children:e})]})]})}):null,PR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(""),[p,m]=le.useState(null),[y,w]=le.useState(!1),[A,I]=le.useState({name:"",email:"",dob:"",workAnniversary:"",personalId:""}),[R,k]=le.useState(!1),[M,V]=le.useState(""),[q,U]=le.useState({isOpen:!1,type:"success",title:"",message:""});le.useEffect(()=>{re()},[]);const[te,W]=le.useState({isOpen:!1,item:null}),re=async()=>{a(!0);try{const K=[...await cr.getAllEmployeeEventRecords()].sort((Ae,Ce)=>Ae.name.localeCompare(Ce.name));t(K)}catch(z){console.error("Failed to fetch employee event records",z),U({isOpen:!0,type:"error",title:"Fetch Failed",message:"Failed to retrieve employee records. Please try again."})}finally{a(!1)}},xe=z=>{m({...z})},ve=async()=>{if(p){k(!0);try{await cr.updateEmployeeEventRecord(p.id,{name:p.name,email:p.email,dob:p.dob,workAnniversary:p.workAnniversary,personalId:p.personalId}),V(`Updated record for ${p.name} successfully!`),m(null),await re(),setTimeout(()=>V(""),3e3)}catch(z){const K=z instanceof Error?z.message:"Failed to update record. Please try again.";U({isOpen:!0,type:"error",title:"Update Failed",message:K})}finally{k(!1)}}},De=async()=>{if(!A.name||!A.email){U({isOpen:!0,type:"error",title:"Incomplete Data",message:"Please provide at least a name and email."});return}k(!0);try{await cr.addEmployeeEventRecord(A),V(`Added record for ${A.name} successfully!`),w(!1),I({name:"",email:"",dob:"",workAnniversary:"",personalId:""}),await re(),setTimeout(()=>V(""),3e3)}catch(z){const K=z instanceof Error?z.message:"Failed to add record. Please try again.";U({isOpen:!0,type:"error",title:"Add Failed",message:K})}finally{k(!1)}},ke=z=>{W({isOpen:!0,item:z})},de=async()=>{const z=te.item;if(z){console.log("ReportsEmployeeEvents: Delete confirmed for",z.name,"ID:",z.id),a(!0),console.log("ReportsEmployeeEvents: Calling deleteEmployeeEventRecord...");try{await cr.deleteEmployeeEventRecord(z.id),console.log("ReportsEmployeeEvents: Deletion V2 successful"),V(`Deleted record for ${z.name} successfully!`),await re(),setTimeout(()=>V(""),3e3)}catch(K){console.error("ReportsEmployeeEvents: Delete operation failed",K);const Ae=K instanceof Error?K.message:"Failed to delete record.";U({isOpen:!0,type:"error",title:"Delete Failed",message:Ae})}finally{a(!1),W({isOpen:!1,item:null})}}},Oe=i.filter(z=>z.name.toLowerCase().includes(n.toLowerCase())||z.email.toLowerCase().includes(n.toLowerCase()));return h.jsxs("div",{className:"flex flex-col h-full",children:[h.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-20 bg-slate-50 pb-3 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Employee DOB & Work Anniv"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-bold hover:bg-blue-700 transition-all shadow-md",children:[h.jsx(ip,{}),"Add New Record"]}),h.jsxs("button",{onClick:re,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-600 hover:bg-gray-50 transition-all shadow-sm",children:[h.jsx(uu,{className:r?"animate-spin":""}),"Refresh"]})]})]}),M&&h.jsx("div",{className:"bg-emerald-50 border-l-4 border-emerald-500 p-4 mb-4 rounded-r-lg shadow-sm animate-slideIn",children:h.jsxs("p",{className:"text-emerald-700 text-sm flex items-center gap-2",children:[h.jsx("span",{className:"w-5 h-5 bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px]",children:""}),M]})}),h.jsx("div",{className:"flex-1 flex items-start justify-center overflow-hidden",children:h.jsxs("div",{className:"w-full max-w-7xl flex flex-col",style:{height:"100%"},children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden flex flex-col flex-1",children:[h.jsx("div",{className:"p-3 border-b border-gray-100 bg-gray-50 flex items-center gap-3 flex-shrink-0",children:h.jsxs("div",{className:"relative flex-1 max-w-md",children:[h.jsx($o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs"}),h.jsx("input",{type:"text",placeholder:"Search by name or email...",value:n,onChange:z=>e(z.target.value),className:"w-full pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all font-medium"})]})}),h.jsx("div",{className:"flex-1 overflow-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:h.jsxs("tr",{className:"bg-gray-50 border-b border-gray-100",children:[h.jsx("th",{className:"px-6 py-3 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-left",children:"Employee Name"}),h.jsx("th",{className:"px-6 py-3 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-left",children:"Official Email"}),h.jsx("th",{className:"px-6 py-3 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-left",children:"Personal ID"}),h.jsx("th",{className:"px-6 py-3 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-center",children:"Date of Birth"}),h.jsx("th",{className:"px-6 py-3 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-center",children:"Work Anniversary"}),h.jsx("th",{className:"px-6 py-3 text-[10px] font-bold text-gray-800 uppercase tracking-widest text-right",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-50",children:r?Array(5).fill(0).map((z,K)=>h.jsxs("tr",{className:"animate-pulse",children:[h.jsx("td",{className:"px-6 py-4",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-48"})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-48"})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-24 mx-auto"})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-24 mx-auto"})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("div",{className:"h-8 bg-gray-100 rounded w-20 ml-auto"})})]},K)):Oe.length>0?Oe.map(z=>h.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors group",children:[h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center",children:h.jsx(gS,{className:"text-xs"})}),h.jsx("span",{className:"text-sm font-bold text-gray-800",children:z.name})]})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"text-xs text-gray-500",children:z.email})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"text-xs text-gray-500",children:z.personalId})}),h.jsx("td",{className:"px-6 py-4 text-center",children:h.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-[11px] font-medium italic",children:z.dob?new Date(z.dob).toLocaleDateString("en-GB"):"N/A"})}),h.jsx("td",{className:"px-6 py-4 text-center",children:h.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-[11px] font-medium italic",children:z.workAnniversary?new Date(z.workAnniversary).toLocaleDateString("en-GB"):"N/A"})}),h.jsx("td",{className:"px-6 py-4 text-right",children:h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx("button",{onClick:()=>xe(z),className:"p-2 bg-indigo-600 text-white rounded shadow hover:bg-indigo-700 transition-all",title:"Edit",children:h.jsx(Nf,{className:"text-sm"})}),h.jsx("button",{onClick:()=>ke(z),className:"p-2 bg-rose-600 text-white rounded shadow hover:bg-rose-700 transition-all",title:"Delete",children:h.jsx(Sd,{className:"text-sm"})})]})})]},z.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-gray-400 font-medium italic",children:"No employee records found matching your search."})})})]})})]}),(p||y)&&h.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black bg-opacity-65 backdrop-blur-sm",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-scaleIn border border-gray-100",children:[h.jsxs("div",{className:"bg-gradient-to-r from-blue-700 to-indigo-800 p-6 text-white flex items-center justify-between",children:[h.jsx("h3",{className:"font-black text-xl tracking-tight",children:y?"Add New Employee Record":"Update Employee Information"}),h.jsx("button",{onClick:()=>{m(null),w(!1)},className:"text-white hover:text-blue-100 transition-colors p-1",children:h.jsx(Ju,{className:"text-2xl"})})]}),h.jsx("div",{className:"p-8 space-y-6",children:h.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest pl-1",children:"Employee Name"}),h.jsx("input",{type:"text",value:y?A.name:p?.name,onChange:z=>{const K=z.target.value;y?I({...A,name:K}):p&&m({...p,name:K})},placeholder:"e.g. John Doe",className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest pl-1",children:"Official Email"}),h.jsx("input",{type:"email",value:y?A.email:p?.email,onChange:z=>{const K=z.target.value;y?I({...A,email:K}):p&&m({...p,email:K})},placeholder:"email@example.com",className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest pl-1",children:"Personal ID / Email"}),h.jsx("input",{type:"text",value:y?A.personalId:p?.personalId,onChange:z=>{const K=z.target.value;y?I({...A,personalId:K}):p&&m({...p,personalId:K})},placeholder:"personal@email.com",className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest pl-1",children:"Date of Birth"}),h.jsx("input",{type:"date",value:y?A.dob:p?.dob?new Date(p.dob).toISOString().split("T")[0]:"",onChange:z=>{const K=z.target.value;y?I({...A,dob:K}):p&&m({...p,dob:K})},className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest pl-1",children:"Work Anniversary"}),h.jsx("input",{type:"date",value:y?A.workAnniversary:p?.workAnniversary?new Date(p.workAnniversary).toISOString().split("T")[0]:"",onChange:z=>{const K=z.target.value;y?I({...A,workAnniversary:K}):p&&m({...p,workAnniversary:K})},className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]})]})]})}),h.jsxs("div",{className:"p-6 bg-gray-50 border-t border-gray-100 flex gap-4",children:[h.jsx("button",{onClick:()=>{m(null),w(!1)},className:"flex-1 py-3.5 text-xs font-black text-gray-500 uppercase tracking-widest hover:bg-white hover:shadow-sm border border-transparent hover:border-gray-200 rounded-xl transition-all",children:"Cancel"}),h.jsxs("button",{onClick:y?De:ve,disabled:R,className:"flex-1 py-3.5 bg-blue-600 text-white text-xs font-black uppercase tracking-widest rounded-xl shadow-lg shadow-blue-200 hover:bg-blue-700 transition-all flex items-center justify-center gap-2 disabled:opacity-50",children:[R?h.jsx(uu,{className:"animate-spin text-sm"}):h.jsx(yp,{className:"text-sm"}),R?"Processing...":y?"Create Record":"Save Changes"]})]})]})})]})}),h.jsx(Oh,{isOpen:q.isOpen,type:q.type,title:q.title,message:q.message,onClose:()=>U({...q,isOpen:!1})}),h.jsx(xx,{isOpen:te.isOpen,onClose:()=>W({...te,isOpen:!1}),onConfirm:de,title:"Delete Employee Record",message:`Are you sure you want to delete the record for ${te.item?.name}? This action cannot be undone.`,confirmText:"Delete Record",isDestructive:!0})]})},MR=()=>{const[i,t]=le.useState([]),[r,a]=le.useState(!0),[n,e]=le.useState(""),[p,m]=le.useState(!1),[y,w]=le.useState(!1),[A,I]=le.useState(!1),[R,k]=le.useState(null),[M,V]=le.useState(!1),[q,U]=le.useState(null),[te,W]=le.useState({name:"",employeeId:"",professionalEmail:"",department:"",designation:"",reportingManager:"",location:"",deskNumber:"",contactNumber:"",emergencyContact:"",dateOfJoining:"",dateOfBirth:"",personalEmail:"",currentAddress:"",permanentAddress:""});le.useEffect(()=>{re()},[]);const re=async()=>{a(!0);try{const Ae=[...await cr.getAllEmployeesDB()].sort((Ce,Be)=>Ce.name.localeCompare(Be.name));t(Ae)}catch(K){console.error("Failed to fetch employee DB records",K),$u.error("Failed to load employee database")}finally{a(!1)}},xe=()=>{w(!1),k(null),W({name:"",employeeId:"",professionalEmail:"",department:"",designation:"",reportingManager:"",location:"",deskNumber:"",contactNumber:"",emergencyContact:"",dateOfJoining:"",dateOfBirth:"",personalEmail:"",currentAddress:"",permanentAddress:""}),m(!0)},ve=K=>{w(!0),k(K.id),W({name:K.name,employeeId:K.employeeId,professionalEmail:K.professionalEmail,department:K.department,designation:K.designation,reportingManager:K.reportingManager,location:K.location,deskNumber:K.deskNumber,contactNumber:K.contactNumber,emergencyContact:K.emergencyContact,dateOfJoining:K.dateOfJoining,dateOfBirth:K.dateOfBirth,personalEmail:K.personalEmail,currentAddress:K.currentAddress,permanentAddress:K.permanentAddress}),m(!0)},De=K=>{U(K),V(!0)},ke=async()=>{if(q)try{await cr.deleteEmployeeDBRecord(q),$u.success("Employee record deleted successfully"),re()}catch(K){console.error("Failed to delete record",K),$u.error("Failed to delete record")}finally{V(!1),U(null)}},de=async()=>{if(!te.name?.trim()){$u.error("Employee Name is required");return}if(!te.professionalEmail?.trim()){$u.error("Professional Email is required");return}I(!0);try{y&&R?(await cr.updateEmployeeDBRecord(R,te),$u.success("Employee record updated successfully")):(await cr.addEmployeeDBRecord(te),$u.success("New employee added successfully")),m(!1),re()}catch(K){console.error("Failed to save record",K),$u.error("Failed to save record. Please try again.")}finally{I(!1)}},Oe=i.filter(K=>K.name.toLowerCase().includes(n.toLowerCase())||K.professionalEmail.toLowerCase().includes(n.toLowerCase())||K.employeeId.toLowerCase().includes(n.toLowerCase())||K.department.toLowerCase().includes(n.toLowerCase())),z=K=>K?new Date(K).toLocaleDateString("en-GB"):"-";return h.jsxs("div",{className:"flex flex-col h-full p-6 md:p-8",children:[h.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-20 bg-gray-50 pb-4 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[h.jsx(t9,{className:"text-blue-600"}),"Employee Database"]}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Complete directory of all employees across locations."})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("button",{onClick:xe,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 transition-all shadow-sm font-medium",children:[h.jsx(ip,{}),"Add Employee"]}),h.jsxs("button",{onClick:re,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-600 hover:bg-gray-50 transition-all shadow-sm",children:[h.jsx(uu,{className:r?"animate-spin":""}),"Refresh"]})]})]}),h.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden",children:[h.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-3",children:[h.jsxs("div",{className:"relative flex-1 max-w-md",children:[h.jsx($o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs"}),h.jsx("input",{type:"text",placeholder:"Search by name, ID, email, or department...",value:n,onChange:K=>e(K.target.value),className:"w-full pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all font-medium"})]}),h.jsxs("div",{className:"text-xs text-gray-500 font-medium ml-auto",children:["Showing ",Oe.length," records"]})]}),h.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:h.jsxs("table",{className:"w-full text-left border-collapse min-w-[2000px]",children:[h.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:h.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200 shadow-sm",children:[h.jsx("th",{className:"sticky left-0 bg-gray-50 z-20 px-4 py-3 text-[10px] font-bold text-gray-500 uppercase w-24 text-center",children:"Action"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[100px]",children:"Emp ID"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[200px]",children:"Name"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[250px]",children:"Professional Email"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[150px]",children:"Department"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[150px]",children:"Designation"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[150px]",children:"Reporting Mgr"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[120px]",children:"Location"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[100px]",children:"Desk No"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[120px]",children:"Contact No"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[120px]",children:"Emergency No"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[100px]",children:"DOJ"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[100px]",children:"DOB"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[200px]",children:"Personal Email"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[300px]",children:"Current Address"}),h.jsx("th",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase tracking-widest text-left min-w-[300px]",children:"Permanent Address"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-50",children:r?Array(10).fill(0).map((K,Ae)=>h.jsxs("tr",{className:"animate-pulse",children:[h.jsx("td",{className:"px-4 py-3",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded"})}),h.jsx("td",{colSpan:15,className:"px-4 py-3",children:h.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/2"})})]},Ae)):Oe.length>0?Oe.map(K=>h.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors group text-sm text-gray-700",children:[h.jsx("td",{className:"sticky left-0 bg-white group-hover:bg-blue-50/30 z-20 px-4 py-3 text-center border-r border-gray-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:h.jsxs("div",{className:"flex items-center justify-center gap-2",children:[h.jsx("button",{onClick:()=>ve(K),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-100 rounded-md transition-all",title:"Edit Record",children:h.jsx(Nf,{})}),h.jsx("button",{onClick:()=>De(K.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-100 rounded-md transition-all",title:"Delete Record",children:h.jsx(Sd,{})})]})}),h.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:K.employeeId}),h.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:K.name}),h.jsx("td",{className:"px-4 py-3 text-gray-600",children:K.professionalEmail}),h.jsx("td",{className:"px-4 py-3",children:K.department}),h.jsx("td",{className:"px-4 py-3",children:K.designation}),h.jsx("td",{className:"px-4 py-3",children:K.reportingManager}),h.jsx("td",{className:"px-4 py-3",children:K.location}),h.jsx("td",{className:"px-4 py-3",children:K.deskNumber}),h.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:K.contactNumber}),h.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:K.emergencyContact}),h.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:z(K.dateOfJoining)}),h.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:z(K.dateOfBirth)}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:K.personalEmail}),h.jsx("td",{className:"px-4 py-3 text-xs text-gray-500 truncate max-w-xs",title:K.currentAddress,children:K.currentAddress}),h.jsx("td",{className:"px-4 py-3 text-xs text-gray-500 truncate max-w-xs",title:K.permanentAddress,children:K.permanentAddress})]},K.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:16,className:"px-6 py-12 text-center text-gray-400 font-medium italic bg-gray-50/50",children:"No employees found matching your search criteria."})})})]})})]}),p&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col animate-in fade-in zoom-in duration-200",children:[h.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 bg-gray-50",children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[y?h.jsx(Nf,{className:"text-blue-600"}):h.jsx(ip,{className:"text-blue-600"}),y?"Edit Employee Record":"Add New Employee"]}),h.jsx("button",{onClick:()=>m(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:h.jsx(Ju,{})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest border-b pb-2 mb-4",children:"Professional Details"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Employee Name ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"text",value:te.name,onChange:K=>W({...te,name:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Full Name"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Employee ID"}),h.jsx("input",{type:"text",value:te.employeeId,onChange:K=>W({...te,employeeId:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"e.g. JMT 123"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Professional Email ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"email",value:te.professionalEmail,onChange:K=>W({...te,professionalEmail:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"work@jm-group.ca"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Department"}),h.jsx("input",{type:"text",value:te.department,onChange:K=>W({...te,department:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Department Name"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Designation"}),h.jsx("input",{type:"text",value:te.designation,onChange:K=>W({...te,designation:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Job Title"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Reporting Manager"}),h.jsx("input",{type:"text",value:te.reportingManager,onChange:K=>W({...te,reportingManager:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Manager Name"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date of Joining"}),h.jsx("input",{type:"date",value:te.dateOfJoining?te.dateOfJoining.split("T")[0]:"",onChange:K=>W({...te,dateOfJoining:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Place"}),h.jsx("input",{type:"text",value:te.location,onChange:K=>W({...te,location:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"City"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Desk Number"}),h.jsx("input",{type:"text",value:te.deskNumber,onChange:K=>W({...te,deskNumber:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Desk ID"})]})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest border-b pb-2 mb-4",children:"Personal Details"}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Personal Email"}),h.jsx("input",{type:"email",value:te.personalEmail,onChange:K=>W({...te,personalEmail:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"personal@gmail.com"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Contact Number"}),h.jsx("input",{type:"text",value:te.contactNumber,onChange:K=>W({...te,contactNumber:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Mobile Number"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Emergency Contact"}),h.jsx("input",{type:"text",value:te.emergencyContact,onChange:K=>W({...te,emergencyContact:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Emergency Number"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date of Birth"}),h.jsx("input",{type:"date",value:te.dateOfBirth?te.dateOfBirth.split("T")[0]:"",onChange:K=>W({...te,dateOfBirth:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Current Address"}),h.jsx("textarea",{value:te.currentAddress,onChange:K=>W({...te,currentAddress:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all resize-none h-20",placeholder:"Full current address"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Permanent Address"}),h.jsx("textarea",{value:te.permanentAddress,onChange:K=>W({...te,permanentAddress:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all resize-none h-20",placeholder:"Full permanent address"})]})]})]})}),h.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex items-center justify-end gap-3 z-10",children:[h.jsx("button",{onClick:()=>m(!1),className:"px-5 py-2.5 bg-white border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors shadow-sm",children:"Cancel"}),h.jsx("button",{onClick:de,disabled:A,className:"px-5 py-2.5 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-sm flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:A?h.jsxs(h.Fragment,{children:[h.jsx(uu,{className:"animate-spin"}),"Saving..."]}):h.jsxs(h.Fragment,{children:[h.jsx(yp,{}),"Save Employee"]})})]})]})}),h.jsx(xx,{isOpen:M,onClose:()=>V(!1),onConfirm:ke,title:"Delete Employee Record",message:"Are you sure you want to delete this employee record? This action cannot be undone.",confirmText:"Delete Record",cancelText:"Cancel",isDestructive:!0})]})},UR=()=>{const i=kf(),[t,r]=le.useState([]),[a,n]=le.useState(!0),[e,p]=le.useState(""),[m,y]=le.useState(!1),[w,A]=le.useState(!1),[I,R]=le.useState(!1),[k,M]=le.useState(null),[V,q]=le.useState(!1),[U,te]=le.useState(null),[W,re]=le.useState({employeeName:"",date:""});le.useEffect(()=>{xe()},[]);const xe=async()=>{n(!0);try{const K=await cr.getAllUpcomingLeaves();r(K)}catch(K){console.error("Failed to fetch upcoming leaves",K),ps.error("Failed to load upcoming leaves")}finally{n(!1)}},ve=()=>{A(!1),M(null),re({employeeName:"",date:""}),y(!0)},De=K=>{A(!0),M(K.id),re({employeeName:K.employeeName,date:K.date}),y(!0)},ke=K=>{te(K),q(!0)},de=async()=>{if(U)try{await cr.deleteUpcomingLeave(U),ps.success("Leave record deleted successfully"),xe()}catch(K){console.error("Failed to delete record",K),ps.error("Failed to delete record")}finally{q(!1),te(null)}},Oe=async()=>{if(!W.employeeName?.trim()||!W.date?.trim()){ps.error("Name and Date are required");return}R(!0);try{w&&k?(await cr.updateUpcomingLeave(k,W),ps.success("Leave updated successfully")):(await cr.addUpcomingLeave(W),ps.success("Leave added successfully")),y(!1),xe()}catch(K){console.error("Failed to save record",K),ps.error("Failed to save record")}finally{R(!1)}},z=t.filter(K=>K.employeeName.toLowerCase().includes(e.toLowerCase()));return h.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[h.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{onClick:()=>i("/reports"),className:"p-2 hover:bg-white rounded-lg transition-colors text-gray-600",children:h.jsx(fS,{})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Upcoming Leaves"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Manage projected leave schedules"})]})]}),h.jsxs("button",{onClick:ve,className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[h.jsx(ip,{})," Add Leave"]})]}),h.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:h.jsxs("div",{className:"relative max-w-md",children:[h.jsx($o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Search by name...",value:e,onChange:K=>p(K.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all"})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200 text-xs uppercase text-gray-500 font-semibold",children:[h.jsx("th",{className:"px-6 py-4",children:"Employee Name"}),h.jsx("th",{className:"px-6 py-4",children:"Date(s)"}),h.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100",children:a?h.jsx("tr",{children:h.jsx("td",{colSpan:3,className:"px-6 py-8 text-center text-gray-500",children:h.jsxs("div",{className:"animate-pulse flex justify-center items-center gap-2",children:[h.jsx("div",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce"}),h.jsx("div",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce delay-100"}),h.jsx("div",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce delay-200"})]})})}):z.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:3,className:"px-6 py-8 text-center text-gray-500",children:"No upcoming leaves found."})}):z.map(K=>h.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[h.jsx("td",{className:"px-6 py-4 font-medium text-gray-800",children:K.employeeName}),h.jsx("td",{className:"px-6 py-4 text-gray-600",children:K.date}),h.jsxs("td",{className:"px-6 py-4 text-right space-x-2",children:[h.jsx("button",{onClick:()=>De(K),className:"p-1.5 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-all opacity-0 group-hover:opacity-100",title:"Edit",children:h.jsx(Nf,{})}),h.jsx("button",{onClick:()=>ke(K.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-100 rounded-md transition-all opacity-0 group-hover:opacity-100",title:"Delete",children:h.jsx(Sd,{})})]})]},K.id))})]})})})]}),m&&h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200",children:[h.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:w?"Edit Leave Record":"Add New Leave"}),h.jsx("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:h.jsx(Ju,{})})]}),h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Name *"}),h.jsx("input",{type:"text",value:W.employeeName,onChange:K=>re({...W,employeeName:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all",placeholder:"Enter employee name"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date(s) *"}),h.jsx("input",{type:"text",value:W.date,onChange:K=>re({...W,date:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all",placeholder:"e.g. 29 December - 31 December"})]})]}),h.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-200 rounded-lg transition-colors font-medium",disabled:I,children:"Cancel"}),h.jsx("button",{onClick:Oe,disabled:I,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:I?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):h.jsxs(h.Fragment,{children:[h.jsx(yp,{}),"Save Record"]})})]})]})}),h.jsx(xx,{isOpen:V,onClose:()=>q(!1),onConfirm:de,title:"Delete Leave Record",message:"Are you sure you want to delete this leave record? This action cannot be undone.",confirmText:"Delete Record",cancelText:"Cancel",isDestructive:!0})]})},BR=({onSignIn:i})=>h.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(/login-bg.jpg)"}}),h.jsx("div",{className:"absolute inset-0 bg-gray-900/20"}),h.jsx("div",{className:"relative z-10 w-full max-w-sm",children:h.jsxs("div",{className:"bg-slate-800/20 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/20 p-8 text-center",children:[h.jsx("div",{className:"flex justify-center mb-4",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 bg-orange-500/10 blur-xl rounded-full"}),h.jsx("img",{src:"/jm-logo.png",alt:"JM Group Inc Logo",className:"relative w-24 h-24 object-contain drop-shadow-2xl"})]})}),h.jsx("h1",{className:"text-3xl font-bold text-white mb-2 tracking-tight drop-shadow-lg",children:"JM Group Inc"}),h.jsx("h2",{className:"text-base text-gray-100 mb-2 font-medium",children:"HRMS Portal"}),h.jsx("p",{className:"text-gray-200 text-xs mb-6",children:"Please sign in to continue"}),h.jsxs("button",{onClick:i,className:"w-full bg-white hover:bg-gray-50 text-gray-900 font-semibold py-3 px-5 rounded-xl transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2 group relative overflow-hidden text-sm",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-200%] group-hover:translate-x-[200%] transition-transform duration-700"}),h.jsx(y9,{className:"text-orange-500 group-hover:text-orange-600 transition-colors relative z-10 text-sm"}),h.jsx("span",{className:"relative z-10",children:"Sign In with Microsoft"})]}),h.jsx("p",{className:"mt-5 text-[10px] text-gray-300",children:"Powered by Microsoft Azure AD"})]})})]}),HR=()=>{const{permissionLevel:i,employee:t,loading:r,isAccessDenied:a}=du(),{instance:n}=Cd(),e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||navigator.maxTouchPoints>0&&window.innerWidth<1024;return r?h.jsx("div",{className:"h-screen flex items-center justify-center",children:"Loading..."}):a?h.jsxs("div",{className:"h-screen flex flex-col items-center justify-center bg-gray-50 text-center p-6",children:[h.jsx("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Access Denied"}),h.jsx("p",{className:"text-gray-600 mb-6 max-w-md",children:"Your account is not registered in the HRMS Employee database. Please contact the HR department to verify your profile settings."}),h.jsx("button",{onClick:()=>n.logoutPopup(),className:"px-6 py-2 bg-gray-800 text-white rounded hover:bg-gray-900",children:"Sign Out"})]}):h.jsx(R9,{permissionLevel:i||"Employee",department:t?.department,designation:t?.designation,isMobileOnly:e,children:h.jsxs(yk,{children:[h.jsx(Ta,{path:"/",element:h.jsx(g5,{to:e?"/leave":"/dashboard",replace:!0})}),e?h.jsxs(h.Fragment,{children:[h.jsx(Ta,{path:"/leave",element:h.jsx(cw,{})}),h.jsx(Ta,{path:"/leave/new",element:h.jsx(uw,{})}),h.jsx(Ta,{path:"*",element:h.jsx(g5,{to:"/leave",replace:!0})})]}):h.jsxs(h.Fragment,{children:[h.jsx(Ta,{path:"/dashboard",element:h.jsx(j9,{})}),h.jsx(Ta,{path:"/attendance",element:h.jsx(lR,{})}),B1(i||"Employee","Approvals",t?.department,t?.designation)&&h.jsx(Ta,{path:"/approvals",element:h.jsx(SR,{})}),h.jsx(Ta,{path:"/monthly-attendance",element:h.jsx(cR,{})}),h.jsx(Ta,{path:"/my-team",element:h.jsx(uR,{})}),h.jsx(Ta,{path:"/employee-profile",element:h.jsx(dR,{})}),h.jsx(Ta,{path:"/leave",element:h.jsx(cw,{})}),h.jsx(Ta,{path:"/leave/new",element:h.jsx(uw,{})}),h.jsx(Ta,{path:"/permission",element:h.jsx(fR,{})}),h.jsx(Ta,{path:"/permission/new",element:h.jsx(pR,{})}),h.jsx(Ta,{path:"/holiday",element:h.jsx(vR,{})}),B1(i||"Employee","Reports",t?.department,t?.designation)&&h.jsxs(h.Fragment,{children:[B1(i||"Employee","Payroll")&&h.jsx(Ta,{path:"/payroll",element:h.jsx(gR,{})}),B1(i||"Employee","Employees")&&h.jsx(Ta,{path:"/employees",element:h.jsx(yR,{})}),h.jsx(Ta,{path:"/reports",element:h.jsx(wR,{})}),h.jsx(Ta,{path:"/reports/todays-attendance",element:h.jsx(AR,{})}),h.jsx(Ta,{path:"/reports/filter-by-name",element:h.jsx(CR,{})}),h.jsx(Ta,{path:"/reports/update-leave-balance",element:h.jsx(NR,{})}),h.jsx(Ta,{path:"/reports/update-employee-leave",element:h.jsx(TR,{})}),h.jsx(Ta,{path:"/reports/employee-leave-calendar",element:h.jsx(ER,{})}),h.jsx(Ta,{path:"/reports/download-report",element:h.jsx(RR,{})}),h.jsx(Ta,{path:"/reports/leave-report",element:h.jsx(jR,{})}),h.jsx(Ta,{path:"/reports/permission-report",element:h.jsx(OR,{})}),h.jsx(Ta,{path:"/reports/previous-month",element:h.jsx(LR,{})}),h.jsx(Ta,{path:"/reports/employee-events",element:h.jsx(PR,{})}),h.jsx(Ta,{path:"/reports/employee-db",element:h.jsx(MR,{})}),h.jsx(Ta,{path:"/reports/upcoming-leaves",element:h.jsx(UR,{})})]}),B1(i||"Employee","Settings")&&h.jsx(Ta,{path:"/settings",element:h.jsx(xR,{})}),h.jsx(Ta,{path:"*",element:h.jsx(g5,{to:"/dashboard",replace:!0})})]})]})})};function zR(){const{instance:i}=Cd();return h.jsxs(Hk,{children:[h.jsx(BE,{children:h.jsxs(z_,{children:[h.jsx(P_,{position:"top-right"}),h.jsx(HR,{})]})}),h.jsx(HE,{children:h.jsx(BR,{onSignIn:()=>i.loginPopup({scopes:["Sites.ReadWrite.All"]})})})]})}const vf=new Vb(zE);ry(vf);!vf.getActiveAccount()&&vf.getAllAccounts().length>0&&vf.setActiveAccount(vf.getAllAccounts()[0]);vf.addEventCallback(i=>{if(i.eventType==="msal:loginSuccess"&&i.payload.account){const t=i.payload.account;vf.setActiveAccount(t)}});class $R extends vo.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?h.jsxs("div",{className:"p-8 text-center",children:[h.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong."}),h.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an unexpected error."}),h.jsx("pre",{className:"bg-gray-100 p-4 rounded text-left overflow-auto max-w-2xl mx-auto text-sm",children:this.state.error?.toString()}),h.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Application"})]}):this.props.children}}UA.createRoot(document.getElementById("root")).render(h.jsx(le.StrictMode,{children:h.jsxs($R,{children:[" ",h.jsx(ME,{instance:vf,children:h.jsx(zR,{})})]})}));export{ns as _,qR as c,kA as g};
